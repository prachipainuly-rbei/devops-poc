# Copyright (C) 1990 - 2012 CONTACT Software GmbH
# All rights reserved.
# http://www.contact.de/
#

# TO BE TESTED:

# - System tasks are assigned to the same user that runs the wfqueue
# - Forward a task (when is it allowed?)

Feature: Manage Tasks


Scenario Outline: Task with constraints
    GIVEN a running process with some not running tasks exists
        AND the not running task has a constraint which evaluates to <status>
    WHEN the new task is started
    THEN the new task is <outcome>

    Examples:
        | status | outcome  |
        | true   | started  |
        | false  | canceled |


Scenario Outline: Task with comments
    GIVEN a process was created
        AND the process has a <type> task
    WHEN the task is closed <preposition> a comment
    THEN the task is <outcome>

    Examples:
        | type        | preposition | outcome    |
        | execution   | with        | closed     |
        | execution   | without     | closed     |
        | examination | with        | closed     |
        | examination | without     | not closed |
        | approval    | with        | closed     |
        | approval    | without     | not closed |


Scenario Outline: Task with finish option
    GIVEN a process exists
        AND the process has a examination task with finish option
    WHEN the task is <event>
    THEN the following task is <task outcome>
        AND the process is <process outcome>

    Examples:
        | event     | task outcome | process outcome |
        | closed    | canceled     | closed          |
        | refused   | canceled     | closed          |
        | forwarded | started      | not closed      |


Scenario Outline: Task with finish option
    GIVEN a process exists
        AND the process has a task group
        AND the task group has a <type> task with finish option
    WHEN the task is <event>
    THEN the following task is <task outcome>
        AND the task group is <task group outcome>
        AND the process is <process outcome>

    Examples:
        | type        | event     | task outcome  | task group outcome | process outcome |
        | examination | closed    | canceled      | closed             | closed          |
        | examination | refused   | canceled      | closed             | closed          |
        | examination | forwarded | started       | not closed         | not closed      |
        | approval    | closed    | canceled      | closed             | closed          |
        | approval    | refused   | canceled      | refused            | canceled        |
        | approval    | forwarded | started       | not closed         | not closed      |

Scenario: Extend rights for system tasks
    GIVEN a process was created
        AND the process has a system task
        AND the task has some briefcase without the extends rights option
    THEN the briefcase link has not the extends rights property
