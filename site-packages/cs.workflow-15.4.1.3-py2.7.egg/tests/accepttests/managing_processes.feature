# Copyright (C) 1990 - 2013 CONTACT Software GmbH
# All rights reserved.
# http://www.contact.de/
#


Feature: Managing Processes


Scenario Outline: Create New Process
    WHEN <role> creates a new process
    THEN a new process is <creation>
    THEN a global info briefcase is <creation>
    THEN a process completion task group is <creation>

    Examples:
        | role                         | creation  |
        | cdbwf: Process Administrator | generated |


Scenario Outline: Create New Process From A Template
    GIVEN a process template was created by <creator>
    WHEN <role> creates a new process from a template
    THEN a new process is <creation>
    THEN a global info briefcase is <creation>
    THEN a process completion task group is <creation>

    Examples:
        | creator                        		| role                          	  | creation  |
        | public,cdbwf: Process Library Manager | public,cdbwf: Process Administrator | generated |


Scenario Outline: Change Process
    GIVEN a process was created by <creator>
    WHEN <role> changes this process
    THEN the changed process is <status>

    Examples:
        | creator                      | role                         | status    |
        | cdbwf: Process Administrator | cdbwf: Process Administrator | saved     |


Scenario Outline: Copy Process
    GIVEN a process was created by <creator>
    WHEN <role> copies this process
    THEN the process is <status>

    Examples:
        | creator                      | role                         | status     |
        | cdbwf: Process Administrator | cdbwf: Process Administrator | copied     |


Scenario Outline: Delete Process
    GIVEN a process was created by <creator>
    WHEN <actor> deletes this process
    THEN the process is <status>

    Examples:
        | creator                      | actor                        | status      |
        | cdbwf: Process Administrator | cdbwf: Process Administrator | deleted     |


Scenario Outline: Create New Parallel Task Group
    GIVEN a process was created by <creator>
    WHEN <actor> creates a new parallel task group
    THEN a new parallel task group is <creation>

    Examples:
        | creator                      | actor                        | creation      |
        | cdbwf: Process Administrator | cdbwf: Process Administrator | generated     |


Scenario Outline: Create New Sequential Task Group
    GIVEN a process was created by <creator>
    WHEN <actor> creates a new sequential task group
    THEN a new sequential task group is <creation>

    Examples:
        | creator                      | actor                        | creation      |
        | cdbwf: Process Administrator | cdbwf: Process Administrator | generated     |


Scenario Outline: Create New Execution Task
    GIVEN a process was created by <creator>
    WHEN <actor> creates a new execution task
    THEN a new execution task is <creation>

    Examples:
        | creator                      | actor                        | creation      |
        | cdbwf: Process Administrator | cdbwf: Process Administrator | generated     |


Scenario Outline: Create New Examination Task
    GIVEN a process was created by <creator>
    WHEN <actor> creates a new examination task
    THEN a new examination task is <creation>

    Examples:
        | creator                      | actor                        | creation      |
        | cdbwf: Process Administrator | cdbwf: Process Administrator | generated     |


Scenario Outline: Create New Approval Task
    GIVEN a process was created by <creator>
    WHEN <actor> creates a new approval task
    THEN a new approval task is <creation>

    Examples:
        | creator                      | actor                        | creation      |
        | cdbwf: Process Administrator | cdbwf: Process Administrator | generated     |


Scenario Outline: Change Task
    GIVEN a task was created by <creator>
    WHEN <actor> changes this task
    THEN the changed task is <status>

    Examples:
        | creator                      | actor                        | status    |
        | cdbwf: Process Administrator | cdbwf: Process Administrator | saved     |


Scenario Outline: Copy Task
    GIVEN a task was created by <creator>
    WHEN <actor> copies this task
    THEN the task is <status>

    Examples:
        | creator                      | actor                        | status     |
        | cdbwf: Process Administrator | cdbwf: Process Administrator | copied     |


Scenario Outline: Delete Task
    GIVEN a task was created by <creator>
    WHEN <actor> deletes this task
    THEN the task is <status>

    Examples:
        | creator                      | actor                        | status      |
        | cdbwf: Process Administrator | cdbwf: Process Administrator | deleted     |


Scenario Outline: Change State Of A Task
    GIVEN a task was created by <creator>
    WHEN <actor> changes the state of this task
        | FROM |  TO       |
        | New  | Execution |
    THEN the state of the task is <status>

    Examples:
        | creator                      | actor                        | status    |
        | cdbwf: Process Administrator | cdbwf: Process Administrator | saved     |

@skip
# Follow up operation of operation "new_from_template" failed
# ValueError: Invalid url - did not find 'byname'
Scenario: Set current user as responsible for process
    GIVEN the user caddok has created a process template
    WHEN the logged user instantiates the template
    THEN the logged user is responsible for the process

@skip # SKIP this due to E034121
Scenario Outline: Delete an object with constraints
    GIVEN a process with some tasks exists
        AND the task has some briefcase
        AND the task has a constraint with a briefcase
    WHEN the <object> is deleted
    THEN the <object> is not deleted

    Examples:
        | object         |
        | briefcase      |
        | briefcase link |


Scenario: Prevent deleting objects used as briefcase contents
    GIVEN a process was created
        AND some briefcase has some content
    WHEN an Administrator tries to delete the content object
    THEN the content object is not deleted


Scenario: Delete objects not used as briefcase contents
    GIVEN a process was created
        AND some briefcase has some content
    WHEN the briefcase content is deleted
        AND an Administrator tries to delete the content object
    THEN the content object is deleted
