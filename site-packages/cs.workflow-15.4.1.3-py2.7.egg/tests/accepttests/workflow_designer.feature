# Copyright (C) 1990 - 2018 CONTACT Software GmbH
# All rights reserved.
# http://www.contact.de/
#

# Workflow designer tests using selenium

@slow
Feature: Workflow designer


Scenario: Create first task
    GIVEN a process was created
        AND the user has opened the workflow designer
    WHEN the user adds a new execution task
    THEN the new task is created

@flaky
Scenario Outline: Add a second task
    GIVEN a process was created
        AND the process has a execution task
        AND the user has opened the workflow designer
    WHEN the user selects the task
        AND the user clicks on the <location> arrow
    THEN a new task <position> the selected task is created

    Examples:
        | location | position    |
        | left     | before      |
        | right    | after       |
        | bottom   | parallel to |


Scenario: Creating a task with extension
    # The biggest need is to test the addition of extensions to a task created by the workflow designer
    # in this case, it is not important what kind of extension is added

    GIVEN a process was created
        AND the user has opened the workflow designer
        AND the approval task type has a configured extension
    WHEN the user adds a new approval task with that extension
    THEN the new task is created
        AND the task has that extension
        AND a extension tile is added to the overview of the task

@flaky
Scenario: Modify a field in task extension
    GIVEN a process was created
        AND the user has opened the workflow designer
        AND the approval task type has a configured extension
        AND the user added a new approval task with that extension
        AND there is an editable field in the extension tile
    WHEN the user modifies the field of the extension
    THEN the field of the extension is modified


Scenario: Render "Run Operation" System Task
    GIVEN a process was created
        AND the user has opened the workflow designer
    WHEN the user adds a new "run operation" system task
    THEN the new task is created
        AND the task's picture url is "/resources/icons/byname/operation_placeholder?"

@flaky
Scenario: Change "Run Operation" System Task Parameters
    GIVEN a process was created
        AND the user has opened the workflow designer
    WHEN the user adds a new "run operation" system task
        AND the user selects the parameter "CDB_Copy"
    THEN the new task is created
        AND the task's picture url is "/resources/icons/byname/Copy?"

@flaky
Scenario: Delete "Run Operation" System Task Parameter
    GIVEN a process was created
        AND the user has opened the workflow designer
    WHEN the user adds a new "run operation" system task
        AND the user selects the parameter "CDB_Copy"
        AND the user deletes the parameter
    THEN the new task is created
        AND the task's picture url is "/resources/icons/byname/operation_placeholder?"
