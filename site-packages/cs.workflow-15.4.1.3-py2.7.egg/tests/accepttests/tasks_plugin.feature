# -*- mode: feature; coding: utf-8 -*-
#
# Copyright (C) 1990 - 2018 CONTACT Software GmbH
# All rights reserved.
# http://www.contact.de/
#

@slow
Feature: Tasks Plugin


Background:
    GIVEN tasks testdata exists


Scenario: Task rows are rendered correctly
    WHEN user opens the Task Manager
    THEN 4 tasks are shown
        AND the approval_task's deadline is "01.09.2018"
        AND the examination_task's deadline is "02.09.2018"
        AND the execution_task's deadline is "03.09.2018"
        AND the info_message's deadline is "--"


Scenario Outline: Task statuses are rendered correctly
    WHEN user opens the Task Manager
        AND user clicks the <task>'s proceed cell
    THEN the statuses <statuses> are shown

    Examples:

    | task              | statuses                      |
    | approval_task     | "Abgeschlossen", "Abgelehnt"  |
    | examination_task  | "Abgeschlossen", "Abgelehnt"  |
    | execution_task    | "Abgeschlossen"               |
    | info_message      | "Gelesen"                     |


Scenario Outline: Task status is changeable
    WHEN user opens the Task Manager
        AND user changes the <task>'s status to "<status>" with comment "<comment>"
    THEN 3 tasks are shown

    Examples:

    | task              | status        | comment |
    | approval_task     | Abgeschlossen | OK      |
    | examination_task  | Abgeschlossen | OK      |
    | execution_task    | Abgeschlossen |         |
    | info_message      | Gelesen       |         |


Scenario Outline: Task details are rendered correctly
    GIVEN the <task> has an info form
        AND the <task> has an edit form
        AND the <task> has a non-emtpy info briefcase
        AND the <task> has a non-emtpy edit briefcase
    WHEN user opens the Task Manager
        AND user selects the <task>
    THEN the context contains 2 objects
        AND <forms> forms are shown
        AND <relship> relationship objects are shown
        AND the text is "<text>"

    Examples:

    | task              | forms | relship | text          |
    | approval_task     | 2     | 2       | App\nroval    |
    | examination_task  | 2     | 2       | Exam\nination |
    | execution_task    | 2     | 2       | Exe\ncution   |


Scenario: Info Message details are rendered correctly
    GIVEN the execution_task has an info form
        AND the execution_task has an edit form
        AND the info_message has a non-emtpy info briefcase
        AND the info_message has a non-emtpy edit briefcase
    WHEN user opens the Task Manager
        AND user selects the info_message
    THEN the context contains 2 objects
        AND 0 forms are shown
        AND 2 relationship objects are shown
        AND the text is "Info\nrmation"
