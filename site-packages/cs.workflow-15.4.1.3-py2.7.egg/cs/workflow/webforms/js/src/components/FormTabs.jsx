import React from 'react';
import {Registry} from 'cs-web-components-base';
import {ImmutablePropTypes, PropTypes} from 'cs-web-components-externals';
import {Tab, Nav, NavItem} from 'react-bootstrap';
import {prefixNS} from '../helpers';

const Icon = Registry.findComponent('cs-web-components-base-Icon');
const EDIT_FORM_ICON = 'cdbwf_form_edit';
const INFO_FORM_ICON = 'cdbwf_form_info';

const FormTabs = ({children}) => (
    <Tab.Container defaultActiveKey={0} id={prefixNS('tabs')}>
        <div className={prefixNS('form-tabs')}>
            <Nav bsStyle='tabs'>
                {
                    children.map(
                        (child, idx) => {
                            const form = child.props.contextObjects.get(0);
                            const form_id = form.get('cdb_object_id');
                            return (
                                <NavItem key={`nav-${form_id}`} eventKey={idx}
                                         className={prefixNS(
                                             `tabs__${child.props.edit ? 'edit' : 'info'}`
                                         )}>
                                    <Icon className={prefixNS('tabs__iotype')}
                                          name={
                                              child.props.edit ? EDIT_FORM_ICON : INFO_FORM_ICON
                                          } />
                                    {form.get('name')}
                                </NavItem>
                            );
                        }
                    )
                }
            </Nav>
            <Tab.Content animation={true}
                         className={prefixNS('form-tabs-content')}>
                {
                    children.map(
                        (child, idx) => {
                            const form = child.props.contextObjects.get(0);
                            const form_id = form.get('cdb_object_id');
                            return (
                                <Tab.Pane key={form_id}
                                          eventKey={idx}
                                          className={prefixNS('form-tabs-content__pane')}>
                                    {child}
                                </Tab.Pane>
                            );
                        }
                    )
                }
            </Tab.Content>
        </div>
    </Tab.Container>
);

FormTabs.propTypes = {
    children: ImmutablePropTypes.listOf(PropTypes.element).isRequired
};

export default FormTabs;
