.. _`constraints`:

Constraints
###########

Verwendbare Objektregeln im Workflow Designer
=============================================

:term:`Constraints <Constraint>` sind
:ref:`Objektregeln <admin:cdbpws-api-cdbobjects-rules>`, aber nicht alle Regeln
eignen sich als :term:`Constraint`. Im :term:`Workflow Designer` stehen nur
Regeln zur Verfügung, die für die Definition von
:term:`Constraints <Constraint>` freigeschaltet wurden.

Im Auslieferungszustand gilt dies nur für Regeln, deren Name mit
``wf-designer:`` beginnt. Durch Anpassung der |cdbpy|- Liste
`cs.workflow.designer.catalogs.ConstraintsCatalog.__catalog_rules_conditions__`
kann diese Konvention an Ihre Bedürfnisse angepasst werden.

Die Liste enthält SQL-Bedingungen. Im :term:`Workflow Designer` stehen alle
Objektregeln zur Verfügung, die mindestens eine dieser
:term:`Constraints <Constraint>` erfüllen.

.. rubric:: Beispiel

.. code-block:: python

    from cs.workflow.designer.catalogs import ConstraintsCatalog
    catalog_conditions = ConstraintsCatalog.__catalog_rules_conditions__
    catalog_conditions.append("name LIKE 'constraint-rule:%'")

Eigene Objektregeln für Constraints definieren
==============================================

Bei Prüfung eines :term:`Constraints <Constraint>` ohne Zuordnung zu einer
spezifischen :term:`Mappe` wird die Objektregel gegen die :term:`Aufgabe` des
:term:`Constraints <Constraint>` geprüft. Andernfalls erfolgt die Prüfung gegen
die :term:`Mappe`.

.. rubric:: Beispiel *Alle Mappendokumente sind freigegeben*

Die Objektregel soll bei Prüfung gegen eine :term:`Mappe` erfüllt sein, wenn
die :term:`Mappe` keine oder ausschließlich freigegebene Dokumente enthält.
Enthält die :term:`Mappe` mindestens ein nicht freigegebenes Dokument, soll die
Objektregel nicht erfüllt sein.

.. _`constraint_rule1.png`:

.. figure:: images/constraint_rule1.png
   :scale: 60%
   :align: center

   Objektregel *Alle Mappendokumente sind freigegeben*

Das Attribut ``Content`` enthält eine Liste der
:term:`Mappeninhalte <Mappeninhalt>`. Diese werden mit dem Filter "Dokument ist
nicht freigegeben" weiter eingeschränkt. Die gefilterte Liste muss anschließend
leer sein (bzw. ihre Länge muss 0 sein).

.. rubric:: Beispiel *Alle Aufgabendokumente sind freigegeben*

.. _`constraint_rule2.png`:

.. figure:: images/constraint_rule2.png
   :scale: 60%
   :align: center

   Objektregel *Alle Aufgabendokumente sind freigegeben*

Dieses Beispiel funktioniert analog zum vorhergehenden Beispiel. Allerdings ist
diese Regel dazu gedacht, gegen eine :term:`Aufgabe` geprüft zu werden.
``Content`` enthält in diesem Fall die Inhalte aller :term:`Mappen <Mappe>` der
:term:`Aufgabe`.

Um genauer zu unterscheiden, bieten :term:`Aufgaben <Aufgabe>` auch die
Attribute ``InfoContent`` und ``EditContent`` an, die nur Inhalte des
jeweiligen :term:`Bearbeitungsmodus` liefern.
