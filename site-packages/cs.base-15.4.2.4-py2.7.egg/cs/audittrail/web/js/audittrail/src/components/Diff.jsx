/*
 * Copyright (C) 2018 CONTACT Software GmbH
 * All rights reserved.
 * http://www.contact-software.com
 *
 * Revision "$Id: Diff.jsx 174047 2018-03-06 06:26:20Z ssa $"
 */

import React, {Component} from 'react';
import jsdiff from 'diff';
import {prefixNS} from '../helpers.js';
import {PropTypes} from 'cs-web-components-externals';


const diffChoice = {
    'chars': jsdiff.diffChars,
    'words': jsdiff.diffWords,
    'sentences': jsdiff.diffSentences,
    'json': jsdiff.diffJson
};

export default class DiffText extends Component {
    render() {
        const diff = diffChoice[this.props.type](this.props.old, this.props.new);
        const result = diff.map((part, idx) => {
            if (part.added) {
                return (<ins key={idx}>{part.value}</ins>);
            }
            if (part.removed) {
                return (<del key={idx}>{part.value}</del>);
            }
            return (<span key={idx}>{part.value}</span>);
        });
        return (<div className={prefixNS('DiffText')}>
                    {result}
                </div>);
    }
}

DiffText.propTypes = {
    old: PropTypes.string.isRequired,
    new: PropTypes.string.isRequired,
    type: PropTypes.string.isRequired
};

DiffText.defaultProps = {
    old: '',
    new: '',
    type: 'words'
};
