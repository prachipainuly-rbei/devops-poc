<metal:previewImage define-macro="preview_image"
                    tal:define="prev_img prev_img|nothing;
                                img_url img_url|nothing;
                                default_img_url default_img_url|string:${options.plugins}picture_uploader/placeholder-camera.png;
                                btn_title btn_title|options.labels['cdb_import_image']|'upload';
                                btn_status_class btn_status_class|'';
                                img_attr_alt img_attr_alt|nothing;
                                img_attr_title img_attr_title|nothing;
                                img_link img_link|nothing;
                                img_link_target img_link_target|options.default_link_target">
    <div class="elink-picture-preview">
        <a href="${img_link}" target="${img_link_target}">
          <img src="${options.base_uri}powerscript/cdb.apps.preview.app/pic?cdb_file_id=${prev_img}" tal:condition="prev_img" alt="${img_attr_alt}" title="${img_attr_title}" />
          <img src="${img_url}" tal:condition="not prev_img and img_url" alt="${img_attr_alt}" title="${img_attr_title}" />
          <img src="${default_img_url}" class="default-image" tal:condition="not prev_img and not img_url" alt="${img_attr_alt}" title="${img_attr_title}" />
        </a>
        <div class="btn-container">
          <button type="button"
                  class="btn btn-primary img-button-ch ${btn_status_class} hide"><i class="icon-picture"></i> ${btn_title}</button>
        </div>
    </div>
</metal:previewImage>

<metal:modalupload define-macro="upload_modal"
                   tal:define="modal_title modal_title|options.labels['cdb_import_image']|nothing;
                               modal_desc modal_desc|'';
                               action_url action_url|''">
    <div id="popup_image_modal" class="modal hide fade in">
        <div class="modal-header">
           <a class="close" data-dismiss="modal">&times;</a>
           <div class="modal-header-content">
               <h2 class="pull-left"><i class="title-placeholder"></i>: ${modal_title}</h2>
               <div class="filter-container"></div>
               <div class="no-float"></div>
           </div>
        </div>
        <div class="modal-body">
            <span class="help-block">${modal_desc}</span>
            <form class="well form-inline" enctype="multipart/form-data" name="cdbw3"
                  action="${action_url}" method="post">
              <div class="row-fluid">
                <input type="file" tabindex="3"  value=""
                       name="cdb::argument.localfilename"
                       class="span12"
                       size="50" />
              </div>
                <metal:formHidden define-slot="input_hidden">
            </form>
        </div>
        <div class="modal-footer">
            <a href="#" class="btn" data-dismiss="modal">${options.labels.button_cancel}</a>
            <a href="#" class="btn btn-primary" data-dismiss="modal">${options.labels.ok}</a>
        </div>
    </div>
</metal:modalupload>
