<metal:postings define-macro="catalog_head">
    <link href="${options.css}jquery/dataTables.bootstrap.css" rel="stylesheet" type="text/css" />
    <link href="${options.css}jquery/dataTables.cdb.css" rel="stylesheet" type="text/css" />
    <link href="${options.plugins}float/float.css" rel="stylesheet" type="text/css" />
    <link href="${options.plugins}datatables/datatables.css" rel="stylesheet" type="text/css" />
    <link href="${options.css}jquery/jquery.autocomplete.contact.css" rel="stylesheet" type="text/css"></link>
    <link href="${options.plugins}catalog/catalog.css" rel="stylesheet" type="text/css"/>
    <script src="${options.jscript}jquery/jquery.dataTables.min.js" type="text/javascript"></script>
    <script src="${options.jscript}jquery/jquery.autocomplete.contact.js" type="text/javascript"></script>
    <script src="${options.jscript}jquery/dataTables/jquery.dataTables.fixedColumns.js" type="text/javascript"></script>
    <script src="${options.jscript}jquery/dataTables/jquery.dataTables.fnAddTr.js" type="text/javascript"></script>
    <script src="${options.plugins}catalog/catalog.js" type="text/javascript"></script>
</metal:postings>

<metal:catalogButton define-macro="catalog_button"
                        tal:define="catalog_url catalog_url|nothing;
                                    catalog_id catalog_id|nothing;
                                    catalog_multiselect catalog_multiselect|nothing;
                                    catalog_button_class catalog_button_class|''">
    <div class="btn-group">
          <button class="btn ${catalog_button_class} catalog-button"
                  type="button"
                  data-elink-catalog-url="${catalog_url}"
                  data-elink-catalog-id="${catalog_id}"
                  data-elink-catalog-multiselect="${catalog_multiselect}">
          <metal:buttontitle define-slot="button_title">
          <img src="${options.plugins}catalog/catalog.png" />
        </metal:buttontitle>
          </button>
      </div>
</metal:catalogButton>

<metal:filter define-macro="column_filter">
<div class="form-inline">
  <input class="input-mini filter-input" type="text" />
</div>
</metal:filter>


<metal:tableHeader define-macro="table_header"
                   tal:define="column_defs table_def['columns']|nothing">
  <tr class="fields">
    <th class="actions"
        data-elink-catalog-visible="1">&nbsp;</th>
      <tal:headers repeat="column_def column_defs">
      <th title="${column_def['label']}"
          data-elink-catalog-attribute="${column_def['attribute']}"
          data-elink-catalog-type="${column_def['type']}"
          data-elink-catalog-visible="${1 if column_def['visible'] else None}">${column_def['label']}</th>
      </tal:headers>
    <th data-elink-catalog-attribute="_description"
        data-elink-catalog-type="text">&nbsp;</th>
  </tr>
</metal:tableHeader>

<metal:tableBody define-macro="table_body"
                 tal:define="column_defs table_def['columns']|nothing;
                                datalist datalist|nothing">
    <tal:rows repeat="data datalist" condition="len(datalist)">
        <tr data-elink-cdb_object_id="${data[0]['text']}">
            <td class="actions">
                <i class="icon-check-empty not-checked" />
                <i class="icon-check checked" />
                &nbsp;
            </td>
            <tal:cells repeat="trdata data[2:]">
                <td data-elink-catalog-value="${trdata.get('value', None)}"
                    title="${trdata['text']}">${trdata['text']}</td>
            </tal:cells>
            <td title="${data[1]['text']}">${data[1]['text']}</td>
        </tr>
    </tal:rows>
    <tal:dummy condition="len(datalist)==0">
      <tr>
        <td />
        <td tal:repeat="column_def column_defs" />
        <td />
      </tr>
    </tal:dummy>
</metal:tableBody>

<metal:tablefooter define-macro="table_footer"
                   tal:define="column_defs table_def['columns']|nothing">
  <tr class="fields">
    <th class="actions">&nbsp;</th>
    <tal:headers repeat="column_def column_defs">
      <th data-elink-catalog-attribute="${column_def['attribute']}"
          tal:condition="column_def['searchable']">
        <metal:flt use-macro="global_plugins['catalog'].macros['column_filter']" />
      </th>
      <th tal:condition="not column_def['searchable']">&nbsp;</th>
    </tal:headers>
    <th>&nbsp;</th>
  </tr>
</metal:tablefooter>

<metal:table define-macro="table"
             tal:define="table_def table_def|nothing;
                         datalist datalist|nothing">
    <table class="main-table table table-bordered hide">
        <thead>
            <metal:tbhead use-macro="global_plugins['catalog'].macros.table_header"></metal:tbhead>
        </thead>
             <tbody>
             </tbody>
        <tfoot tal:condition="table_def['searchable']|nothing">
          <metal:tbfoot use-macro="global_plugins['catalog'].macros.table_footer"></metal:tbfoot>
        </tfoot>
    </table>
</metal:table>

<metal:table define-macro="save_table"
             tal:define="table_page_size table_page_size|nothing">
    <table class="save-table table table-bordered">
        <thead>
            <tr>
                <th>${options.labels.cdb_elink_selected}</th>
                <th class="actions">
                </th>
            </tr>
        </thead>
             <tbody>
            <tr>
                <td class="desc">&nbsp;</td>
                <td class="actions">
                    <i class="icon-trash hide"/>
                </td>
            </tr>
             </tbody>
    </table>
</metal:table>

<metal:table define-macro="modal_body"
             tal:define="table_def table_def|nothing;
                            datalist datalist|nothing;">
  <div class="row-fluid">
    <div class="main-table-container span8">
        <metal:head use-macro="macros.table">
        </metal:head>
        <div class="catalog-pagenator"></div>
    </div>
    <div class="save-table-container span4">
        <div class="table-top"></div>
        <metal:head use-macro="macros.save_table"
                          tal:define="table_page_size table_page_size">
        </metal:head>
    </div>
  </div>
</metal:table>

<metal:modalWindow define-macro="open_catalog"
                   tal:define="catalog_title catalog_title|nothing;
                               table_def table_def|nothing;
                               datalist datalist|nothing;
                               paginator paginator|nothing;
                               catalog_def_required catalog_def_required|nothing">
  <div>
    <div class="catalog-layout" tal:condition="catalog_def_required">
      <tal:titleslot metal:define-slot="catalog_title">
        <div class="modal-header" tal:condition="catalog_title">
          <h3>${catalog_title}</h3>
        </div>
      </tal:titleslot>
      <div class="modal-body">
        <metal:mb use-macro="global_plugins['catalog'].macros['modal_body']" />
      </div>
      <div class="modal-footer">
        <button type="button" class="btn lbl-resetFields" data-elink-common-modal-button="resetFields" data-dismiss="modal" aria-hidden="true">${options.labels.pccl_brow_no_entry|'Reset Fields'}</button>
      </div>
    </div>
    <div  class="catalog-data">
      <table>
        <metal:tb use-macro="macros.table_body" />
      </table>
      <div class="catalog-pagenator">
        <div class="catalog-full-search pull-right"
             tal:condition="table_def['searchable']|nothing">
          <button type="button" class="btn btn-small full-search"><i class="icon-search"></i></button>
        </div>
        <metal:pg use-macro="global_plugins['pagination'].macros.paginator"
                  tal:define="paginator paginator"/>
      </div>
    </div>
  </div>
</metal:modalWindow>

<metal:respModal define-macro="responsible_catalog" use-macro="global_plugins['catalog'].macros['open_catalog']">
  <metal:roles fill-slot="catalog_title">
    <div class="modal-header" tal:condition="catalog_title">
      <h3>${catalog_title}</h3>
      <div class="catalog-role-filter pull-left">
          <div class="role-filter-icon pull-left" title="${options.labels.cdb_resp_filter_by_role}"></div>
          <div class="filter-wrapper pull-left">
              <input type="text" name="catalog_role_filter"
                     tabindex="10"
                     class="span3"
                     value="" />
              <a class="btn"><span class="caret"></span></a>
          </div>
      </div>
      <div class="no-float"></div>
    </div>
  </metal:roles>
</metal:respModal>

