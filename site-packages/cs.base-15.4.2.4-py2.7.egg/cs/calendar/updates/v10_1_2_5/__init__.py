#!/usr/bin/env powerscript
# -*- python -*- coding: iso-8859-1 -*-
#
# Copyright (C) 1990 - 2013 CONTACT Software GmbH
# All rights reserved.
# http://www.contact.de/

__revision__ = "$Id: __init__.py 111211 2014-06-25 12:19:38Z heg $"

from cdb.comparch import protocol


class GenerateWorkdayIndex(object):
    """Generate workday index for all existing calendar profiles"""

    def run(self):
        from cs.calendar import CalendarProfile
        for cal_prof in CalendarProfile.Query():
            protocol.logMessage("Generate workday index for profile %s (%s)"
                                % (cal_prof.name, cal_prof.description))
            cal_prof.generateWorkdayIndex()


post = [GenerateWorkdayIndex]
