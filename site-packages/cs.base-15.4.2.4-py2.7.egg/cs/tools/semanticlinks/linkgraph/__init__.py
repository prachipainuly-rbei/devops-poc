#!/usr/bin/env python
# -*- python -*- coding: iso-8859-1 -*-
#
# Copyright (C) 1990 - 2012 CONTACT Software GmbH
# All rights reserved.
# http://www.contact.de/
#
"""
Module for SemanticLink management
"""

from cdb import CADDOK
from cdb import elink
from cdb import tools
from cdb import util
from cdb.lru_cache import lru_cache
from cdb.objects import ByID
from cdb.objects import Rule
from cdb.platform.mom.entities import Entity
from cdb.plattools import killableprocess
import glob
import logging
import os
import subprocess
import sys
from cs.tools import semanticlinks
from cs.tools.semanticlinks.linkgraph import renderer

__docformat__ = "restructuredtext en"
__revision__ = "$Id: __init__.py 174009 2018-03-05 11:58:42Z ssa $"


LOG = logging.getLogger(__name__)


@lru_cache(clear_after_ue=False)
def get_graphviz_dot_path():
    if sys.platform == 'win32':
        dot_paths = glob.glob(os.path.join(CADDOK.RUNTIME,
                                           'graphviz*',
                                           'bin',
                                           'dot.exe'))
    else:
        dot_paths = glob.glob(os.path.join(CADDOK.RUNTIME, 'dot'))
    if len(dot_paths) == 1 and os.path.isfile(dot_paths[0]):
        dot_path = os.path.abspath(dot_paths[0])
        LOG.info('using graphviz dot path: %s', dot_path)
        return dot_path
    else:
        LOG.error('failed to locate graphviz dot')
