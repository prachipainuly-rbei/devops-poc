!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("cs-web-components-base"),require("cs-web-components-externals"),require("React"),require("Immutable"),require("moment"),require("ReactBootstrap")):"function"==typeof define&&define.amd?define(["cs-web-components-base","cs-web-components-externals","React","Immutable","moment","ReactBootstrap"],e):"object"==typeof exports?exports["cs-tools-semanticlinks-linkgraph"]=e(require("cs-web-components-base"),require("cs-web-components-externals"),require("React"),require("Immutable"),require("moment"),require("ReactBootstrap")):t["cs-tools-semanticlinks-linkgraph"]=e(t["cs-web-components-base"],t["cs-web-components-externals"],t.React,t.Immutable,t.moment,t.ReactBootstrap)}(this,function(t,e,n,i,o,r){return function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=8)}([function(e,n){e.exports=t},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(){return p}function r(t){return"cs-tools-semanticlinks-linkgraph-"+t}function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=e?"?"+h.qs.stringify(e):"";return""+o().getIn(["links","common","iconBase"])+t+n}function a(t){if(!t)return"";var e=void 0;e=t.endsWith("T00:00:00")?o().getIn(["formats","dateFormat"]):o().getIn(["formats","dateTimeFormat"]).replace("hh","HH");var n=(0,f.default)(t,f.default.ISO_8601).format(e);return"Invalid date"===n?t:n}Object.defineProperty(e,"__esModule",{value:!0}),e.getAppSetup=o,e.prefixNS=r,e.getIcon=s,e.timeToDisplayFormat=a;var l=n(4),u=i(l),c=n(9),f=i(c),h=n(2),p=u.default.fromJS(window.appSetup)},function(t,n){t.exports=e},function(t,e){t.exports=n},function(t,e){t.exports=i},function(t,e,n){var i=n(6),o="unknown";document.documentMode&&(o="ie"),t.exports={svgNS:"http://www.w3.org/2000/svg",xmlNS:"http://www.w3.org/XML/1998/namespace",xmlnsNS:"http://www.w3.org/2000/xmlns/",xlinkNS:"http://www.w3.org/1999/xlink",evNS:"http://www.w3.org/2001/xml-events",getBoundingClientRectNormalized:function(t){if(t.clientWidth&&t.clientHeight)return{width:t.clientWidth,height:t.clientHeight};if(t.getBoundingClientRect())return t.getBoundingClientRect();throw new Error("Cannot get BoundingClientRect for SVG.")},getOrCreateViewport:function(t,e){var n=null;if(!(n=i.isElement(e)?e:t.querySelector(e))){var o=Array.prototype.slice.call(t.childNodes||t.children).filter(function(t){return"defs"!==t.nodeName&&"#text"!==t.nodeName});1===o.length&&"g"===o[0].nodeName&&null===o[0].getAttribute("transform")&&(n=o[0])}if(!n){var r="viewport-"+(new Date).toISOString().replace(/\D/g,"");n=document.createElementNS(this.svgNS,"g"),n.setAttribute("id",r);var s=t.childNodes||t.children;if(s&&s.length>0)for(var a=s.length;a>0;a--)"defs"!==s[s.length-a].nodeName&&n.appendChild(s[s.length-a]);t.appendChild(n)}var l=[];return n.getAttribute("class")&&(l=n.getAttribute("class").split(" ")),~l.indexOf("svg-pan-zoom_viewport")||(l.push("svg-pan-zoom_viewport"),n.setAttribute("class",l.join(" "))),n},setupSvgAttributes:function(t){if(t.setAttribute("xmlns",this.svgNS),t.setAttributeNS(this.xmlnsNS,"xmlns:xlink",this.xlinkNS),t.setAttributeNS(this.xmlnsNS,"xmlns:ev",this.evNS),null!==t.parentNode){var e=t.getAttribute("style")||"";-1===e.toLowerCase().indexOf("overflow")&&t.setAttribute("style","overflow: hidden; "+e)}},internetExplorerRedisplayInterval:300,refreshDefsGlobal:i.throttle(function(){for(var t=document.querySelectorAll("defs"),e=t.length,n=0;n<e;n++){var i=t[n];i.parentNode.insertBefore(i,i)}},this.internetExplorerRedisplayInterval),setCTM:function(t,e,n){var i=this,r="matrix("+e.a+","+e.b+","+e.c+","+e.d+","+e.e+","+e.f+")";t.setAttributeNS(null,"transform",r),"transform"in t.style?t.style.transform=r:"-ms-transform"in t.style?t.style["-ms-transform"]=r:"-webkit-transform"in t.style&&(t.style["-webkit-transform"]=r),"ie"===o&&n&&(n.parentNode.insertBefore(n,n),window.setTimeout(function(){i.refreshDefsGlobal()},i.internetExplorerRedisplayInterval))},getEventPoint:function(t,e){var n=e.createSVGPoint();return i.mouseAndTouchNormalize(t,e),n.x=t.clientX,n.y=t.clientY,n},getSvgCenterPoint:function(t,e,n){return this.createSVGPoint(t,e/2,n/2)},createSVGPoint:function(t,e,n){var i=t.createSVGPoint();return i.x=e,i.y=n,i}}},function(t,e){function n(t){return function(e){window.setTimeout(e,t)}}t.exports={extend:function(t,e){t=t||{};for(var n in e)this.isObject(e[n])?t[n]=this.extend(t[n],e[n]):t[n]=e[n];return t},isElement:function(t){return t instanceof HTMLElement||t instanceof SVGElement||t instanceof SVGSVGElement||t&&"object"==typeof t&&null!==t&&1===t.nodeType&&"string"==typeof t.nodeName},isObject:function(t){return"[object Object]"===Object.prototype.toString.call(t)},isNumber:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},getSvg:function(t){var e,n;if(this.isElement(t))e=t;else{if(!("string"==typeof t||t instanceof String))throw new Error("Provided selector is not an HTML object nor String");if(!(e=document.querySelector(t)))throw new Error("Provided selector did not find any elements. Selector: "+t)}if("svg"===e.tagName.toLowerCase())n=e;else if("object"===e.tagName.toLowerCase())n=e.contentDocument.documentElement;else{if("embed"!==e.tagName.toLowerCase())throw"img"===e.tagName.toLowerCase()?new Error('Cannot script an SVG in an "img" element. Please use an "object" element or an in-line SVG.'):new Error("Cannot get SVG.");n=e.getSVGDocument().documentElement}return n},proxy:function(t,e){return function(){return t.apply(e,arguments)}},getType:function(t){return Object.prototype.toString.apply(t).replace(/^\[object\s/,"").replace(/\]$/,"")},mouseAndTouchNormalize:function(t,e){if(void 0===t.clientX||null===t.clientX)if(t.clientX=0,t.clientY=0,void 0!==t.touches&&t.touches.length){if(void 0!==t.touches[0].clientX)t.clientX=t.touches[0].clientX,t.clientY=t.touches[0].clientY;else if(void 0!==t.touches[0].pageX){var n=e.getBoundingClientRect();t.clientX=t.touches[0].pageX-n.left,t.clientY=t.touches[0].pageY-n.top}}else void 0!==t.originalEvent&&void 0!==t.originalEvent.clientX&&(t.clientX=t.originalEvent.clientX,t.clientY=t.originalEvent.clientY)},isDblClick:function(t,e){if(2===t.detail)return!0;if(void 0!==e&&null!==e){var n=t.timeStamp-e.timeStamp,i=Math.sqrt(Math.pow(t.clientX-e.clientX,2)+Math.pow(t.clientY-e.clientY,2));return n<250&&i<10}return!1},now:Date.now||function(){return(new Date).getTime()},throttle:function(t,e,n){var i,o,r,s=this,a=null,l=0;n||(n={});var u=function(){l=!1===n.leading?0:s.now(),a=null,r=t.apply(i,o),a||(i=o=null)};return function(){var c=s.now();l||!1!==n.leading||(l=c);var f=e-(c-l);return i=this,o=arguments,f<=0||f>e?(clearTimeout(a),a=null,l=c,r=t.apply(i,o),a||(i=o=null)):a||!1===n.trailing||(a=setTimeout(u,f)),r}},createRequestAnimationFrame:function(t){var e=null;return"auto"!==t&&t<60&&t>1&&(e=Math.floor(1e3/t)),null===e?window.requestAnimationFrame||n(33):n(e)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.formatStr=e.Format=void 0;var i=n(0);e.Format=i.i18ndb.makeFormat("linkgraph"),e.formatStr=i.i18ndb.makeFormatStr("linkgraph")},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(1),r=n(10),s=function(t){return t&&t.__esModule?t:{default:t}}(r);i.Registry.registerComponent((0,o.prefixNS)("MainComponent"),s.default),e.default={MainComponent:s.default}},function(t,e){t.exports=o},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),l=n(3),u=i(l),c=n(0),f=n(11),h=i(f),p=function(t){function e(){return o(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return s(e,t),a(e,[{key:"render",value:function(){return u.default.createElement(c.SinglePage,{frameComponent:c.PageFrame.ApplicationFrame,pageContent:h.default})}}]),e}(u.default.Component);e.default=p},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t,e){var n={};for(var i in t)e.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(t){return{getObjectById:function(e){return t.objectsById.get(e)}}}Object.defineProperty(e,"__esModule",{value:!0});var c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},f=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),h=n(3),p=i(h),d=n(4),m=i(d),v=n(12),g=n(2),b=n(0),y=n(7),S=n(1),w=n(13),E=i(w),_=n(14),k=i(_),x=b.Registry.findComponent("cs-tools-semanticlinks-createLinksApp-CreateLink"),C=b.Registry.findComponent("cs-web-components-base-SplitLayout"),M=function(t){function e(t){return s(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return l(e,t),f(e,[{key:"render",value:function(){var t=this.props,e=t.title,n=t.buttons,i=t.onHide,s=t.hideFooter,a=t.dialogClassName,l=t.allowOverlay,u=t.showCancel,f=t.size,h=t.sizes,d=t.children,m=r(t,["title","buttons","onHide","hideFooter","dialogClassName","allowOverlay","showCancel","size","sizes","children"]),b=(0,g.classNames)([(0,S.prefixNS)("dialog"),f||h.get(this.state.sizeIndex),o({},"cs-web-components-base-dialog-allow-overlay",l)]);return p.default.createElement(v.Modal,c({},m,{onHide:i,className:b,backdrop:u||"static",keyboard:u,autoFocus:!0,dialogClassName:a}),p.default.createElement(v.Modal.Header,null,p.default.createElement(v.Modal.Title,{title:e},e)),p.default.createElement(v.Modal.Body,null,d),s?null:p.default.createElement(v.Modal.Footer,null,p.default.createElement("img",{src:"/resources/icons/byname/branding_web_portal_logo_small",name:"branding_web_portal_logo"}),n))}}]),e}(b.Dialog.Dialog),O=function(){return p.default.createElement(b.ContentBlock,{collapsible:!1},p.default.createElement(b.ContentBlock.Body,null,(0,y.formatStr)("selectObject")))},P=function(){return p.default.createElement("div",null)},N=function(t){function e(t){s(this,e);for(var n=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),i={},o=window.appSetup["cs-tools-semanticlinks-linkgraph"],r=0;r<o.link_types.length;r++)o.link_types[r].includes("Contains")?o.link_types[r].split(" / ").forEach(function(t){i[t]=0}):o.link_types[r].split(" / ").forEach(function(t){i[t]=1});for(var l={},u=0;u<o.classnames.length;u++)l[o.classnames[u][0]]=[1,o.classnames[u][1]];return n.config_id=(0,b.parseQuery)(location).config_id,n.state={root:(0,b.parseQuery)(location).root,root_desc:"",svg:void 0,active_object:void 0,cdbwin_link:"",maylink:!1,radius:1,linkfilters:i,objectfilters:l,obsolete:0,showModal:!1,descComponent:O,settings:!1,width:800,loading:!1},n.changeRadius=n._changeRadius.bind(n),n.refreshSVG=n._refreshSVG.bind(n),n.handleObjectSelect=n._handleObjectSelect.bind(n),n.newRoot=n._newRoot.bind(n),n.openFilterOverlay=n._openFilterOverlay.bind(n),n.toggleObjectFilter=n._toggleObjectFilter.bind(n),n.toggleLinkFilter=n._toggleLinkFilter.bind(n),n.toggleObsoleteFilter=n._toggleObsoleteFilter.bind(n),n.constructFilter=n._constructFilter.bind(n),n.savetoCDB=n._savetoCDB.bind(n),n.openDialog=n._openDialog.bind(n),n.closeDialog=n._closeDialog.bind(n),n.getSettings=n._getSettings.bind(n),n.setSettings=n._setSettings.bind(n),n.setTableSettings=n._setTableSettings.bind(n),n.getSettings(),n}return l(e,t),f(e,[{key:"componentDidUpdate",value:function(t,e){!e.settings&&this.state.settings&&this.refreshSVG(this.state.radius)}},{key:"_getSettings",value:function(){var t=this,e="/internal//cs-tools-semanticlinks-linkgraph/settings/"+(0,b.parseQuery)(location).config_id;(0,b.getJSON)(e).then(function(e){if(e.settings){var n=e.settings;n.linkfilters&&n.objectfilters&&n.obsolete&&n.radius?t.setState({linkfilters:Object.assign(t.state.linkfilters,JSON.parse(n.linkfilters)),objectfilters:Object.assign(t.state.objectfilters,JSON.parse(n.objectfilters)),obsolete:JSON.parse(n.obsolete),radius:JSON.parse(n.radius),width:JSON.parse(n.width),settings:!0}):t.refreshSVG(t.state.radius)}})}},{key:"_setSettings",value:function(t){var e="/internal//cs-tools-semanticlinks-linkgraph/settings/"+(0,b.parseQuery)(location).config_id,n={linkfilters:JSON.stringify(this.state.linkfilters),objectfilters:JSON.stringify(this.state.objectfilters),obsolete:JSON.stringify(this.state.obsolete),radius:JSON.stringify(t),width:JSON.stringify(this.state.width)};(0,b.postJSON)(e,n),this.refreshSVG(t)}},{key:"_setTableSettings",value:function(t){var e="/internal//cs-tools-semanticlinks-linkgraph/settings/"+(0,b.parseQuery)(location).config_id,n={linkfilters:JSON.stringify(this.state.linkfilters),objectfilters:JSON.stringify(this.state.objectfilters),obsolete:JSON.stringify(this.state.obsolete),radius:JSON.stringify(this.state.radius),width:JSON.stringify(t)};(0,b.postJSON)(e,n),this.setState({width:t})}},{key:"_changeRadius",value:function(t){this.setSettings(t)}},{key:"_constructFilter",value:function(){var t="",e=!0,n=!1,i=void 0;try{for(var o,r=Object.keys(this.state.linkfilters)[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value;0===this.state.linkfilters[s]&&(t+=s+";")}}catch(t){n=!0,i=t}finally{try{!e&&r.return&&r.return()}finally{if(n)throw i}}t+="@";var a=!0,l=!1,u=void 0;try{for(var c,f=Object.keys(this.state.objectfilters)[Symbol.iterator]();!(a=(c=f.next()).done);a=!0){var h=c.value;0===this.state.objectfilters[h][0]&&(t+=this.state.objectfilters[h][1]+";")}}catch(t){l=!0,u=t}finally{try{!a&&f.return&&f.return()}finally{if(l)throw u}}return t+="@"+this.state.obsolete}},{key:"_refreshSVG",value:function(t){var e=this;if(!0!==this.state.loading){var n="/api/v1/collection/linkgraphconfig/"+this.config_id+"/svg/"+this.state.root+"/"+t+"/"+this.constructFilter();(0,b.getJSON)(n).then(function(t){e.setState({svg:t.svg,root_desc:t.root_desc,radius:t.radius,loading:!1})}),this.setState({loading:!0})}}},{key:"_newRoot",value:function(t){var e=this;if(!0!==this.state.loading){var n="/api/v1/collection/linkgraphconfig/"+this.config_id+"/svg/"+t.getAttribute("id")+"/"+this.state.radius+"/"+this.constructFilter();(0,b.getJSON)(n).then(function(n){e.setState({svg:n.svg,radius:n.radius,root:t.getAttribute("id"),root_desc:n.root_desc,loading:!1})}),this.setState({loading:!0})}}},{key:"_handleObjectSelect",value:function(t){var e=this,n=this.props.getObjectById(t.getAttribute("url")),i="",o=!1;if((0,b.isCEDesktop)()&&(i=t.getAttribute("cdbwin_url")),void 0===n)this.props.fetchObject(t.getAttribute("url")).then(function(t){var r=t.cdb_object_id,s=e.state.active_object;if(s){document.getElementById(s.get("cdb_object_id")).setAttribute("class","node")}document.getElementById(r).setAttribute("class","node-selected");var a=t["system:classname"];Object.keys(e.state.objectfilters).forEach(function(t){return a===e.state.objectfilters[t][1]&&(o=!0,!0)}),n=m.default.Map(t);var l=n.get("system:classname"),u=(0,b.getPlugin)("cs-semanticlinks-linkgraph-desc",function(t){return t===l},P);e.setState({active_object:n,cdbwin_link:i,maylink:o,descComponent:u})});else{var r=n.get("cdb_object_id"),s=this.state.active_object;if(s){var a=document.getElementById(s.get("cdb_object_id"));a&&a.setAttribute("class","node")}document.getElementById(r).setAttribute("class","node-selected");var l=n.get("system:classname");Object.keys(this.state.objectfilters).forEach(function(t){return l===e.state.objectfilters[t][1]&&(o=!0,!0)});var u=n.get("system:classname"),c=(0,b.getPlugin)("cs-semanticlinks-linkgraph-desc",function(t){return t===u},P);this.setState({active_object:n,cdbwin_link:i,maylink:o,descComponent:c})}}},{key:"_toggleLinkFilter",value:function(t){var e=0;0===this.state.linkfilters[t]&&(e=1);var n=this.state.linkfilters;n[t]=e,this.setState({linkfilters:n})}},{key:"_toggleObjectFilter",value:function(t){var e=this.state.objectfilters[t][1],n=[0,e];0===this.state.objectfilters[t][0]&&(n=[1,e]);var i=this.state.objectfilters;i[t]=n,this.setState({objectfilters:i})}},{key:"_toggleObsoleteFilter",value:function(){var t=0;0===this.state.obsolete&&(t=1),this.setState({obsolete:t})}},{key:"_openFilterOverlay",value:function(){var t=this,e=[],n=[];window.appSetup["cs-tools-semanticlinks-linkgraph"].link_types.forEach(function(i){var o=i.split(" / ");e.push(p.default.createElement(v.Checkbox,{checked:1===t.state.linkfilters[o[0]],onChange:t.toggleLinkFilter.bind(t,o[0])},o[0])),o[1]&&o[0]!==o[1]?n.push(p.default.createElement(v.Checkbox,{checked:1===t.state.linkfilters[o[1]],onChange:t.toggleLinkFilter.bind(t,o[1])},o[1])):n.push(p.default.createElement("span",null," "))});var i=[],o=!0,r=!1,s=void 0;try{for(var a,l=Object.keys(this.state.objectfilters)[Symbol.iterator]();!(o=(a=l.next()).done);o=!0){var u=a.value;i.push(p.default.createElement(v.Checkbox,{checked:1===this.state.objectfilters[u][0],onChange:this.toggleObjectFilter.bind(this,u)},u))}}catch(t){r=!0,s=t}finally{try{!o&&l.return&&l.return()}finally{if(r)throw s}}return p.default.createElement(v.Popover,{id:"filter",style:{maxWidth:"550px"}},p.default.createElement(v.Grid,null,p.default.createElement(v.Row,null,p.default.createElement(v.Col,{xs:4,md:4},p.default.createElement(v.Checkbox,{checked:1===this.state.obsolete,onChange:this.toggleObsoleteFilter},(0,y.formatStr)("obsolete")))),p.default.createElement(v.Row,null,p.default.createElement(v.Col,{xs:2,md:2},p.default.createElement("b",null,(0,y.formatStr)("objectfilter")),i.map(function(t){return t})),p.default.createElement(v.Col,{xs:2,md:2},p.default.createElement("b",null,(0,y.formatStr)("linkfilter")),e.map(function(t){return t})),p.default.createElement(v.Col,{xs:2,md:2},p.default.createElement("span",null," "),n.map(function(t){return t})))))}},{key:"_savetoCDB",value:function(){this.refs.CreateLink.wrappedInstance.submitForm(),this.refreshSVG(this.state.radius)}},{key:"_closeDialog",value:function(){this.setState({showModal:!1})}},{key:"_openDialog",value:function(){this.setState({showModal:!0})}},{key:"render",value:function(){var t=p.default.createElement(M,{buttons:[p.default.createElement(b.Dialog.Buttons.Create,{key:"create",onClick:this.savetoCDB}),p.default.createElement(b.Dialog.Buttons.Cancel,{key:"cancel",onClick:this.closeDialog})],size:b.Dialog.SIZE_LARGE,show:this.state.showModal,title:(0,y.formatStr)("add_link"),allowOverlay:!0,dialogClassName:(0,S.prefixNS)("create-link-modal")},p.default.createElement(x,{ref:"CreateLink",onClose:this.closeDialog,contextObject:this.state.active_object})),e=this.state.descComponent,n="";return this.state.active_object&&(n="/internal/uisupport/form/operation/class/CDB_ShowObject/"+this.state.active_object.get("system:classname")),p.default.createElement("div",null,t,p.default.createElement(C,{onDragFinished:this.setTableSettings,defaultSize:this.state.width,minSize:0,maxSize:-21,style:{height:"inherit"}},p.default.createElement("div",null,p.default.createElement(b.ContentBlock,{collapsible:!1,title:this.state.root_desc},p.default.createElement(b.ContentBlock.Header,null,(0,y.formatStr)("radius"),p.default.createElement(b.ButtonGroup,null,p.default.createElement(b.Button.DropdownTextButton,{title:(0,y.formatStr)("radius"),label:String(this.state.radius),onSelect:this.changeRadius,bsSize:"xsmall"},p.default.createElement(v.MenuItem,{eventKey:"1",key:"1"},"1"),p.default.createElement(v.MenuItem,{eventKey:"2",key:"2"},"2"),p.default.createElement(v.MenuItem,{eventKey:"3",key:"3"},"3"),p.default.createElement(v.MenuItem,{eventKey:"4",key:"4"},"4"),p.default.createElement(v.MenuItem,{eventKey:"5",key:"5"},"5"),p.default.createElement(v.MenuItem,{eventKey:"6",key:"6"},"6"),p.default.createElement(v.MenuItem,{eventKey:"7",key:"7"},"7")),p.default.createElement(v.OverlayTrigger,{trigger:"click",rootClose:!0,placement:"bottom",overlay:this.openFilterOverlay(),onExited:this.setSettings.bind(this,this.state.radius)},p.default.createElement(b.Button.IconButton,{title:(0,y.formatStr)("filter"),buttonStyle:"primary",iconName:"csweb_filter"})),p.default.createElement(b.Button.IconButton,{disabled:!this.state.maylink,title:(0,y.formatStr)("add_link"),onClick:this.openDialog,buttonStyle:"success",iconName:"csweb_add"}))),p.default.createElement(b.ContentBlock.Body,null,this.state.svg?p.default.createElement("div",{className:(0,S.prefixNS)("linkgraph-svg")},!0===this.state.loading&&p.default.createElement("div",{className:(0,S.prefixNS)("throbber")},p.default.createElement(b.Throbber,{hidden:!1})),p.default.createElement(k.default,{svg:this.state.svg,onClicked:this.handleObjectSelect,onDblClicked:this.newRoot})):p.default.createElement("div",{className:(0,S.prefixNS)("linkgraph-svg")},p.default.createElement(b.Throbber,{hidden:!1}))))),p.default.createElement("div",null,this.state.active_object?p.default.createElement("div",null,p.default.createElement(e,{contextObject:this.state.active_object,readOnly:!0}),p.default.createElement(E.default,{contextObject:this.state.active_object,formLink:n})):p.default.createElement(O,null))))}}]),e}(h.Component);N.propTypes={fetchObject:g.PropTypes.func.isRequired,getObjectById:g.PropTypes.func,location:g.PropTypes.object};var j={fetchObject:b.fetchObject};e.default=(0,g.connect)(u,j)(N)},function(t,e){t.exports=r},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t){var e=t.contextObject,n=t.dialog;return e.get("system:classname")+"."+n}function l(t,e){var n=t.userSettings.getIn([b,a(e)]);return{userSetting:void 0===n||""===n?void 0:n}}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),c=n(3),f=i(c),h=n(2),p=n(0),d=n(4),m=i(d),v=n(1),g=n(7),b=(0,v.prefixNS)("Attributes"),y=function(t){return t.sortBy(function(t){return t.get("label")})},S=function(t){function e(t){o(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),i=m.default.List(),s=m.default.List(),a=m.default.List();return n.state={attributes:n.createItemList(a,i),operationState:void 0,values:void 0,visibleAttributes:i,availableAttributes:s,allAttributes:a,showAttributeSettings:!1},n.openSettings=n.toggleSettings.bind(n,!0),n.closeSettings=n.toggleSettings.bind(n,!1),n.cancelChanges=n.cancelChanges.bind(n),n.saveAttributes=n.saveAttributes.bind(n),n.resetToDefault=n.resetToDefault.bind(n),n.transferAttribute=n.transferAttribute.bind(n),n.settingButtons=[{text:(0,g.formatStr)("save"),isPrimary:!0,callback:n.saveAttributes},{text:(0,g.formatStr)("attributes_reset"),isPrimary:!1,callback:n.resetToDefault}],n}return s(e,t),u(e,[{key:"componentDidMount",value:function(){var t=this,e=this.props,n=e.contextObject,i=e.dialog,o=e.formLink;this.userSettingKey=a(this.props);var r={};r.object_navigation_id=n.get("system:navigation_id"),i&&(r.dialog_name=i),void 0===o&&this.props.addNotification(o,(0,g.formatStr)("config_error"),(0,g.formatStr)("attr_mask_loading_failed"),"danger",2,null,5e3),(0,p.getJSON)(o,r).then(function(e){t.initializeAttributesFromResult(e),t.props.fetchUserSetting(b,t.userSettingKey)},function(){t.props.addNotification(o,(0,g.formatStr)("config_error"),(0,g.formatStr)("attr_mask_loading_failed"),"danger",2,null,5e3)})}},{key:"componentWillReceiveProps",value:function(t){var e=this;if(this.props.contextObject!==t.contextObject){var n=t.contextObject,i=t.dialog,o=t.formLink;this.userSettingKey=a(t);var r={};r.object_navigation_id=n.get("system:navigation_id"),i&&(r.dialog_name=i),void 0===o&&this.props.addNotification(o,(0,g.formatStr)("config_error"),(0,g.formatStr)("attr_mask_loading_failed"),"danger",2,null,5e3),(0,p.getJSON)(o,r).then(function(n){e.initializeAttributesFromResult(n),t.fetchUserSetting(b,e.userSettingKey)},function(){e.props.addNotification(o,(0,g.formatStr)("config_error"),(0,g.formatStr)("attr_mask_loading_failed"),"danger",2,null,5e3)})}}},{key:"toggleSettings",value:function(t){this.setState({showAttributeSettings:t})}},{key:"saveAttributes",value:function(){this.props.storeUserSetting(b,this.userSettingKey,this.state.visibleAttributes.map(function(t){return t.get("id")})),this.closeSettings()}},{key:"resetToDefault",value:function(){this.props.resetUserSetting(b,this.userSettingKey)}},{key:"cancelChanges",value:function(){this.initializeAttributes(this.state.allAttributes,this.props.userSetting),this.closeSettings()}},{key:"initializeAttributesFromResult",value:function(t){var e=[];t.registers.forEach(function(t){t.fields.forEach(function(t){e.push(t)})}),this.initializeAttributes(m.default.fromJS(e.map(function(e){return{id:e.attribute,label:e.attribute_label,value:"calendar"===e.fieldtype?(0,v.timeToDisplayFormat)(t.values[e.attribute]):e.config.display_mapping?e.config.display_mapping.mappings[0][1]:t.values[e.attribute],visible:!e.hidden,link:e.config.link_target_url}})),this.props.userSetting),this.setState({values:t.values,operationState:t.operation_state})}},{key:"initializeAttributes",value:function(t,e){var n=void 0,i=void 0;if(e){var o=m.default.Map(t.map(function(t){return[t.get("id"),t]}).toJS());n=t.filter(function(t){return!e.find(function(e){return e===t.get("id")})}),i=m.default.fromJS(e.map(function(t){return o.get(t)}))}else n=y(t.filter(function(t){return!t.get("visible")})),i=t.filter(function(t){return t.get("visible")});this.setState({allAttributes:t,visibleAttributes:i,availableAttributes:n,attributes:this.createItemList(n,i)})}},{key:"createItemList",value:function(t,e){return m.default.List([m.default.Map({label:(0,g.formatStr)("attributes_available_title"),items:t,unsortable:!0}),m.default.Map({label:(0,g.formatStr)("attributes_visible_title"),items:e})])}},{key:"transferAttribute",value:function(t){var e=y(t.get(0).get("items"));this.setState({availableAttributes:e,visibleAttributes:t.get(1).get("items"),attributes:t.set(0,t.get(0).set("items",e))})}},{key:"navigateLink",value:function(t){var e=this;(0,p.postJSON)(t,{values:this.state.values,operation_state:this.state.operationState}).then(function(n){n.ui_link?window.open(n.ui_link):n.error_message&&e.props.addNotification(t,(0,g.formatStr)("form_name"),n.error_message,"danger",2,null,5e3)})}},{key:"renderAttributes",value:function(){var t=this;return this.state.visibleAttributes.map(function(e){return[f.default.createElement("dt",{className:"text-muted",key:e.get("id")},e.get("label")),f.default.createElement("dd",{key:e.get("id")+"#value"},e.get("value"),e.get("link")?f.default.createElement(p.Icon,{src:(0,v.getIcon)("csweb_link"),className:(0,v.prefixNS)("attribute-list-button"),title:(0,g.formatStr)("attributes_panel_link"),onClick:function(){return t.navigateLink(e.get("link"))},size:"sm"}):void 0)]})}},{key:"render",value:function(){var t=this.props,e=t.onStartEditing,n=t.editingLabel,i=t.contextObject;return f.default.createElement("div",{className:(0,v.prefixNS)("attributes")},f.default.createElement(p.ContentBlock,{collapsible:!0,expanded:!0,title:(0,g.formatStr)("attributes_panel_title")},f.default.createElement(p.ContentBlock.Header,null,f.default.createElement(p.ButtonToolbar,null,e?f.default.createElement(p.Button.IconButton,{onClick:e,disabled:void 0===e,title:n,buttonStyle:"success",iconName:"csweb_edit"}):null,f.default.createElement(p.Button.IconButton,{onClick:this.openSettings,title:(0,g.formatStr)("attributes_dialog_title"),buttonStyle:"info",iconName:"csweb_settings"}),(0,p.isCEDesktop)()?f.default.createElement(p.Button.IconButton,{onClick:function(){return window.open(i.get("system:ui_link"))},title:(0,g.formatStr)("attributes_panel_link"),buttonStyle:"info",iconName:"csweb_link"}):f.default.createElement(p.ContentOperationToolbar,{contextObject:i}))),f.default.createElement(p.ContentBlock.Body,null,f.default.createElement("div",{className:(0,v.prefixNS)("attribute-list")},f.default.createElement("div",{className:(0,v.prefixNS)("attribute-block")},f.default.createElement("dl",{className:"dl-horizontal"},this.renderAttributes()))))),f.default.createElement(p.Dialog.Dialog,{title:(0,g.formatStr)("attributes_dialog_title"),buttons:[f.default.createElement(p.Dialog.Buttons.Save,{key:"save",onClick:this.saveAttributes}),f.default.createElement(p.Dialog.Buttons.Reset,{key:"reset",onClick:this.resetToDefault}),f.default.createElement(p.Dialog.Buttons.Cancel,{key:"cancel",onClick:this.cancelChanges})],size:p.Dialog.Dialog.SIZE_SMALL,show:this.state.showAttributeSettings},f.default.createElement("p",null,(0,g.formatStr)("attributes_dialog_text1")),f.default.createElement("p",null,(0,g.formatStr)("attributes_dialog_text2")),f.default.createElement(p.Organizer,{itemLists:this.state.attributes,onItemListsChange:this.transferAttribute,placeholder:(0,g.formatStr)("attributes_no_items")})))}}]),e}(c.Component);S.propTypes={contextObject:h.PropTypes.object.isRequired,dialog:h.PropTypes.string,onStartEditing:h.PropTypes.func,editingLabel:h.PropTypes.string,userSetting:h.ImmutablePropTypes.list,fetchUserSetting:h.PropTypes.func,storeUserSetting:h.PropTypes.func,resetUserSetting:h.PropTypes.func,addNotification:h.PropTypes.func,formLink:h.PropTypes.string},S.defaultProps={formLink:(0,v.getAppSetup)().getIn(["links","detail_view","info_form_url"])},e.default=(0,h.connect)(l,{storeUserSetting:p.storeUserSetting,fetchUserSetting:p.fetchUserSetting,resetUserSetting:p.resetUserSetting,addNotification:p.addNotification})(S)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),l=n(3),u=i(l),c=n(15),f=i(c),h=n(2),p=n(1),d=function(t){var e=t.svg;return u.default.createElement("div",{className:(0,p.prefixNS)("svg"),dangerouslySetInnerHTML:{__html:e}})};d.propTypes={svg:h.PropTypes.string.isRequired};var m=function(t){function e(t){return o(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return s(e,t),a(e,[{key:"componentDidUpdate",value:function(){var t=this,e=document.getElementById("linkgraph");e&&function(){(0,f.default)(e,{dblClickZoomEnabled:!1,minZoom:0,maxZoom:1e3,zoomScaleSensitivity:.5});for(var n=e.querySelectorAll(".node"),i=0,o=n.length;i<o;i++)!function(e,i){var o=0;n[e].addEventListener("click",function(){o++,1===o?setTimeout(function(){o=0,t.props.onClicked(n[e])},400):2===o&&(o=0,t.props.onDblClicked(n[e]))},!1)}(i)}()}},{key:"render",value:function(){return u.default.createElement(d,{svg:this.props.svg})}}]),e}(l.Component);e.default=m,m.propTypes={svg:h.PropTypes.string.isRequired,onClicked:h.PropTypes.func.isRequired,onDblClicked:h.PropTypes.func.isRequired}},function(t,e,n){var i=n(16);t.exports=i},function(t,e,n){var i=n(17),o=n(18),r=n(6),s=n(5),a=n(19),l=function(t,e){this.init(t,e)},u={viewportSelector:".svg-pan-zoom_viewport",panEnabled:!0,controlIconsEnabled:!1,zoomEnabled:!0,dblClickZoomEnabled:!0,mouseWheelZoomEnabled:!0,preventMouseEventsDefault:!0,zoomScaleSensitivity:.1,minZoom:.5,maxZoom:10,fit:!0,contain:!1,center:!0,refreshRate:"auto",beforeZoom:null,onZoom:null,beforePan:null,onPan:null,customEventsHandler:null,eventsListenerElement:null,onUpdatedCTM:null};l.prototype.init=function(t,e){var n=this;this.svg=t,this.defs=t.querySelector("defs"),s.setupSvgAttributes(this.svg),this.options=r.extend(r.extend({},u),e),this.state="none";var i=s.getBoundingClientRectNormalized(t);this.width=i.width,this.height=i.height,this.viewport=a(s.getOrCreateViewport(this.svg,this.options.viewportSelector),{svg:this.svg,width:this.width,height:this.height,fit:this.options.fit,contain:this.options.contain,center:this.options.center,refreshRate:this.options.refreshRate,beforeZoom:function(t,e){if(n.viewport&&n.options.beforeZoom)return n.options.beforeZoom(t,e)},onZoom:function(t){if(n.viewport&&n.options.onZoom)return n.options.onZoom(t)},beforePan:function(t,e){if(n.viewport&&n.options.beforePan)return n.options.beforePan(t,e)},onPan:function(t){if(n.viewport&&n.options.onPan)return n.options.onPan(t)},onUpdatedCTM:function(t){if(n.viewport&&n.options.onUpdatedCTM)return n.options.onUpdatedCTM(t)}});var l=this.getPublicInstance();l.setBeforeZoom(this.options.beforeZoom),l.setOnZoom(this.options.onZoom),l.setBeforePan(this.options.beforePan),l.setOnPan(this.options.onPan),l.setOnUpdatedCTM(this.options.onUpdatedCTM),this.options.controlIconsEnabled&&o.enable(this),this.lastMouseWheelEventTime=Date.now(),this.setupHandlers()},l.prototype.setupHandlers=function(){var t=this,e=null;if(this.eventListeners={mousedown:function(n){var i=t.handleMouseDown(n,e);return e=n,i},touchstart:function(n){var i=t.handleMouseDown(n,e);return e=n,i},mouseup:function(e){return t.handleMouseUp(e)},touchend:function(e){return t.handleMouseUp(e)},mousemove:function(e){return t.handleMouseMove(e)},touchmove:function(e){return t.handleMouseMove(e)},mouseleave:function(e){return t.handleMouseUp(e)},touchleave:function(e){return t.handleMouseUp(e)},touchcancel:function(e){return t.handleMouseUp(e)}},null!=this.options.customEventsHandler){this.options.customEventsHandler.init({svgElement:this.svg,eventsListenerElement:this.options.eventsListenerElement,instance:this.getPublicInstance()});var n=this.options.customEventsHandler.haltEventListeners;if(n&&n.length)for(var i=n.length-1;i>=0;i--)this.eventListeners.hasOwnProperty(n[i])&&delete this.eventListeners[n[i]]}for(var o in this.eventListeners)(this.options.eventsListenerElement||this.svg).addEventListener(o,this.eventListeners[o],!1);this.options.mouseWheelZoomEnabled&&(this.options.mouseWheelZoomEnabled=!1,this.enableMouseWheelZoom())},l.prototype.enableMouseWheelZoom=function(){if(!this.options.mouseWheelZoomEnabled){var t=this;this.wheelListener=function(e){return t.handleMouseWheel(e)},i.on(this.options.eventsListenerElement||this.svg,this.wheelListener,!1),this.options.mouseWheelZoomEnabled=!0}},l.prototype.disableMouseWheelZoom=function(){this.options.mouseWheelZoomEnabled&&(i.off(this.options.eventsListenerElement||this.svg,this.wheelListener,!1),this.options.mouseWheelZoomEnabled=!1)},l.prototype.handleMouseWheel=function(t){if(this.options.zoomEnabled&&"none"===this.state){this.options.preventMouseEventsDefault&&(t.preventDefault?t.preventDefault():t.returnValue=!1);var e=t.deltaY||1,n=Date.now()-this.lastMouseWheelEventTime,i=3+Math.max(0,30-n);this.lastMouseWheelEventTime=Date.now(),"deltaMode"in t&&0===t.deltaMode&&t.wheelDelta&&(e=0===t.deltaY?0:Math.abs(t.wheelDelta)/t.deltaY),e=-.3<e&&e<.3?e:(e>0?1:-1)*Math.log(Math.abs(e)+10)/i;var o=this.svg.getScreenCTM().inverse(),r=s.getEventPoint(t,this.svg).matrixTransform(o),a=Math.pow(1+this.options.zoomScaleSensitivity,-1*e);this.zoomAtPoint(a,r)}},l.prototype.zoomAtPoint=function(t,e,n){var i=this.viewport.getOriginalState();n?(t=Math.max(this.options.minZoom*i.zoom,Math.min(this.options.maxZoom*i.zoom,t)),t/=this.getZoom()):this.getZoom()*t<this.options.minZoom*i.zoom?t=this.options.minZoom*i.zoom/this.getZoom():this.getZoom()*t>this.options.maxZoom*i.zoom&&(t=this.options.maxZoom*i.zoom/this.getZoom());var o=this.viewport.getCTM(),r=e.matrixTransform(o.inverse()),s=this.svg.createSVGMatrix().translate(r.x,r.y).scale(t).translate(-r.x,-r.y),a=o.multiply(s);a.a!==o.a&&this.viewport.setCTM(a)},l.prototype.zoom=function(t,e){this.zoomAtPoint(t,s.getSvgCenterPoint(this.svg,this.width,this.height),e)},l.prototype.publicZoom=function(t,e){e&&(t=this.computeFromRelativeZoom(t)),this.zoom(t,e)},l.prototype.publicZoomAtPoint=function(t,e,n){if(n&&(t=this.computeFromRelativeZoom(t)),"SVGPoint"!==r.getType(e)){if(!("x"in e&&"y"in e))throw new Error("Given point is invalid");e=s.createSVGPoint(this.svg,e.x,e.y)}this.zoomAtPoint(t,e,n)},l.prototype.getZoom=function(){return this.viewport.getZoom()},l.prototype.getRelativeZoom=function(){return this.viewport.getRelativeZoom()},l.prototype.computeFromRelativeZoom=function(t){return t*this.viewport.getOriginalState().zoom},l.prototype.resetZoom=function(){var t=this.viewport.getOriginalState();this.zoom(t.zoom,!0)},l.prototype.resetPan=function(){this.pan(this.viewport.getOriginalState())},l.prototype.reset=function(){this.resetZoom(),this.resetPan()},l.prototype.handleDblClick=function(t){if(this.options.preventMouseEventsDefault&&(t.preventDefault?t.preventDefault():t.returnValue=!1),this.options.controlIconsEnabled){if((t.target.getAttribute("class")||"").indexOf("svg-pan-zoom-control")>-1)return!1}var e;e=t.shiftKey?1/(2*(1+this.options.zoomScaleSensitivity)):2*(1+this.options.zoomScaleSensitivity);var n=s.getEventPoint(t,this.svg).matrixTransform(this.svg.getScreenCTM().inverse());this.zoomAtPoint(e,n)},l.prototype.handleMouseDown=function(t,e){this.options.preventMouseEventsDefault&&(t.preventDefault?t.preventDefault():t.returnValue=!1),r.mouseAndTouchNormalize(t,this.svg),this.options.dblClickZoomEnabled&&r.isDblClick(t,e)?this.handleDblClick(t):(this.state="pan",this.firstEventCTM=this.viewport.getCTM(),this.stateOrigin=s.getEventPoint(t,this.svg).matrixTransform(this.firstEventCTM.inverse()))},l.prototype.handleMouseMove=function(t){if(this.options.preventMouseEventsDefault&&(t.preventDefault?t.preventDefault():t.returnValue=!1),"pan"===this.state&&this.options.panEnabled){var e=s.getEventPoint(t,this.svg).matrixTransform(this.firstEventCTM.inverse()),n=this.firstEventCTM.translate(e.x-this.stateOrigin.x,e.y-this.stateOrigin.y);this.viewport.setCTM(n)}},l.prototype.handleMouseUp=function(t){this.options.preventMouseEventsDefault&&(t.preventDefault?t.preventDefault():t.returnValue=!1),"pan"===this.state&&(this.state="none")},l.prototype.fit=function(){var t=this.viewport.getViewBox(),e=Math.min(this.width/t.width,this.height/t.height);this.zoom(e,!0)},l.prototype.contain=function(){var t=this.viewport.getViewBox(),e=Math.max(this.width/t.width,this.height/t.height);this.zoom(e,!0)},l.prototype.center=function(){var t=this.viewport.getViewBox(),e=.5*(this.width-(t.width+2*t.x)*this.getZoom()),n=.5*(this.height-(t.height+2*t.y)*this.getZoom());this.getPublicInstance().pan({x:e,y:n})},l.prototype.updateBBox=function(){this.viewport.simpleViewBoxCache()},l.prototype.pan=function(t){var e=this.viewport.getCTM();e.e=t.x,e.f=t.y,this.viewport.setCTM(e)},l.prototype.panBy=function(t){var e=this.viewport.getCTM();e.e+=t.x,e.f+=t.y,this.viewport.setCTM(e)},l.prototype.getPan=function(){var t=this.viewport.getState();return{x:t.x,y:t.y}},l.prototype.resize=function(){var t=s.getBoundingClientRectNormalized(this.svg);this.width=t.width,this.height=t.height;var e=this.viewport;e.options.width=this.width,e.options.height=this.height,e.processCTM(),this.options.controlIconsEnabled&&(this.getPublicInstance().disableControlIcons(),this.getPublicInstance().enableControlIcons())},l.prototype.destroy=function(){var t=this;this.beforeZoom=null,this.onZoom=null,this.beforePan=null,this.onPan=null,this.onUpdatedCTM=null,null!=this.options.customEventsHandler&&this.options.customEventsHandler.destroy({svgElement:this.svg,eventsListenerElement:this.options.eventsListenerElement,instance:this.getPublicInstance()});for(var e in this.eventListeners)(this.options.eventsListenerElement||this.svg).removeEventListener(e,this.eventListeners[e],!1);this.disableMouseWheelZoom(),this.getPublicInstance().disableControlIcons(),this.reset(),c=c.filter(function(e){return e.svg!==t.svg}),delete this.options,delete this.viewport,delete this.publicInstance,delete this.pi,this.getPublicInstance=function(){return null}},l.prototype.getPublicInstance=function(){var t=this;return this.publicInstance||(this.publicInstance=this.pi={enablePan:function(){return t.options.panEnabled=!0,t.pi},disablePan:function(){return t.options.panEnabled=!1,t.pi},isPanEnabled:function(){return!!t.options.panEnabled},pan:function(e){return t.pan(e),t.pi},panBy:function(e){return t.panBy(e),t.pi},getPan:function(){return t.getPan()},setBeforePan:function(e){return t.options.beforePan=null===e?null:r.proxy(e,t.publicInstance),t.pi},setOnPan:function(e){return t.options.onPan=null===e?null:r.proxy(e,t.publicInstance),t.pi},enableZoom:function(){return t.options.zoomEnabled=!0,t.pi},disableZoom:function(){return t.options.zoomEnabled=!1,t.pi},isZoomEnabled:function(){return!!t.options.zoomEnabled},enableControlIcons:function(){return t.options.controlIconsEnabled||(t.options.controlIconsEnabled=!0,o.enable(t)),t.pi},disableControlIcons:function(){return t.options.controlIconsEnabled&&(t.options.controlIconsEnabled=!1,o.disable(t)),t.pi},isControlIconsEnabled:function(){return!!t.options.controlIconsEnabled},enableDblClickZoom:function(){return t.options.dblClickZoomEnabled=!0,t.pi},disableDblClickZoom:function(){return t.options.dblClickZoomEnabled=!1,t.pi},isDblClickZoomEnabled:function(){return!!t.options.dblClickZoomEnabled},enableMouseWheelZoom:function(){return t.enableMouseWheelZoom(),t.pi},disableMouseWheelZoom:function(){return t.disableMouseWheelZoom(),t.pi},isMouseWheelZoomEnabled:function(){return!!t.options.mouseWheelZoomEnabled},setZoomScaleSensitivity:function(e){return t.options.zoomScaleSensitivity=e,t.pi},setMinZoom:function(e){return t.options.minZoom=e,t.pi},setMaxZoom:function(e){return t.options.maxZoom=e,t.pi},setBeforeZoom:function(e){return t.options.beforeZoom=null===e?null:r.proxy(e,t.publicInstance),t.pi},setOnZoom:function(e){return t.options.onZoom=null===e?null:r.proxy(e,t.publicInstance),t.pi},zoom:function(e){return t.publicZoom(e,!0),t.pi},zoomBy:function(e){return t.publicZoom(e,!1),t.pi},zoomAtPoint:function(e,n){return t.publicZoomAtPoint(e,n,!0),t.pi},zoomAtPointBy:function(e,n){return t.publicZoomAtPoint(e,n,!1),t.pi},zoomIn:function(){return this.zoomBy(1+t.options.zoomScaleSensitivity),t.pi},zoomOut:function(){return this.zoomBy(1/(1+t.options.zoomScaleSensitivity)),t.pi},getZoom:function(){return t.getRelativeZoom()},setOnUpdatedCTM:function(e){return t.options.onUpdatedCTM=null===e?null:r.proxy(e,t.publicInstance),t.pi},resetZoom:function(){return t.resetZoom(),t.pi},resetPan:function(){return t.resetPan(),t.pi},reset:function(){return t.reset(),t.pi},fit:function(){return t.fit(),t.pi},contain:function(){return t.contain(),t.pi},center:function(){return t.center(),t.pi},updateBBox:function(){return t.updateBBox(),t.pi},resize:function(){return t.resize(),t.pi},getSizes:function(){return{width:t.width,height:t.height,realZoom:t.getZoom(),viewBox:t.viewport.getViewBox()}},destroy:function(){return t.destroy(),t.pi}}),this.publicInstance};var c=[],f=function(t,e){var n=r.getSvg(t);if(null===n)return null;for(var i=c.length-1;i>=0;i--)if(c[i].svg===n)return c[i].instance.getPublicInstance();return c.push({svg:n,instance:new l(n,e)}),c[c.length-1].instance.getPublicInstance()};t.exports=f},function(t,e){t.exports=function(){function t(t,e,n){var i=function(t){!t&&(t=window.event);var n={originalEvent:t,target:t.target||t.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"==t.type?0:1,deltaX:0,delatZ:0,preventDefault:function(){t.preventDefault?t.preventDefault():t.returnValue=!1}};return"mousewheel"==u?(n.deltaY=-.025*t.wheelDelta,t.wheelDeltaX&&(n.deltaX=-.025*t.wheelDeltaX)):n.deltaY=t.detail,e(n)};return f.push({element:t,fn:i,capture:n}),i}function e(t,e){for(var n=0;n<f.length;n++)if(f[n].element===t&&f[n].capture===e)return f[n].fn;return function(){}}function n(t,e){for(var n=0;n<f.length;n++)if(f[n].element===t&&f[n].capture===e)return f.splice(n,1)}function i(e,n,i,o){var r;r="wheel"===u?i:t(e,i,o),e[a](c+n,r,o||!1)}function o(t,i,o,r){var s;s="wheel"===u?o:e(t,r),t[l](c+i,s,r||!1),n(t,r)}function r(t,e,n){i(t,u,e,n),"DOMMouseScroll"==u&&i(t,"MozMousePixelScroll",e,n)}function s(t,e,n){o(t,u,e,n),"DOMMouseScroll"==u&&o(t,"MozMousePixelScroll",e,n)}var a,l,u,c="",f=[];return window.addEventListener?(a="addEventListener",l="removeEventListener"):(a="attachEvent",l="detachEvent",c="on"),u="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",{on:r,off:s}}()},function(t,e,n){var i=n(5);t.exports={enable:function(t){var e=t.svg.querySelector("defs");if(e||(e=document.createElementNS(i.svgNS,"defs"),t.svg.appendChild(e)),!e.querySelector("style#svg-pan-zoom-controls-styles")){var n=document.createElementNS(i.svgNS,"style");n.setAttribute("id","svg-pan-zoom-controls-styles"),n.setAttribute("type","text/css"),n.textContent=".svg-pan-zoom-control { cursor: pointer; fill: black; fill-opacity: 0.333; } .svg-pan-zoom-control:hover { fill-opacity: 0.8; } .svg-pan-zoom-control-background { fill: white; fill-opacity: 0.5; } .svg-pan-zoom-control-background { fill-opacity: 0.8; }",e.appendChild(n)}var o=document.createElementNS(i.svgNS,"g");o.setAttribute("id","svg-pan-zoom-controls"),o.setAttribute("transform","translate("+(t.width-70)+" "+(t.height-76)+") scale(0.75)"),o.setAttribute("class","svg-pan-zoom-control"),o.appendChild(this._createZoomIn(t)),o.appendChild(this._createZoomReset(t)),o.appendChild(this._createZoomOut(t)),t.svg.appendChild(o),t.controlIcons=o},_createZoomIn:function(t){var e=document.createElementNS(i.svgNS,"g");e.setAttribute("id","svg-pan-zoom-zoom-in"),e.setAttribute("transform","translate(30.5 5) scale(0.015)"),e.setAttribute("class","svg-pan-zoom-control"),e.addEventListener("click",function(){t.getPublicInstance().zoomIn()},!1),e.addEventListener("touchstart",function(){t.getPublicInstance().zoomIn()},!1);var n=document.createElementNS(i.svgNS,"rect");n.setAttribute("x","0"),n.setAttribute("y","0"),n.setAttribute("width","1500"),n.setAttribute("height","1400"),n.setAttribute("class","svg-pan-zoom-control-background"),e.appendChild(n);var o=document.createElementNS(i.svgNS,"path");return o.setAttribute("d","M1280 576v128q0 26 -19 45t-45 19h-320v320q0 26 -19 45t-45 19h-128q-26 0 -45 -19t-19 -45v-320h-320q-26 0 -45 -19t-19 -45v-128q0 -26 19 -45t45 -19h320v-320q0 -26 19 -45t45 -19h128q26 0 45 19t19 45v320h320q26 0 45 19t19 45zM1536 1120v-960 q0 -119 -84.5 -203.5t-203.5 -84.5h-960q-119 0 -203.5 84.5t-84.5 203.5v960q0 119 84.5 203.5t203.5 84.5h960q119 0 203.5 -84.5t84.5 -203.5z"),o.setAttribute("class","svg-pan-zoom-control-element"),e.appendChild(o),e},_createZoomReset:function(t){var e=document.createElementNS(i.svgNS,"g");e.setAttribute("id","svg-pan-zoom-reset-pan-zoom"),e.setAttribute("transform","translate(5 35) scale(0.4)"),e.setAttribute("class","svg-pan-zoom-control"),e.addEventListener("click",function(){t.getPublicInstance().reset()},!1),e.addEventListener("touchstart",function(){t.getPublicInstance().reset()},!1);var n=document.createElementNS(i.svgNS,"rect");n.setAttribute("x","2"),n.setAttribute("y","2"),n.setAttribute("width","182"),n.setAttribute("height","58"),n.setAttribute("class","svg-pan-zoom-control-background"),e.appendChild(n);var o=document.createElementNS(i.svgNS,"path");o.setAttribute("d","M33.051,20.632c-0.742-0.406-1.854-0.609-3.338-0.609h-7.969v9.281h7.769c1.543,0,2.701-0.188,3.473-0.562c1.365-0.656,2.048-1.953,2.048-3.891C35.032,22.757,34.372,21.351,33.051,20.632z"),o.setAttribute("class","svg-pan-zoom-control-element"),e.appendChild(o);var r=document.createElementNS(i.svgNS,"path");return r.setAttribute("d","M170.231,0.5H15.847C7.102,0.5,0.5,5.708,0.5,11.84v38.861C0.5,56.833,7.102,61.5,15.847,61.5h154.384c8.745,0,15.269-4.667,15.269-10.798V11.84C185.5,5.708,178.976,0.5,170.231,0.5z M42.837,48.569h-7.969c-0.219-0.766-0.375-1.383-0.469-1.852c-0.188-0.969-0.289-1.961-0.305-2.977l-0.047-3.211c-0.03-2.203-0.41-3.672-1.142-4.406c-0.732-0.734-2.103-1.102-4.113-1.102h-7.05v13.547h-7.055V14.022h16.524c2.361,0.047,4.178,0.344,5.45,0.891c1.272,0.547,2.351,1.352,3.234,2.414c0.731,0.875,1.31,1.844,1.737,2.906s0.64,2.273,0.64,3.633c0,1.641-0.414,3.254-1.242,4.84s-2.195,2.707-4.102,3.363c1.594,0.641,2.723,1.551,3.387,2.73s0.996,2.98,0.996,5.402v2.32c0,1.578,0.063,2.648,0.19,3.211c0.19,0.891,0.635,1.547,1.333,1.969V48.569z M75.579,48.569h-26.18V14.022h25.336v6.117H56.454v7.336h16.781v6H56.454v8.883h19.125V48.569z M104.497,46.331c-2.44,2.086-5.887,3.129-10.34,3.129c-4.548,0-8.125-1.027-10.731-3.082s-3.909-4.879-3.909-8.473h6.891c0.224,1.578,0.662,2.758,1.316,3.539c1.196,1.422,3.246,2.133,6.15,2.133c1.739,0,3.151-0.188,4.236-0.562c2.058-0.719,3.087-2.055,3.087-4.008c0-1.141-0.504-2.023-1.512-2.648c-1.008-0.609-2.607-1.148-4.796-1.617l-3.74-0.82c-3.676-0.812-6.201-1.695-7.576-2.648c-2.328-1.594-3.492-4.086-3.492-7.477c0-3.094,1.139-5.664,3.417-7.711s5.623-3.07,10.036-3.07c3.685,0,6.829,0.965,9.431,2.895c2.602,1.93,3.966,4.73,4.093,8.402h-6.938c-0.128-2.078-1.057-3.555-2.787-4.43c-1.154-0.578-2.587-0.867-4.301-0.867c-1.907,0-3.428,0.375-4.565,1.125c-1.138,0.75-1.706,1.797-1.706,3.141c0,1.234,0.561,2.156,1.682,2.766c0.721,0.406,2.25,0.883,4.589,1.43l6.063,1.43c2.657,0.625,4.648,1.461,5.975,2.508c2.059,1.625,3.089,3.977,3.089,7.055C108.157,41.624,106.937,44.245,104.497,46.331z M139.61,48.569h-26.18V14.022h25.336v6.117h-18.281v7.336h16.781v6h-16.781v8.883h19.125V48.569z M170.337,20.14h-10.336v28.43h-7.266V20.14h-10.383v-6.117h27.984V20.14z"),r.setAttribute("class","svg-pan-zoom-control-element"),e.appendChild(r),e},_createZoomOut:function(t){var e=document.createElementNS(i.svgNS,"g");e.setAttribute("id","svg-pan-zoom-zoom-out"),e.setAttribute("transform","translate(30.5 70) scale(0.015)"),e.setAttribute("class","svg-pan-zoom-control"),e.addEventListener("click",function(){t.getPublicInstance().zoomOut()},!1),e.addEventListener("touchstart",function(){t.getPublicInstance().zoomOut()},!1);var n=document.createElementNS(i.svgNS,"rect");n.setAttribute("x","0"),n.setAttribute("y","0"),n.setAttribute("width","1500"),n.setAttribute("height","1400"),n.setAttribute("class","svg-pan-zoom-control-background"),e.appendChild(n);var o=document.createElementNS(i.svgNS,"path");return o.setAttribute("d","M1280 576v128q0 26 -19 45t-45 19h-896q-26 0 -45 -19t-19 -45v-128q0 -26 19 -45t45 -19h896q26 0 45 19t19 45zM1536 1120v-960q0 -119 -84.5 -203.5t-203.5 -84.5h-960q-119 0 -203.5 84.5t-84.5 203.5v960q0 119 84.5 203.5t203.5 84.5h960q119 0 203.5 -84.5 t84.5 -203.5z"),o.setAttribute("class","svg-pan-zoom-control-element"),e.appendChild(o),e},disable:function(t){t.controlIcons&&(t.controlIcons.parentNode.removeChild(t.controlIcons),t.controlIcons=null)}}},function(t,e,n){var i=n(5),o=n(6),r=function(t,e){this.init(t,e)};r.prototype.init=function(t,e){this.viewport=t,this.options=e,this.originalState={zoom:1,x:0,y:0},this.activeState={zoom:1,x:0,y:0},this.updateCTMCached=o.proxy(this.updateCTM,this),this.requestAnimationFrame=o.createRequestAnimationFrame(this.options.refreshRate),this.viewBox={x:0,y:0,width:0,height:0},this.cacheViewBox();var n=this.processCTM();this.setCTM(n),this.updateCTM()},r.prototype.cacheViewBox=function(){var t=this.options.svg.getAttribute("viewBox");if(t){var e=t.split(/[\s\,]/).filter(function(t){return t}).map(parseFloat);this.viewBox.x=e[0],this.viewBox.y=e[1],this.viewBox.width=e[2],this.viewBox.height=e[3];var n=Math.min(this.options.width/this.viewBox.width,this.options.height/this.viewBox.height);this.activeState.zoom=n,this.activeState.x=(this.options.width-this.viewBox.width*n)/2,this.activeState.y=(this.options.height-this.viewBox.height*n)/2,this.updateCTMOnNextFrame(),this.options.svg.removeAttribute("viewBox")}else this.simpleViewBoxCache()},r.prototype.simpleViewBoxCache=function(){var t=this.viewport.getBBox();this.viewBox.x=t.x,this.viewBox.y=t.y,this.viewBox.width=t.width,this.viewBox.height=t.height},r.prototype.getViewBox=function(){return o.extend({},this.viewBox)},r.prototype.processCTM=function(){var t=this.getCTM();if(this.options.fit||this.options.contain){var e;e=this.options.fit?Math.min(this.options.width/this.viewBox.width,this.options.height/this.viewBox.height):Math.max(this.options.width/this.viewBox.width,this.options.height/this.viewBox.height),t.a=e,t.d=e,t.e=-this.viewBox.x*e,t.f=-this.viewBox.y*e}if(this.options.center){var n=.5*(this.options.width-(this.viewBox.width+2*this.viewBox.x)*t.a),i=.5*(this.options.height-(this.viewBox.height+2*this.viewBox.y)*t.a);t.e=n,t.f=i}return this.originalState.zoom=t.a,this.originalState.x=t.e,this.originalState.y=t.f,t},r.prototype.getOriginalState=function(){return o.extend({},this.originalState)},r.prototype.getState=function(){return o.extend({},this.activeState)},r.prototype.getZoom=function(){return this.activeState.zoom},r.prototype.getRelativeZoom=function(){return this.activeState.zoom/this.originalState.zoom},r.prototype.computeRelativeZoom=function(t){return t/this.originalState.zoom},r.prototype.getPan=function(){return{x:this.activeState.x,y:this.activeState.y}},r.prototype.getCTM=function(){var t=this.options.svg.createSVGMatrix();return t.a=this.activeState.zoom,t.b=0,t.c=0,t.d=this.activeState.zoom,t.e=this.activeState.x,t.f=this.activeState.y,t},r.prototype.setCTM=function(t){var e=this.isZoomDifferent(t),n=this.isPanDifferent(t);if(e||n){if(e&&(!1===this.options.beforeZoom(this.getRelativeZoom(),this.computeRelativeZoom(t.a))?(t.a=t.d=this.activeState.zoom,e=!1):(this.updateCache(t),this.options.onZoom(this.getRelativeZoom()))),n){var i=this.options.beforePan(this.getPan(),{x:t.e,y:t.f}),r=!1,s=!1;!1===i?(t.e=this.getPan().x,t.f=this.getPan().y,r=s=!0):o.isObject(i)&&(!1===i.x?(t.e=this.getPan().x,r=!0):o.isNumber(i.x)&&(t.e=i.x),!1===i.y?(t.f=this.getPan().y,s=!0):o.isNumber(i.y)&&(t.f=i.y)),r&&s||!this.isPanDifferent(t)?n=!1:(this.updateCache(t),this.options.onPan(this.getPan()))}(e||n)&&this.updateCTMOnNextFrame()}},r.prototype.isZoomDifferent=function(t){return this.activeState.zoom!==t.a},r.prototype.isPanDifferent=function(t){return this.activeState.x!==t.e||this.activeState.y!==t.f},r.prototype.updateCache=function(t){this.activeState.zoom=t.a,this.activeState.x=t.e,this.activeState.y=t.f},r.prototype.pendingUpdate=!1,r.prototype.updateCTMOnNextFrame=function(){this.pendingUpdate||(this.pendingUpdate=!0,this.requestAnimationFrame.call(window,this.updateCTMCached))},r.prototype.updateCTM=function(){var t=this.getCTM();i.setCTM(this.viewport,t,this.defs),this.pendingUpdate=!1,this.options.onUpdatedCTM&&this.options.onUpdatedCTM(t)},t.exports=function(t,e){return new r(t,e)}}])});
//# sourceMappingURL=cs-tools-semanticlinks-linkgraph.3cbaa068c55c86ce4e8e.js.map