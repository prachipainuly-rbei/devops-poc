#!/usr/bin/env python
# -*- python -*- coding: iso-8859-1 -*-
#
# Copyright (C) 1990 - 2012 CONTACT Software GmbHfor behave
# All rights reserved.
# http://www.contact.de/
#
from cdb.objects import org
from cdb.validationkit import generateUser
import cdbwrapc

__docformat__ = "restructuredtext en"
__revision__ = "$Id: environment.py 135776 2016-01-12 11:27:41Z wen $"


def before_all(context):
    # Create a new User to use for testing and login as this one
    users = org.User.KeywordQuery(personalnummer="behave_test")
    if len(users) > 0:
        context.user = users[0]
    else:
        context.user = generateUser("behave_test")

    assert cdbwrapc.set_user(context.user.personalnummer),\
        "The User couldn't be logged in"


def after_all(context):
    # Delete the created user
    if hasattr(context, "user"):
        context.user.Delete()
