# !/usr/bin/env python
# -*- python -*- coding: iso-8859-1 -*-
#
# Copyright (C) 1990 - 2013 CONTACT Software GmbH
# All rights reserved.
# http://www.contact.de/
#

"""
Register tiles by launchpad.
"""

__docformat__ = "restructuredtext en"
__revision__ = "$Id: __init__.py 110730 2014-06-11 07:51:55Z mher $"

from cdb import elink
from cdb import sig

__all__ = []


@elink.using_template_engine("chameleon")
class LaunchpadPlugin(elink.Application):
    def setup(self):
        self.cssfile = ""
        self.make_tiles()

    def _tile(self, cssid, url, label, count=None):
        result = {"cssid": cssid,
                  "url": url,
                  "label": label}
        result["count"] = count
        return result

    def make_tiles(self):
        projects = []

        projects.append(self._tile("project-my", "", "Test-Label"))

        self.category_label = "Test Tile"  # Project._getClassDef().getTitle()
        self.tiles = projects


# lazy initialization
app = None


@sig.connect("cs.launchpad.getplugins")
def get_launchpad_plugin():
    global app
    if app is None:
        app = LaunchpadPlugin()
    # return: (order, plugin-app)
    return (1, app)
