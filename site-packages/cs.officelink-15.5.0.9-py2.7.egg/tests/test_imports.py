#!/usr/bin/env python
# -*- python -*- coding: UTF-8 -*-
#
# Copyright (C) 2015 CONTACT Software GmbH
# All rights reserved.
# http://www.contact.de/

import glob
import importlib
import os
import sys


def test_imports():

    def import_module(module_path):
        print "Importing %s.." % module_path,
        importlib.import_module(module_path)
        print "OK"

    def recursive_module_import(root_dir, module_path):
        scanned_dir = os.path.join(root_dir, *module_path.split("."))
        if glob.glob(os.path.join(scanned_dir, "__init__.py")):
            for name in os.listdir(scanned_dir):
                path = os.path.join(scanned_dir, name)
                sub_module_name = os.path.splitext(name)[0]
                sub_module_path = ".".join([module_path, sub_module_name])
                if os.path.isdir(path):
                    recursive_module_import(root_dir, sub_module_path)
                elif name.endswith(".py"):
                    if name == "__init__.py":
                        import_module(module_path)
                    else:
                        import_module(sub_module_path)

    root_dir = os.path.abspath(os.path.join(os.path.dirname(
        __file__.decode(sys.getfilesystemencoding())), ".."))
    for module_path in ["cs.officelink",
                        "cs.pcs.msproject"]:
        recursive_module_import(root_dir, module_path)
