.. _`officelink-adminmanual-config-project-server`:

Server
######

.. _`officelink-adminmanual-config-project-server-update-script`:

Komponente 'officelink'
=======================

Die PowerScript-Klasse :emphasis:`OfficeLinkComponent` in :file:`$(CADDOK_MODULE)/component.py` liegt
in Form eines Skelettes vor, welches nach kundenspezifischen Anforderungen überschrieben und angepasst
werden kann. Die Klasse bietet u.A. das Attribut :emphasis:`MSP_UPDATABLE_ATTRIBUTES` und die
Einstiegspunkte :emphasis:`on_project_config` und :emphasis:`on_project_export_xml`, welche dazu
dienen Anpassungen für den Projektabgleich vorzunehmen.

.. important::
    
    Es ist zudem erforderlich, weiterführende Hinweise im Projects Entwicklerhandbuch nachzuschlagen.

Erweiterung der Datenabgleichskomponente
========================================

Erweiterungsmöglichkeiten der Komponente
----------------------------------------

Der Datenabgleich kann über die PowerScript-Komponente :emphasis:`officelink` angepasst werden,
welcher standardmäßig auf das Modul :file:`cs.officelink.component.py` zeigt.
Zu diesem Zweck muss die in diesem Modul befindliche Klasse :emphasis:`OfficeLinkComponent` in
einem eigenen Modul per Klassenvererbung erweitert werden. Damit nun das eigene Modul bei einem
Datenabgleich geladen wird, muss die Komponenten-Konfiguration so angepasst werden, dass der
Komponenten-Pfad auf das eigene Modul zeigt.

.. container:: example

   .. rubric:: Beispiel-Modul eines Kundenpakets :file:`$(CADDOK_BASE)/customer.plm/customer/plm/MyOfficeLink.py`

   .. code-block:: python
      :linenos:

      #!/usr/bin/env powerscript
      # -*- python -*- coding: UTF-8 -*-

      from cdb import ue
      from cs.officelink.component import OfficeLinkComponent
        
      class MyOfficeLinkComponent(OfficeLinkComponent):
          pass

      if __name__ == "__main__":
          ue.run(MyOfficeLinkComponent)
