.. _`officelink-adminmanual-config-outlook-server-component`:

Komponente 'officelink'
#######################

Die PowerScript-Klasse :emphasis:`OfficeLinkComponent` in :file:`$(CADDOK_MODULE)/component.py` liegt
in Form eines Skelettes vor, welches nach kundenspezifischen Anforderungen überschrieben und angepasst
werden kann. Die Klasse bietet einen Einstiegspunkt (:emphasis:`on_document_created`), um darin den
eigentlichen Archivierungsvorgang mit kundenspezifischen nachbearbeitenden Schritten abzuschließen.
Diese Komponente wird, sofern sie aktiviert ist, von der |tm.ms.outlook| Integration unmittelbar nach der
erfolgreichen Archivierung eines Elementes (Anlage oder Nachricht) als Dokument aufgerufen.

.. note:: 

   Standardmäßig wird die Methode :emphasis:`on_document_created` nicht aufgerufen.
   D.h. dass für diese Komponente zuerst noch ein :guilabel:`aktiver Aufruf` mit den Werten
   :emphasis:`document|created` angelegt werden muss.

Beispiel-Modul eines Kundenpakets :file:`$(CADDOK_BASE)/customer.plm/customer/plm/MyOfficeLink.py` :

.. code-block:: python

    #!/usr/bin/env powerscript
    # -*- python -*- coding: UTF-8 -*-

    from cdb import ue
    from cs.documents import Document
    from cs.officelink.component import OfficeLinkComponent

    class MyOfficeLinkComponent(OfficeLinkComponent):

        def on_document_created(self, ctx):
            ctx.log("MyOfficeLinkComponent.on_document_created: -start-")

            if ctx.interface_host == "Outlook":
                cdb_object_id = ctx.object["cdb_object_id"]
                doc = Document.ByKeys(cdb_object_id=cdb_object_id)
                doc.ChangeState(200)

            # Example error (displayed in interface gui):
            # raise Exception("Invalid operation")  # or ue.Exception#

            ctx.log("MyOfficeLinkComponent.on_document_created: -stop-")

    if __name__ == "__main__":
        ue.run(MyOfficeLinkComponent)

.. toctree::
   :maxdepth: 2
