

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>DCS plug-in &mdash; OfficeLink</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="OfficeLink" href="index.html"/>
        <link rel="next" title="COM interop" href="officelink-adminmanual-com-interop.html"/>
        <link rel="prev" title="CAD switch: Metadata synchronization (II)" href="officelink-adminmanual-config-word-server-cad-conf-metadata-password.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="/doc/en" class="icon fa-book">
            Documentation Portal
          </a>
        

        
          <a href="index.html" class="icon icon-home"> OfficeLink
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="teaser.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-preface-abstract.html">General</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-preface-requirements.html">System requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-preface-security.html">Security settings</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-adminmanual-setup.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-setup-installation.html">Installing OfficeLink</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-setup-deinstallation.html">Uninstalling OfficeLink</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-adminmanual-config.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-config-common.html">Common settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-config-excel.html">Excel</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-config-outlook.html">Outlook</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-config-powerpoint.html">PowerPoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-config-project.html">Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-config-visio.html">Visio</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-config-word.html">Word</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">DCS plug-in</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#konfiguration-des-konverters">Configuration of the converter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#betrieb-des-konvertierungsserver-im-service-daemon-als-windows-dienst">Operation of the conversion server in the daemon service as a Windows service</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testen-von-konvertierungen">Testing conversions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#office-sicherheitseinstellungen-trust-center">Office Security Settings (Trust Center)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-adminmanual-com-interop.html">COM interop</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-com-interop-common.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-com-interop-interfaces.html">Interfaces &amp; methods</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-adminmanual-troubleshooting.html">Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-troubleshooting-table.html">Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-troubleshooting-log.html">Logbook</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">OfficeLink</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>DCS plug-in</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/officelink-adminmanual-dcs-plugin.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="dcs-plug-in">
<span id="officelink-adminmanual-dcs-plugin"></span><h1>DCS plug-in<a class="headerlink" href="#dcs-plug-in" title="Permalink to this headline">¶</a></h1>
<p>This document describes the specific aspects of installing and configuring a conversion server for converting MS Office documents to PDF with the mso Plugin.</p>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">The highest Microsoft Office version used in the company must always be installed on the conversion server.</p>
</div>
</div></blockquote>
</div>
<div class="section" id="konfiguration-des-konverters">
<h2>Configuration of the converter<a class="headerlink" href="#konfiguration-des-konverters" title="Permalink to this headline">¶</a></h2>
<p>To configure the converter, the configuration file must be copied from</p>
<p><code class="file docutils literal"><span class="pre">%CADDOK_MODULE%/cs/officelink/converter/pdfconverter.conf</span></code> to <code class="file docutils literal"><span class="pre">%CADDOK_BASE%/etc</span></code></p>
<p>. Specific adjustments should only be made in this file. The configuration options are commented in the configuration file at the respective switch.</p>
<p>The plug-in can be globally registered in the system using the following command line:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>powerscript -m cdb.acs.acstools register mso
</pre></div>
</div>
<p>Finally, the plug-in has to be activated for the DCS service in its configuration file (default <code class="file docutils literal"><span class="pre">BASE/etc/acs/acs.conf</span></code>) where the variable <em>plugins</em> is extended by the value <em>mso</em>.</p>
<div class="section" id="timeout-parameter">
<h3>Timeout parameter:<a class="headerlink" href="#timeout-parameter" title="Permalink to this headline">¶</a></h3>
<p>If it is determined during later operation of the converter that large documents could not be converted due to a timeout, the timeouts may have to be extended.</p>
<p>The setting of the timeout parameters depends on the performance of the conversion server. The timeout values should not be set too high, because in the case of Office dialogs (e.g. password queries) no further documents are converted until the timeout expires.</p>
<p>The parameter &#8216;default_conversion_timeout&#8217; defines a standard timeout for all converters, unless it is overwritten by a converter-specific parameter &lt;converter name&gt;_conversion_timeout.</p>
</div>
<div class="section" id="dialogroboter">
<h3>Dialog robot:<a class="headerlink" href="#dialogroboter" title="Permalink to this headline">¶</a></h3>
<p>In order to handle certain Office dialogs that are irrelevant or annoying for a conversion, there is a dialog robot in the converter. A thread recognizes pop-up windows based on the window title and closes them with a simulated button click or a window close event. Which button to press or whether to send a close event is configurable in the file &#8216;$BASE/etc/pdfconverter.conf&#8217; by adjusting the dictionary variable &#8216;<em>converter_dialog_confirmations</em>&#8216;. To do this, you use the title of the dialog box in question as a dictionary key and as a value, either the button name that is to be confirmed automatically, or an empty string. In the latter case, the dialog is closed neutrally.</p>
<p>Example: excelconverter_dialog_confirmations = {&#8220;Save?&#8221;: &#8220;Ok&#8221;}</p>
<p>The example closes dialogs with the window title &#8220;Save?&#8221; by clicking on the button labeled &#8220;Ok&#8221;. The system always checks whether the parent window is the <em>correct</em> application, in this case Excel.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">For button names, please note that the internal button name string must be used. For example, the names of buttons that have an accelerator (shortcuts in conjunction with the ALT key) contain an additional &#8216;&amp;&#8217; character. Example: &#8220;&amp;Yes&#8221;</p>
</div>
<p>If no button is specified, a window close event is sent to the window.</p>
<p>Example: excelconverter_dialog_confirmations = {&#8220;Save?&#8221;: &#8220;&#8221;}</p>
<p>There is also the possibility to access specific dialogs by specifying additional text content that appears within the dialog. For certain dialog types (e.g. VBA dialogs), this approach is even mandatory, as otherwise the dialogs cannot be uniquely identified and controlled for technical reasons.</p>
<p>Example: excelconverter_dialog_confirmations = {(&#8220;Save?&#8221;, &#8220;overwrite the existing file&#8221;): &#8220;&#8221;}</p>
<p>In the above example, a dialog with the window label &#8220;Warning: Do you really want to overwrite the existing file?&#8221; would close.</p>
<p>If none of these mechanisms intervene because no response is configured for a window, the converter runs on the configured timeout. In general, dialogs should be evaluated individually in advance. In addition, you can also set whether or not the dialogs should be displayed in the Office application for some messages, especially for compatibility messages.</p>
</div>
</div>
<div class="section" id="betrieb-des-konvertierungsserver-im-service-daemon-als-windows-dienst">
<h2>Operation of the conversion server in the daemon service as a Windows service<a class="headerlink" href="#betrieb-des-konvertierungsserver-im-service-daemon-als-windows-dienst" title="Permalink to this headline">¶</a></h2>
<p>To start as a Windows service, the service daemon should ideally be started in a shell with a logged in Windows user and tested with a conversion. If the DCS service is already running as a Windows service, the Office applications are invisible during the conversion, making it difficult to detect any insufficient conversion settings. After successful conversion, the Windows service must be configured so that the service logs in with the previously tested Windows user (&#8216;Log On Account&#8217;). Experience has shown that the conversion of Office documents with the&#8217;Local System account&#8217; set by default for Windows services often does not work without problems, whereby the cause is to be found in MS Windows or MS Office.</p>
<p>In some cases, and especially in virtualized environments, PDF conversion only works if a &#8216;Desktop&#8217; folder is located under: <code class="file docutils literal"><span class="pre">C:\Windows\System32\config\systemprofile</span></code> resp. <code class="file docutils literal"><span class="pre">C:\Windows\SysWOW64\config\systemprofile</span></code> and provided with sufficient permissions for the corresponding Windows user.</p>
<p>Furthermore it may be necessary to activate the performance-heavier pdfconverter.conf option <a href="#id1"><span class="problematic" id="id2">**</span></a>converter_shellexecute*. This applies, for example, to Excel documents in which print ranges were defined with a specific Excel language version and which are then converted using an Excel with a different language version.</p>
</div>
<div class="section" id="testen-von-konvertierungen">
<h2>Testing conversions<a class="headerlink" href="#testen-von-konvertierungen" title="Permalink to this headline">¶</a></h2>
<p>Documents can be directly converted via the following command line:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>powerscript -m cdb.acs.acstools testplg mso &quot;&lt;z_nummer&gt;&quot; &quot;&lt;z_index&gt;&quot; pdf
</pre></div>
</div>
</div>
<div class="section" id="office-sicherheitseinstellungen-trust-center">
<h2>Office Security Settings (Trust Center)<a class="headerlink" href="#office-sicherheitseinstellungen-trust-center" title="Permalink to this headline">¶</a></h2>
<p>It is recommended to deactivate all macros without notification on the conversion server using the Trust Center setting in all Office applications to which conversions are to be made, so that the conversion cannot be blocked by any dialogs controlled by VBA.</p>
<p>Especially in the Trust Center of Outlook the decision must be made whether an anti-virus scanner is installed on the conversion server and at the same time can guarantee that it is updated daily. Outlook displays whether the anti-virus status is valid in the Trust Center in the tab <span class="guilabel">Programmatic Access</span>. There you can also deactivate the warning dialog displayed by Outlook by default when anti-virus signatures are outdated and blocking during a conversion.</p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="officelink-adminmanual-com-interop.html" class="btn btn-neutral float-right" title="COM interop" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="officelink-adminmanual-config-word-server-cad-conf-metadata-password.html" class="btn btn-neutral" title="CAD switch: Metadata synchronization (II)" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, CONTACT Software GmbH.
      Last updated on 25.09.2018.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'15.5.0.9',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>