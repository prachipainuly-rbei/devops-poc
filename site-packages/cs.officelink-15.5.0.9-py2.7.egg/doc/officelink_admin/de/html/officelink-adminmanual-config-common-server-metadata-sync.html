

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Serverseitiger Metadatenabgleich &mdash; OfficeLink</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Stichwortverzeichnis"
              href="genindex.html"/>
        <link rel="search" title="Suche" href="search.html"/>
    <link rel="top" title="OfficeLink" href="index.html"/>
        <link rel="up" title="Server" href="officelink-adminmanual-config-excel-server.html"/>
        <link rel="next" title="CAD-Schalter: Maskenvorbelegung" href="officelink-adminmanual-config-common-server-cad-conf-preset-mask.html"/>
        <link rel="prev" title="CAD-Schalter: Metadatenabgleich" href="officelink-adminmanual-config-common-server-cad-conf-metadata.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="/doc/de" class="icon fa-book">
            Dokumentationsportal
          </a>
        

        
          <a href="index.html" class="icon icon-home"> OfficeLink
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="teaser.html">Einleitung</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-preface-abstract.html">Allgemeines</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-preface-requirements.html">Systemvoraussetzungen</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-preface-security.html">Sicherheitseinstellungen</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-adminmanual-setup.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-setup-installation.html">OfficeLink installieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-setup-deinstallation.html">OfficeLink deinstallieren</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="officelink-adminmanual-config.html">Konfiguration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-config-common.html">Allgemeine Einstellungen</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="officelink-adminmanual-config-excel.html">Excel</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-config-outlook.html">Outlook</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="officelink-adminmanual-config-powerpoint.html">Powerpoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-config-project.html">Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-config-visio.html">Visio</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="officelink-adminmanual-config-word.html">Word</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-adminmanual-dcs-plugin.html">DCS-Plug-In</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-dcs-plugin.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-dcs-plugin.html#konfiguration-des-konverters">Konfiguration des Konverters</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-dcs-plugin.html#betrieb-des-konvertierungsserver-im-service-daemon-als-windows-dienst">Betrieb des Konvertierungsserver im Service Daemon als Windows Dienst</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-dcs-plugin.html#testen-von-konvertierungen">Testen von Konvertierungen</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-dcs-plugin.html#office-sicherheitseinstellungen-trust-center">Office Sicherheitseinstellungen (Trust Center)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-adminmanual-com-interop.html">COM Interop</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-com-interop-common.html">Einführung</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-com-interop-interfaces.html">Interfaces &amp; Methoden</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-adminmanual-troubleshooting.html">Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-troubleshooting-table.html">Fehler-Ursachen-Lösungen</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-troubleshooting-log.html">Logbuch</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">OfficeLink</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="officelink-adminmanual-config.html">Konfiguration</a> &raquo;</li>
      
          <li><a href="officelink-adminmanual-config-excel.html">Excel</a> &raquo;</li>
      
          <li><a href="officelink-adminmanual-config-excel-server.html">Server</a> &raquo;</li>
      
    <li>Serverseitiger Metadatenabgleich</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/officelink-adminmanual-config-common-server-metadata-sync.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="serverseitiger-metadatenabgleich">
<span id="officelink-adminmanual-config-common-server-metadata-sync"></span><h1>Serverseitiger Metadatenabgleich<a class="headerlink" href="#serverseitiger-metadatenabgleich" title="Link zu dieser Überschrift">¶</a></h1>
<p>Gemeint ist hier nicht eine <em>vollständig</em> automatisierte auf dem Server ablaufende Aktion, d.h. ohne
dass dabei vorerst das entsprechende Dokument aus dem System zum Bearbeiten geöffnet wird. Gemeint
ist vielmehr das rein serverseitig lesende oder schreibende Auswerten von explizit dafür bestimmter
Dokumentvariablen. Der Unterschied zu den üblichen Dokumentvariablen besteht darin, dass die
serverseitigen Variablen flexibler benutzt werden können. Standardmäßig werden lesende serverseitige
Dokumentvariablen von einem Defaulthandler gefüllt.</p>
<div class="admonition important">
<p class="first admonition-title">Wichtig</p>
<p class="last">Damit die (standardmäßig aktivierten) Komponentenmethoden <em>on_metadata_read</em> und
<em>on_metadata_write</em> überhaupt aufgerufen werden, bzw. deren Signale
<em>officelink_metadata_read</em> und <em>officelink_metadata_write</em> gesendet werden,
muss es die für die <em>officelink</em> Komponente entsprechenden <span class="guilabel">Aktiver Aufruf</span>
Werte <em>metadata|read</em> und <em>metadata|write</em> geben.</p>
</div>
<p>Folgender Code liefert der Beispielvariable aus dem Anwenderhandbuch
(<em>cdb.rs.document2cdb_file.cdbf_original_name.N.string.PRIMARY</em>) einen Wert zurück:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cdb.sig</span> <span class="kn">import</span> <span class="n">connect</span>

<span class="nd">@connect</span><span class="p">(</span><span class="s2">&quot;officelink_metadata_read&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">set_result_values_in_excel_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">object</span><span class="p">[</span><span class="s2">&quot;cdb_classname&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;document&quot;</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">cs.documents</span> <span class="kn">import</span> <span class="n">Document</span>
        <span class="kn">from</span> <span class="nn">cs.officelink.documentvariables</span> <span class="kn">import</span> <span class="n">DocumentVariable</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="n">Document</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">object</span><span class="p">[</span><span class="s2">&quot;cdb_object_id&quot;</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">var_name</span> <span class="ow">in</span> <span class="n">ctx</span><span class="o">.</span><span class="n">document_variables</span><span class="p">:</span>
            <span class="n">var</span> <span class="o">=</span> <span class="n">DocumentVariable</span><span class="p">(</span><span class="n">var_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">relationship</span> <span class="o">==</span> <span class="s2">&quot;document2cdb_file&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">parameter</span> <span class="o">==</span> <span class="s2">&quot;PRIMARY&quot;</span><span class="p">:</span>
                    <span class="n">ctx</span><span class="o">.</span><span class="n">document_variables</span><span class="p">[</span><span class="n">var_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">PrimaryFiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cdbf_original_name</span>
</pre></div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="officelink-adminmanual-config-common-server-cad-conf-preset-mask.html" class="btn btn-neutral float-right" title="CAD-Schalter: Maskenvorbelegung" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="officelink-adminmanual-config-common-server-cad-conf-metadata.html" class="btn btn-neutral" title="CAD-Schalter: Metadatenabgleich" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, CONTACT Software GmbH.
      Zuletzt aktualisiert am 25.09.2018.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'15.5.0.9',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>