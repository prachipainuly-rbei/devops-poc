

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>DCS-Plug-In &mdash; OfficeLink</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Stichwortverzeichnis"
              href="genindex.html"/>
        <link rel="search" title="Suche" href="search.html"/>
    <link rel="top" title="OfficeLink" href="index.html"/>
        <link rel="next" title="COM Interop" href="officelink-adminmanual-com-interop.html"/>
        <link rel="prev" title="CAD-Schalter: Metadatenabgleich (II)" href="officelink-adminmanual-config-word-server-cad-conf-metadata-password.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="/doc/de" class="icon fa-book">
            Dokumentationsportal
          </a>
        

        
          <a href="index.html" class="icon icon-home"> OfficeLink
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="teaser.html">Einleitung</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-preface-abstract.html">Allgemeines</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-preface-requirements.html">Systemvoraussetzungen</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-preface-security.html">Sicherheitseinstellungen</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-adminmanual-setup.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-setup-installation.html">OfficeLink installieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-setup-deinstallation.html">OfficeLink deinstallieren</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-adminmanual-config.html">Konfiguration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-config-common.html">Allgemeine Einstellungen</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-config-excel.html">Excel</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-config-outlook.html">Outlook</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-config-powerpoint.html">Powerpoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-config-project.html">Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-config-visio.html">Visio</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-config-word.html">Word</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">DCS-Plug-In</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#konfiguration-des-konverters">Konfiguration des Konverters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#betrieb-des-konvertierungsserver-im-service-daemon-als-windows-dienst">Betrieb des Konvertierungsserver im Service Daemon als Windows Dienst</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testen-von-konvertierungen">Testen von Konvertierungen</a></li>
<li class="toctree-l2"><a class="reference internal" href="#office-sicherheitseinstellungen-trust-center">Office Sicherheitseinstellungen (Trust Center)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-adminmanual-com-interop.html">COM Interop</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-com-interop-common.html">Einführung</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-com-interop-interfaces.html">Interfaces &amp; Methoden</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-adminmanual-troubleshooting.html">Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-troubleshooting-table.html">Fehler-Ursachen-Lösungen</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-troubleshooting-log.html">Logbuch</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">OfficeLink</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>DCS-Plug-In</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/officelink-adminmanual-dcs-plugin.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="dcs-plug-in">
<span id="officelink-adminmanual-dcs-plugin"></span><h1>DCS-Plug-In<a class="headerlink" href="#dcs-plug-in" title="Link zu dieser Überschrift">¶</a></h1>
<p>Dieses Dokument beschreibt die spezifischen Aspekte der Installation und
Konfiguration eines Konvertierungsservers zur Konvertierung von MS-Office
Dokumenten nach PDF mit dem mso Plugin.</p>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link zu dieser Überschrift">¶</a></h2>
<blockquote>
<div><div class="admonition important">
<p class="first admonition-title">Wichtig</p>
<p class="last">Auf dem Konvertierungsserver muss immer die höchste im Unternehmen
eingesetzte Microsoft Office Version installiert werden.</p>
</div>
</div></blockquote>
</div>
<div class="section" id="konfiguration-des-konverters">
<h2>Konfiguration des Konverters<a class="headerlink" href="#konfiguration-des-konverters" title="Link zu dieser Überschrift">¶</a></h2>
<p>Zur Konfiguration des Konverters sollte die Konfigurationsdatei</p>
<p><code class="file docutils literal"><span class="pre">%CADDOK_MODULE%/cs/officelink/converter/pdfconverter.conf</span></code>
nach
<code class="file docutils literal"><span class="pre">%CADDOK_BASE%/etc</span></code></p>
<p>kopiert werden. Nur in dieser Datei sollten spezifische Anpassungen durchgeführt werden.
Die Konfigurationsmöglichkeiten sind in der Konfigurationsdatei beim jeweiligen Schalter
kommentiert.</p>
<p>Das Plug-In kann über folgende Kommandozeile global im System registriert werden:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>powerscript -m cdb.acs.acstools register mso
</pre></div>
</div>
<p>Abschließend muss das Plug-In noch für den DCS Dienst in dessen Konfigurationsdatei
(standardmäßig <code class="file docutils literal"><span class="pre">BASE/etc/acs/acs.conf</span></code>) aktiviert werden, in dem die Variable
<em>plugins</em> durch den Wert <em>mso</em> erweitert wird.</p>
<div class="section" id="timeout-parameter">
<h3>Timeout Parameter:<a class="headerlink" href="#timeout-parameter" title="Link zu dieser Überschrift">¶</a></h3>
<p>Wird beim späteren Betrieb des Konverters festgestellt, dass große Dokumente
wegen eines Timeouts nicht konvertiert werden konnten, müssen ggf. die
Timeouts verlängert werden.</p>
<p>Die Einstellung der Timeout Parameter ist abhängig von der Leistung des
Konvertierungsservers. Die Timeout Zeiten sollten nicht zu hoch gesetzt
werden, da im Falle von Office Dialogen (z.B. Passwortabfrage) bis zum Ablauf
des Timeouts keine weiteren Dokumente konvertiert werden.</p>
<p>Der Parameter &#8216;default_conversion_timeout&#8217; bestimmt ein standard Timeout für
alle Konverter, sofern dieser nicht durch einen konverterspezifischen
Parameter &lt;Konvertername&gt;_conversion_timeout überschrieben ist.</p>
</div>
<div class="section" id="dialogroboter">
<h3>Dialogroboter:<a class="headerlink" href="#dialogroboter" title="Link zu dieser Überschrift">¶</a></h3>
<p>Um bestimmte für eine Konvertierung irrelevante oder störende Office Meldungen zu behandeln, gibt
es im Konverter einen Dialogroboter. Ein Thread erkennt aufpoppende Fenster anhand des
Fenstertitels und schließt die Fenster durch einen simulierten Buttonclick oder mit einem Window
Close Event. Welcher Button gedrückt werden soll oder ob ein Close Event geschickt werden soll,
ist in der Datei &#8216;$BASE/etc/pdfconverter.conf&#8217; konfigurierbar durch Anpassen der
Dictionary-Variable &#8216;<em>converter_dialog_confirmations</em>&#8216;. Dazu verwenden Sie den Titel des
betroffenen Dialogs als Dictionary-Schlüssel und als Wert entweder den Button-Namen, welcher
automatisch bestätigt werden soll, oder einen Leer-String. In letzterem Fall wird der Dialog
neutral geschlossen.</p>
<p>Beispiel: excelconverter_dialog_confirmations = {&#8220;Speichern?&#8221;: &#8220;Ok&#8221;}</p>
<p>Das Beispiel schließt Dialoge mit dem Fenstertitel &#8220;Speichern?&#8221; durch Anklicken des Buttons mit
der Beschriftung &#8220;Ok&#8221;. Dabei wird immer geprüft, ob das übergeordnete Fenster die <em>richtige</em>
Anwendung ist, also in diesem Fall Excel.</p>
<div class="admonition important">
<p class="first admonition-title">Wichtig</p>
<p class="last">Bei Button-Namen ist zu beachten, dass der interne Button-Namen-String verwendet werden
muss. Z.B. beinhalten die Namen von Buttons, welche über einen sogenannten Accelerator
(Shortcuts in Verbindung mit der ALT-Taste) verfügen, zusätzlich ein &#8216;&amp;&#8217;-Zeichen.
Beipiel: &#8220;&amp;Ja&#8221;</p>
</div>
<p>Wird kein zu verwendender Button angegeben, wird ein Window Close Event an das Fenster geschickt.</p>
<p>Beispiel: excelconverter_dialog_confirmations = {&#8220;Speichern?&#8221;: &#8220;&#8221;}</p>
<p>Es gibt zudem die Möglichkeit, gezielter Dialoge anzusteuern, indem man zusätzlich Textinhalt mit
angibt, der innerhalb des Dialogs auftaucht. Bei bestimmten Dialogarten (z.B. VBA-Dialoge) ist
dieser Ansatz sogar obligatorisch, da andernfalls die Dialoge aus technischen Gründen nicht
eindeutig identifiziert und angesteuert werden können.</p>
<p>Beispiel: excelconverter_dialog_confirmations = {(&#8220;Speichern?&#8221;, &#8220;bestehende Datei überschreiben&#8221;): &#8220;&#8221;}</p>
<p>In obigem Beispiel würde z.B. ein per VBA aufgeblendeter Dialog mit dem Fensterlabel
&#8220;Warnung: Wollen Sie wirklich die bestehende Datei überschreiben?&#8221; geschlossen werden.</p>
<p>Greift keiner dieser Mechanismen, weil für ein Fenster keine Antwort konfiguriert ist, läuft der
Konverter auf den konfigurierten Timeout. Generell sollten Meldungen im Vorfeld einzeln bewertet
werden. Zudem kann man auch für einige Meldungen, insbesondere bei Kompatibilitätsmeldungen, in
der Office Anwendung einstellen, ob die Meldungen kommen sollen oder nicht.</p>
</div>
</div>
<div class="section" id="betrieb-des-konvertierungsserver-im-service-daemon-als-windows-dienst">
<h2>Betrieb des Konvertierungsserver im Service Daemon als Windows Dienst<a class="headerlink" href="#betrieb-des-konvertierungsserver-im-service-daemon-als-windows-dienst" title="Link zu dieser Überschrift">¶</a></h2>
<p>Zur Inbetriebnahme als Windows Dienst sollte der Service Daemon idealerweise vorweg mit einem
eingeloggten Windows Benutzer in einer Shell gestartet und mit einer Konvertierung getestet werden.
Wenn der DCS Dienst bereits als Windows Dienst läuft, sind die Office Anwendungen während der
Konvertierung unsichtbar, so dass eventuelle unzureichende Konvertierungseinstellungen schwer
erkannt werden können. Bei erfolgreicher Konvertierung muss der Windows Dienst anschließend so
konfiguriert werden, dass sich der Dienst mit dem zuvor getesteten Windows Benutzer einloggt (&#8216;Log
On Account&#8217;). Die Erfahrung hat gezeigt, dass die Konvertierung von Office Dokumenten mit dem für
Windows Dienste standardmäßig gesetztem &#8216;Local System account&#8217; oft nicht problemlos funktioniert,
wobei die Ursache bei MS Windows bzw. MS Office zu suchen ist.</p>
<p>In einzelnen Fällen und vor allem in virtualisierten Umgebungen funktioniert die PDF Konvertierung
nur, wenn ein Ordner &#8216;Desktop&#8217; unter:
<code class="file docutils literal"><span class="pre">C:\Windows\System32\config\systemprofile</span></code> bzw.
<code class="file docutils literal"><span class="pre">C:\Windows\SysWOW64\config\systemprofile</span></code>
angelegt und mit ausreichenden Rechten für den entsprechenden Windows Benutzer versehen wird.</p>
<p>Weiterhin kann ein Aktivieren der etwas performanzlastigeren pdfconverter.conf Option
<a href="#id1"><span class="problematic" id="id2">**</span></a>converter_shellexecute* erforderlich sein. Dies betrifft beispielsweise Excel Dokumente, in denen
mit einer bestimmten Excel Sprachversion Druckbereiche definiert wurden und die dann anschließend
über ein Excel mit einer abweichenden Sprachversion konvertiert werden.</p>
</div>
<div class="section" id="testen-von-konvertierungen">
<h2>Testen von Konvertierungen<a class="headerlink" href="#testen-von-konvertierungen" title="Link zu dieser Überschrift">¶</a></h2>
<p>Dokumente können testweise direkt über folgende Kommandozeile konvertiert werden:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>powerscript -m cdb.acs.acstools testplg mso &quot;&lt;z_nummer&gt;&quot; &quot;&lt;z_index&gt;&quot; pdf
</pre></div>
</div>
</div>
<div class="section" id="office-sicherheitseinstellungen-trust-center">
<h2>Office Sicherheitseinstellungen (Trust Center)<a class="headerlink" href="#office-sicherheitseinstellungen-trust-center" title="Link zu dieser Überschrift">¶</a></h2>
<p>Es empfiehlt sich, auf dem Konvertierungsserver per Trust Center Einstellung in allen Office
Anwendungen, in welchen konvertiert werden soll, alle Makros ohne Benachrichtigung zu deaktivieren,
damit die Konvertierung nicht durch eventuelle durch VBA gesteuerten Dialoge blockiert werden kann.</p>
<p>Speziell im Trust Center von Outlook muss zudem die Entscheidung getroffen werden, ob man auf dem
Konvertierungsserver einen Antivirenscanner installiert hat und gleichzeitig gewährleisten kann,
dass dieser täglich aktualisiert wird. Ob der Antivirusstatus gültig ist, zeigt Outlook konkret im
Trust Center im Reiter <span class="guilabel">Programmgesteuerter Zugriff</span> an. Dort kann auch der von Outlook
standardmäßig bei veralteten Antivirussignaturen angezeigte und während einer Konvertierung
blockierende Warndialog deaktiviert werden.</p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="officelink-adminmanual-com-interop.html" class="btn btn-neutral float-right" title="COM Interop" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="officelink-adminmanual-config-word-server-cad-conf-metadata-password.html" class="btn btn-neutral" title="CAD-Schalter: Metadatenabgleich (II)" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, CONTACT Software GmbH.
      Zuletzt aktualisiert am 25.09.2018.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'15.5.0.9',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>