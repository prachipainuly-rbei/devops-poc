

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Komponente ‘officelink’ &mdash; OfficeLink</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Stichwortverzeichnis"
              href="genindex.html"/>
        <link rel="search" title="Suche" href="search.html"/>
    <link rel="top" title="OfficeLink" href="index.html"/>
        <link rel="up" title="Server" href="officelink-adminmanual-config-outlook-server.html"/>
        <link rel="next" title="CAD-Schalter: Maskenvorbelegung" href="officelink-adminmanual-config-outlook-server-cad-conf-preset-mask.html"/>
        <link rel="prev" title="Server" href="officelink-adminmanual-config-outlook-server.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="/doc/de" class="icon fa-book">
            Dokumentationsportal
          </a>
        

        
          <a href="index.html" class="icon icon-home"> OfficeLink
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="teaser.html">Einleitung</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-preface-abstract.html">Allgemeines</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-preface-requirements.html">Systemvoraussetzungen</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-preface-security.html">Sicherheitseinstellungen</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-adminmanual-setup.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-setup-installation.html">OfficeLink installieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-setup-deinstallation.html">OfficeLink deinstallieren</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="officelink-adminmanual-config.html">Konfiguration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-config-common.html">Allgemeine Einstellungen</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-config-excel.html">Excel</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="officelink-adminmanual-config-outlook.html">Outlook</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-config-powerpoint.html">Powerpoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-config-project.html">Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-config-visio.html">Visio</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-config-word.html">Word</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-adminmanual-dcs-plugin.html">DCS-Plug-In</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-dcs-plugin.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-dcs-plugin.html#konfiguration-des-konverters">Konfiguration des Konverters</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-dcs-plugin.html#betrieb-des-konvertierungsserver-im-service-daemon-als-windows-dienst">Betrieb des Konvertierungsserver im Service Daemon als Windows Dienst</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-dcs-plugin.html#testen-von-konvertierungen">Testen von Konvertierungen</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-dcs-plugin.html#office-sicherheitseinstellungen-trust-center">Office Sicherheitseinstellungen (Trust Center)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-adminmanual-com-interop.html">COM Interop</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-com-interop-common.html">Einführung</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-com-interop-interfaces.html">Interfaces &amp; Methoden</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-adminmanual-troubleshooting.html">Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-troubleshooting-table.html">Fehler-Ursachen-Lösungen</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-adminmanual-troubleshooting-log.html">Logbuch</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">OfficeLink</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="officelink-adminmanual-config.html">Konfiguration</a> &raquo;</li>
      
          <li><a href="officelink-adminmanual-config-outlook.html">Outlook</a> &raquo;</li>
      
          <li><a href="officelink-adminmanual-config-outlook-server.html">Server</a> &raquo;</li>
      
    <li>Komponente &#8216;officelink&#8217;</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/officelink-adminmanual-config-outlook-server-component.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="komponente-officelink">
<span id="officelink-adminmanual-config-outlook-server-component"></span><h1>Komponente &#8216;officelink&#8217;<a class="headerlink" href="#komponente-officelink" title="Link zu dieser Überschrift">¶</a></h1>
<p>Die PowerScript-Klasse <em>OfficeLinkComponent</em> in <code class="file docutils literal"><span class="pre">$(CADDOK_MODULE)/component.py</span></code> liegt
in Form eines Skelettes vor, welches nach kundenspezifischen Anforderungen überschrieben und angepasst
werden kann. Die Klasse bietet einen Einstiegspunkt (<em>on_document_created</em>), um darin den
eigentlichen Archivierungsvorgang mit kundenspezifischen nachbearbeitenden Schritten abzuschließen.
Diese Komponente wird, sofern sie aktiviert ist, von der Microsoft Outlook Integration unmittelbar nach der
erfolgreichen Archivierung eines Elementes (Anlage oder Nachricht) als Dokument aufgerufen.</p>
<div class="admonition note">
<p class="first admonition-title">Bemerkung</p>
<p class="last">Standardmäßig wird die Methode <em>on_document_created</em> nicht aufgerufen.
D.h. dass für diese Komponente zuerst noch ein <span class="guilabel">aktiver Aufruf</span> mit den Werten
<em>document|created</em> angelegt werden muss.</p>
</div>
<p>Beispiel-Modul eines Kundenpakets <code class="file docutils literal"><span class="pre">$(CADDOK_BASE)/customer.plm/customer/plm/MyOfficeLink.py</span></code> :</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env powerscript</span>
<span class="c1"># -*- python -*- coding: UTF-8 -*-</span>

<span class="kn">from</span> <span class="nn">cdb</span> <span class="kn">import</span> <span class="n">ue</span>
<span class="kn">from</span> <span class="nn">cs.documents</span> <span class="kn">import</span> <span class="n">Document</span>
<span class="kn">from</span> <span class="nn">cs.officelink.component</span> <span class="kn">import</span> <span class="n">OfficeLinkComponent</span>

<span class="k">class</span> <span class="nc">MyOfficeLinkComponent</span><span class="p">(</span><span class="n">OfficeLinkComponent</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">on_document_created</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;MyOfficeLinkComponent.on_document_created: -start-&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">interface_host</span> <span class="o">==</span> <span class="s2">&quot;Outlook&quot;</span><span class="p">:</span>
            <span class="n">cdb_object_id</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">object</span><span class="p">[</span><span class="s2">&quot;cdb_object_id&quot;</span><span class="p">]</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="n">Document</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="n">cdb_object_id</span><span class="o">=</span><span class="n">cdb_object_id</span><span class="p">)</span>
            <span class="n">doc</span><span class="o">.</span><span class="n">ChangeState</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>

        <span class="c1"># Example error (displayed in interface gui):</span>
        <span class="c1"># raise Exception(&quot;Invalid operation&quot;)  # or ue.Exception#</span>

        <span class="n">ctx</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;MyOfficeLinkComponent.on_document_created: -stop-&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">ue</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">MyOfficeLinkComponent</span><span class="p">)</span>
</pre></div>
</div>
<div class="toctree-wrapper compound">
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="officelink-adminmanual-config-outlook-server-cad-conf-preset-mask.html" class="btn btn-neutral float-right" title="CAD-Schalter: Maskenvorbelegung" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="officelink-adminmanual-config-outlook-server.html" class="btn btn-neutral" title="Server" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, CONTACT Software GmbH.
      Zuletzt aktualisiert am 25.09.2018.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'15.5.0.9',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>