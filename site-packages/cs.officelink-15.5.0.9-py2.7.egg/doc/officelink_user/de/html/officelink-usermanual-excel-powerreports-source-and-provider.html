

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Datenquellen und Datenprovider &mdash; OfficeLink</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Stichwortverzeichnis"
              href="genindex.html"/>
        <link rel="search" title="Suche" href="search.html"/>
    <link rel="top" title="OfficeLink" href="index.html"/>
        <link rel="up" title="PowerReports" href="officelink-usermanual-excel-powerreports.html"/>
        <link rel="next" title="Implementierung eigener Provider" href="officelink-usermanual-excel-powerreports-implementation.html"/>
        <link rel="prev" title="Architektur" href="officelink-usermanual-excel-powerreports-architecture.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="/doc/de" class="icon fa-book">
            Dokumentationsportal
          </a>
        

        
          <a href="index.html" class="icon icon-home"> OfficeLink
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="teaser.html">Einleitung</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="officelink-usermanual-excel.html">Excel</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-excel-preface.html">Einführung</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-excel-documents.html">Dokumente bearbeiten</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-excel-metadata.html">Daten abgleichen</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="officelink-usermanual-excel-powerreports.html">PowerReports</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-outlook.html">Outlook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-outlook-preface.html">Einführung</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-outlook-mails.html">E-Mails und Anlagen</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-powerpoint.html">PowerPoint</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-powerpoint-preface.html">Einführung</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-powerpoint-documents.html">Dokumente bearbeiten</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-powerpoint-metadata.html">Daten abgleichen</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-project.html">Project</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-project-preface.html">Einführung</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-project-documents.html">Dokumente bearbeiten</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-project-sync.html">Projekt-Synchronisation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-visio.html">Visio</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-visio-preface.html">Einführung</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-visio-documents.html">Dokumente bearbeiten</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-visio-metadata.html">Daten abgleichen</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-word.html">Word</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-word-preface.html">Einführung</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-word-documents.html">Dokumente bearbeiten</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-word-metadata.html">Daten abgleichen</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">OfficeLink</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="officelink-usermanual-excel.html">Excel</a> &raquo;</li>
      
          <li><a href="officelink-usermanual-excel-powerreports.html">PowerReports</a> &raquo;</li>
      
    <li>Datenquellen und Datenprovider</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/officelink-usermanual-excel-powerreports-source-and-provider.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="datenquellen-und-datenprovider">
<span id="officelink-usermanual-excel-powerreports-source-and-provider"></span><h1>Datenquellen und Datenprovider<a class="headerlink" href="#datenquellen-und-datenprovider" title="Link zu dieser Überschrift">¶</a></h1>
<p>PowerReports beziehen ihre Daten aus XML Datenquellen, die im System unter
<span class="menuselection">Administration/Konfiguration ‣ Konfiguration ‣ XML Datenquellen</span> konfiguriert werden.</p>
<p>XML Datenquellen können kontextfreie oder kontextbezoge Daten liefern und werden
grundsätzlich anhand dieser Eigenschaft in zwei Typen unterschieden:</p>
<ol class="arabic">
<li><p class="first"><span class="guilabel">Kontextbezogene Datenquellen</span></p>
<p>Kontextbezogene Datenquellen liefern beispielsweise Daten zu einem Projekt, EC oder
einem Artikel. Zur Auswertung kontextbezogener XML Datenquellen wird also immer
mindestens ein Objekt benötigt, das den Kontext bildet. Beispielsweise Aufgaben
und Offene Punkte zum Projekt. Das Projekt bildet in diesem Beispiel den Kontext.
Reports, die auf kontextbezogenen Datenquellen basieren, werden immer über das
Kontextmenü des kontextbildenden Objekts aufgerufen. Ein Report &#8216;Projektübersicht&#8217;,
der Detailinformationen zu einem Projekt enthält, wird also im Kontextmenü eines
Projektes aufgerufen.</p>
</li>
<li><p class="first"><span class="guilabel">Kontextfreie Datenquellen</span></p>
<p>Kontextfreie Daten sind beispielsweise Abfragen über den gesamten Datenbestand.
Zur Auswertung kontextfreier Datenquellen wird kein kontextbildendes Objekt benötigt.
Reports, die auf kontextfreien Datenquellen basieren, werden an zentraler Stelle
in der OfficeLink-Menüleiste unter <span class="menuselection">Einstellungen ‣ Weitere Einstellungen... ‣ Reports</span> aufgerufen.</p>
</li>
</ol>
<div class="figure align-center" id="id1">
<span id="officelink-usermanual-excel-powerreports-source-properties"></span><img alt="_images/excel_powerreports_source_properties.png" src="_images/excel_powerreports_source_properties.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Datenquelleneigenschaften</span></p>
</div>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">Bezeichnung</span></code></dt>
<dd>Eindeutiger Name einer XML Datenquelle.</dd>
<dt><code class="docutils literal"><span class="pre">Kontext</span></code></dt>
<dd>Legt fest, ob die Datenquelle kontextfrei oder kontextbezogen ist. Für kontextfreie
Datenquellen bleibt dieses Feld leer. Für kontextbezogene Datenquellen wird der
Objekttyp, in dessen Kontext die Datenquelle ausgewertet werden soll, in Form eines
voll qualifizierten Pythonnamens der zugehörigen cdb.objects Klasse angegeben.
Beispielsweise <code class="file docutils literal"><span class="pre">cdb.objects.pcs.Projects.Project</span></code> für eine
Datenquelle, die im Kontext von Projekten ausgewertet werden kann.
Bei der Neuanlage einer Datenquelle stehen hier alle Root-Klassen in der Dropdown-Liste zur
Verfügung. Bei der Verwendung von Python-Unterklassen muss der voll qualifizierte Pythonname
jedoch manuell eingetragen werden.</dd>
<dt><code class="docutils literal"><span class="pre">Kardinalität</span></code></dt>
<dd>Gibt die Kardinalität des Kontextes an. Für kontextfreie Datenquellen wird dieses
Feld nicht ausgewertet. Für kontextbezogene Datenquellen legt die Kardinalität fest,
ob die Datenquelle mit genau einem kontextbildenden Objekt (Single Select) oder mit
einer beliebigen Anzahl kontextbildender Objekte (Multi Select) ausgewertet werden
kann. Mögliche Werte sind 1 oder N.</dd>
<dt><code class="docutils literal"><span class="pre">Beschreibung</span></code></dt>
<dd>Beschreibung der Datenquelle.</dd>
</dl>
<div class="section" id="datenprovider">
<span id="officelink-usermanual-excel-powerreports-source-and-provider-provider-intro"></span><h2>Datenprovider<a class="headerlink" href="#datenprovider" title="Link zu dieser Überschrift">¶</a></h2>
<p>Die Daten einer XML Datenquelle werden durch zugeordnete Datenprovider geliefert.
Eine Datenquelle kann aus einer beliebigen Anzahl von Datenprovidern bestehen.
Datenprovider sind parametrisierbar und wiederverwendbar.</p>
<p>Datenprovider werden in zwei Gruppen unterschieden:</p>
<ol class="arabic">
<li><p class="first"><span class="guilabel">Universelle Datenprovider</span></p>
<p>Universelle Datenprovider sind vorgefertigte Datenproviderimplementierungen für häufige
Anwendungsfälle, die ohne Programmierung in beliebigen Datenquellen verwendet und in
deren Kontext konfiguriert werden können. Folgende Typen universeller Datenprovider
stehen zur Verfügung:</p>
<ul>
<li><p class="first"><span class="guilabel">Relationship</span></p>
<p>zur Navigation von Beziehungen des cdb.objects Frameworks</p>
</li>
<li><p class="first"><span class="guilabel">Rule</span></p>
<p>für konfigurierte komplexe Abfragen</p>
</li>
<li><p class="first"><span class="guilabel">SimpleQuery</span></p>
<p>für einfache interaktive Abfragen</p>
</li>
<li><p class="first"><span class="guilabel">GroupBy</span></p>
<p>zur Gruppierung der Ergebnismenge anderer Provider</p>
</li>
</ul>
</li>
<li><p class="first"><span class="guilabel">Spezialisierte Datenprovider</span></p>
<p>Spezialisierte Datenprovider sind kundenspezifische Providerimplementierungen
für spezielle Anwendungsfälle. Spezialisierte Datenprovider sind ebenfalls in
beliebigen Datenquellen wiederverwendbar. Die Implementierung erfolgt durch
Ableitung von einer vordefinierten Basisklasse und Implementierung einer Schnittstelle.
Spezialisierte Datenprovider sind immer vom Typ <code class="file docutils literal"><span class="pre">CustomCode</span></code> .</p>
</li>
</ol>
<p>Kontextbezogene Datenquellen enthalten automatisch einen speziellen Datenprovider,
der das kontextbildende Objekt bzw. die kontextbildenden Objekte liefert. Dieser
Datenprovider wird im Folgenden als Kontextprovider bezeichnet. Die folgende
Abbildung zeigt den Kontextprovider anhand der XML Datenquelle &#8216;Projektübersicht&#8217;.
Das Projekt, auf dem ein zugrundeliegender Report aufgerufen wird, ist somit
automatisch in den exportierten XML Daten enthalten und kann im Report dargestellt
werden.</p>
<div class="figure align-center" id="id2">
<span id="officelink-usermanual-excel-powerreports-source-and-provider-provider-intro-contextprovider"></span><img alt="_images/excel_powerreports_contextprovider.png" src="_images/excel_powerreports_contextprovider.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Kontextprovider eines projektbezogenen Reports</span></p>
</div>
<p>Datenprovider können hierarchisch angeordnet werden. Ein untergeordneter Datenprovider
arbeitet dabei immer mit der Ergebnismenge des übergeordneten Datenproviders. Die
Ergebnismenge des übergeordneten Providers dient also als Eingabeparameter für den
untergeordneten Provider. Auf diese Weise lassen sich beispielsweise die Ergebnisse
des übergeordneten Providers mit einem GroupBy Provider gruppieren oder Beziehungen
durch das Objektmodell navigieren.</p>
<p>Folgende Abbildung zeigt wieder das Beispiel &#8216;Projektübersicht&#8217;, erweitert um einen
Relationship Provider, der die Dokumente zum Projekt liefert. Der Kontextprovider
dient dabei als übergeordneter Provider und stellt damit das Startobjekt (das Projekt)
zur Navigation der Beziehung.</p>
<div class="figure align-center" id="id3">
<span id="officelink-usermanual-excel-powerreports-source-and-provider-provider-relshipsubprovider"></span><img alt="_images/excel_powerreports_relshipsubprovider.png" src="_images/excel_powerreports_relshipsubprovider.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Relationship Subprovider zum Kontextprovider</span></p>
</div>
</div>
<div class="section" id="datenprovider-eigenschaften">
<span id="officelink-usermanual-excel-powerreports-source-and-provider-provider-properties"></span><h2>Datenprovider Eigenschaften<a class="headerlink" href="#datenprovider-eigenschaften" title="Link zu dieser Überschrift">¶</a></h2>
<div class="figure align-center" id="id4">
<span id="officelink-usermanual-excel-powerreports-source-and-provider-provider-properties-properties"></span><img alt="_images/excel_powerreports_provider_properties.png" src="_images/excel_powerreports_provider_properties.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Datenprovider Eigenschaften</span></p>
</div>
<ul>
<li><p class="first"><span class="guilabel">XML Datenquelle</span></p>
<p>Fremdschlüssel der zugehörigen XML Datenquelle. Automatisch vorbelegt und nicht änderbar.</p>
</li>
<li><p class="first"><span class="guilabel">Typ</span></p>
<p>Der Typ des Datenproviders (siehe <a class="reference internal" href="#officelink-usermanual-excel-powerreports-source-and-provider-provider-details"><span class="std std-ref">Providertypen im Detail</span></a> ).</p>
</li>
<li><p class="first"><span class="guilabel">Provider</span></p>
<p>Abhängig vom Providertyp spezifiziert dieses Feld die Datenherkunft (siehe <a class="reference internal" href="#officelink-usermanual-excel-powerreports-source-and-provider-provider-details"><span class="std std-ref">Providertypen im Detail</span></a> ).</p>
</li>
<li><p class="first"><span class="guilabel">XSD Name</span></p>
<p>Ein im Kontext der Datenquelle eindeutiger Namensraum. Abhängig vom Providertyp auch automatisch
vorbelegt. Nach der Neuanlage eines Providers nicht mehr veränderbar.</p>
</li>
</ul>
</div>
<div class="section" id="providertypen-im-detail">
<span id="officelink-usermanual-excel-powerreports-source-and-provider-provider-details"></span><h2>Providertypen im Detail<a class="headerlink" href="#providertypen-im-detail" title="Link zu dieser Überschrift">¶</a></h2>
<ul>
<li><p class="first"><span class="guilabel">Relationship</span></p>
<p>Datenprovider vom Typ Relationship liefern Objekte, die durch Navigation einer Beziehung des cdb.objects
Frameworks ermittelt werden. Da zur Navigation einer Beziehung immer ein Startobjekt benötigt wird, können
Relationship Provider ausschließlich als Subprovider verwendet werden. Relationship Provider können allen
Providern zugeordnet werden, die cdb.objects Objekte als Ergebnis liefern.</p>
<p>Im Feld <code class="file docutils literal"><span class="pre">Provider</span></code> wird der Name einer Beziehung eingetragen, die ausgehend von dem
Ergebnisobjekt des übergeordneten Providers navigierbar ist. Die jeweils verfügbaren Beziehungen stehen bei
der Neuanlage eines Relationship Providers in einem Katalog zur Auswahl.
Insofern es sich jedoch bei der Datenquelle des übergeordneten Providers nur um eine
Python-Unterklasse handelt, dann werden die verfügbaren Beziehungen nicht automatisch aufgelistet,
sondern müssen manuell eingetragen werden.</p>
<p>Durch Verkettung von Relationship Provider können ausgehend von dem Startobjekt Daten aus dem gesamten
Objektmodell ermittelt werden. Folgendes Beispiel zeigt die Verwendung von Relationship Provider ausgehend
von einem Projekt. Unter anderem werden auch das übergeordnete Projekt und alle zu diesem Projekt gehörigen
Dokumente ermittelt.</p>
<div class="figure align-center" id="id5">
<span id="officelink-usermanual-excel-powerreports-source-and-provider-provider-details-relhsipprovider"></span><img alt="_images/excel_powerreports_provider_relshipprovider.png" src="_images/excel_powerreports_provider_relshipprovider.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Beziehungen als Provider</span></p>
</div>
<p>Die Verwendung eines Relationship Providers an einem übergeordneten Provider, der ein n-stelliges Ergebnis
liefert, führt zu einem Multi-Export, d.h. die Beziehung wird für jedes Ergebnisobjekt des übergeordneten
Providers einzeln navigiert und gemeinsam mit dem Startobjekt exportiert. Für Datenquellen mit Multi-Export
Konfigurationen ist ein spezielles Template-Sheet in der Excel Vorlage erforderlich
(siehe <a class="reference internal" href="officelink-usermanual-excel-powerreports-creation.html#officelink-usermanual-excel-powerreports-creation-multiexport"><span class="std std-ref">Darstellung komplexer Zeilen bei Multi-Export Datenquellen</span></a> ).</p>
<p>Die Ergebnismenge eines Relationship Providers ist in Abhängigkeit von der Kardinalität der Beziehung entweder
ein <code class="file docutils literal"><span class="pre">ReportData</span></code> Objekt oder eine <code class="file docutils literal"><span class="pre">ReportDataList</span></code> .</p>
</li>
<li><p class="first"><span class="guilabel">Rule</span></p>
<p>Datenprovider vom Typ Rule liefern Objekte durch Auswertung einer konfigurierten Regel, die die Objekte
deklarativ beschreibt. Mit konfigurierten Regeln lassen sich sowohl einfache als auch komplexe Abfragen
unter Einbeziehung von Eigenschaften referenzierter Objekte ausführen. Detailierte Informationen zu
konfigurierbaren Regeln finden Sie im Administratorhandbuch im Abschnitt &#8216;Konfigurierbare Regeln&#8217;.</p>
<p>Rule Provider können ohne übergeordneten Provider oder als Subprovider verwendet werden. In beiden Fällen
kann die Regel durch Verwendung von Variablen parametrisiert werden. Die Variablen können durch einen
vorgeschalteten Dialog vom Anwender abgefragt werden. Dazu im Folgenden ein Beispiel für einen regelbasierten
Provider ohne übergeordneten Provider. Wenn eine Regel mit dem Namen <em>My Projects: By Category</em> Projekte
mit einer über einen Reportdialog definierten Projektkategorie liefern soll und zu diesem Zweck der Term
<em>category=$(category)</em> definiert wird, dann muss in dem Reportdialog ein Attribut mit dem Namen
<em>myprojectsbycategory-category</em> eingebaut werden. Da der Variablenname <em>$(category)</em> in diesem Beispiel
einem tatsächlichen Objektattributnamen entspricht, kann dieser variable Regelfilter zusätzlich in dem Report
selbst per automatisch im XML-Schema erscheinendem Argumentattribut mit einer Zelle verlinkt und aktualisiert
werden.
Bei Verwendung als Subprovider wird versucht, die Variablen aus den Attributen des Ergebnisobjektes des
übergeordneten Providers zu belegen, sofern diese  nicht durch einen ggf. vorgeschalteten Dialog definiert sind.
Ein Beispiel dazu für einen Term, der für einen regelbasierten Subprovider Aufgaben zu dem
übergeordneten Projekt Provider liefern soll, wäre demnach <em>cdb_project_id=$(cdb_project_id)</em>.</p>
<p>Im Feld &#8216;Provider&#8217; wird bei Rule Providern der Name der zu verwendenden Regel eingetragen.</p>
<p>Die Sortierung der Ergebnismenge kann durch den Parameter <span class="guilabel">OrderBy</span> festgelegt werden.
Die Definition der Sortierung erfolgt durch kommagetrennte Auflistung der Datenbankattribute, nach denen
sortiert werden soll. Für eine absteigende Sortierung wird dem jeweiligen Attribut ein Minuszeichen
vorangestellt.</p>
<p>Folgende Abbildung zeigt eine Datenquelle mit zwei Rule Providern zur Ermittlung von zu bearbeitenden
Projektaufgaben und unerledigten Offenen Punkten, für die der angemeldete Anwender verantwortlich ist:</p>
<div class="figure align-center" id="id6">
<span id="officelink-usermanual-excel-powerreports-source-and-provider-provider-details-ruleprovider"></span><img alt="_images/excel_powerreports_provider_ruleprovider.png" src="_images/excel_powerreports_provider_ruleprovider.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Provider zur regelbasierten Ermittlung von Aufgaben</span></p>
</div>
<p>Die Definition der Regel zur Ermittlung der Offenen Punkte könnte beispielsweise wie folgt aussehen:</p>
<div class="figure align-center" id="id7">
<span id="officelink-usermanual-excel-powerreports-source-and-provider-provider-details-ruleoverview"></span><img alt="_images/excel_powerreports_provider_ruleoverview.png" src="_images/excel_powerreports_provider_ruleoverview.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Konfigurierte Regel zur Ermittlung der Offenen Punkte eines Anwenders</span></p>
</div>
<p>Die Ergebnismenge von Rule Providern ist immer eine <span class="guilabel">ReportDataList</span> .</p>
</li>
<li><p class="first"><span class="guilabel">SimpleQuery</span></p>
<p>Datenprovider vom Typ SimpleQuery liefern Objekte durch Abfragen auf einer Datenbanktabelle, ähnlich einer
System-Suche. SimpleQuery Provider werden kontextfrei verwendet, dass heißt sie werden nicht als Subprovider
verwendet, sondern immer Top Level zur Datenquelle.</p>
<p>Im Feld &#8216;Provider&#8217; wird eine cdb.objects Klasse eingetragen, die den Typ der zu liefernden Objekte festlegt.
Die cdb.object Klasse legt damit auch die Datenbanktabelle fest, auf der die Suche ausgeführt wird.</p>
<p>SimpleQuery Provider liefern ohne einschränkende Suchbedingungen den gesamten Datenbestand der jeweiligen
Datenbanktabelle. Die zu verwendenden Suchbedingungen werden bei SimpleQuery Providern durch einen
vorgeschalteten Reportdialog vom Anwender abgefragt. Dieser Dialog kann für jeden auf einer Datenquelle
basierenden Report andere Suchbedingungen zur Auswahl stellen oder auch fest vorgeben. Unabhängig von den
verwendeten Suchbedingungen kann die maximale Ergebnismenge mit dem Parameter <span class="guilabel">MaxRows</span>
beschränkt werden. Wenn diese Menge überschritten wird, dann kommt es zu einer Fehlermeldung und der Report
wird nicht generiert.</p>
<p>Die Sortierung der Ergebnismenge kann durch den Parameter <span class="guilabel">OrderBy</span> festgelegt werden.
Die Definition der Sortierung erfolgt durch kommagetrennte Auflistung der Datenbankattribute, nach denen
sortiert werden soll. Für eine absteigende Sortierung wird dem jeweiligen Attribut ein Minuszeichen
vorangestellt.</p>
<p>Folgende Abbildung zeigt eine Datenquelle mit einem SimpleQuery Provider für Projekte mit einer definierten
Sortierung und eine Begrenzung der Ergebnismenge auf 5000. Die übrigen dargestellten Parameter gelten auch
für alle anderen Providertypen und werden in
<a class="reference internal" href="#officelink-usermanual-excel-powerreports-source-and-provider-provider-parameter"><span class="std std-ref">Provider Parameter</span></a> ausführlich beschrieben.</p>
<div class="figure align-center" id="id8">
<span id="officelink-usermanual-excel-powerreports-source-and-provider-provider-details-simplequeryprovider"></span><img alt="_images/excel_powerreports_provider_simplequeryprovider.png" src="_images/excel_powerreports_provider_simplequeryprovider.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - SimpleQuery Provider</span></p>
</div>
<p>SimpleQuery Provider liefern immer eine <span class="guilabel">ReportDataList</span> als Ergebnis.</p>
</li>
<li><p class="first"><span class="guilabel">GroupBy</span></p>
<p>GroupBy Provider gruppieren das Ergebnis anderer Provider anhand konfigurierbarer Attribute oder Wertebereiche.
Sie werden immer als Subprovider zu Providern verwendet, die als Ergebnis eine <span class="guilabel">ReportDataList</span>
liefern. Hierbei können für alle numerischen Attribute des übergeordneten Providers Gruppenfunktionen (sum, average,
min, max, count) definiert werden. Die Ergebnistabellen von GroupBy Providern sind damit besonders gut zur Erstellung
von Diagrammen geeignet.</p>
<div class="figure align-center" id="id9">
<span id="officelink-usermanual-excel-powerreports-source-and-provider-provider-details-groupbyprovider-table"></span><img alt="_images/excel_powerreports_provider_groupbyprovider_table_a.png" src="_images/excel_powerreports_provider_groupbyprovider_table_a.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Ergebnistabelle eines GroupBy Providers</span></p>
</div>
<p>Die folgende Abbildung zeigt exemplarisch die Gruppierung von Projekten, die durch einen übergeordneten SimpleQuery
Provider geliefert werden. Die Definition der Kriterien zur Gruppierung erfolgt durch die Parameter Group_By1,
Group_By2 und Group_By3. Im einfachsten Fall werden diese Parameter mit Attributnamen belegt, nach denen gruppiert
werden soll. Die Definition von  Gruppenfunktionen erfolgt durch optionale Parameter Function1, Function2, usw.
Diese werden jeweils mit einem durch Doppelpunkt getrennten Wertepaar aus Gruppenfunktion und Attributname belegt,
z.B. mit count:* oder average:effort_plan (die Gruppenfunktion count steht hierbei standardmäßig zur Verfügung, d.h.
diese muss nicht explizit als FunctionX des Providers definiert werden).
Durch Hinzufügen mehrerer GroupBy Provider lassen sich die Ergebnisse des übergeordneten Datenproviders
gleichzeitig nach unterschiedlichen Kriterien gruppieren. Jeder GroupBy Provider liefert dabei eine eigene
Ergebnistabelle.</p>
<div class="figure align-center" id="id10">
<span id="officelink-usermanual-excel-powerreports-source-and-provider-provider-details-groupbyprovider-projectgrouping"></span><img alt="_images/excel_powerreports_provider_groupbyprovider_projectgrouping.png" src="_images/excel_powerreports_provider_groupbyprovider_projectgrouping.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Gruppierung von Projekten</span></p>
</div>
<p>Die Gruppierungskriterien GroupBy_1, GroupBy_2 und Group_By_3 können in einem vorgeschalteten Reportdialog auch
interaktiv vom Anwender abgefragt werden. Anwender können auf diese Weise nach beliebigen Eigenschaften selbst
gruppieren. Die Gruppierungskriterien aus dem Dialog haben Vorrang gegenüber den im Register <span class="guilabel">Parameter</span>
definierten Kriterien.</p>
<p>Zur Gruppierung nach Wertebereichen, beispielsweise Projekte nach Budget, kann statt eines Attributnamen auch eine
Liste von konfigurierten Regeln angegeben werden. Die Regeln beschreiben dabei Teilmengen, in die die Ergebnisobjekte
das übergeordneten Providers einsortiert werden. Die Regeln werden, wie in der folgenden Abbildung dargestellt, in
Klammern als kommagetrennte Liste angegeben.</p>
<div class="figure align-center" id="id11">
<span id="officelink-usermanual-excel-powerreports-source-and-provider-provider-details-groupbyprovider-groupbyvalueranges"></span><img alt="_images/excel_powerreports_provider_groupbyprovider_groupbyvalueranges.png" src="_images/excel_powerreports_provider_groupbyprovider_groupbyvalueranges.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Gruppierung nach Wertebereichen mit Regeln</span></p>
</div>
<p>Die in dem Beispiel verwendeten Gruppierungsregeln geben Wertebereiche für das Projektbudget an. Die Definition
dieser Regeln könnte beispielsweise wie folgt aussehen. Weitere Informationen zu konfigurierbaren Regeln finden
Sie im Administratorhandbuch im Abschnitt &#8216;Konfigurierbare Regeln&#8217;.</p>
<div class="figure align-center" id="id12">
<span id="officelink-usermanual-excel-powerreports-source-and-provider-provider-details-groupbyprovider-groupingexample"></span><img alt="_images/excel_powerreports_provider_groupbyprovider_groupingexample_a.png" src="_images/excel_powerreports_provider_groupbyprovider_groupingexample_a.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Gruppierungsregeln am Beispiel Projekte nach Budget</span></p>
</div>
</li>
<li><p class="first"><span class="guilabel">CustomCode</span></p>
<p>Datenprovider vom Typ CustomCode können Daten auf beliebige Art und Weise ermitteln und zurückliefern.
CustomCode Provider können beispielsweise Abfragen ausführen, berechnete Spalten hinzufügen oder auch Daten
aus externen Datenbanken liefern. CustomCode Provider können die Reportdaten aus cdb.objects Objekten oder
RecordSets konstruieren. Darüberhinaus können die Reportdaten auch völlig frei konstruiert werden. Die
Implementierung von CustomCode Providern und eine ausführliche API Beschreibung finden Sie in
<a class="reference internal" href="officelink-usermanual-excel-powerreports-implementation.html#officelink-usermanual-excel-powerreports-implementation"><span class="std std-ref">Implementierung eigener Provider</span></a> .</p>
</li>
<li><p class="first"><span class="guilabel">Context</span></p>
<p>Datenprovider vom Typ Context werden ausschließlich automatisch vom System bei der Neuanlage einer
kontextbezogenen Datenquelle angelegt. Eine kontextbezogene Datenquelle enthält immer genau einen
Datenprovider vom Typ Kontext. Dieser Provider liefert das Objekt bzw. die Objekte, auf denen der
Report aufgerufen wurde. An den Kontextprovider können beispielsweise Subprovider vom Typ
Relationship angehängt werden, um referenzierte Objekte in den Report einzubeziehen.</p>
<p>In Abhängigkeit von der Kardinalität der Datenquelle liefert ein Kontextprovider entweder einer Liste
von Objekten als <span class="guilabel">ReportDataList</span> oder ein einzelnes Objekt als <span class="guilabel">ReportData</span>
Objekt.</p>
</li>
</ul>
</div>
<div class="section" id="provider-parameter">
<span id="officelink-usermanual-excel-powerreports-source-and-provider-provider-parameter"></span><h2>Provider Parameter<a class="headerlink" href="#provider-parameter" title="Link zu dieser Überschrift">¶</a></h2>
<p>Datenprovider sind durch Parameter konfigurierbar. Die verfügbaren Parameter hängen vom jeweiligen Providertyp ab
und werden bei der Neuanlage von Providern automatisch mit Standardwerten hinzugefügt. Die in diesem Abschnitt
beschriebenen Parameter gelten für alle Provider, die Daten in Form von cdb.objects Objekten liefern. Dies gilt
auch für selbst implementierte Provider vom Typ CustomCode.</p>
<div class="figure align-center" id="id13">
<span id="officelink-usermanual-excel-powerreports-source-and-provider-provider-standardparameter"></span><img alt="_images/excel_powerreports_provider_standardparameter.png" src="_images/excel_powerreports_provider_standardparameter.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Datenprovider Standardparameter</span></p>
</div>
<dl class="docutils">
<dt><span class="guilabel">Rechteprüfung auf Objektebene</span></dt>
<dd><p class="first">Die Rechteprüfung auf Objektebene kann für alle Datenprovider, die cdb.objects-Objekte als Ergebnismenge
liefern, mit folgenden Parametern konfiguriert werden.</p>
<ul class="last">
<li><p class="first"><span class="guilabel">AccessControl:CheckedRight</span></p>
<p>Legt das pro Objekt zu prüfende Recht fest. Ist dieser Parameter nicht vorhanden oder leer, ist die
Rechteprüfung auf Objektebene deaktiviert. Verwendet werden können alle im Rechtesystem verfügbaren
Rechte und Rechtegruppen. Standardmäßig wird bei Neuanlage eines universellen Providers automatisch
das read-Recht eingetragen. Bei großen Datenmengen, wie sie beispielsweise bei Providern vom Typ
SimpleQuery anfallen können, verschlechtert sich bei aktivierter Rechteprüfung das Laufzeitverhalten.
Sofern nicht unbedingt erforderlich, sollte die Rechteprüfung auf Objektebene bei potentiell großen
Datenmengen deaktiviert werden.</p>
</li>
<li><p class="first"><span class="guilabel">AccessControl:FailBehavior</span></p>
<p>Legt das Verhalten bei negativer Rechteprüfung fest. Zur Auswahl stehen zwei Modi:</p>
<ul>
<li><p class="first"><span class="guilabel">obfuscate</span></p>
<p>Die Objektattribute werden vor dem Export unkenntlich gemacht. Die Schlüsselattribute und weitere
hinzugefügte Daten, beispielsweise berechnete Spalten, bleiben leserlich.</p>
</li>
<li><p class="first"><span class="guilabel">skip row</span></p>
<p>Das Objekt und ggf. weitere hinzugefügte Daten werden nicht exportiert.</p>
</li>
</ul>
</li>
</ul>
</dd>
<dt><span class="guilabel">Hyperlinks</span></dt>
<dd><p class="first">Datenprovider können konfigurativ Hyperlinks exportieren, mit denen aus Excel direkt auf die entsprechenden
Objekte im System verlinkt werden kann. Die Konfiguration von Hyperlinks erfolgt mit den nachfolgend
beschriebenen Parametern:</p>
<ul>
<li><p class="first"><span class="guilabel">Hyperlinks:Enabled</span></p>
<p>Aktiviert Hyperlinks für den Datenprovider. Es wird ein zusätzliches Attribut cdbxml_hyperlink exportiert.
Dieses kann in der Excel Datenbindung verwendet werden und verlinkt damit automatisch aus Excel auf das
entsprechende System-Objekt. Zur Aktivierung von Hyperlinks ist es hinreichend, diesen Parameter mit &#8216;true&#8217;
zu belegen. Werden die nachfolgend beschriebenen weiteren Parameter nicht belegt, werden Hyperlinks mit
der Aktion CDB_ShowObject (Anzeige des Objekts im Infodialog) generiert, die mit der im Klassenverzeichnis
konfigurierten Objektbeschreibung beschriftet werden.</p>
</li>
<li><p class="first"><span class="guilabel">Hyperlinks:Action</span></p>
<p>Legt die auszuführende System-Operation beim Click auf den Hyperlink fest. Verwendet werden können alle
für eine Objektklasse definierten Operationen. Dies umfasst Systemoperationen wie beispielsweise
CDB_Modify und CDB_View, PowerScript Operationen und GraphView Operationen wie beispielsweise
cdbpcs_project_overview zur Darstellung der Projektübersicht. Wird dieses Feld leer gelassen, wird die
Klassenvariable __default_action__ der zugrundeliegenden cdb.objects Klasse ausgewertet. Ist diese
ebenfalls nicht definiert, wird die Operation CDB_ShowObject verwendet.</p>
</li>
<li><p class="first"><span class="guilabel">Hyperlinks:TextToDisplay</span></p>
<p>Legt den anzuzeigenden Text fest. Es kann eine beliebige Zeichenkette für einen konstanten Ausdruck
oder ein Attributname der zugrundeliegenden cdb.objects-Klasse angegeben werden. Wird dieses Feld
leer gelassen, wird die konfigurierte Objektbeschreibung aus dem System-Klassenverzeichnis verwendet.</p>
</li>
</ul>
<div class="last figure align-center" id="id14">
<span id="officelink-usermanual-excel-powerreports-source-and-provider-provider-standardparameter-hyperlink"></span><img alt="_images/excel_powerreports_provider_standardparameter_hyperlink_a.png" src="_images/excel_powerreports_provider_standardparameter_hyperlink_a.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Hyperlinkkonfiguration und zugehöriges Schemaobjekt</span></p>
</div>
</dd>
<dt><span class="guilabel">Langtexte</span></dt>
<dd><p class="first">Datenprovider können optional die zu einem Objekt gehörigen Langtexte exportieren. Die Angabe der zu
exportierenden Langtexte erfolgt aus Performancegründen explizit durch den Parameter
<span class="guilabel">LongTexts</span> . Die zu exportierenden Langtexte werden durch eine kommagetrennte
Aufzählung der Langtextrelationen angegeben. Die eingetragenen Langtexte stehen anschließend in Excel
zur Herstellung der Datenbindung unter diesen Namen zur Verfügung.</p>
<div class="last figure align-center" id="id15">
<span id="officelink-usermanual-excel-powerreports-source-and-provider-provider-standardparameter-longtext"></span><img alt="_images/excel_powerreports_provider_standardparameter_longtext_a.png" src="_images/excel_powerreports_provider_standardparameter_longtext_a.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Langtextkonfiguration und zugehöriges Schemaobjekt</span></p>
</div>
</dd>
<dt><span class="guilabel">Attributtypen</span></dt>
<dd><p class="first">Datenprovider exportieren standardmäßig neben allen normalen Attributen auch immer alle Mapped
Attribute. Jedoch muss das Ausleiten weiterer spezieller Attribute, wie das der Joined und
Virtual Attribute, für jeden Provider explizit aktiviert werden. Die geschieht, indem man
den Providerparameter <span class="guilabel">AllAttributeTypes</span> auf <span class="guilabel">True</span> setzt.</p>
<div class="last admonition important">
<p class="first admonition-title">Wichtig</p>
<p class="last">Das Verwenden von Joined und Virtual Attributen ist aus Gründen der Performance nicht für
Provider empfehlenswert, welche viele Objekte liefern müssen.</p>
</div>
</dd>
<dt><span class="guilabel">MaxRowsTruncate</span></dt>
<dd>Die Ergebnismenge eines Providers kann mit diesem Parameter limitiert werden. Der Standardwert
hierfür liegt aufgrund einer Beschränkung in Excel bei 64000. Falls eine Liste beim Füllen einer Tabelle
die Tabellenzeilennummer 65535 überschreitet, kommt es zu einer XML-Import Fehlermeldung in Excel, dass
keine oder nur einige Daten importiert wurden.</dd>
</dl>
</div>
<div class="section" id="generelle-zugriffsberechtigungen-auf-providerebene">
<span id="officelink-usermanual-excel-powerreports-source-and-provider-provider-accessrights"></span><h2>Generelle Zugriffsberechtigungen auf Providerebene<a class="headerlink" href="#generelle-zugriffsberechtigungen-auf-providerebene" title="Link zu dieser Überschrift">¶</a></h2>
<p>Der Zugriff auf die Daten eines Datenproviders wird durch Zuordnung von berechtigten Rollen und Personen geschützt.
Bei der Neuanlage eines Datenproviders wird automatisch die Rolle &#8216;public&#8217; eingetragen, so dass auf Providerebene
zunächst keine Zugriffsbeschränkungen bestehen.</p>
<div class="figure align-center" id="id16">
<span id="officelink-usermanual-excel-powerreports-source-and-provider-provider-accessrights-common"></span><img alt="_images/excel_powerreports_provider_accessrights.png" src="_images/excel_powerreports_provider_accessrights.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Generelle Zugriffsberechtigungen auf Providerebene</span></p>
</div>
<p>Zusätzlich zu den Zugriffsbeschränkungen auf Providerebene führen Provider beim Datenexport auch eine Rechteprüfung
auf Objektebene anhand des Rechtesystems durch. Die Rechteprüfung auf Objektebene ist für jeden Provider
aktivierbar/deaktivierbar. Das geprüfte Recht ist konfigurierbar.</p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="officelink-usermanual-excel-powerreports-implementation.html" class="btn btn-neutral float-right" title="Implementierung eigener Provider" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="officelink-usermanual-excel-powerreports-architecture.html" class="btn btn-neutral" title="Architektur" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, CONTACT Software GmbH.
      Zuletzt aktualisiert am 25.09.2018.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'15.5.0.9',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>