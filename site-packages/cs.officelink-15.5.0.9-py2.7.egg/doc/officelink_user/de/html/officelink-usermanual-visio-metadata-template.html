

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Vorlagen zum Datenabgleich erstellen &mdash; OfficeLink</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Stichwortverzeichnis"
              href="genindex.html"/>
        <link rel="search" title="Suche" href="search.html"/>
    <link rel="top" title="OfficeLink" href="index.html"/>
        <link rel="up" title="Daten abgleichen" href="officelink-usermanual-visio-metadata.html"/>
        <link rel="next" title="Word" href="officelink-usermanual-word.html"/>
        <link rel="prev" title="Metadatensynchronisation mit dem System" href="officelink-usermanual-visio-metadata-syncwrite.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="/doc/de" class="icon fa-book">
            Dokumentationsportal
          </a>
        

        
          <a href="index.html" class="icon icon-home"> OfficeLink
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="teaser.html">Einleitung</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-excel.html">Excel</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-excel-preface.html">Einführung</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-excel-documents.html">Dokumente bearbeiten</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-excel-metadata.html">Daten abgleichen</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-excel-powerreports.html">PowerReports</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-outlook.html">Outlook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-outlook-preface.html">Einführung</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-outlook-mails.html">E-Mails und Anlagen</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-powerpoint.html">PowerPoint</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-powerpoint-preface.html">Einführung</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-powerpoint-documents.html">Dokumente bearbeiten</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-powerpoint-metadata.html">Daten abgleichen</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-project.html">Project</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-project-preface.html">Einführung</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-project-documents.html">Dokumente bearbeiten</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-project-sync.html">Projekt-Synchronisation</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="officelink-usermanual-visio.html">Visio</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-visio-preface.html">Einführung</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-visio-documents.html">Dokumente bearbeiten</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="officelink-usermanual-visio-metadata.html">Daten abgleichen</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-word.html">Word</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-word-preface.html">Einführung</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-word-documents.html">Dokumente bearbeiten</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-word-metadata.html">Daten abgleichen</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">OfficeLink</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="officelink-usermanual-visio.html">Visio</a> &raquo;</li>
      
          <li><a href="officelink-usermanual-visio-metadata.html">Daten abgleichen</a> &raquo;</li>
      
    <li>Vorlagen zum Datenabgleich erstellen</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/officelink-usermanual-visio-metadata-template.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="vorlagen-zum-datenabgleich-erstellen">
<span id="officelink-usermanual-visio-metadata-template"></span><h1>Vorlagen zum Datenabgleich erstellen<a class="headerlink" href="#vorlagen-zum-datenabgleich-erstellen" title="Link zu dieser Überschrift">¶</a></h1>
<p>Dieser Abschnitt beschreibt die Erstellung von Dokumentvorlagen mit den System-
Variablen zum Datenabgleich.</p>
<ul class="simple">
<li>Abgleich von Dokumentmetadaten (z.B. Titel, Dokument-Nr. ...)</li>
<li>Abgleich von 1:1 referenzierten Objekten (z.B. Projektname des zugeordneten Projekts)</li>
</ul>
<div class="section" id="formatbeschreibung-fur-system-variablen">
<span id="officelink-usermanual-visio-metadata-template-format"></span><h2>Formatbeschreibung für System-Variablen<a class="headerlink" href="#formatbeschreibung-fur-system-variablen" title="Link zu dieser Überschrift">¶</a></h2>
<p>System-Variablen in Visio Dokumenten haben folgendes Format:
cdb.&lt;Mode&gt;.&lt;Beziehung&gt;.&lt;Attribut&gt;.&lt;Kardinalität&gt;</p>
<dl class="docutils">
<dt><span class="guilabel">Mode</span></dt>
<dd><p class="first">Der Mode gibt an, ob eine Variable aus dem System ausschließlich gelesen oder auch
nach Änderung im Dokument im System aktualisiert werden darf. Gültige Werte
für den Modus sind:</p>
<ul class="last">
<li><p class="first"><span class="guilabel">r</span></p>
<p>Nur Datenübernahme aus dem System möglich. Der übernommene Wert kann im Dokument
verändert werden, jedoch nicht an das System übergeben werden. Bei erneuter
Datenübernahme wird der geänderte Wert im Dokument wieder durch den System-Wert ersetzt.</p>
</li>
<li><p class="first"><span class="guilabel">w</span></p>
<p>Nur Datenübergabe in das System möglich. Durch diesen Modus kann sichergestellt
werden, dass ein Dokumentfeld durch eine Datenübernahme nicht verändert werden kann,
eine Aktualisierung im System aber möglich ist (sinnvoll bei Feldern, die durch
das Dokument berechnet werden). Dieser Modus kann nicht bei 1:N Beziehungen
verwendet werden.</p>
</li>
<li><p class="first"><span class="guilabel">rw</span></p>
<p>Datenübernahme aus dem System und Aktualisierung im System nach Änderung im Dokument
möglich. Dieser Modus kann nicht bei 1:N Beziehungen verwendet werden.</p>
</li>
</ul>
</dd>
<dt><span class="guilabel">Beziehung</span></dt>
<dd><p class="first">Die Beziehung gibt ausgehend vom Dokument den Pfad zu den durch die Variable
repräsentierten Daten im System an. Als Beziehung können folgende Ausdrücke
verwendet werden:</p>
<ul class="last">
<li><p class="first"><span class="guilabel">this</span></p>
<p>Der konstante Ausdruck &#8216;this&#8217; wird verwendet, um Attribute des Dokuments
selbst anzugeben.</p>
</li>
<li><p class="first"><span class="guilabel">Name einer in CIM DATABASE konfigurierten Beziehung</span></p>
<p>Über eine Beziehung können Attribute von referenzierten Objekten übernommen
und abgeglichen werden.</p>
</li>
<li><p class="first"><span class="guilabel">BY_ZNUM_ZIDX_FROM_&lt;table_name&gt;</span></p>
<p>Verwendung einer impliziten Beziehung über die Attribute z_nummer und z_index.
Hierzu wird der Ausdruck BY_ZNUM_ZIDX_FROM_&lt;table_name&gt; angegeben.
table_name gibt dabei die Datenbanktabelle an, aus der ein Objekt über z_nummer
und z_index implizit referenziert wird. Die angegebene Datenbanktabelle
muss die Attribute z_nummer und z_index enthalten und die Kombination
aus z_nummer und z_index muss eindeutig sein.</p>
</li>
</ul>
</dd>
<dt><span class="guilabel">Attribut</span></dt>
<dd><p class="first">Das Attribut spezifiziert ein Attribut eines durch die Beziehung referenzierten
System-Objekts.</p>
<p>Sachmerkmale als Attribute von Artikeln:</p>
<p>Wird eine Artikelbeziehung als Beziehung angegeben, können auch die Sachmerkmale
des Artikels als Attribut angegeben werden. Dies kann qualifiziert über die Merkmalkennung
oder unqualifiziert mittels Zählnummer erfolgen:</p>
<ul>
<li><p class="first"><span class="guilabel">Sachmerkmale qualifiziert:</span></p>
<p><code class="docutils literal"><span class="pre">_SML_&lt;mm_mk&gt;</span></code></p>
<div class="example container">
<p class="rubric">Visio: Datenabgleich - Sachmerkmale qualifiziert</p>
<p>Sachmerkmal mit der Kennung &#8216;L&#8217; des zugeordneten Artikels</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>``cdb.r.cdb_doc_to_part._SML_L``
</pre></div>
</div>
</div>
</li>
<li><p class="first"><span class="guilabel">Sachmerkmale unqualifiziert:</span></p>
<p><code class="docutils literal"><span class="pre">_SMLN&lt;nummer&gt;</span> <span class="pre">für</span> <span class="pre">Merkmalskennungen</span></code></p>
<p><code class="docutils literal"><span class="pre">_SMLV&lt;nummer&gt;</span> <span class="pre">für</span> <span class="pre">Merkmalswerte</span></code></p>
<p>Merkmalkennung und der zugehörige Wert müssen dabei dieselbe Nummer haben.</p>
<div class="example container">
<p class="rubric">Visio: Datenabgleich - Sachmerkmale unqualifiziert</p>
<p>Kennung und Wert des erstes Sachmerkmals des zugeordneten Artikels</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>``cdb.r.cdb_doc_to_part._SMLN1``
``cdb.r.cdb_doc_to_part._SMLV1``
</pre></div>
</div>
</div>
</li>
</ul>
<div class="last admonition important">
<p class="first admonition-title">Wichtig</p>
<p class="last">SML Attribute können nicht schreibend synchronisiert werden!</p>
</div>
</dd>
<dt><span class="guilabel">Kardinalität</span></dt>
<dd><p class="first">Gibt die Kardinalität der Beziehung an. Wenn keine Kardinalität angegeben wurde,
wird von der Kardinalität 1 ausgegangen. Bei der Erstellung neuer Dokumentvorlagen
sollte die Kardinalität explizit angegeben werden. Folgende Werte können für die
Kardinalität verwendet werden:</p>
<ul class="last">
<li><p class="first"><span class="guilabel">1</span></p>
<p>Für Beziehungen vom Typ <code class="docutils literal"><span class="pre">this,</span> <span class="pre">BY_ZNUM_ZIDX_FROM_&lt;table_name&gt;</span></code>
und für 1-stellige homogene Beziehungen.</p>
</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="definition-von-system-variablen">
<span id="officelink-usermanual-visio-metadata-template-definition"></span><h2>Definition von System-Variablen<a class="headerlink" href="#definition-von-system-variablen" title="Link zu dieser Überschrift">¶</a></h2>
<p>Die Definition von System-Variablen erfolgt mit einem Assistenten, der über die Schaltfläche
<span class="guilabel">[ Verwalten ]</span> der OfficeLink-Symbolleiste aufgerufen wird. Damit die Schaltfläche
verfügbar ist, muss sie zuvor in dem Einstellungsdialog aktiviert worden sein. Der Dialog
bietet auf der linken Seite die Möglichkeit neue Variablen im System-Format anzulegen
(siehe <a class="reference internal" href="#officelink-usermanual-visio-metadata-template-format"><span class="std std-ref">Formatbeschreibung für System-Variablen</span></a> ). Auf der rechten
Seite werden alle im Dokument enthaltenen System-Variablen angezeigt. Durch Markierung einer
Variablen wird gleichzeitig das entsprechende Textfeld in der Visio Dokument markiert. Durch
Betätigung der Schaltfläche <span class="guilabel">[ Variable löschen ]</span> kann die markierte
Variable aus dem Dokument entfernt werden.</p>
<div class="figure align-center" id="id1">
<span id="officelink-usermanual-visio-metadata-template-definition-dialog"></span><img alt="_images/visio2007_docvar_dialog.png" src="_images/visio2007_docvar_dialog.png" />
<p class="caption"><span class="caption-text">Visio: Datenabgleich - Dialog zur Erstellung von System-Variablen</span></p>
</div>
<ul>
<li><p class="first"><span class="guilabel">Beziehung:</span></p>
<p>Die Beziehung gibt ausgehend vom Dokument den Pfad zu einem Attribut eines oder
mehrerer referenzierter System-Objekte an. Der Katalog bietet alle im System
konfigurierten Dokumentenbeziehungen an, bei denen das Dokument das Startobjekt
darstellt. Für Attribute des Dokuments selbst, muss in diesem Feld
<code class="docutils literal"><span class="pre">this</span></code> eingetragen werden.</p>
<p>Zur Verwendung einer impliziten Beziehung, die über die Schlüsselattribute
Dokumentennummer und Index hergestellt wird, muss in diesem Feld
<code class="docutils literal"><span class="pre">BY_ZNUM_ZIDX_FROM_</span></code> ausgewählt werden und
im Feld Datenbanktabelle eine Relation als Datenquelle ausgewählt werden.</p>
</li>
<li><p class="first"><span class="guilabel">Datenbanktabelle:</span></p>
<p>Eine Datenbanktabelle muss nur dann ausgewählt werden, wenn im Feld Beziehung
der spezielle Eintrag <code class="docutils literal"><span class="pre">BY_ZNUM_ZIDX_FROM_</span></code> für
implizite Beziehungen ausgewählt wurde. In der ausgewählten Relation muss die
Kombination der Attribute z_nummer und z_index eindeutig sein.</p>
</li>
<li><p class="first"><span class="guilabel">Attribut:</span></p>
<p>Das Attribut spezifiziert ein Attribut eines durch die Beziehung referenzierten
System-Objekts.</p>
</li>
<li><p class="first"><span class="guilabel">Abgleichmodus:</span></p>
<p>Der Modus gibt an, ob eine Variable aus dem System ausschließlich gelesen oder auch
nach Änderung im Dokument im System aktualisiert werden darf:</p>
<p>r: nur lesend</p>
<p>w: nur schreibend</p>
<p>rw: lesender und schreibender Zugriff in CIM DATABASE</p>
</li>
<li><p class="first"><span class="guilabel">CIM DATABASE Variable:</span></p>
<p>In diesem Feld wird der aus den anderen Feldern erzeugte Ausdruck für die zu
erstellenden System-Variable angezeigt. Das manuelle Ändern dieses Ausdrucks
ist nur zur Angabe von Sachmerkmalen bei Artikelbeziehungen erforderlich.</p>
</li>
</ul>
<p>Beim Hinzufügen der Variablen durch Betätigung der Schaltfläche <span class="guilabel">[ Variable hinzufügen ]</span> wird der in dem Feld System-Variable angezeigte Ausdruck überprüft
und bei Ungültigkeit eine entsprechende Fehlermeldung angezeigt. Ansonsten wird die
Variable als neue System-Variable in dem aktiven Dokument angelegt und mit dem Wert
<code class="docutils literal"><span class="pre">&lt;Attribut&gt;</span></code> als Platzhalter initialisiert.</p>
<div class="admonition important">
<p class="first admonition-title">Wichtig</p>
<p class="last">Die System-Variablen können nur in einfachen Visio &#8216;Formen&#8217; plaziert werden.
Desweiteren kann nur jeweils eine System-Variable pro Visio Form definiert werden.
Es erscheint eine Fehlermeldung, falls versucht wird eine neue Variable zu definieren,
ohne dass eine einfache Form aktiviert ist, oder falls die zur Zeit aktivierte Form
schon eine Variable enthält.</p>
</div>
</div>
<div class="section" id="andern-von-system-variablen">
<span id="officelink-usermanual-visio-metadata-template-change"></span><h2>Ändern von System-Variablen<a class="headerlink" href="#andern-von-system-variablen" title="Link zu dieser Überschrift">¶</a></h2>
<p>Die Änderung der Textfelder, welche System-Variablen beinhalten, erfolgt durch Mausklick
in das zu ändernde Feld. Der Cursor befindet sich dann innerhalb des Feldes und ermöglicht
eine freie Bearbeitung.</p>
</div>
<div class="section" id="verwendung-von-system-variablen-im-dokument">
<span id="officelink-usermanual-visio-metadata-template-usage"></span><h2>Verwendung von System-Variablen im Dokument<a class="headerlink" href="#verwendung-von-system-variablen-im-dokument" title="Link zu dieser Überschrift">¶</a></h2>
<p>System-Variablen sollten im Dokument für den Anwender kenntlich gemacht werden,
um versehentliches Löschen oder Überschreiben zu vermeiden. Der Schutz von
Dokumentenvariablen ist nur bedingt möglich. Eine Möglichkeit ist die Erstellung
von Formularen.</p>
<div class="admonition note">
<p class="first admonition-title">Bemerkung</p>
<p class="last">Beim Datenabgleich von Variablen in das System werden Attributänderungen auch dann
vorgeblendet, wenn das Feld laut Maskenkonfiguration durch den Anwender nicht
interaktiv änderbar oder nur via Katalogauswahl änderbar wäre. Bei der Verwendung
von System-Variablen mit schreibenden Zugriff ist dies zu berücksichtigen. Gegebenenfalls
ist die Gültigkeit der Werte durch eine entsprechende Prüfung im User Exit abzusichern.</p>
</div>
</div>
<div class="section" id="automatisches-aktualisieren-von-metadaten">
<span id="officelink-usermanual-visio-metadata-template-autoupdate"></span><h2>Automatisches Aktualisieren von Metadaten<a class="headerlink" href="#automatisches-aktualisieren-von-metadaten" title="Link zu dieser Überschrift">¶</a></h2>
<p>Die Metadaten aller System-Variablen mit lesendem Zugriff werden beim Laden eines Dokuments aus CDB automatisch übernommen.
Die Bedingungen dafür sind, dass das Dokument:</p>
<ol class="arabic simple">
<li>im Client im &#8220;Bearbeiten&#8221; Modus geöffnet wurde (oder direkt aus Office heraus über &#8220;Laden&#8221;)</li>
<li>eine &#8220;Zeichnung&#8221; ist (d.h. die Eigenschaft &#8220;vorlage_kz&#8221; hat)</li>
<li>keine Vorlage ist (d.h. &#8220;vorlage_kz=0&#8221;)</li>
</ol>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="officelink-usermanual-word.html" class="btn btn-neutral float-right" title="Word" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="officelink-usermanual-visio-metadata-syncwrite.html" class="btn btn-neutral" title="Metadatensynchronisation mit dem System" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, CONTACT Software GmbH.
      Zuletzt aktualisiert am 25.09.2018.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'15.5.0.9',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>