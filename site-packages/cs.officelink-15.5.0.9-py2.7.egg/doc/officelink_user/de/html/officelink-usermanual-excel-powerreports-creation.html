

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Reportvorlagen erstellen &mdash; OfficeLink</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Stichwortverzeichnis"
              href="genindex.html"/>
        <link rel="search" title="Suche" href="search.html"/>
    <link rel="top" title="OfficeLink" href="index.html"/>
        <link rel="up" title="PowerReports" href="officelink-usermanual-excel-powerreports.html"/>
        <link rel="next" title="Ausführen von PowerReports" href="officelink-usermanual-excel-powerreports-execution.html"/>
        <link rel="prev" title="Aktivierung von PowerReports" href="officelink-usermanual-excel-powerreports-activation.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="/doc/de" class="icon fa-book">
            Dokumentationsportal
          </a>
        

        
          <a href="index.html" class="icon icon-home"> OfficeLink
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="teaser.html">Einleitung</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="officelink-usermanual-excel.html">Excel</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-excel-preface.html">Einführung</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-excel-documents.html">Dokumente bearbeiten</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-excel-metadata.html">Daten abgleichen</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="officelink-usermanual-excel-powerreports.html">PowerReports</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-outlook.html">Outlook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-outlook-preface.html">Einführung</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-outlook-mails.html">E-Mails und Anlagen</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-powerpoint.html">PowerPoint</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-powerpoint-preface.html">Einführung</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-powerpoint-documents.html">Dokumente bearbeiten</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-powerpoint-metadata.html">Daten abgleichen</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-project.html">Project</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-project-preface.html">Einführung</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-project-documents.html">Dokumente bearbeiten</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-project-sync.html">Projekt-Synchronisation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-visio.html">Visio</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-visio-preface.html">Einführung</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-visio-documents.html">Dokumente bearbeiten</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-visio-metadata.html">Daten abgleichen</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-word.html">Word</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-word-preface.html">Einführung</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-word-documents.html">Dokumente bearbeiten</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-word-metadata.html">Daten abgleichen</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">OfficeLink</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="officelink-usermanual-excel.html">Excel</a> &raquo;</li>
      
          <li><a href="officelink-usermanual-excel-powerreports.html">PowerReports</a> &raquo;</li>
      
    <li>Reportvorlagen erstellen</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/officelink-usermanual-excel-powerreports-creation.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="reportvorlagen-erstellen">
<span id="officelink-usermanual-excel-powerreports-creation"></span><h1>Reportvorlagen erstellen<a class="headerlink" href="#reportvorlagen-erstellen" title="Link zu dieser Überschrift">¶</a></h1>
<p class="rubric">Die Erstellung neuer Reports erfolgt mit Unterstützung der Excel Kopplung in drei Schritten:</p>
<ol class="arabic">
<li><p class="first"><span class="guilabel">Datenquelle auswählen</span></p>
<p>Die Auswahl der Datenquelle erfolgt mit der Kopplungsfunktion <span class="guilabel">[ Datenquelle auswählen ]</span> .</p>
<p>Es wird ein Dialog zur Auswahl einer im System konfigurierten Datenquelle angezeigt.</p>
<div class="figure align-center" id="id1">
<span id="officelink-usermanual-excel-powerreports-creation-sourcedialog"></span><img alt="_images/excel_powerreports_creation_sourcedialog.png" src="_images/excel_powerreports_creation_sourcedialog.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Auswahldialog für Datenquellen</span></p>
</div>
</li>
<li><p class="first"><span class="guilabel">Datenbindung herstellen und Layout gestalten</span></p>
<p>Nach Auswahl der Datenquelle wird das zugehörige XSD Schema geladen und angezeigt. Das XSD Schema wird zur Herstellung der
Datenbindung verwendet. Die Datenbindung wird via Drag&amp;Drop von Schemaelementen an die gewünschte Position in das Excel
Sheet hergestellt. Dabei können einzelne Attribute aber auch vollständige Objekte auf einmal positioniert werden.</p>
<div class="figure align-center" id="id2">
<span id="officelink-usermanual-excel-powerreports-creation-dragdrop"></span><img alt="_images/excel_powerreports_creation_dragdrop.png" src="_images/excel_powerreports_creation_dragdrop.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Datenbindung via Drag&amp;Drop herstellen</span></p>
</div>
</li>
<li><p class="first"><span class="guilabel">Dokument als Reportvorlage speichern</span></p>
<p>Abschließend muss der neu erstellte Report als Reportvorlage zur Datenquelle gespeichert werden. Dies erfolgt durch die
Kopplungsfunktion <span class="guilabel">[ Vorlage anlegen ]</span> .</p>
<p>Reportvorlagen werden im System direkt als Dateien an den jeweiligen Report gehängt. Dabei können mehrere sprachspezifische
Vorlagen für ein und den gleichen Report erstellt werden (siehe <a class="reference internal" href="#officelink-usermanual-excel-powerreports-creation-multilang"><span class="std std-ref">Erstellung sprachspezifischer Reports</span></a> ).</p>
<div class="admonition note">
<p class="first admonition-title">Bemerkung</p>
<p class="last">Da Reportvorlagen nicht als eigene Dokumente angelegt werden sondern direkt an die Reports geheftet, können die Reportvorlagen
nicht im Nachhinein über die <span class="guilabel">[ Laden ]</span> Funktion der Kopplung zum erneuten Bearbeiten geöffnet werden.
Zum erneuten Bearbeiten können sie entweder im Client (z.B. in der Projektübersicht) oder nach der Ausführung eines Reports
über die <span class="guilabel">[ Vorlage bearbeiten ]</span> Funktion geöffnet werden.</p>
</div>
<p>Mit Abschluss der Dateienneuanlage wird die Reportvorlage automatisch der Datenquelle zugeordnet. Der Report ist
anschließend sofort in Abhängigkeit von der Datenquelle entweder kontextfrei oder im Kontextmenü eines entsprechenden
Objektes für den Reportersteller aufrufbar.</p>
<p>Alle zu einer Datenquelle erstellten Reports sind in dem Ordner Reports einer Datenquelle gelistet. Dort können die
Berechtigungen, ein ggf. vorzuschaltender Dialog und der Reporttitel angepasst werden. Abbildung 32 zeigt exemplarisch den
Report Projektportfolio zur gleichnamigen Datenquelle. Zu einer Datenquelle können beliebig viele Reports unterschiedlicher
Ausprägung und in jeweils unterschiedlichen Sprachversionen erstellt werden.</p>
<div class="figure align-center" id="id3">
<span id="officelink-usermanual-excel-powerreports-creation-reportoverview"></span><img alt="_images/excel_powerreports_creation_reportoverview.png" src="_images/excel_powerreports_creation_reportoverview.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Report zur Datenquelle</span></p>
</div>
<p>Der Reporttitel und ein ggf. vorzuschaltender Dialog können im Datenblatt der Vorlagenzuordnung zur Datenquelle konfiguriert
werden. Das Register <code class="file docutils literal"><span class="pre">Berechtigungen</span></code> steuert die Sichtbarkeit von Reports im Reportauswahldialog. Der
Reportersteller wird bei der Neuanlage automatisch durch eine entsprechende Zuordnung berechtigt. Andere Anwender können den
Report erst dann aufrufen, wenn diese hier zusätzlich durch eine Rollenzuordnung oder durch direkte Personenzuordnung
berechtigt werden.</p>
<p>Desweiteren können in dem Datenblatt noch diverse Einstellungen zur Art der Reporterzeugung und dessen Darstellung vorgenommen
werden (siehe <a class="reference internal" href="officelink-usermanual-excel-powerreports-execution.html#officelink-usermanual-excel-powerreports-execution-selectionconfig"><span class="std std-ref">Auswahlkonfiguration</span></a> ).</p>
</li>
</ol>
<div class="section" id="reportdialoge-erstellen">
<span id="officelink-usermanual-excel-powerreports-creation-dialogs"></span><h2>Reportdialoge erstellen<a class="headerlink" href="#reportdialoge-erstellen" title="Link zu dieser Überschrift">¶</a></h2>
<p>Einem Report kann optional ein Dialog vorgeschaltet werden, der Parameter vom Anwender abfragt, die beim Aufruf eines Reports
an die Datenprovider weitergegeben werden und dort die Datenermittlung beeinflussen können. Dies ist immer dann sinnvoll,
wenn der Anwender das Reportergebnis durch eigene Eingaben beeinflussen können soll. Beispielsweise zur Eingabe eines zu
betrachtenden Zeitraumes oder anderer filternder Bedingungen in Verbindung mit SimpleQuery Datenprovidern.</p>
<div class="figure align-center" id="id4">
<span id="officelink-usermanual-excel-powerreports-creation-dialogs-predialog"></span><img alt="_images/excel_powerreports_creation_dialogs_predialog.png" src="_images/excel_powerreports_creation_dialogs_predialog.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Reportdialog zur Abfrage von Projekten</span></p>
</div>
<p>Die Parameter werden durch Namenskonvention für die Attributnamen der Maskenfelder an Datenprovider adressiert:
&lt;Providername&gt;-&lt;Attributname&gt;, wobei die Attributnamen jedoch keine Großbuchstaben enthalten dürfen.
Das Feld Relation der Maskenfeldkonfiguration bleibt leer.</p>
<div class="figure align-center" id="id5">
<span id="officelink-usermanual-excel-powerreports-creation-dialogs-addressing"></span><img alt="_images/excel_powerreports_creation_dialogs_addressing.png" src="_images/excel_powerreports_creation_dialogs_addressing.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Adressierung der Dialogfelder an Datenprovider als Parameter</span></p>
</div>
<p>Die Möglichkeiten zur Parametrisierung der universellen Standardprovider durch Dialoge finden Sie in
<a class="reference internal" href="officelink-usermanual-excel-powerreports-source-and-provider.html#officelink-usermanual-excel-powerreports-source-and-provider-provider-details"><span class="std std-ref">Providertypen im Detail</span></a> zum jeweiligen Providertyp.</p>
<div class="admonition note">
<p class="first admonition-title">Bemerkung</p>
<p class="last">Wenn Felder in Reportdialogen geändert, gelöscht oder hinzugefügt werden, ist darauf zu achten, dass
in den Reportvorlagen, welche den jeweiligen Dialog verwenden, das XML Schema aktualisiert werden muss.</p>
</div>
<p>Fernerhin kann jeder Dialog um die Möglichkeit erweitert werden, sämtliche Vorbelegungen zu speichern,
wodurch bei erneuten Reportausführungen sich eventuell wiederholende Eingaben vermieden werden können.
Um dies zu erreichen, muss derjenige Dialog um 3 Elemente erweitert werden: die 2 (versteckten, aber
den jeweiligen Report identifizierenden) Textfelder <span class="guilabel">cdbxml_source_name</span> und
<span class="guilabel">cdbxml_report_title</span> ; 1 Button welcher bei Betätigung die Komponente
<span class="guilabel">cdbxml_set_defaults</span> auslöst (siehe <a class="reference internal" href="#officelink-usermanual-excel-powerreports-creation-dialogs-predialog-set-defaults"><span class="std std-ref">Excel: PowerReports - Speichern der Eingabewerte von Reportdialogen</span></a> ).</p>
<div class="figure align-center" id="id6">
<span id="officelink-usermanual-excel-powerreports-creation-dialogs-predialog-set-defaults"></span><img alt="_images/excel_powerreports_creation_dialogs_predialog_set_defaults.png" src="_images/excel_powerreports_creation_dialogs_predialog_set_defaults.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Speichern der Eingabewerte von Reportdialogen</span></p>
</div>
</div>
<div class="section" id="darstellung-hierarchischer-daten">
<span id="officelink-usermanual-excel-powerreports-creation-indentation"></span><h2>Darstellung hierarchischer Daten<a class="headerlink" href="#darstellung-hierarchischer-daten" title="Link zu dieser Überschrift">¶</a></h2>
<p>In PowerReports können hierarchisch organisierte Daten entsprechend dargestellt werden. Typische Beispiele für hierarchische
Daten sind Produktstrukturen oder Aufgabenstrukturen.</p>
<p>Voraussetzung für die hierarchische Darstellung ist, dass der Datenprovider die Hierarchieinformation in dem Attribut
<code class="file docutils literal"><span class="pre">cdbxml_level</span></code> bereitstellt. Ist diese Voraussetzung erfüllt, können die Hierarchieebenen im PowerReport
auf- und zu geklappt und für eine bessere Übersicht farblich codiert und eingerückt werden.</p>
<p>Zur Erstellung einer hierarchisch organisierten Liste muss das Attribut <code class="file docutils literal"><span class="pre">cdbxml_level</span></code> in der Liste
enthalten sein. Idealerweise wird dieses Attribut am Ende des Listekopfes angefügt und mit Abschluss der Layoutarbeiten
durch Setzen der Spaltenbreite auf 0 unsichtbar gesetzt. Ist das Attribut <code class="file docutils literal"><span class="pre">cdbxml_level</span></code> in der Liste
enthalten, wird die Ergebnistabelle automatisch, wie in folgender Abbildung am linken Rand dargestellt, mit Excel Funktionalität
gegliedert.</p>
<div class="figure align-center" id="id7">
<span id="officelink-usermanual-excel-powerreports-creation-indentation-example-layout"></span><img alt="_images/excel_powerreports_creation_indentation_example_layout.png" src="_images/excel_powerreports_creation_indentation_example_layout.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Hierarchische Darstellung am Beispiel Produkstruktur</span></p>
</div>
<p>Diese Gliederung kann zusätzlich durch Einrückung einer beliebigen Spalte und durch farbliche Codierung hervorgehoben werden.
Hierfür muss jeweils ein spezieller Ausdruck in die Spaltenbeschriftung des <code class="file docutils literal"><span class="pre">cdbxml_level</span></code> Attributes
aufgenommen werden. Die Ausdrücke müssen dabei durch einen Doppelpunkt voneinander getrennt werden.
Einrückung einer Spalte:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>indent(column)
</pre></div>
</div>
<p>Farbliche Codierung:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>colorize(&lt;rgb_start_color&gt;),(&lt;rgb_offset&gt;)
</pre></div>
</div>
<p><code class="file docutils literal"><span class="pre">column</span></code> gibt den Spaltenindex an, in welchem die Einrückungen ausgeführt werden.</p>
<p><code class="file docutils literal"><span class="pre">rgb_start_color</span></code> gibt dabei die Startfarbe als RGB Farbcode für die Hierarchiebene 0 an. Für die
darunterliegenden Ebenen wird die Zeilenfarbe durch addieren des <code class="file docutils literal"><span class="pre">rgb_offsets</span></code> ermittelt.</p>
<div class="example container">
<p class="rubric">Excel: PowerReports - Hierarchische Darstellung mit Einrückung der 1. Spalte und Farbcodierung</p>
<p>Nur Einrückung der 1 Spalte:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>level:indent(1)
</pre></div>
</div>
<p>Einrücken der 1.Spalte + blaue Farbcodierung:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>level:colorize(230,230,255),(20,15,12):indent(1)
</pre></div>
</div>
</div>
<p>Der Ausdruck level:colorize(230,230,255),(20,15,12):indent(1) ergibt beispielsweise folgende Darstellung.</p>
<div class="figure align-center" id="id8">
<span id="officelink-usermanual-excel-powerreports-creation-indentation-example-report"></span><img alt="_images/excel_powerreports_creation_indentation_example_report.png" src="_images/excel_powerreports_creation_indentation_example_report.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Hierarchische Darstellung mit Einrückung der 1. Spalte und Farbcodierung</span></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Bemerkung</p>
<p class="last">Standardmäßig werden in Excel Gruppierungen mit der Einstellung &#8216;Hauptzeilen unter Detaildaten&#8217; angezeigt. In der Regel
wird sich der Anwender diese jedoch wie in obigem Beispiel über den Detaildaten wünschen. Daher sollte darauf geachtet
werden, dass bei der Erstellung der PowerReport-Vorlage diese Einstellung deaktiviert wird
(<span class="menuselection">Daten ‣ Gliederung ‣ Einstellungen</span> ).</p>
</div>
<div class="figure align-center" id="id9">
<span id="officelink-usermanual-excel-powerreports-creation-indentation-example-settings"></span><img alt="_images/excel_powerreports_creation_indentation_example_settings.png" src="_images/excel_powerreports_creation_indentation_example_settings.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Hierarchische Darstellung - Gruppierungseinstellungen</span></p>
</div>
</div>
<div class="section" id="darstellung-dynamischer-spaltentitel-in-listen">
<span id="officelink-usermanual-excel-powerreports-creation-dynamic-headers"></span><h2>Darstellung dynamischer Spaltentitel in Listen<a class="headerlink" href="#darstellung-dynamischer-spaltentitel-in-listen" title="Link zu dieser Überschrift">¶</a></h2>
<p>In PowerReports ist es möglich die Spaltentitel von Listen, welche durch Provider gefüllt werden, dynamisch mit Werten zu belegen.
Als Beispiel dient der folgende PowerReport:</p>
<div class="figure align-center" id="id10">
<span id="officelink-usermanual-excel-powerreports-creation-dynamic-headers-example-a"></span><img alt="_images/excel_powerreports_creation_dynamic_headers_example_a.png" src="_images/excel_powerreports_creation_dynamic_headers_example_a.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Darstellung dynamischer Spaltentitel</span></p>
</div>
<p>Dieser PowerReport zur Anzeige der Mitarbeiterauslastung zeigt in einer Liste einen durch den Benutzer vor der Generierung
angegebenen Zeitraum. Im Nachhinein kann in dem rot markierten Feld der Zeitraum geändert und der PowerReport aktualisiert
werden. Die Spaltentitel sind somit abhängig vom Zeitraum, da sie die jeweiligen Kalenderwochen anzeigen. Realisiert wird
dies durch Hinzufügen eines weiteren Providers (&#8216;PersonnelLoadWeekly_Label&#8217;), welcher bei jedem Erstellen/Aktualisieren
eines PowerReports die jeweils aktuellen Spaltentitel liefert. Damit die Excel-Kopplung diese Werte finden, auslesen und in
die Liste übertragen kann, müssen sie in die Zeile direkt über der Liste gelegt werden. Im Abschluss muss diese Zeile in
der Vorlage versteckt werden.</p>
<div class="figure align-center" id="id11">
<span id="officelink-usermanual-excel-powerreports-creation-dynamic-headers-example-b"></span><img alt="_images/excel_powerreports_creation_dynamic_headers_example_b.png" src="_images/excel_powerreports_creation_dynamic_headers_example_b.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Darstellung dynamischer Spaltentitel (Layout)</span></p>
</div>
</div>
<div class="section" id="darstellung-dynamischer-bildinhalte">
<span id="officelink-usermanual-excel-powerreports-creation-dynamic-images"></span><h2>Darstellung dynamischer Bildinhalte<a class="headerlink" href="#darstellung-dynamischer-bildinhalte" title="Link zu dieser Überschrift">¶</a></h2>
<p>In PowerReports hat man die Möglichkeit, sowohl einfache Felder wie auch Listenfelder mit Image-Dateien (in allen von Excel
unterstützen Formaten) zu füllen. Welche Bilder man bereitstellen kann und wie man diese bereitstellt, wird im Abschnitt
<a class="reference internal" href="officelink-usermanual-excel-powerreports-implementation.html#officelink-usermanual-excel-powerreports-implementation-images"><span class="std std-ref">Hinzufügen von Bilddateien</span></a> beschrieben. Damit die bei der Reportgenerierung
dynamisch geladenen Bilddateien korrekt eingefügt werden bzw. eine gewünschte einheitliche Größe oder Position innerhalb
der Zelle bekommen, muss in der Reportvorlage ein entsprechendes Musterbild eingefügt werden. Damit dieses Bild von der Kopplung
als Muster erkannt wird, muss entweder der Bildname mit &#8220;cdb_image&#8221; oder der Attributname, welcher dem zugehörigen Feld über den
Datenprovider zugewiesen wurde, mit &#8220;cdbxml_image&#8221; beginnen. Des weiteren können bestimmte Formatierungsregeln in der
Alternativtextbox im Eigenschaftendialog des jeweiligen Bildes festgelegt werden.</p>
<div class="admonition important">
<p class="first admonition-title">Wichtig</p>
<p class="last">Das Vorlagebild muss sich mit seiner linken oberen Ecke eindeutig innerhalb der jeweiligen Zelle befinden, ansonsten verknüpft
Excel das Bild mit einer anderen Zelle und die dynamischen Bilder werden u.U. nicht eingefügt.</p>
</div>
<p>In bestimmten Fällen kommt es bei dynamischen Bilderlisten zu unerwarteten Ergebnissen (z.B. verzerrte oder unsichtbare
Bilder). Dies betrifft zur Zeit vornehmlich Excel 2010. Vermeiden lässt sich dies in der Regel dadurch, dass die Bildvorlage
so in der Zelle platziert wird, dass sie (bzw. die später eingefügten Bilder) nicht über die Zellgrenze hinausragen.
Insofern bei einem PowerReport ein anschließendes Filtern oder Sortieren von Listen gewünscht ist, welche dynamische Bilder
enthalten, müssen die betroffenen Bildvorlagen innerhalb dieser Liste mit der Eigenschaft &#8220;Von Zellposition und -größe abhängig&#8221;
formatiert werden. Andernfalls kann es bei einer filter- oder sortierbedingten Listenzeilenbewegung zu falschen Bildergebnissen kommen.</p>
<div class="admonition important">
<p class="first admonition-title">Wichtig</p>
<p class="last">Dynamische Bildinhalte werden zur Zeit in komplexen Reports nicht unterstützt.</p>
</div>
<p class="rubric">Formatierungsmöglichkeiten:</p>
<ul class="simple">
<li><span class="guilabel">KeepWidth</span> : Die Breite des Musterbildes wird auf den dynamischen Bildinhalt übertragen.  Diese Variable ist intern standardmäßig aktiviert, da in der Regel ein Einhalten der Spaltenbreite erwünscht ist.</li>
<li><span class="guilabel">KeepHeight</span> : Die Höhe des Musterbildes wird auf den dynamischen Bildinhalt übertragen.</li>
<li><span class="guilabel">MinBorderHeight</span> : Der Mindestabstand zwischen Bildhöhe und Zellhöhe. Ein Wert von &#8220;1&#8221; garantiert z.B.,  dass beim Füllen von &#8216;zu hochformatigen&#8217; Bildern die jeweilige Zeilenhöhe vergrößert und dadurch ein Überschneiden von Bildinhalten
vermieden wird. Höhere Werte wie &#8220;20&#8221; oder &#8220;30&#8221; sorgen für einen optischen Rand zwischen Bild und Zelle.</li>
<li><span class="guilabel">MinBorderWidth</span> : Der Mindestabstand zwischen Bildbreite und Zellbreite.</li>
<li><span class="guilabel">CenterWidth</span> : Der dynamische Bildinhalt wird innerhalb der Zelle horizontal zentriert.</li>
<li><span class="guilabel">CenterHeight</span> : Der dynamische Bildinhalt wird innerhalb der Zelle vertikal zentriert.</li>
</ul>
<div class="admonition important">
<p class="first admonition-title">Wichtig</p>
<p class="last">Der gesamte Formatierungstext muss mit dem Präfix <span class="guilabel">&#8220;cdb:&#8221;</span> beginnen.</p>
</div>
<div class="figure align-center" id="id12">
<span id="officelink-usermanual-excel-powerreports-creation-dynamic-images-placeholder"></span><img alt="_images/excel_powerreports_creation_dynamic_images_placeholder.png" src="_images/excel_powerreports_creation_dynamic_images_placeholder.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Dynamische Bildinhalte (Musterbild)</span></p>
</div>
<ul>
<li><p class="first">Formatierungsbeispiel 1: <span class="guilabel">&#8220;cdb:KeepHeight=1,CenterWidth=1&#8221;</span></p>
<div class="figure align-center" id="id13">
<span id="officelink-usermanual-excel-powerreports-creation-dynamic-images-example-a"></span><img alt="_images/excel_powerreports_creation_dynamic_images_example_a.png" src="_images/excel_powerreports_creation_dynamic_images_example_a.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Dynamische Bildinhalte (Beispiel 1)</span></p>
</div>
</li>
<li><p class="first">Formatierungsbeispiel 2: <span class="guilabel">&#8220;cdb:MinBorderHeight=1,KeepWidth=1&#8221;</span></p>
<div class="figure align-center" id="id14">
<span id="officelink-usermanual-excel-powerreports-creation-dynamic-images-example-b"></span><img alt="_images/excel_powerreports_creation_dynamic_images_example_b.png" src="_images/excel_powerreports_creation_dynamic_images_example_b.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Dynamische Bildinhalte (Beispiel 2)</span></p>
</div>
</li>
</ul>
</div>
<div class="section" id="darstellung-komplexer-zeilen-bei-multi-export-datenquellen">
<span id="officelink-usermanual-excel-powerreports-creation-multiexport"></span><h2>Darstellung komplexer Zeilen bei Multi-Export Datenquellen<a class="headerlink" href="#darstellung-komplexer-zeilen-bei-multi-export-datenquellen" title="Link zu dieser Überschrift">¶</a></h2>
<p>Mit Microsoft Excel ist es nicht möglich, Listen bestehend aus komplexeren Zeilen zu erstellen. Eine Listezeile besteht immer
nur aus genau einer Zeile Excel Zellen. Häufig wird jedoch die Darstellung komplexerer Daten in Listenform benötigt. Die
folgende Darstellung einer Artikelliste mit jeweils einer Liste der zugeordneten Dokumente ist beispielsweise allein mit Excel
Listen nicht realisierbar. Stattdessen müssen derartige Listen durch aneinanderfügen eines sich wiederholenden Layouts erstellt
werden. In folgender Abbildung ist ein solches komplexes Listenelement rot gekennzeichnet. Dieses Element wiederholt sich
beliebig häufig und bildet dadurch eine komplexe Liste.</p>
<div class="figure align-center" id="id15">
<span id="officelink-usermanual-excel-powerreports-creation-multiexport-example-report"></span><img alt="_images/excel_powerreports_creation_multiexport_example_report.png" src="_images/excel_powerreports_creation_multiexport_example_report.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Komplexe Zeilen am Beispiel Artikelliste</span></p>
</div>
<p>Das Layout und die Datenbindung für ein komplexes Listenelement muss auf einem speziellen Template Sheet mit dem fest vorgegebenen
Namen <code class="file docutils literal"><span class="pre">cdb_template</span></code> erfolgen. Auf dem Template Sheet wird genau eine komplexe Zeile modelliert.</p>
<p>Bei der Reportausführung werden die komplexen Zeilen einer Datenquelle in einzelne XML Dateien exportiert. Diese werden durch
die Excel Kopplung anschließend einzeln in das Template Sheet importiert. Zwischen den Importvorgängen wird das Ergebnis vom
Template Sheet in das Zielsheet kopiert.</p>
<div class="figure align-center" id="id16">
<span id="officelink-usermanual-excel-powerreports-creation-multiexport-complex-row"></span><img alt="_images/excel_powerreports_creation_multiexport_complex_row.png" src="_images/excel_powerreports_creation_multiexport_complex_row.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Definition einer komplexen Zeile</span></p>
</div>
<p>In der oberen linken Zelle des Template Sheets kann das Zielsheet und eine Zielzelle angegeben werden. Diese Zieladresse
beschreibt das Ziel für die obere linke Zelle der 1. zu kopierenden komplexen Zeile. Alle weiteren Zeilen werden von dort
ausgehend fortlaufend aneinandergehängt. Wird keine Zieladresse angegeben, wird als Startzelle die obere linke Zelle des
ersten im Workbook enthaltenen Sheets verwendet.</p>
<p>Das PowerReports Framework erkennt Daten, die als komplexe Zeilen exportiert und importiert werden müssen, automatisch anhand
der Ergebnis- und Aufrufkardinalitäten verknüpfter Datenprovider.</p>
<p>Eine Multi-Export Konfiguration liegt immer dann vor, wenn der übergeordnete Provider als Ergebnis eine Liste liefert
(Ergebniskardinalität N) und ein zugeordneter Subprovider die Aufrufkardinalität 1 hat, der Subprovider also Daten liefert,
die sich auf einzelne Listenelemente des übergeordneten Providers beziehen.</p>
<div class="figure align-center" id="id17">
<span id="officelink-usermanual-excel-powerreports-creation-multiexport-schema"></span><img alt="_images/excel_powerreports_creation_multiexport_schema.png" src="_images/excel_powerreports_creation_multiexport_schema.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Schema Multi-Export</span></p>
</div>
<p>Liefert beispielsweise ein SimpleQuery Provider eine Liste von Artikeln und ein Relationship Provider liefert als zugeordneter
Subprovider die zugeordneten Dokumente, so liegt eine Konfiguration vor, die ausschließlich als komplexe Liste in Excel
darstellbar ist.</p>
<p>Ein zugeordneter GroupBy Provider würde hingegen keine Multi-Export Konfiguration darstellen, da GroupBy Provider mit dem
gesamten Ergebnis des übergeordneten Providers aufgerufen werden, also die Aufrufkardinalität N haben. GroupBy Provider
liefern keine Ergebnisse, die sich auf einzelne Listenelemente des Parent Providers beziehen sondern aggregierte Informationen,
die sich ausschließlich auf die gesamte Liste beziehen.</p>
</div>
<div class="section" id="darstellung-von-langtexten">
<span id="officelink-usermanual-excel-powerreports-creation-longtext"></span><h2>Darstellung von Langtexten<a class="headerlink" href="#darstellung-von-langtexten" title="Link zu dieser Überschrift">¶</a></h2>
<p>Für Zeilen, in welchen Zellen ausschließlich oder teilweise mit Langtexten gefüllt werden, muss die Eigenschaft
<span class="guilabel">Zeilenumbruch</span> &#8221; der <span class="guilabel">kompletten Zeile</span> gesetzt sein, damit die Kopplung diese erkennen
und deren Zeilenhöhe automatisch anpassen kann.</p>
<p>Falls Langtexte in Zellen angezeigt werden sollen, welche aus mehreren Verbundzellen bestehen, dann lässt sich die korrekte
Darstellung nur über einen Umweg erreichen:</p>
<ol class="arabic simple">
<li>Die eigentliche Verknüpfung mit dem Langtext-Attribut der Datenquelle darf nicht mit der gewünschten Ziel-Zelle erfolgen,   sondern mit einer am Ende <span class="guilabel">versteckten Zelle</span> , welche sich auf der <span class="guilabel">gleichen Zeile</span> befindet.</li>
<li>Damit die Langtexte nicht abgeschnitten oder mit anfänglichen Leerzeilen dargestellt werden, muss diese Helfer-Zelle absolut die   <span class="guilabel">gleiche Breite</span> besitzen.</li>
<li>Die Eigenschaft &#8220;<span class="guilabel">Zeilenumbruch</span> &#8221; muss für die komplette Zeile gesetzt sein.</li>
</ol>
</div>
<div class="section" id="nachbearbeitung-fertiger-powerreports-durch-vba">
<span id="officelink-usermanual-excel-powerreports-creation-vbacode"></span><h2>Nachbearbeitung fertiger PowerReports durch VBA<a class="headerlink" href="#nachbearbeitung-fertiger-powerreports-durch-vba" title="Link zu dieser Überschrift">¶</a></h2>
<p>Manchmal möchte man programmtechnisch über VBA und das Excel-Object-Model bestimmte Dinge erledigen, nachdem ein
Report von der Kopplung fertig gestellt wurde (z.B. um gefüllte Diagramme korrekt zu formatieren, oder um etwas zu fokusieren).
Zu diesem Zweck sucht die Kopplung in der Excel-Mappe eine VBA-Funktion mit einem bestimmten Namen. Wird diese gefunden, wird
sie jeweils nach Fertigstellung/Aktualisierung eines Reports aufgerufen.</p>
<p class="rubric">Hinzufügen einer VBA-Funktion zur automatisierten Nachbearbeitung fertiggestellter PowerReports</p>
<ol class="arabic simple">
<li>In Excel den VBA-Editor öffnen.</li>
<li>In der PowerReport-Vorlage ein Modul einfügen.</li>
<li>Eine Funktion mit dem Namen &#8216;CDBReportDone&#8217; einbauen:</li>
</ol>
<div class="highlight-none"><div class="highlight"><pre><span></span>Public Sub CDBReportDone()
    &#39; ...
End Sub
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Bemerkung</p>
<p>Falls die Sicherheitseinstellungen in Office so eingestellt sind, dass nicht digital signierte Makros automatisch deaktiviert
werden, müssen die Report-Vorlagen mit einem Zertifikat signiert werden, bevor sie im System gespeichert werden.
Diejenigen mit dem System gelieferten Standard-PowerReports, welche VBA-Code zur Nachbearbeitung enthalten, sind bereits
mit einem für die Contact GmbH ausgestelltem Zertifikat und unter Verwendung eines Zeitstempel-Servers signiert. Um eigene
Report-Vorlagen oder geänderte Standard-Report-Vorlagen mit einem eigenen Zertifikat und unter Verwendung eines Zeitstempel-Servers
zu signieren, müssen manuell folgende Einträge in der Registry gesetzt werden, da sich der Zertifikats-Zeitstempel-Server
nicht über die Office-Oberfläche konfigurieren lässt:</p>
<div class="highlight-registry"><div class="highlight"><pre><span></span>Windows Registry Editor Version 5.00

<span class="k">[</span><span class="nb">HKEY_CURRENT_USER</span><span class="k">\Software\Microsoft\VBA\Security]</span>
<span class="na">&quot;TimeStampURL&quot;</span><span class="o">=</span><span class="s">&quot;http://timestamp.some-ca.com/scripts/timestamp.dll&quot;</span>
<span class="na">&quot;TimeStampRetryCount&quot;</span><span class="o">=</span><span class="nv">dword</span><span class="p">:</span><span class="m">00000005</span>
<span class="na">&quot;TimeStampRetryDelay&quot;</span><span class="o">=</span><span class="nv">dword</span><span class="p">:</span><span class="m">00000005</span>
</pre></div>
</div>
<p class="last">Falls das digitale Signieren ohne Zeitstempel erfolgt, erlöscht die Gültigkeit der Signatur nach Ablauf des Zertifikates.
Bei Verwendung eines Zeitstempels ist die Signatur zeitlich unbegrenzt gültig.</p>
</div>
</div>
<div class="section" id="erstellung-personlicher-reports">
<span id="officelink-usermanual-excel-powerreports-creation-personalreports"></span><h2>Erstellung persönlicher Reports<a class="headerlink" href="#erstellung-personlicher-reports" title="Link zu dieser Überschrift">¶</a></h2>
<p>Anwender haben die Möglichkeit, das Layout und die Datenbindung eines aufgerufenen Reports direkt zu modifizieren und als
persönlichen Report abzuspeichern. Die Erstellung eines persönlichen Reports kann also ad-hoc erfolgen, wenn dem Anwender das
Reportergebnis nicht gefällt oder für seine Zwecke unpassend ist.</p>
<p>Die Speicherung des modifizierten Reports als persönlichen Report erfolgt mit der Excel Kopplungsfunktion
<span class="menuselection">Reports ‣ Reportvorlage anlegen</span>. Der modifizierte Report wird durch Aufruf dieser Funktion als neue
Reportvorlage zur zugrundeliegenden Datenquelle angelegt und für den ausführenden Anwender berechtigt. Andere Anwender haben
keinen Zugriff auf diesen Report, könnten aber durch den Administrator durch Rollen- und Personenzuordnungen nachträglich
berechtigt werden.</p>
<div class="figure align-center" id="id18">
<span id="officelink-usermanual-excel-powerreports-creation-personalreports-example"></span><img alt="_images/excel_powerreports_creation_personalreports_example.png" src="_images/excel_powerreports_creation_personalreports_example.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Persönlicher Report am Beispiel Mitarbeiterauslastung</span></p>
</div>
<p>Bei der Erstellung eines persönlichen Reports wird der ggf. vorgeschaltete Reportdialog vom ursprünglichen Report übernommen.
Die Änderung des Reportdialogs durch Anwender ist nicht vorgesehen.</p>
</div>
<div class="section" id="erstellung-sprachspezifischer-reports">
<span id="officelink-usermanual-excel-powerreports-creation-multilang"></span><h2>Erstellung sprachspezifischer Reports<a class="headerlink" href="#erstellung-sprachspezifischer-reports" title="Link zu dieser Überschrift">¶</a></h2>
<p>Der Gestalter eines PowerReports hat die Möglichkeit eine bereits bestehende Reportvorlage für eine bestimmte Sprache anzupassen
und anschliessend für den gleichen übergeordneten Report bereitzustellen, so dass die Anwender, welche diesen Report im
Nachhinein ausführen, zwischen verschiedenen Sprachen wählen können. Falls man eine bereits angelegte Reportvorlage zum
Bearbeiten öffnet und man hinterher <span class="guilabel">[ Vorlage anlegen ]</span> ausführt, bietet die Kopplung in einem
Zwischendialog an, für bereits bestehende Reports eine sprachspezifische Reportvorlage anzulegen.</p>
<div class="figure align-center" id="id19">
<span id="officelink-usermanual-excel-powerreports-creation-multilang-predlg"></span><img alt="_images/excel_powerreports_creation_multilang_predlg.png" src="_images/excel_powerreports_creation_multilang_predlg.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Report zur Datenquelle</span></p>
</div>
<p>Im darauf folgenden Dialog muss nur noch die Sprache und ein eindeutiger Titel gewählt werden.</p>
<div class="figure align-center" id="id20">
<span id="officelink-usermanual-excel-powerreports-creation-multilang-cdbpcdlg"></span><img alt="_images/excel_powerreports_creation_multilang_newtmpl.png" src="_images/excel_powerreports_creation_multilang_newtmpl.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Report zur Datenquelle</span></p>
</div>
</div>
<div class="section" id="besondere-hinweise">
<span id="officelink-usermanual-excel-powerreports-creation-hints"></span><h2>Besondere Hinweise<a class="headerlink" href="#besondere-hinweise" title="Link zu dieser Überschrift">¶</a></h2>
<ul class="simple">
<li>Bei der Verknüpfung zwischen Listenattributen eines Providerschemas und den Excel-Zellen, d.h. wenn  durch die Verknüpfung in dem Blatt Tabellenspalten entstehen, dann ist besonders darauf zu achten, dass
die jeweilige Tabelle als Ganzes in logischer Reihenfolge von links nach rechts aufgebaut wird.
Wenn im Nachhinein aus dieser Tabelle wieder Spalten gelöscht oder eingefügt werden, kann es unter
Umständen zu Fehlern oder sogar Abbrüchen bei der Generierung der Reports kommen, da die Spalten
dann eventuell nicht mehr eine gesamte Tabelle bilden, sondern mehrere nebeneinander stehende Tabellen.
Ob jetzt eine Tabelle aus mehrerer Tabellen besteht, kann man an den kleinen Dreiecken am rechten
unteren Rand einer jeden Tabelle erkennen. Vor allem seit Excel 2010 stößt man diesbezüglich oft auf
Probleme, welche sich nur dadurch lösen lassen, dass Tabellen entfernt und von neuem aufgebaut werden.</li>
<li>Das Füllen von Daten in Verbundzellen hinein kann zu unerwartetem Fehlverhalten führen.  In solchen Fällen kann meist anstelle der Option &#8220;Zellen verbinden&#8221; auch einfach die Option
&#8220;Textausrichtung &gt; Horizontal &gt; Über Auswahl zentrieren&#8221; verwendet werden.</li>
<li>Für mit Datumsformaten oder benutzerdefinierten Zahlenformaten vorkonfigurierte Zellen darf nicht  gleichzeitig die Option &#8220;Zeilenumbruch&#8221; gesetzt sein, da dies zu einem Verlust der Formatierung führen kann.</li>
<li>Bei der Verknüpfung zwischen einem Schemaattribut und einer Zelle formatiert Excel die Zelle automatisch  mit der zum jeweiligen Attributwertetyp passenden Zahlenkategorie. Da jetzt z.B. Zellen, welche später
mit Gleitkommazahlen gefüllt werden sollen, von Excel automatisch der Zahlenkategorie &#8216;Standard&#8217; zugewiesen
werden, werden eventuelle Nachkommastellen nur dargestellt, wenn diese nicht gleich Null sind.
Wenn ein fixes Nachkommastellenformat (0,00) erwünscht ist, muss man die Zahlenkategorie nach der Verknüpfung
in &#8216;Zahl&#8217; ändern.</li>
<li>Falls in irgendeinem Sheet gleich mehrere dynamisch gefüllte Tabellen übereinander verwendet
werden, dann darf eine untere Tabelle niemals breiter sein als die Tabelle(n) über ihr. Sie darf
also höchstens genauso breit oder natürlich auch schmaler sein, da es sonst zu internen Problemen
kommt, in Folge dessen die Reportgenerierung abbricht. Falls untere Tabellen also vom Design her
doch breiter sein müssen, dann müssen die höheren Tabellen z.B. durch unsichtbare Dummy-Spalten
verbreitert werden.</li>
</ul>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="officelink-usermanual-excel-powerreports-execution.html" class="btn btn-neutral float-right" title="Ausführen von PowerReports" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="officelink-usermanual-excel-powerreports-activation.html" class="btn btn-neutral" title="Aktivierung von PowerReports" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, CONTACT Software GmbH.
      Zuletzt aktualisiert am 25.09.2018.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'15.5.0.9',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>