

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Implementierung eigener Provider &mdash; OfficeLink</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Stichwortverzeichnis"
              href="genindex.html"/>
        <link rel="search" title="Suche" href="search.html"/>
    <link rel="top" title="OfficeLink" href="index.html"/>
        <link rel="up" title="PowerReports" href="officelink-usermanual-excel-powerreports.html"/>
        <link rel="next" title="Aktivierung von PowerReports" href="officelink-usermanual-excel-powerreports-activation.html"/>
        <link rel="prev" title="Datenquellen und Datenprovider" href="officelink-usermanual-excel-powerreports-source-and-provider.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="/doc/de" class="icon fa-book">
            Dokumentationsportal
          </a>
        

        
          <a href="index.html" class="icon icon-home"> OfficeLink
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="teaser.html">Einleitung</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="officelink-usermanual-excel.html">Excel</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-excel-preface.html">Einführung</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-excel-documents.html">Dokumente bearbeiten</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-excel-metadata.html">Daten abgleichen</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="officelink-usermanual-excel-powerreports.html">PowerReports</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-outlook.html">Outlook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-outlook-preface.html">Einführung</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-outlook-mails.html">E-Mails und Anlagen</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-powerpoint.html">PowerPoint</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-powerpoint-preface.html">Einführung</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-powerpoint-documents.html">Dokumente bearbeiten</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-powerpoint-metadata.html">Daten abgleichen</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-project.html">Project</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-project-preface.html">Einführung</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-project-documents.html">Dokumente bearbeiten</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-project-sync.html">Projekt-Synchronisation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-visio.html">Visio</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-visio-preface.html">Einführung</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-visio-documents.html">Dokumente bearbeiten</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-visio-metadata.html">Daten abgleichen</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-word.html">Word</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-word-preface.html">Einführung</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-word-documents.html">Dokumente bearbeiten</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-word-metadata.html">Daten abgleichen</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">OfficeLink</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="officelink-usermanual-excel.html">Excel</a> &raquo;</li>
      
          <li><a href="officelink-usermanual-excel-powerreports.html">PowerReports</a> &raquo;</li>
      
    <li>Implementierung eigener Provider</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/officelink-usermanual-excel-powerreports-implementation.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="implementierung-eigener-provider">
<span id="officelink-usermanual-excel-powerreports-implementation"></span><h1>Implementierung eigener Provider<a class="headerlink" href="#implementierung-eigener-provider" title="Link zu dieser Überschrift">¶</a></h1>
<p>Eigene Datenprovider können in einem beliebigen Python Kundenmodul abgelegt werden.
Damit eigene Datenprovider zu einer Datenquelle zugeordnet werden können, müssen die jeweiligen
Python Module in der dem jeweiligen Kundenmodul zugehörigen <code class="file docutils literal"><span class="pre">default.conf</span></code> eingetragen werden.
Befinden sich die Implementierungen eigener Datenprovider beispielsweise in dem Python Modul
<code class="file docutils literal"><span class="pre">my_namespace/my_module/PowerReportsCodeSamples.py</span></code> , so muss die Zeile
my_namespace.my_module.PowerReportsCodeSamples zur Datei <code class="file docutils literal"><span class="pre">my_namespace/my_module/default.conf</span></code>
hinzugefügt werden. Der Eintrag bewirkt, dass die enthaltenen Providerklassen bei der Zuordnung zur
Datenquelle zur Auswahl stehen.</p>
<div class="figure align-center" id="id1">
<span id="officelink-usermanual-excel-powerreports-implementation-selectionlist"></span><img alt="_images/excel_powerreports_implementation_selectionlist.png" src="_images/excel_powerreports_implementation_selectionlist.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Auswahlkatalog für eigene Providerimplementierungen</span></p>
</div>
<p>Die Implementierung eigener Datenprovider erfolgt durch Ableitung von der Basisklasse
<code class="file docutils literal"><span class="pre">contact.PowerReports.CustomDataProvider</span></code> .</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cdb.objects.PowerReports</span> <span class="kn">import</span> <span class="o">*</span>
<span class="k">class</span> <span class="nc">ProjectsProvider</span><span class="p">(</span><span class="n">CustomDataProvider</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>Für einen Datenprovider müssen zwei Kardinalitäten angegeben werden. Die Kardinalität der Ergebnismenge und die Kardinalität
für den Aufruf. Die Definition dieser Kardinalitäten erfolgt durch die zwei Klassenvariablen CARD und CALL_CARD.</p>
<ul>
<li><p class="first"><span class="guilabel">CARD</span></p>
<p>Gibt die Ergebniskardinalität eines Datenproviders an. Gültige Werte sind:</p>
<ul>
<li><p class="first"><span class="guilabel">CARD_1</span></p>
<p>Für Datenprovider, die ein einzelnes Datenobjekt als Ergebnismenge liefern.</p>
</li>
<li><p class="first"><span class="guilabel">CARD_N</span></p>
<p>Für Datenprovider, die Listen als Ergebnismenge liefern.</p>
</li>
</ul>
</li>
<li><p class="first"><span class="guilabel">CALL_CARD</span></p>
<p>Die Aufrufkardinalität legt u.a. fest, ob ein Datenprovider die Ergebnismenge kontextfrei oder kontextbezogen ermittelt.
Kontextbezogene Datenprovider werden immer als Subprovider zu einem übergeordneten Provider zugeordnet und erhalten zur
Ermittlung der eigenen Ergebnismenge das Ergebnis des übergeordneten Providers als ersten Parameter.</p>
<ul>
<li><p class="first"><span class="guilabel">CARD_0</span></p>
<p>Für Datenprovider, deren Ergebnismenge kontextfrei ermittelt wird. Beispielsweise ein Datenprovider, der alle laufenden
Projekte liefert. Datenprovider mit der Aufrufkardinalität CARD_0 können nicht als Subprovider zugeordnet werden, sondern
werden immer Top-Level zur Datenquelle zugeordnet.</p>
</li>
<li><p class="first"><span class="guilabel">CARD_1</span></p>
<p>Für Datenprovider, die zur Ermittlung der eigenen Ergebnismenge genau ein Datenobjekt des übergeordneten Providers benötigen.
Beispielsweise ein Datenprovider, der zu einem Projekt den Projektfortschritt und weitere Kennzahlen berechnet. Datenprovider
mit der Kardinalität CARD_1 werden immer als Subprovider zu einem übergeordneten Provider zugeordnet. Liefert der übergeordnete
Provider als Ergebnis eine Liste, wird der Subprovider mehrfach mit jedem Listenelement einzeln aufgerufen. Diese Kombination
aus Ergebniskardinalität des übergeordneten Providers und Aufrufkardinalität des untergeordneten Providers erfordert die Erstellung
eines besonderen Template Sheets in der Excel Vorlage. Weitere Informationen zur Erstellung derartiger Vorlagen finden Sie in
<a class="reference internal" href="officelink-usermanual-excel-powerreports-creation.html#officelink-usermanual-excel-powerreports-creation"><span class="std std-ref">Reportvorlagen erstellen</span></a> .</p>
</li>
<li><p class="first"><span class="guilabel">CARD_N</span></p>
<p>Für Datenprovider, die zur Ermittlung der Ergebnismenge eine Ergebnisliste vom übergeordneten Datenprovider erwarten.
Beispielsweise ein Provider, der über eine Liste von Projekten, die vom übergeordneten Provider geliefert wird, aggregierte
Informationen liefert.</p>
</li>
</ul>
</li>
</ul>
<p>Folgendes Codebeispiel zeigt einen Datenprovider, der eine Liste von Projekten liefern soll und dafür keinen Kontext benötigt.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ProjectsProvider</span><span class="p">(</span><span class="n">CustomDataProvider</span><span class="p">):</span>
<span class="hll">    <span class="n">CARD</span>      <span class="o">=</span> <span class="n">CARD_N</span>
</span><span class="hll">    <span class="n">CALL_CARD</span> <span class="o">=</span> <span class="n">CARD_0</span>
</span>    <span class="o">...</span>
</pre></div>
</div>
<p>Im Gegensatz zum vorherigen Beispiel kann der im folgenden Codebeispiel dargestellte Datenprovider ausschließlich als Subprovider
verwendet werden, da zur Ergebnisermittlung ein Ergebnisobjekt des übergeordneten Providers benötigt wird. Ein derartiger Provider
könnte beispielsweise alle laufenden Projekte zu einem Kunden liefern. Der Kunde ist dabei das Ergebnis des übergeordneten Providers.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ProjectsProvider</span><span class="p">(</span><span class="n">CustomDataProvider</span><span class="p">):</span>
<span class="hll">    <span class="n">CARD</span>      <span class="o">=</span> <span class="n">CARD_N</span>
</span><span class="hll">    <span class="n">CALL_CARD</span> <span class="o">=</span> <span class="n">CARD_1</span>
</span>    <span class="o">...</span>
</pre></div>
</div>
<p>Aus den Kardinalitäten ergibt sich, wie Datenprovider miteinander verkettet werden können. Die Kardinalität der Ergebnismenge
muss zur Aufrufkardinalität des Subproviders passen.</p>
<ul>
<li><p class="first"><span class="guilabel">CARD 1 &#8211;&gt; CALL_CARD 1</span></p>
<p>Der übergeordnete Provider liefert beispielsweise ein Projekt, welches vom Subprovider als Parameter zur Berechnung seiner
eigenen Ergebnismenge verwendet wird. Dieser könnte beispielsweise den Projektfortschritt und weitere Kennzahlen zum Projekt
berechnen.</p>
</li>
<li><p class="first"><span class="guilabel">CARD N &#8211;&gt; CALL_CARD N</span></p>
<p>Beispielsweise zur Berechnung aggregierter Daten über die Ergebnisliste des übergeordneten Providers. Der Subprovider kann
keine Daten liefern, die sich auf einzelne Listenelemente des übergeordneten Ergebnisses beziehen, da dieser Zusammenhang
beim Export und Import verloren geht und in Excel nicht darstellbar ist. In diesem Fall muss eine Multi-Export Konfiguration
verwendet werden.</p>
</li>
<li><p class="first"><span class="guilabel">CARD N &#8211;&gt; CALL_CARD 1</span> (Sonderfall Multi-Export)</p>
<p>Der Subprovider wird für jedes Ergebnisobjekt des übergeordneten Providers einzeln aufgerufen und exportiert. Mit einer
Multi-Export Konfiguration können geschachtelte Listen und komplexe Zeilen in Excel dargestellt werden. Die Excel Datenbindung
für Daten, die via Multi-Export exportiert werden, muss bei der Vorlagenerstellung auf einem speziellen Template Sheet erfolgen.
Weitere Informationen zur Erstellung derartiger Vorlagen finden Sie in
<a class="reference internal" href="officelink-usermanual-excel-powerreports-creation.html#officelink-usermanual-excel-powerreports-creation-multiexport"><span class="std std-ref">Darstellung komplexer Zeilen bei Multi-Export Datenquellen</span></a> .</p>
</li>
</ul>
<p>Die Implementierung eines Datenproviders besteht im Wesentlichen aus zwei Methoden. Eine Methode zur Definition des XML Schemas
und eine Methode zur Ermittlung der Ergebnismenge.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ProjectsProvider</span><span class="p">(</span><span class="n">CustomDataProvider</span><span class="p">):</span>
    <span class="n">CARD</span>      <span class="o">=</span> <span class="n">CARD_N</span>
    <span class="n">CALL_CARD</span> <span class="o">=</span> <span class="n">CARD_1</span>
<span class="hll">    <span class="k">def</span> <span class="nf">getSchema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span>        <span class="o">...</span>
<span class="hll">    <span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_result</span><span class="p">,</span> <span class="n">source_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span>        <span class="o">...</span>
</pre></div>
</div>
<div class="section" id="getschema-self">
<span id="officelink-usermanual-excel-powerreports-implementation-getschema"></span><h2>getSchema(self)<a class="headerlink" href="#getschema-self" title="Link zu dieser Überschrift">¶</a></h2>
<p>Liefert das XML Schema zur Herstellung der Datenbindung in Excel. Das XML Schema muss zu den durch die Methode
<code class="file docutils literal"><span class="pre">getData</span></code> gelieferten Daten passen. Das Schema wird durch die Konstruktion eines Objekts vom Typ
<code class="file docutils literal"><span class="pre">XSDType</span></code> beschrieben. Als Konstruktorparameter wird die Kardinalität angegeben, die mit der
Ergebniskardinalität des Providers identisch sein muss.  Mit der Methode <code class="file docutils literal"><span class="pre">add_attr</span></code> können anschließend
zu dem Schemaobjekt beliebig viele Attribute hinzugefügt werden. Der Datentyp wird dabei als zweiter Parameter in Form
eines cdb.sqlapi Datentypen angegeben. Die hinzugefügten Attribute muss es in der Datenbank nicht zwingend geben, sondern
können auch durch den Provider berechnet sein, jedoch dürfen deren Attributnamen keine Großbuchstaben enthalten.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ProjectsProvider</span><span class="p">(</span><span class="n">CustomDataProvider</span><span class="p">):</span>
    <span class="n">CARD</span>      <span class="o">=</span> <span class="n">CARD_N</span>
    <span class="n">CALL_CARD</span> <span class="o">=</span> <span class="n">CARD_1</span>
    <span class="k">def</span> <span class="nf">getSchema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="hll">        <span class="n">schema</span> <span class="o">=</span> <span class="n">XSDType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CARD</span><span class="p">)</span>
</span><span class="hll">        <span class="n">schema</span><span class="o">.</span><span class="n">add_attr</span><span class="p">(</span><span class="s1">&#39;cdb_project_id&#39;</span><span class="p">,</span> <span class="n">sqlapi</span><span class="o">.</span><span class="n">SQL_CHAR</span><span class="p">)</span>
</span><span class="hll">        <span class="n">schema</span><span class="o">.</span><span class="n">add_attr</span><span class="p">(</span><span class="s1">&#39;project_name&#39;</span><span class="p">,</span> <span class="n">sqlapi</span><span class="o">.</span><span class="n">SQL_CHAR</span><span class="p">)</span>
</span><span class="hll">        <span class="n">schema</span><span class="o">.</span><span class="n">add_attr</span><span class="p">(</span><span class="s1">&#39;calculated&#39;</span><span class="p">,</span> <span class="n">sqlapi</span><span class="o">.</span><span class="n">SQL_INTEGER</span><span class="p">)</span>
</span>        <span class="o">...</span>
<span class="hll">        <span class="k">return</span> <span class="n">schema</span>
</span></pre></div>
</div>
<p>Als zweiter Parameter kann im XSDType Konstruktor optional ein Relationsname oder eine cdb.objects Klasse angegeben werden.
Das Schemaobjekt enthält dann automatisch alle in der Relation enthaltenen Attribute. Im Falle einer cdb.objects Klasse
sind anschließend zusätzlich alle MappedAttributes im Schemaobjekt enthalten.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="k">def</span> <span class="nf">getSchema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="hll">    <span class="n">schema</span> <span class="o">=</span> <span class="n">XSDType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CARD</span><span class="p">,</span> <span class="s1">&#39;cdbpcs_project&#39;</span><span class="p">)</span>
</span>    <span class="n">schema</span><span class="o">.</span><span class="n">add_attr</span><span class="p">(</span><span class="s1">&#39;calculated&#39;</span><span class="p">,</span> <span class="n">sqlapi</span><span class="o">.</span><span class="n">SQL_INTEGER</span><span class="p">)</span>
    <span class="o">...</span>
    <span class="k">return</span> <span class="n">schema</span>
</pre></div>
</div>
<p>Basiert das Schema auf genau einer Datenbankrelation oder cdb.objects Klasse, kann getSchema auch direkt einen Relationsnamen
oder eine cdb.objects Klasse zurückliefern. Das XML Schema wird in diesem Fall vollständig automatisch aus dem Datenbankschema
erzeugt. Im Falle einer cdb.objects Klasse sind wiederum zusätzlich alle MappedAttributes im XML Schema enthalten.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="k">def</span> <span class="nf">getSchema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="hll">    <span class="k">return</span> <span class="s2">&quot;cdbpcs_project&quot;</span>
</span></pre></div>
</div>
<p>Für zeilenweise kombinierte Daten kann das Schema mit dem Plus-Operator aus den zugrundeliegenden Typen konstruiert werden.
Bei namensgleichen Attributen in den beteiligten Relationen muss als dritter Parameter ein Präfix angegeben werden, der die
Eindeutigkeit der Attributbezeichner in dem XML Schema sicherstellt. Dieser Präfix ist auch in der Implementierung von
<code class="file docutils literal"><span class="pre">getData</span></code> bei der Konstruktion der Ergebnisobjekte zu verwenden.</p>
<p>Folgendes Beispiel zeigt die Konstruktion eines Schemas für Artikel, erweitert um das Schema für die zugehörige Projekte:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="k">def</span> <span class="nf">getSchema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="hll">    <span class="n">schema</span> <span class="o">=</span> <span class="n">XSDType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CARD</span><span class="p">,</span><span class="s1">&#39;teile_stamm&#39;</span><span class="p">)</span>
</span><span class="hll">    <span class="n">schema</span> <span class="o">+=</span> <span class="n">XSDType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CARD</span><span class="p">,</span> <span class="s1">&#39;cdbpcs_project&#39;</span><span class="p">,</span> <span class="s1">&#39;Project_&#39;</span><span class="p">)</span>
</span>    <span class="o">...</span>
    <span class="k">return</span> <span class="n">schema</span>
</pre></div>
</div>
</div>
<div class="section" id="getdata-self-parent-result-source-args-kwargs">
<span id="officelink-usermanual-excel-powerreports-implementation-getdata"></span><h2>getData(self, parent_result, source_args, **kwargs)<a class="headerlink" href="#getdata-self-parent-result-source-args-kwargs" title="Link zu dieser Überschrift">¶</a></h2>
<p>Liefert die Reportdaten beim Aufruf eines Reports. Zur Ermittlung der Ergebnismenge werden dem Provider folgende Argumente übergeben:</p>
<dl class="docutils">
<dt><span class="guilabel">parent_result</span></dt>
<dd>Ergebnismenge des übergeordneten Providers. Ist der übergeordnete Provider der Kontextprovider, enthält
<code class="file docutils literal"><span class="pre">parent_result</span></code> die Objekte, auf denen der Report aufgerufen wurde. In Abhängigkeit von der Ergebniskardinalität
des übergeordneten Providers ist <code class="file docutils literal"><span class="pre">parent_result</span></code> entweder vom Typ <code class="file docutils literal"><span class="pre">ReportDataList</span></code> oder
<code class="file docutils literal"><span class="pre">ReportData</span></code> . Für Top-Level Provider ist dieser Parameter immer <code class="file docutils literal"><span class="pre">None</span></code> .</dd>
<dt><span class="guilabel">source_args</span></dt>
<dd>Ein Dictionary mit alle Argumenten aus dem optional vorgeschalteten Reportdialog. Die Schlüssel des Dictionaries entsprechen
den Attributnamen der zugrundeliegenden Maskenkonfiguration, jedoch bestehen sie in diesem Moment immer nur aus Kleinbuchstaben,
selbst wenn sie in der Maske teilweise mit Grossbuchstaben (im Providernamen) definiert wurden. Die Attributnamen in der
Maskenkonfiguration folgen zur Zuordnung der Parameter zu den Datenprovidern dem Namensschema &lt;Providername&gt;-&lt;Attributname&gt;.</dd>
<dt><span class="guilabel">kwargs</span></dt>
<dd>Alle Argumente aus dem optional vorgeschalteten Reportdialog, die durch die Namenskonvention &lt;Providername&gt;-
&lt;Attributname&gt; an den Datenprovider adressiert sind. Die Adressierung an den Provider ist aus den Argumentnamen entfernt,
so dass die Argumente direkt via Attributname verwendet werden können. Wie oben erwähnt, enthalten die Atttributnamen
an dieser Stelle stets nur Kleinbuchstaben.</dd>
</dl>
<p>Die Rückgabe der Reportdaten erfolgt in Abhängigkeit von der Ergebniskardinalität (CARD) des Providers. Für die Ergebniskardinalität
CARD_1 muss ein <code class="file docutils literal"><span class="pre">ReportData</span></code> Objekt, für die Ergebniskardinalität CARD_N eine <code class="file docutils literal"><span class="pre">ReportDataList</span></code>
zurückgeliefert werden. Die Konstruktion dieser Ergebnisobjekte wird im Folgenden beschrieben.</p>
</div>
<div class="section" id="reportdata">
<span id="officelink-usermanual-excel-powerreports-implementation-reportdata"></span><h2>ReportData<a class="headerlink" href="#reportdata" title="Link zu dieser Überschrift">¶</a></h2>
<p>Ergebnisobjekt für Datenprovider mit der Ergebniskardinalität CARD_1.</p>
<p>Die Konstruktion von <code class="file docutils literal"><span class="pre">ReportData</span></code> Objekten erfolgt immer durch Angabe des konstruierenden Providers als 1.Parameter.
Es wird also immer <code class="file docutils literal"><span class="pre">self</span></code> als ersten Parameter übergeben. Folgendes Beispiel konstruiert ein leeres
<code class="file docutils literal"><span class="pre">ReportData</span></code> Objekt und gibt dieses als Ergebnis zurück.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SampleProvider</span><span class="p">(</span><span class="n">CustomDataProvider</span><span class="p">):</span>
    <span class="n">CARD</span> <span class="o">=</span> <span class="n">CARD_1</span>
    <span class="o">...</span>
    <span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="hll">        <span class="k">return</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Der Zugriff auf die Elemente eines <code class="file docutils literal"><span class="pre">ReportData</span></code> Objekts entspricht den üblichen Zugriffsmethoden auf Python
Dictionaries. Verfügbar sind die Methoden <code class="file docutils literal"><span class="pre">keys,</span> <span class="pre">values</span></code> und <code class="file docutils literal"><span class="pre">items</span></code> . Das Setzen und Lesen
einzelner Attribute erfolgt durch den Indexoperator.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="hll">    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;cdb_project_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;4711&quot;</span>
</span><span class="hll">    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;project_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Test project&quot;</span>
</span>    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>Die Konstruktion von <code class="file docutils literal"><span class="pre">ReportData</span></code> Objekten kann direkt aus einem cdb.objects-Objekt oder sqlapi.Record
erfolgen. Hierfür wird das Objekt bzw. der Record als zweiter Parameter an den Konstruktor übergeben.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="hll">    <span class="n">project</span> <span class="o">=</span> <span class="n">pcs</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;P000001&#39;</span><span class="p">)</span>
</span><span class="hll">    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">)</span>
</span>    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>Zusätzlich können weitere beliebige Felder hinzugefügt werden.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">project</span> <span class="o">=</span> <span class="n">pcs</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;P000001&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">)</span>
<span class="hll">    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;calculated_attribute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">42</span>
</span>    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p><code class="file docutils literal"><span class="pre">ReportData</span></code> Objekte, die aus cdb.objects Objekten konstruiert werden, können auch die zum Objekt gehörigen
Langtexte als Ergebnis zurückliefern. Hierfür kann als dritter Parameter eine Liste von Langtextrelationen angegeben werden.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">project</span> <span class="o">=</span> <span class="n">pcs</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;P000001&#39;</span><span class="p">)</span>
<span class="hll">    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;cdbpcs_proj_txt&#39;</span><span class="p">])</span>
</span>    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>Für zeilenweise kombinierte Daten, beispielsweise Artikel mit zugehörigem Projekt, können <code class="file docutils literal"><span class="pre">ReportData</span></code> Objekte
mit dem Plus-Operator verknüpft werden. Bei namensgleichen Attributen in den beteiligten Relationen muss als dritter Parameter ein
Präfix angegeben werden, der die Eindeutigkeit der Attributbezeichner sicherstellt. Dabei ist derselbe Präfix zu verwenden, der auch
bei der Schemaerstellung in der Implementierung von <code class="file docutils literal"><span class="pre">getSchema</span></code> verwendet wurde. Folgendes Beispiel zeigt die
Erstellung eines <code class="file docutils literal"><span class="pre">ReportData</span></code> Objektes aus einem Artikel mit anschließender Erweiterung um das zugehörige Projekt.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">item</span> <span class="o">=</span> <span class="n">pdd</span><span class="o">.</span><span class="n">Item</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;4711&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="hll">    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
</span><span class="hll">    <span class="n">data</span> <span class="o">+=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">Project</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;Project_&quot;</span><span class="p">)</span>
</span>    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
</div>
<div class="section" id="reportdatalist">
<span id="officelink-usermanual-excel-powerreports-implementation-reportdatalist"></span><h2>ReportDataList<a class="headerlink" href="#reportdatalist" title="Link zu dieser Überschrift">¶</a></h2>
<p>Ergebnisobjekt für Datenprovider mit der Ergebniskardinalität CARD_N.</p>
<p>Die Konstruktion von <code class="file docutils literal"><span class="pre">ReportDataList</span></code> Objekten erfolgt immer durch Angabe des konstruierenden Providers als
ersten Parameter. Folgendes Beispiel konstruiert eine leere <code class="file docutils literal"><span class="pre">ReportDataList</span></code> und gibt diese als Ergebnis zurück.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SampleProvider</span><span class="p">(</span><span class="n">CustomDataProvider</span><span class="p">):</span>
    <span class="n">CARD</span> <span class="o">=</span> <span class="n">CARD_N</span>
    <span class="o">...</span>
    <span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="hll">        <span class="k">return</span> <span class="n">ReportDataList</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>
</div>
<p><code class="file docutils literal"><span class="pre">ReportDataList</span></code> Objekte bestehen aus einer Liste von <code class="file docutils literal"><span class="pre">ReportData</span></code> Objekten und bieten zum
Zugriff auf Listenelemente die üblichen Zugriffsmethoden für Python Listen: <code class="file docutils literal"><span class="pre">append,</span> <span class="pre">count,</span> <span class="pre">extend,</span> <span class="pre">index,</span> <span class="pre">insert,</span> <span class="pre">pop,</span> <span class="pre">remove,</span> <span class="pre">reverse</span></code> und <code class="file docutils literal"><span class="pre">sort</span></code> . Darüberhinaus können alle Listenoperatoren verwendet werden. Folgendes
Beispiel zeigt, wie mit dem Plus-Operator zwei Listenelemente hinzugefügt werden, die jeweils ein Projekt enthalten.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportDataList</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="hll">    <span class="n">data</span> <span class="o">+=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pcs</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;P000001&#39;</span><span class="p">))</span>
</span><span class="hll">    <span class="n">data</span> <span class="o">+=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pcs</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;P000002&#39;</span><span class="p">))</span>
</span>    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>Mit den Plus-Operator kann als verkürzte Schreibweise auch direkt ein sqlapi.Record oder cdb.objects Objekt hinzugefügt werden,
ohne erst selbst ein ReportData Objekt zu konstruieren.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportDataList</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="hll">    <span class="n">data</span> <span class="o">+=</span> <span class="n">pcs</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;P000001&#39;</span><span class="p">)</span>
</span><span class="hll">    <span class="n">data</span> <span class="o">+=</span> <span class="n">pcs</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;P000002&#39;</span><span class="p">)</span>
</span>    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>ReportDataList Objekte können direkt aus einer Liste von cdb.objects Objekten oder einem sqlapi.RecordSet2 konstruiert werden.
Dabei werden automatisch für jedes Listenelement ReportData Objekte konstruiert und hinzugefügt.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="hll">    <span class="n">projects</span> <span class="o">=</span> <span class="n">pcs</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">Query</span><span class="p">(</span><span class="s2">&quot;status&gt;0&quot;</span><span class="p">)</span>
</span><span class="hll">    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportDataList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">projects</span><span class="p">)</span>
</span>    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>Als dritter Parameter kann bei der Konstruktion aus cdb.objects Objekten eine Liste von einzubeziehenden Langtextrelationen
angegeben werden.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">projects</span> <span class="o">=</span> <span class="n">pcs</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">Query</span><span class="p">(</span><span class="s2">&quot;status&gt;0&quot;</span><span class="p">)</span>
<span class="hll">    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportDataList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">projects</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;cdbpcs_proj_txt&#39;</span><span class="p">])</span>
</span>    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>Bei der Konstruktion von Ergebnislisten ist zu berücksichtigen, dass die Listenelemente nicht heterogen sein dürfen. Es ist
also beispielsweise nicht möglich, Projekte und Dokumente gemischt in einer ReportDataList zurückzugeben.</p>
</div>
<div class="section" id="getclass-self">
<span id="officelink-usermanual-excel-powerreports-implementation-getclass"></span><h2>getClass(self)<a class="headerlink" href="#getclass-self" title="Link zu dieser Überschrift">¶</a></h2>
<p>Gibt die cdb.objects Klasse der gelieferten Daten zurück, wenn der Provider Daten in Form von cdb.objects Objekten liefert.
Werden die Daten nicht aus cdb.objects Objekten konstruiert, wird diese Methode nicht implementiert. Folgendes Beispiel zeigt
die Implementierung für einen Provider, der Projekte als Ergebnis liefert.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getClass</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">pcs</span><span class="o">.</span><span class="n">Projects</span><span class="o">.</span><span class="n">Project</span>
</pre></div>
</div>
<p>Liefert ein eigener Provider kombinierte Daten, beispielsweise Artikel mit Projekt, so ist der Typ des Primärobjekts anzugeben.
Das Primärobjekt ist das initiale Objekt, dass zur ReportData Konstruktion verwendet wurde.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">item</span> <span class="o">=</span> <span class="n">pdd</span><span class="o">.</span><span class="n">Item</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;4711&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="hll">    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="c1"># &lt;- Primary object</span>
</span>    <span class="n">data</span> <span class="o">+=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">Project</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;Project_&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
<span class="k">def</span> <span class="nf">getClass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="hll">    <span class="k">return</span> <span class="n">pdd</span><span class="o">.</span><span class="n">Item</span> <span class="c1"># &lt;- Primary object</span>
</span></pre></div>
</div>
<p>Die Implementierung von <code class="file docutils literal"><span class="pre">getClass</span></code> ermöglicht die Verwendung von Relationship-Providern als Subprovider an
eigenen Providern. Eigene Provider lassen sich somit direkt in das Objektmodell des cdb.objects Frameworks integrieren.
Liefert beispielsweise ein eigener Provider Projekte, so können alle von Projekten ausgehende Beziehungen als Subprovider
an den eigenen Provider angehängt werden. Auf diese Weise können also zu den selbst ermittelten Projekten beispielsweise Offenen
Punkte, Aufgaben oder Dokumente ohne weitere Programmierung in die Datenquelle integriert werden.</p>
<p>Darüberhinaus erkennt das Report Framework an dieser Methode cdb.objects basierte Provider, so dass bei fehlender Implementierung
beispielsweise die in <a class="reference internal" href="officelink-usermanual-excel-powerreports-source-and-provider.html#officelink-usermanual-excel-powerreports-source-and-provider-provider-parameter"><span class="std std-ref">Provider Parameter</span></a>
beschriebenen Parameter nicht automatisch angelegt werden.</p>
</div>
<div class="section" id="getdefaultparameters-self">
<span id="officelink-usermanual-excel-powerreports-implementation-getdefaultparameters"></span><h2>getDefaultParameters(self)<a class="headerlink" href="#getdefaultparameters-self" title="Link zu dieser Überschrift">¶</a></h2>
<p>Gibt ein Dictionary mit Parameternamen und Defaultwerten zurück, die bei der Neuanlage eines Providers dieses Typs automatisch
angelegt werden und anschließend im Register &#8216;Parameter&#8217; des Providers angepasst werden können. Die durch diese Methode
zurückgelieferten Parameternamen können in der Implementierung des Providers verwendet werden, um den Provider im Verwendungskontext
konfigurierbar zu machen. Auf diese Art und Weise lassen sich universelle und konfigurierbare Datenprovider selbst implementieren.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getDefaultParameters</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;My Parameter&quot;</span> <span class="p">:</span> <span class="s2">&quot;My Value&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>cdb.objects basierte Datenprovider erhalten zusätzlich automatisch immer folgende Defaultparameter, sofern die
<code class="file docutils literal"><span class="pre">getClass</span></code> Methode implementiert wurde.</p>
<div class="figure align-center" id="id2">
<span id="officelink-usermanual-excel-powerreports-implementation-defaultparameters"></span><img alt="_images/excel_powerreports_implementation_defaultparameters.png" src="_images/excel_powerreports_implementation_defaultparameters.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Defaultparameters</span></p>
</div>
<p>Die Auswertung dieser Parameter erfolgt automatisch und muss für eigene Provider nicht selbst implementiert werden.</p>
<p>Der Zugriff auf eigene Parameter eines Providers erfolgt durch die Methode <code class="file docutils literal"><span class="pre">getParameter(name)</span></code> .</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="hll">    <span class="n">param</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParameter</span><span class="p">(</span><span class="s2">&quot;My Parameter&quot;</span><span class="p">)</span>
</span><span class="hll">    <span class="k">if</span> <span class="n">param</span> <span class="o">==</span> <span class="s2">&quot;My Value&quot;</span><span class="p">:</span>
</span>        <span class="o">...</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="o">...</span>
        <span class="o">...</span>
</pre></div>
</div>
</div>
<div class="section" id="getargumentdefinitions-self">
<span id="officelink-usermanual-excel-powerreports-implementation-getargumentdefinitions"></span><h2>getArgumentDefinitions(self)<a class="headerlink" href="#getargumentdefinitions-self" title="Link zu dieser Überschrift">¶</a></h2>
<p>Die Ergebnismenge von Datenprovidern kann durch einen vorgeschalteten Reportdialog beeinflusst werden (siehe auch
<a class="reference internal" href="officelink-usermanual-excel-powerreports-creation.html#officelink-usermanual-excel-powerreports-creation-dialogs"><span class="std std-ref">Reportdialoge erstellen</span></a> ). Üblicherweise werden dabei zusätzliche
einschränkende Suchbedingungen interaktiv vom Anwender abgefragt. Damit auch zu einem späteren Zeitpunkt nachvollziehbar
ist, welche Daten in einem Report dargestellt werden, welche Abfrageparameter also zu dem speziellen Ergebnis geführt
haben, ist es häufig sinnvoll, die verwendeten Abfrageparameter in dem Report mit darzustellen.</p>
<p>Zu diesem Zweck kann die Methode <span class="guilabel">getArgumentDefinitions</span> implementiert werden. Die Methode gibt
ein Dictionary mit Parameternamen und den zugehörigen Datentypen zurück. Die zurückgelieferten Argumentnamen werden
automatisch mit dem angegebenen Datentyp in das XML Schema unter dem Schemanamen <span class="guilabel">Arguments</span>
hinzugefügt und beim Datenexport mit exportiert.</p>
<p>Die Argumentnamen werden dabei automatisch um den Providernamen erweitert, so dass eine eindeutige Zuordnung zum Datenprovider
sichergestellt ist (analog zur Dialogkonfiguration wie in <a class="reference internal" href="officelink-usermanual-excel-powerreports-creation.html#officelink-usermanual-excel-powerreports-creation-dialogs"><span class="std std-ref">Reportdialoge erstellen</span></a>
beschrieben).</p>
<div class="admonition important">
<p class="first admonition-title">Wichtig</p>
<p class="last">Die Attributnamen dürfen keine Großbuchstaben enthalten.</p>
</div>
<p>Die Verwendung im Detail am Beispiel eines Reports über Projekte mit einem vorgeschalteten Dialog zur optionalen Einschränkung
auf eine bestimmte Kategorie (der Dialog enthält das Attribut <span class="guilabel">projekte-category</span> , ermöglicht also die
Eingabe einer Kategorie, die von dem Datenprovider <span class="guilabel">projekte</span> ausgewertet wird):</p>
<div class="figure align-center" id="id3">
<span id="officelink-usermanual-excel-powerreports-implementation-getargumentdefinitions-dlg"></span><img alt="_images/excel_powerreports_implementation_getargumentdefinitions_dlg.png" src="_images/excel_powerreports_implementation_getargumentdefinitions_dlg.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Reportdialog am Beispiel Abfrage der Projektkategorie</span></p>
</div>
<p>Die im folgenden Codebeispiel dargestellte Implementierung des Datenproviders wertet die abgefragte Kategorie aus und schränkt
so die Ergebnismenge ein. Die Methode <span class="guilabel">getArgumentDefinitions</span> liefert das Attribut <span class="guilabel">category</span>
und teilt dem PowerReports Framework damit mit, dass dieses Argument mit exportiert werden soll.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Projekte</span><span class="p">(</span><span class="n">CustomDataProvider</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">getSchema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;cdbpcs_project&quot;</span>
    <span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="hll">        <span class="n">category</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span> <span class="c1"># Parameter from dialog</span>
</span>        <span class="n">cond</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">category</span><span class="p">:</span>
            <span class="n">cond</span> <span class="o">=</span> <span class="s2">&quot;category=&#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">category</span>
        <span class="k">return</span> <span class="n">ReportDataList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pcs</span><span class="o">.</span><span class="n">Projects</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">Query</span><span class="p">(</span><span class="n">cond</span><span class="p">))</span>
<span class="hll">    <span class="k">def</span> <span class="nf">getArgumentDefinitions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;category&quot;</span> <span class="p">:</span> <span class="n">sqlapi</span><span class="o">.</span><span class="n">SQL_CHAR</span><span class="p">}</span>
</span></pre></div>
</div>
<p>Aufgrund der obigen Implementierung von <span class="guilabel">getArgumentDefinitions</span> ist das in dem Reportdialog verwendete
Attribut unter <span class="guilabel">Arguments</span> verfügbar und kann in der Datenbindung der Excel Vorlage verwendet werden.</p>
<div class="figure align-center" id="id4">
<span id="officelink-usermanual-excel-powerreports-implementation-getargumentdefinitions-schematree"></span><img alt="_images/excel_powerreports_implementation_getargumentdefinitions_schematree.png" src="_images/excel_powerreports_implementation_getargumentdefinitions_schematree.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - XML Schema für Argumente</span></p>
</div>
<p>Nach Herstellung der Datenbindung enthalten Reports die verwendete Suchbedingung für die Projektkategorie.</p>
<div class="figure align-center" id="id5">
<span id="officelink-usermanual-excel-powerreports-implementation-getargumentdefinitions-result1"></span><img alt="_images/excel_powerreports_implementation_getargumentdefinitions_result1.png" src="_images/excel_powerreports_implementation_getargumentdefinitions_result1.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Report mit einschränkender Suchbedingung (1)</span></p>
</div>
<p>Die Suchbedingung kann direkt in dem Report geändert werden und anschließend die Kopplungsfunktion
<span class="guilabel">Report aktualisieren</span> aufgerufen werden.</p>
<p>Der Report wird mit den geänderten Suchbedingungen aktualisiert, ohne diesen neu aus dem System aufrufen zu müssen.</p>
<div class="figure align-center" id="id6">
<span id="officelink-usermanual-excel-powerreports-implementation-getargumentdefinitions-result2"></span><img alt="_images/excel_powerreports_implementation_getargumentdefinitions_result2.png" src="_images/excel_powerreports_implementation_getargumentdefinitions_result2.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Report mit einschränkender Suchbedingung (2)</span></p>
</div>
</div>
<div class="section" id="hinzufugen-weiterer-hyperlinks">
<span id="officelink-usermanual-excel-powerreports-implementation-hyperlinks"></span><h2>Hinzufügen weiterer Hyperlinks<a class="headerlink" href="#hinzufugen-weiterer-hyperlinks" title="Link zu dieser Überschrift">¶</a></h2>
<p>Hyperlinks werden abhängig von der Providerkonfiguration automatisch für die durch einen Provider gelieferten Objekte erzeugt.
Sollen diese Objekte weitere Links zu referenzierten Objekten enthalten, müssen diese explizit hinzugefügt werden. Dabei ist zu
beachten, dass das XSD Schema entsprechend erweitert werden muss. Die Erstellung von Hyperlinks erfolgt mit der Methode
<code class="file docutils literal"><span class="pre">MakeReportURL</span></code> . Folgendes Beispiel zeigt das Hinzufügen eines Hyperlinks für das zugeordnete Projekt eines
Artikels.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getSchema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">XSDType</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;teile_stamm&#39;</span><span class="p">)</span>
<span class="hll">    <span class="n">t</span><span class="o">.</span><span class="n">add_attr</span><span class="p">(</span><span class="s2">&quot;project_hyperlink&quot;</span><span class="p">,</span> <span class="n">sqlapi</span><span class="o">.</span><span class="n">SQL_CHAR</span><span class="p">)</span>
</span>    <span class="k">return</span> <span class="n">t</span>
<span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">item</span> <span class="o">=</span> <span class="n">pdd</span><span class="o">.</span><span class="n">Item</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;4711&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
<span class="hll">    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;project_hyperlink&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">MakeReportURL</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">Project</span><span class="p">)</span>
</span>    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>Im obigen Beispiel wird der Hyperlink mit der Default Aktion CDB_ShowObject und der konfigurierten Objektschreibung aus dem
Klassenverzeichnis erzeugt.</p>
<p>Als zweiter und dritter Parameter kann der <code class="file docutils literal"><span class="pre">MakeReportURL</span></code> Methode eine beliebige andere Aktion und eine
anzuzeigende Beschriftung übergeben werden. Wird als Beschriftung ein Attributbezeichner des Objekts angegeben, wird der Wert
dieses Attributes verwendet. Ansonsten wird als Beschriftung die angegebene Zeichenkette konstant verwendet.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">item</span> <span class="o">=</span> <span class="n">pdd</span><span class="o">.</span><span class="n">Item</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;4711&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
<span class="hll">    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;project_hyperlink&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MakeReportURL</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">Project</span><span class="p">,</span> <span class="s2">&quot;CDB_Modify&quot;</span><span class="p">,</span> <span class="s2">&quot;project_name&quot;</span><span class="p">)</span>
</span>    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>Bei kombinierten Daten werden Hyperlinks grundsätzlich nur für das Primärobjekt automatisch erzeugt. Das folgende Beispiel
zeigt Reportdaten für einen Artikel, erweitert um die Daten des zugehörigen Projekts. Für das Projektobjekt wird in diesem
Fall kein Hyperlink automatisch angelegt. Soll ein Hyperlink auf das Projekt enthalten sein, muss dieser wie zuvor beschrieben
manuell hinzugefügt werden.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">item</span> <span class="o">=</span> <span class="n">pdd</span><span class="o">.</span><span class="n">Item</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;4711&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="hll">    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>  <span class="c1"># &lt;- Primary object</span>
</span>    <span class="n">data</span> <span class="o">+=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">Project</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;Project_&quot;</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;project_hyperlink&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MakeReportURL</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">Project</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
</div>
<div class="section" id="hinzufugen-von-bilddateien">
<span id="officelink-usermanual-excel-powerreports-implementation-images"></span><h2>Hinzufügen von Bilddateien<a class="headerlink" href="#hinzufugen-von-bilddateien" title="Link zu dieser Überschrift">¶</a></h2>
<p>Soll ein Datenprovider dynamische Bildinhalte liefern (siehe auch
<a class="reference internal" href="officelink-usermanual-excel-powerreports-creation.html#officelink-usermanual-excel-powerreports-creation-dynamic-images"><span class="std std-ref">Darstellung dynamischer Bildinhalte</span></a> ), dann muss zunächst wie im vorigen Kapitel
das XSD Schema entsprechend erweitert werden.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getSchema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="n">XSDType</span><span class="p">(</span><span class="n">CARD_N</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="n">teile_stamm</span><span class="s1">&#39;)</span>
<span class="hll">    <span class="n">schema</span><span class="o">.</span><span class="n">add_attr</span><span class="p">(</span><span class="s1">&#39;cdbxml_image_preview&#39;</span><span class="p">,</span> <span class="n">sqlapi</span><span class="o">.</span><span class="n">SQL_CHAR</span><span class="p">)</span>
</span>    <span class="k">return</span> <span class="n">schema</span>
</pre></div>
</div>
<p>Das Hinzufügen von sogenannten Imagelinks erfolgt über die Methode <span class="guilabel">add_image</span> .</p>
<p class="rubric">add_image(self, image=None, attr_name=&#8217;cdbxml_image&#8217;, hyperlink=&#8217;openfile&#8217;, <strong>args</strong>)</p>
<dl class="docutils">
<dt><span class="guilabel">image</span></dt>
<dd><p class="first">Mögliche Werte:</p>
<ul class="last simple">
<li>CDB_File-Objekt:<ul>
<li>z.B. CDB_File.ByKeys(cdb_object_id=&#8217;...&#8217;)</li>
<li>Die Datei wird zusammen mit den anderen Report-Daten übergeben.</li>
</ul>
</li>
<li>Objekt-ID eines CDB_File-Objektes:<ul>
<li>z.B. some_preview_file_obj.cdb_object_id</li>
<li>Die Datei wird zusammen mit den anderen Report-Daten übergeben.</li>
</ul>
</li>
<li>Einfacher Pfad:<ul>
<li>z.B. &#8220;C:\temp\bild.jpg&#8221;</li>
<li>Die Datei wird zusammen mit den anderen Report-Daten übergeben.</li>
</ul>
</li>
<li>Absoluter URI Pfad:<ul>
<li>z.B. &#8220;<a class="reference external" href="file:///C">file:///C</a>:\temp\bild.jpg&#8221;</li>
<li>Die Datei wird <span class="guilabel">nicht</span> den anderen Report-Daten übergeben, sondern später direkt  bei der Reportgenerierung von der Kopplung importiert. Dabei ist natürlich zu beachten, dass die jeweilige Maschine,
welche den Report zusammenstellt, Zugriff auf diesen (z.B. Netzwerk-)Pfad hat.</li>
</ul>
</li>
<li>HTTP Pfad:<ul>
<li>z.B. &#8220;<a class="reference external" href="http://local.myserver.de/bild.jpg">http://local.myserver.de/bild.jpg</a>&#8220;</li>
<li>Die Datei wird <span class="guilabel">nicht</span> den anderen Report-Daten übergeben, sondern später direkt  bei der Reportgenerierung von der Kopplung importiert. Dabei ist natürlich wiederum zu beachten, dass die jeweilige
Maschine, welche den Report zusammenstellt, Zugriff auf diesen Internet-Pfad hat.</li>
</ul>
</li>
</ul>
</dd>
<dt><span class="guilabel">attr_name</span></dt>
<dd>Das Attribut mit welchem zuvor an anderer Stelle das XSD Schema erweitert wurde (siehe <span class="guilabel">add_attr</span>).</dd>
<dt><span class="guilabel">hyperlink</span></dt>
<dd>Standardmäßig wird jedes Bild im PowerReport mit einem Hyperlink verknüpft, welcher direkt auf die lokale Bilddatei zeigt.
Dadurch sieht man das Bild in der Regel beim Anklicken im Internet-Explorer im (vergrößerten) Originalzustand.</dd>
</dl>
<p>Folgendes Beispiel zeigt das Hinzufügen einer Bilddatei.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_result</span><span class="p">,</span> <span class="n">source_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">item</span> <span class="o">=</span> <span class="n">pdd</span><span class="o">.</span><span class="n">Item</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;4711&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">_getPreviewImageFile</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>  <span class="c1"># some custom method for retrieving regarding preview images</span>
    <span class="n">data</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;cdbxml_image_preview&#39;</span><span class="p">)</span>
<span class="hll">    <span class="k">return</span> <span class="n">data</span>
</span></pre></div>
</div>
<p>Ein weiteres Beispiel zeigt, wie man zusätzlich eigene Hyperlinks einbauen könnte.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_result</span><span class="p">,</span> <span class="n">source_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">item</span> <span class="o">=</span> <span class="n">pdd</span><span class="o">.</span><span class="n">Item</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;4711&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">_getPreviewImageFile</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>  <span class="c1"># some custom method for retrieving regarding preview images</span>
    <span class="n">hyperlink</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">MakeURL</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">plain</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="hll">    <span class="n">data</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;cdbxml_image_preview&#39;</span><span class="p">,</span> <span class="n">hyperlink</span><span class="p">)</span>
</span><span class="hll">    <span class="k">return</span> <span class="n">data</span>
</span></pre></div>
</div>
<div class="admonition important">
<p class="first admonition-title">Wichtig</p>
<p class="last">Beim Aktualisieren eines PowerReports werden Bilddateien <span class="guilabel">nicht</span> mit aktualisiert.</p>
</div>
</div>
<div class="section" id="hinzufugen-von-hierarchieinformationen-bei-hierarchischen-daten">
<span id="officelink-usermanual-excel-powerreports-implementation-indentation"></span><h2>Hinzufügen von Hierarchieinformationen bei hierarchischen Daten<a class="headerlink" href="#hinzufugen-von-hierarchieinformationen-bei-hierarchischen-daten" title="Link zu dieser Überschrift">¶</a></h2>
<p>Hierarchische Daten, wie beispielsweise Produktstrukturen oder Aufgabenstrukturen, können in PowerReports entsprechend
dargestellt werden. Hierarchieebenen sind in PowerReports auf- und zu klappbar und  können für eine bessere Übersicht
farblich codiert und eingerückt werden.</p>
<div class="figure align-center" id="id7">
<span id="officelink-usermanual-excel-powerreports-implementation-indentation-pic"></span><img alt="_images/excel_powerreports_implementation_indentation.png" src="_images/excel_powerreports_implementation_indentation.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Hierarchische Darstellung am Beispiel Produktstruktur</span></p>
</div>
<p>Zur Darstellung hierarchischer Daten benötigt die Excel Kopplung Informationen über die Hierarchietiefe. Diese Information
wird der Kopplung durch ein weiteres Attribut mit dem festen Namen <code class="file docutils literal"><span class="pre">cdbxml_level</span></code> mitgeteilt.</p>
<p>Folgender Code zeigt am Beispiel Produktstruktur, wie <code class="file docutils literal"><span class="pre">cdbxml_level</span></code> zum Schema hinzugefügt wird und beim
Datenexport gesetzt werden kann. Bitte beachten Sie, dass die in dem Beispiel verwendete Methode <code class="file docutils literal"><span class="pre">getComponents2</span></code>
zur Ermittlung der Produktstruktur nicht Bestandteil einer System-Standarddistribution ist.  Der Code kann daher nicht ohne
weitere Anpassungen für einen eigenen Provider kopiert werden.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getSchema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">XSDType</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="s2">&quot;einzelteile&quot;</span><span class="p">)</span>
<span class="hll">    <span class="n">t</span><span class="o">.</span><span class="n">add_attr</span><span class="p">(</span><span class="s2">&quot;cdbxml_level&quot;</span><span class="p">,</span> <span class="n">sqlapi</span><span class="o">.</span><span class="n">SQL_INTEGER</span><span class="p">)</span>
</span>    <span class="k">return</span> <span class="n">t</span>
<span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_result</span><span class="p">,</span> <span class="n">source_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">item</span> <span class="o">=</span> <span class="n">parent_result</span><span class="o">.</span><span class="n">getObject</span><span class="p">()</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">ReportDataList</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="c1"># Custom method getComponents2 provides product structure tuples containing item and depth</span>
    <span class="k">for</span> <span class="n">lev</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">getComponents2</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
        <span class="n">d</span><span class="p">[</span><span class="s2">&quot;cdbxml_level&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lev</span>
<span class="hll">        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</span>    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
<p>Die Beschreibung zur Erstellung von Excelvorlagen mit Darstellung hierarchischer Daten finden Sie in
<a class="reference internal" href="officelink-usermanual-excel-powerreports-creation.html#officelink-usermanual-excel-powerreports-creation-indentation"><span class="std std-ref">Darstellung hierarchischer Daten</span></a> .</p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="officelink-usermanual-excel-powerreports-activation.html" class="btn btn-neutral float-right" title="Aktivierung von PowerReports" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="officelink-usermanual-excel-powerreports-source-and-provider.html" class="btn btn-neutral" title="Datenquellen und Datenprovider" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, CONTACT Software GmbH.
      Zuletzt aktualisiert am 25.09.2018.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'15.5.0.9',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>