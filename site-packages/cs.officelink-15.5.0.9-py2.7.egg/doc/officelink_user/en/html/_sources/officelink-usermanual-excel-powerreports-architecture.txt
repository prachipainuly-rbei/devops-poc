.. _`officelink-usermanual-excel-powerreports-architecture`:

Architektur
###########

PowerReports beziehen ihre Daten aus XML Datenquellen, die in der Datenbank konfiguriert werden. 
Eine XML Datenquelle besteht aus einer beliebigen Anzahl wiederverwendbarer Datenprovider, die 
die darzustellenden Daten liefern. Eine Datenquelle liefert zwei Arten von Informationen in Form 
von temporären Dateien, die sich aus der Summe der zugeordneten Provider ergeben. Einerseits das 
XSD Schema zur Herstellung der Datenbindung in den Reportvorlagen, in der folgenden Abbildung rot 
dargestellt, und andererseits die Daten in Form einer XML Export Datei.

Die XML Exportdatei wird bei Aufruf eines Reports serverseitig erzeugt und zum Client übertragen. 
Gleichzeitig wird die im System-Vault zum Report hinterlegte Excelvorlage instanziiert und ebenfalls 
zum Client übertragen. Der Client verfügt durch die MS-Excel Integration über eine aktive Komponente, 
die die instanziierte Vorlage und die XML Export Datei zu einem fertigen Report zusammenführt.

.. _`officelink-usermanual-excel-powerreports-architecture-overview`:

.. figure:: images/excel_powerreports_architecture_overview.png
   :align: center

   Excel: PowerReports - Architekturübersicht

Das XSD Schema einer Datenquelle ergibt sich aus der Summe der Teilschemata der zugeordneten 
Provider. Die Datenprovider erzeugen dabei das Schema aus den zugrundeliegenden Datenbanktabellen 
automatisiert und ergänzen ggf. weitere Attribute. Das Schema eines Datenproviders kann zusätzlich 
auch völlig datenbankunabhängig erzeugt werden. Dies ist beispielsweise notwendig, wenn ein Provider 
ausschließlich berechnete Daten oder Daten aus externen Systemen liefert.

.. _`officelink-usermanual-excel-powerreports-architecture-exportschema`:

.. figure:: images/excel_powerreports_architecture_exportschema.png
   :align: center

   Excel: PowerReports - Funktionsprinzip Schemaausleitung

Der Aufruf eines Reports kann in Abhängigkeit von der Datenquellenkonfiguration kontextfrei oder 
kontextbezogen erfolgen. Ein kontextfreier Report liefert in der Regel Daten aus dem 
Gesamtdatenbestand, beispielsweise aller laufenden Projekte. Ein kontextbezogener Report liefert 
dagegen Daten, die sich auf eines oder mehrere ausgewählte Objekte beziehen, beispielsweise 
Informationen zu einem Projekt oder Engineering Change. Der Kontext ergibt sich durch den Aufruf 
über das Kontextmenü eines oder mehrerer selektierter Objekte. Die selektierten Objekten 
parametrisieren den Datenexport. 

Zusätzlich zu der Parametrisierung durch den Kontext kann ein Dialog vorgeschaltet werden, der 
weitere Parameter vom Anwender abfragt. In der folgenden Abbildung sind die selektierten Objekte 
und weitere Parameter aus einem vorgeschalteten Dialog als 'Objekte und Parameter' dargestellt. 
Die Objekte und Parameter werden beim XML Export an die Datenprovider übergeben. Die Datenprovider 
ermitteln auf Basis dieser Argumente die Ergebnismenge aus der Datenbank und konstruieren daraus 
ReportData Objekte die anschließend unter Berücksichtigung des Rechtesystems in eine gemeinsame 
XML Datei exportiert werden. 

Datenprovider können durch hierarchische Anordnung miteinander verkettet werden. Ein 
untergeordneter Provider erhält in diesem Fall nicht die Eingabeobjekte der XML Datenquelle, 
sondern die Ergebnismenge des übergeordneten Providers als Argumente. Dies ermöglicht die 
Parametrisierung von Datenprovidern abhängig vom Ergebnis eines anderen Providers. 

.. _`officelink-usermanual-excel-powerreports-architecture-exportxml`:

.. figure:: images/excel_powerreports_architecture_exportxml.png
   :align: center

   Excel: PowerReports - Funktionsprinzip XML Export