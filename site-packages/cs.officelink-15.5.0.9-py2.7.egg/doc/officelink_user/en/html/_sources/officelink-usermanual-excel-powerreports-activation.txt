.. _`officelink-usermanual-excel-powerreports-activation`:

Aktivierung von PowerReports
############################

Kontextbezogene Reports müssen für jede Objektklasse, für die PowerReports verwendet werden sollen, aktiviert werden. Außerdem 
muss für jede zu aktivierende Objektklasse eine minimale Konfiguration zur Reportauswahl im jeweiligen Kontextmenü durchgeführt 
werden.

.. rubric:: Die Aktivierung erfolgt in zwei Schritten:

#. Erweiterung der entsprechenden cdb.objects Klasse durch Ableitung
#. Aktivierung der 'Reports' Operation für das Kontextmenü

.. _`officelink-usermanual-excel-powerreports-activation-objectclass`:

cdb.objects Klasse
==================

Am Beispiel Projekte:

.. code-block:: none

    from cdb.objects.pcs.Projects import Project
    from cdb.objects import PowerReports
    class MyProject(Project, :guilabel:`PowerReports.WithPowerReports` ): 
    ...

Falls für die zu aktivierende Objektklasse noch keine cdb.objects basierte Komponente existiert, muss diese zusätzlich in der 
Komponentenkonfiguration zu der ggf. schon existierenden server_<relation> Komponente angelegt werden. Am Beispiel 
Projekte:

.. _`officelink-usermanual-excel-powerreports-activation-objectclass-component`:

.. figure:: images/excel_powerreports_activation_component.png
   :align: center

   Excel: PowerReports - cdb.objects basierte Komponente für Projekte

Sollen die Reports für mehrere Switch-Klassen mit unterschiedlichen Klassennamen aber gleichen Typs eingerichtet werden, also 
beispielsweise für verschiedene Projektklassen, muss pro Switch-Klassenname eine Komponente angelegt werden. Alle Komponenten 
müssen dabei dieselbe cdb.objects-Klasse im Feld Objektname verwenden.

Im Register 'Aktive Aufrufe' muss die Aktion :file:`cdbxml_excel_report` mit dem Aufrufzeitpunkt \* aktiviert
werden. :guilabel:`Es dürfen auf keinen Fall alle Aktionen mit \* aktiviert werden!` Dies würde in bestehenden
Installationen zur unerwünschten Aktivierung zusätzlichen User Exit Codes führen, der zusätzlich zum existierenden server_<relation> 
User Exit ausgeführt werden würde.

.. _`officelink-usermanual-excel-powerreports-activation-objectclass-operation`:

.. figure:: images/excel_powerreports_activation_operation.png
   :align: center

   Excel: PowerReports - Aktivierung der cdbxml_excel_report Operation

.. _`officelink-usermanual-excel-powerreports-activation-operation`:

'Reports' Operation
===================

Die Aktivierung der Operation erfolgt im Register 'Konfiguration' der Operation :file:`cdbxml_excel_report` durch 
Hinzufügen eines weiteren Eintrages für die zu aktivierende Klasse. Standardmäßig ist mindestens ein Eintrag für Projekte 
vorhanden, der als Kopiervorlage verwendet werden kann.

.. _`officelink-usermanual-excel-powerreports-activation-operation-configuration`:

.. figure:: images/excel_powerreports_activation_operation_configuration.png
   :align: center

   Excel: PowerReports - Operationskonfiguration am Beispiel Dokumente

Die Aktivierung von Reports am Beispiel für Dokumente ist damit abgeschlossen und es können beliebige Reports im Kontext 
von Dokumenten sowohl Single-Select als auch Multi-Select im Kontextmenü aufgerufen werden. 

.. _`officelink-usermanual-excel-powerreports-activation-operation-contextmenu`:

.. figure:: images/excel_powerreports_activation_operation_contextmenu.png
   :align: center

   Excel: PowerReports - Kontextmenüoperation zum Aufruf von Reports

Nach Auswahl der Kontextmenüfunktion 'Reports...' öffnet sich der Dialog zur Auswahl des auszuführenden Reports. Der 
Reportauswahlkatalog listet automatisch alle für den jeweiligen Anwender verfügbaren Reports. Dabei werden bei Multi-Select 
automatisch die Single-Select Reports ausgeblendet (siehe :ref:`officelink-usermanual-excel-powerreports-execution` ).