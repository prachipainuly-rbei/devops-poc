

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Create templates for data synchronization &mdash; OfficeLink</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="OfficeLink" href="index.html"/>
        <link rel="up" title="Synchronizing data" href="officelink-usermanual-visio-metadata.html"/>
        <link rel="next" title="Word" href="officelink-usermanual-word.html"/>
        <link rel="prev" title="Metadata synchronization with the system" href="officelink-usermanual-visio-metadata-syncwrite.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="/doc/en" class="icon fa-book">
            Documentation Portal
          </a>
        

        
          <a href="index.html" class="icon icon-home"> OfficeLink
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="teaser.html">Introduction</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-excel.html">Excel</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-excel-preface.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-excel-documents.html">Editing documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-excel-metadata.html">Synchronizing data</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-excel-powerreports.html">PowerReports</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-outlook.html">Outlook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-outlook-preface.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-outlook-mails.html">E-mails and attachments</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-powerpoint.html">PowerPoint</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-powerpoint-preface.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-powerpoint-documents.html">Editing documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-powerpoint-metadata.html">Synchronizing data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-project.html">Project</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-project-preface.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-project-documents.html">Editing documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-project-sync.html">Project synchronization</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="officelink-usermanual-visio.html">Visio</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-visio-preface.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-visio-documents.html">Editing documents</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="officelink-usermanual-visio-metadata.html">Synchronizing data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-word.html">Word</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-word-preface.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-word-documents.html">Editing documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-word-metadata.html">Synchronizing data</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">OfficeLink</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="officelink-usermanual-visio.html">Visio</a> &raquo;</li>
      
          <li><a href="officelink-usermanual-visio-metadata.html">Synchronizing data</a> &raquo;</li>
      
    <li>Create templates for data synchronization</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/officelink-usermanual-visio-metadata-template.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="vorlagen-zum-datenabgleich-erstellen">
<span id="officelink-usermanual-visio-metadata-template"></span><h1>Create templates for data synchronization<a class="headerlink" href="#vorlagen-zum-datenabgleich-erstellen" title="Permalink to this headline">¶</a></h1>
<p>This chapter describes creating document templates with system variables for data synchronization.</p>
<ul class="simple">
<li><p class="first">Synchronization of document metadata (e.g. title, document No., etc.)</p>
</li>
<li><p class="first">Synchronization of 1:1 referenced objects (e.g. project name of the assigned project)</p>
</li>
</ul>
<div class="section" id="formatbeschreibung-fur-system-variablen">
<span id="officelink-usermanual-visio-metadata-template-format"></span><h2>Format description for system variables<a class="headerlink" href="#formatbeschreibung-fur-system-variablen" title="Permalink to this headline">¶</a></h2>
<p>System variables in Visio documents have the following format: cdb.&lt;Mode&gt;.&lt;Relation&gt;.&lt;Attribute&gt;.&lt;Cardinality&gt;</p>
<dl class="docutils">
<dt><span class="guilabel">Mode</span></dt>
<dd><p class="first">The mode indicates whether a variable may be read from the system exclusively or updated after changing in the document in the system. Valid values for the mode include:</p>
<ul class="last">
<li><p class="first"><span class="guilabel">r</span></p>
<p>Only data transfer from the system possible. The transfered value can be changed in the document, but not transferred to the system. The changed value in the document is replaced again by the system value when transferring the data again.</p>
</li>
<li><p class="first"><span class="guilabel">w</span></p>
<p>Only data transfer to the system possible. This mode can be used to ensure that a document field cannot be changed by a data transfer, though an update is possible in the system (useful for field calculated by the document). This mode cannot be used for 1:N relationships.</p>
</li>
<li><p class="first"><span class="guilabel">rw</span></p>
<p>Data transfer from the system and update in the system possible after changing in the document. This mode cannot be used for 1:N relationships.</p>
</li>
</ul>
</dd>
<dt><span class="guilabel">Relationship</span></dt>
<dd><p class="first">Starting from the document, the relationship indicates the path for the data in the system represented by the variable. The following expressions can be used as a relationship:</p>
<ul class="last">
<li><p class="first"><span class="guilabel">this</span></p>
<p>The constant expression &#8216;this&#8217; is used to specify the attributes of the document itself.</p>
</li>
<li><p class="first"><span class="guilabel">Name of a relationship configured in CIM DATABASE</span></p>
<p>Attributes of referenced objects can be transferred and synchronized via a relationship.</p>
</li>
<li><p class="first"><span class="guilabel">BY_ZNUM_ZIDX_FROM_&lt;table_name&gt;</span></p>
<p>Use an implicit relationship via the attributes z_nummer and z_index. To do so, the expression BY_ZNUM_ZIDX_FROM_&lt;table_name&gt; is specified. table_name indicates the database table used to reference an object implicitly via z_nummer and z_index. The specified database table must contain the attributes z_nummer and z_index and the combination of z_nummer and z_index must be unique.</p>
</li>
</ul>
</dd>
<dt><span class="guilabel">Attribute</span></dt>
<dd><p class="first">The attribute specifies an attribute of a system object referenced by the relationship.</p>
<p>Subject characteristics as attributes of parts:</p>
<p>If a part relationship is specified as a relationship, the subject characteristics of the part can also be specified as an attribute. This can be carried out in a qualified manner via property identification or unqualified using the sequence number:</p>
<ul>
<li><p class="first"><span class="guilabel">Qualified subject characteristics:</span></p>
<p><code class="docutils literal"><span class="pre">_SML_&lt;mm_mk&gt;</span></code></p>
<div class="example container">
<p class="rubric">Visio: data synchronization - subject characteristics qualified</p>
<p>Subject characteristics with the identification &#8216;L&#8217; of the associated part</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>``cdb.r.cdb_doc_to_part._SML_L``
</pre></div>
</div>
</div>
</li>
<li><p class="first"><span class="guilabel">Unqualified subject characteristics:</span></p>
<p><code class="docutils literal"><span class="pre">_SMLN&lt;nummer&gt;</span> <span class="pre">for</span> <span class="pre">characteristic</span> <span class="pre">identifications</span></code></p>
<p><code class="docutils literal"><span class="pre">_SMLV&lt;nummer&gt;</span> <span class="pre">for</span> <span class="pre">characteristic</span> <span class="pre">values</span></code></p>
<p>Property identification and the associated value must have the same number for this.</p>
<div class="example container">
<p class="rubric">Visio: data synchronization - subject characteristics unqualified</p>
<p>Identification and value of the first subject characteristic of the associated part</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>``cdb.r.cdb_doc_to_part._SMLN1``
``cdb.r.cdb_doc_to_part._SMLV1``
</pre></div>
</div>
</div>
</li>
</ul>
<div class="last admonition important">
<p class="first admonition-title">Important</p>
<p class="last">SC attributes cannot be synchronized with write access!</p>
</div>
</dd>
<dt><span class="guilabel">Cardinality</span></dt>
<dd><p class="first">Specifies the cardinality of the relationship. If no cardinality has been specified, cardinality 1 is assumed. The cardinality should be specified explicitly when creating new document templates. The following values can be used for the cardinality:</p>
<ul class="last">
<li><p class="first"><span class="guilabel">1</span></p>
<p>For relationships of the type <code class="docutils literal"><span class="pre">this,</span> <span class="pre">BY_ZNUM_ZIDX_FROM_&lt;table_name&gt;</span></code> and for 1-digit homogeneous relationships.</p>
</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="definition-von-system-variablen">
<span id="officelink-usermanual-visio-metadata-template-definition"></span><h2>Definition of system variables<a class="headerlink" href="#definition-von-system-variablen" title="Permalink to this headline">¶</a></h2>
<p>System variables are defined using a wizard that calls up the OfficeLink toolbar using the <span class="guilabel">[ Manage ]</span> button. The button has to have been enabled beforehand in the settings dialog so that the button is available. The dialog provides the option of creating new variables in the system format on the left side (see <a class="reference internal" href="#officelink-usermanual-visio-metadata-template-format"><span class="std std-ref">Format description for system variables</span></a>). On the right side, all system variables contained in the document are displayed. By marking a variable, the corresponding text field is marked in the Visio document at the same time. The marked variables are removed from the document by pressing the <span class="guilabel">[ Delete variable ]</span> button.</p>
<div class="figure align-center" id="id1">
<span id="officelink-usermanual-visio-metadata-template-definition-dialog"></span><img alt="_images/visio2007_docvar_dialog.png" src="_images/visio2007_docvar_dialog.png" />
<p class="caption"><span class="caption-text">Visio: data synchronization - dialog for creating system variables</span></p>
</div>
<ul>
<li><p class="first"><span class="guilabel">Relationship:</span></p>
<p>Starting from the document, the relationship indicates the path for an attribute of one or more referenced system objects. The catalog provides all document relationships configured in the system, for which the document is the start object. For attributes of the document itself, you have to enter <code class="docutils literal"><span class="pre">this</span></code> in this field.</p>
<p>To use an implicit relationship that is produced via the key attributes document number and index, you have to select <code class="docutils literal"><span class="pre">BY_ZNUM_ZIDX_FROM_</span></code> in this field and select a relation as a data source in the database table field.</p>
</li>
<li><p class="first"><span class="guilabel">Database table:</span></p>
<p>A database table has to be selected only if the special entry <code class="docutils literal"><span class="pre">BY_ZNUM_ZIDX_FROM_</span></code> for implicit relationships has been selected in the relationship field. In the selected relation, the combination of the attributes z_nummer and z_index has to be unique.</p>
</li>
<li><p class="first"><span class="guilabel">Attribute:</span></p>
<p>The attribute specifies an attribute of a system object referenced by the relationship.</p>
</li>
<li><p class="first"><span class="guilabel">Synchronization mode:</span></p>
<p>The mode indicates whether a variable may be read from the system exclusively or may be updated after changing in the document in the system.</p>
<p>r: read only</p>
<p>w: write only</p>
<p>rw: read and write access in CIM DATABASE</p>
</li>
<li><p class="first"><span class="guilabel">CIM DATABASE variable:</span></p>
<p>In this field, the expression generated from the other fields is shown for the system variables to be created. The manual modification of this expression is only required for specifying subject characteristics for part relationships.</p>
</li>
</ul>
<p>When adding the variables by pressing the <span class="guilabel">[ Add variable ]</span> button, the expression shown in the system variable field is reviewed and displays a corresponding error message if invalid. Otherwise, the variables are created as new system variables in the active document and initialized with the <code class="docutils literal"><span class="pre">&lt;Attribut&gt;</span></code> value as a placeholder.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">The system variables can be positioned only in simple Visio &#8216;forms&#8217;. Furthermore, only one system variable can be defined per Visio form. An error message appears if there is an attempt to define a new variable without the simple form being enabled, or if the currently enabled form already contains a variable.</p>
</div>
</div>
<div class="section" id="andern-von-system-variablen">
<span id="officelink-usermanual-visio-metadata-template-change"></span><h2>Modifying system variables<a class="headerlink" href="#andern-von-system-variablen" title="Permalink to this headline">¶</a></h2>
<p>The text fields containing system variables can be modified by clicking in the field to be modified. Then the cursor is in the field and enables free editing.</p>
</div>
<div class="section" id="verwendung-von-system-variablen-im-dokument">
<span id="officelink-usermanual-visio-metadata-template-usage"></span><h2>Using system variables in the document<a class="headerlink" href="#verwendung-von-system-variablen-im-dokument" title="Permalink to this headline">¶</a></h2>
<p>System variables should be identified for the user in the document to avoid accidental deleting or overwriting. The protection of document variables is possible only on condition. One option is to create forms.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">During the data synchronization of variables to the system, attribute changes are also shown if the field cannot be changed by the user interactively according to the mask configuration or would only be able to be changed using a list of options. You have to take this into account when using system variables with write access. If necessary, the validity of the values must be ensured through a corresponding check in the user exit.</p>
</div>
</div>
<div class="section" id="automatisches-aktualisieren-von-metadaten">
<span id="officelink-usermanual-visio-metadata-template-autoupdate"></span><h2>Updating metadata automatically<a class="headerlink" href="#automatisches-aktualisieren-von-metadaten" title="Permalink to this headline">¶</a></h2>
<p>The metadata of all system variables with read access are committed from CDB automatically when loading a document. The conditions for this are that the document:</p>
<ol class="arabic simple">
<li><p class="first">Has been opened in the client in &#8220;Edit&#8221; mode (or directly from Office via &#8220;Load&#8221;)</p>
</li>
<li><p class="first">Is a &#8220;Drawing&#8221; (i.e. has the property &#8220;vorlage_kz&#8221;)</p>
</li>
<li><p class="first">Is not a template (i.e. &#8220;vorlage_kz=0&#8221;)</p>
</li>
</ol>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="officelink-usermanual-word.html" class="btn btn-neutral float-right" title="Word" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="officelink-usermanual-visio-metadata-syncwrite.html" class="btn btn-neutral" title="Metadata synchronization with the system" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, CONTACT Software GmbH.
      Last updated on 25.09.2018.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'15.5.0.9',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>