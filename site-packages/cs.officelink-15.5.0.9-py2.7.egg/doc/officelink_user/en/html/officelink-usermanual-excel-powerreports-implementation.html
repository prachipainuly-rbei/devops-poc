

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Implementation of separate providers &mdash; OfficeLink</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="OfficeLink" href="index.html"/>
        <link rel="up" title="PowerReports" href="officelink-usermanual-excel-powerreports.html"/>
        <link rel="next" title="Activating PowerReports" href="officelink-usermanual-excel-powerreports-activation.html"/>
        <link rel="prev" title="Data sources and data providers" href="officelink-usermanual-excel-powerreports-source-and-provider.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="/doc/en" class="icon fa-book">
            Documentation Portal
          </a>
        

        
          <a href="index.html" class="icon icon-home"> OfficeLink
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="teaser.html">Introduction</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="officelink-usermanual-excel.html">Excel</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-excel-preface.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-excel-documents.html">Editing documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-excel-metadata.html">Synchronizing data</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="officelink-usermanual-excel-powerreports.html">PowerReports</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-outlook.html">Outlook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-outlook-preface.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-outlook-mails.html">E-mails and attachments</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-powerpoint.html">PowerPoint</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-powerpoint-preface.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-powerpoint-documents.html">Editing documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-powerpoint-metadata.html">Synchronizing data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-project.html">Project</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-project-preface.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-project-documents.html">Editing documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-project-sync.html">Project synchronization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-visio.html">Visio</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-visio-preface.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-visio-documents.html">Editing documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-visio-metadata.html">Synchronizing data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-word.html">Word</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-word-preface.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-word-documents.html">Editing documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-word-metadata.html">Synchronizing data</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">OfficeLink</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="officelink-usermanual-excel.html">Excel</a> &raquo;</li>
      
          <li><a href="officelink-usermanual-excel-powerreports.html">PowerReports</a> &raquo;</li>
      
    <li>Implementation of separate providers</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/officelink-usermanual-excel-powerreports-implementation.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="implementierung-eigener-provider">
<span id="officelink-usermanual-excel-powerreports-implementation"></span><h1>Implementation of separate providers<a class="headerlink" href="#implementierung-eigener-provider" title="Permalink to this headline">Â¶</a></h1>
<p>Separate data providers can be stored in any Python customer module. In order to be able to assign separate data providers to a data source, the respective Python modules have to be entered into the <code class="file docutils literal"><span class="pre">default.conf</span></code> file, which belongs to the regarding customer module. If the implementations of separate data providers are in the Python module <code class="file docutils literal"><span class="pre">my_namespace/my_module/PowerReportsCodeSamples.py</span></code>, for example, then the my_namespace.my_module.PowerReportsCodeSamples line has to be added to the <code class="file docutils literal"><span class="pre">my_namespace/my_module/default.conf</span></code> file. The entry makes the contained provider classes available during the assignment to the data source.</p>
<div class="figure align-center" id="id1">
<span id="officelink-usermanual-excel-powerreports-implementation-selectionlist"></span><img alt="_images/excel_powerreports_implementation_selectionlist.png" src="_images/excel_powerreports_implementation_selectionlist.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - list of options for separate provider implementations</span></p>
</div>
<p>Separate data providers are implemented by deriving them from the base class <code class="file docutils literal"><span class="pre">contact.PowerReports.CustomDataProvider</span></code>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cdb.objects.PowerReports</span> <span class="kn">import</span> <span class="o">*</span>
<span class="k">class</span> <span class="nc">ProjectsProvider</span><span class="p">(</span><span class="n">CustomDataProvider</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>Two cardinalities have to be specified for a data provider. The cardinality of the set of results and the cardinality for the call. These cardinalities are defined by the two class variables CARD and CALL_CARD.</p>
<ul>
<li><p class="first"><span class="guilabel">CARD</span></p>
<p>Specifies the result cardinality of a data provider. Valid values are:</p>
<ul>
<li><p class="first"><span class="guilabel">CARD_1</span></p>
<p>For data providers that return an individual data object as a set of results.</p>
</li>
<li><p class="first"><span class="guilabel">CARD_N</span></p>
<p>For data providers that return lists as a set of results.</p>
</li>
</ul>
</li>
<li><p class="first"><span class="guilabel">CALL_CARD</span></p>
<p>The call cardinality defines, among other things, whether a data provider determines the set of results without context or contextually. Context-related data providers are always assigned to a higher-level provider as subproviders and receive the result of the higher-level provider as the first parameter for determining the separate set of results.</p>
<ul>
<li><p class="first"><span class="guilabel">CARD_0</span></p>
<p>For data providers whose set of results is determined without context. For example, a data provider that returns all running projects. Data providers with the call cardinality CARD_0 cannot be assigned as subproviders, but instead are always assigned top level for the data source.</p>
</li>
<li><p class="first"><span class="guilabel">CARD_1</span></p>
<p>For data providers that require exactly one data object of the higher-level provider to determine the separate set of results. For example, a data provider that computes the project progress and other KPIs for a project. Data providers with the cardinality CARD_1 are always assigned to a higher-level provider as subproviders. If the higher-level provider returns a list as a result, the subprovider is individually called up multiple times with each list element. This combination of result cardinality of the higher-level provider and call cardinality of the subordinate provider requires the creation of a special template sheet in the Excel template. You can find additional information for creating these kinds of templates in <a class="reference internal" href="officelink-usermanual-excel-powerreports-creation.html#officelink-usermanual-excel-powerreports-creation"><span class="std std-ref">Creating report templates</span></a>.</p>
</li>
<li><p class="first"><span class="guilabel">CARD_N</span></p>
<p>For data providers that expect a results list from the higher-level data provider to determine the set of results. For example, a provider that returns aggregated information via a list of projects that is returned by the higher-level provider.</p>
</li>
</ul>
</li>
</ul>
<p>The following code example shows a data provider that is to return a list of projects and needs no context for this.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ProjectsProvider</span><span class="p">(</span><span class="n">CustomDataProvider</span><span class="p">):</span>
<span class="hll">    <span class="n">CARD</span>      <span class="o">=</span> <span class="n">CARD_N</span>
</span><span class="hll">    <span class="n">CALL_CARD</span> <span class="o">=</span> <span class="n">CARD_0</span>
</span>    <span class="o">...</span>
</pre></div>
</div>
<p>Unlike the previous example, the data provider presented in the following code example can be used only as a subprovider, because a result object of the higher-level provider is needed for determining results. This kind of provider could, for example, return all ongoing projects for a customer. The customer is the result of the higher-level provider.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ProjectsProvider</span><span class="p">(</span><span class="n">CustomDataProvider</span><span class="p">):</span>
<span class="hll">    <span class="n">CARD</span>      <span class="o">=</span> <span class="n">CARD_N</span>
</span><span class="hll">    <span class="n">CALL_CARD</span> <span class="o">=</span> <span class="n">CARD_1</span>
</span>    <span class="o">...</span>
</pre></div>
</div>
<p>The cardinalities yield how the data providers can be linked to each other. The cardinality of the set of results has to fit with the call cardinality of the subprovider.</p>
<ul>
<li><p class="first"><span class="guilabel">CARD 1 &#8211;&gt; CALL_CARD 1</span></p>
<p>The higher-level provider returns, for example, a project that is used by the subprovider as a parameter for computing its own set of results. This could compute, for example, the project progress and other KPIs for the project.</p>
</li>
<li><p class="first"><span class="guilabel">CARD N &#8211;&gt; CALL_CARD N</span></p>
<p>For example, to compute aggregated data via the results list of the higher-level provider. The subprovider can return no data that refers to individual list elements of the higher-level result, since this relationship is lost during the export and import and cannot be displayed in Excel. In this case, a multi-export configuration has to be used.</p>
</li>
<li><p class="first"><span class="guilabel">CARD N &#8211;&gt; CALL_CARD 1</span> (multi-export special case)</p>
<p>The subprovider is individually called up and exported for every result object of the higher-level provider. With a multi-export configuration, nested lists and complex rows can be displayed in Excel. The Excel data connection for data that is exported via multi-export has to be established during the template creation on a special template sheet. You can find additional information for creating these kinds of templates in <a class="reference internal" href="officelink-usermanual-excel-powerreports-creation.html#officelink-usermanual-excel-powerreports-creation-multiexport"><span class="std std-ref">Displaying complex rows for multi-export data sources</span></a>.</p>
</li>
</ul>
<p>The implementation of a data provider essentially consists of two methods. One method for defining the XML schema and one method for determining the set of results.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ProjectsProvider</span><span class="p">(</span><span class="n">CustomDataProvider</span><span class="p">):</span>
    <span class="n">CARD</span>      <span class="o">=</span> <span class="n">CARD_N</span>
    <span class="n">CALL_CARD</span> <span class="o">=</span> <span class="n">CARD_1</span>
<span class="hll">    <span class="k">def</span> <span class="nf">getSchema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span>        <span class="o">...</span>
<span class="hll">    <span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_result</span><span class="p">,</span> <span class="n">source_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span>        <span class="o">...</span>
</pre></div>
</div>
<div class="section" id="getschema-self">
<span id="officelink-usermanual-excel-powerreports-implementation-getschema"></span><h2>getSchema(self)<a class="headerlink" href="#getschema-self" title="Permalink to this headline">Â¶</a></h2>
<p>Returns the XML schema for establishing the data connection in Excel. The XML schema has to fit with the data returned by the <code class="file docutils literal"><span class="pre">getData</span></code> method. The schema is described by the construction of an object of the type <code class="file docutils literal"><span class="pre">XSDType</span></code>. The cardinality that has to be identical with the result cardinality of the provider is specified as the constructor parameter. With the <code class="file docutils literal"><span class="pre">add_attr</span></code> method, any number of attributes can be subsequently added to the schema object. The data type is specified as the second parameter in the form of a cdb.sqlapi data type. The added attributes do not necessarily have to be in the database; they can also be computed by the provider, but their attribute names must not include any uppercase letters.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ProjectsProvider</span><span class="p">(</span><span class="n">CustomDataProvider</span><span class="p">):</span>
    <span class="n">CARD</span>      <span class="o">=</span> <span class="n">CARD_N</span>
    <span class="n">CALL_CARD</span> <span class="o">=</span> <span class="n">CARD_1</span>
    <span class="k">def</span> <span class="nf">getSchema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="hll">        <span class="n">schema</span> <span class="o">=</span> <span class="n">XSDType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CARD</span><span class="p">)</span>
</span><span class="hll">        <span class="n">schema</span><span class="o">.</span><span class="n">add_attr</span><span class="p">(</span><span class="s1">&#39;cdb_project_id&#39;</span><span class="p">,</span> <span class="n">sqlapi</span><span class="o">.</span><span class="n">SQL_CHAR</span><span class="p">)</span>
</span><span class="hll">        <span class="n">schema</span><span class="o">.</span><span class="n">add_attr</span><span class="p">(</span><span class="s1">&#39;project_name&#39;</span><span class="p">,</span> <span class="n">sqlapi</span><span class="o">.</span><span class="n">SQL_CHAR</span><span class="p">)</span>
</span><span class="hll">        <span class="n">schema</span><span class="o">.</span><span class="n">add_attr</span><span class="p">(</span><span class="s1">&#39;calculated&#39;</span><span class="p">,</span> <span class="n">sqlapi</span><span class="o">.</span><span class="n">SQL_INTEGER</span><span class="p">)</span>
</span>        <span class="o">...</span>
<span class="hll">        <span class="k">return</span> <span class="n">schema</span>
</span></pre></div>
</div>
<p>A relation name or cdb.objects class can optionally be specified in the XSDType constructor as a second parameter. Then the schema object automatically contains all attributes contained in the relation. In the case of a cdb.objects class, all mapped attributes are also contained in the schema object.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="k">def</span> <span class="nf">getSchema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="hll">    <span class="n">schema</span> <span class="o">=</span> <span class="n">XSDType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CARD</span><span class="p">,</span> <span class="s1">&#39;cdbpcs_project&#39;</span><span class="p">)</span>
</span>    <span class="n">schema</span><span class="o">.</span><span class="n">add_attr</span><span class="p">(</span><span class="s1">&#39;calculated&#39;</span><span class="p">,</span> <span class="n">sqlapi</span><span class="o">.</span><span class="n">SQL_INTEGER</span><span class="p">)</span>
    <span class="o">...</span>
    <span class="k">return</span> <span class="n">schema</span>
</pre></div>
</div>
<p>If the schema is based on only one database relation or cdb.objects class, getSchema can also directly return a relation name or a cdb.objects class. In this case, the XML schema is completely and automatically generated from the database schema. In the case of a cdb.objects class, again all mapped attributes are also contained in the XML schema.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="k">def</span> <span class="nf">getSchema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="hll">    <span class="k">return</span> <span class="s2">&quot;cdbpcs_project&quot;</span>
</span></pre></div>
</div>
<p>For data combined by row, the schema can be constructed from the underlying types with the plus operator. For attributes of the same name, a prefix has to be specified as the third parameter in the participating relations that ensures that the attribute names in the XML schema are unique. This prefix is also to be used in the implementation of <code class="file docutils literal"><span class="pre">getData</span></code> when the result objects are being constructed.</p>
<p>The following example shows the construction of a schema for parts, expanded by adding the schema for the associated projects:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="k">def</span> <span class="nf">getSchema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="hll">    <span class="n">schema</span> <span class="o">=</span> <span class="n">XSDType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CARD</span><span class="p">,</span><span class="s1">&#39;teile_stamm&#39;</span><span class="p">)</span>
</span><span class="hll">    <span class="n">schema</span> <span class="o">+=</span> <span class="n">XSDType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CARD</span><span class="p">,</span> <span class="s1">&#39;cdbpcs_project&#39;</span><span class="p">,</span> <span class="s1">&#39;Project_&#39;</span><span class="p">)</span>
</span>    <span class="o">...</span>
    <span class="k">return</span> <span class="n">schema</span>
</pre></div>
</div>
</div>
<div class="section" id="getdata-self-parent-result-source-args-kwargs">
<span id="officelink-usermanual-excel-powerreports-implementation-getdata"></span><h2>getData(self, parent_result, source_args, **kwargs)<a class="headerlink" href="#getdata-self-parent-result-source-args-kwargs" title="Permalink to this headline">Â¶</a></h2>
<p>Returns the report data when calling up a report. The following arguments are transferred to the provider for determining the set of results:</p>
<dl class="docutils">
<dt><span class="guilabel">parent_result</span></dt>
<dd><p class="first last">Set of results of the higher-level provider. If the higher-level provider is the context provider, <code class="file docutils literal"><span class="pre">parent_result</span></code> contains the objects on which the report was called up. Depending on the result cardinality of the higher-level provider, <code class="file docutils literal"><span class="pre">parent_result</span></code> is either of the type <code class="file docutils literal"><span class="pre">ReportDataList</span></code> or <code class="file docutils literal"><span class="pre">ReportData</span></code>. For top-level providers, this parameter is always <code class="file docutils literal"><span class="pre">None</span></code>.</p>
</dd>
<dt><span class="guilabel">source_args</span></dt>
<dd><p class="first last">A dictionary with all arguments from the optionally preceding report dialog. The keys of the dictionaries correspond to the attribute names of the underlying mask configuration, but currently they always consist only of lowercase letters, even if they were defined in the mask with some uppercase letters (in the provider name). For assigning the parameters to the data providers, the attribute names in the mask configuration follow the name schema &lt;Providername&gt;-&lt;Attributname&gt;.</p>
</dd>
<dt><span class="guilabel">kwargs</span></dt>
<dd><p class="first last">All arguments from the optionally preceding report dialog that are addressed to the data provider with the naming convention &lt;Providername&gt;- &lt;Attributname&gt;. The address to the provider is to be removed from the argument name, so that the arguments can be used directly via attribute name. As mentioned above, the attribute names at this place always contain only lowercase letters.</p>
</dd>
</dl>
<p>The report data is returned depending on the result cardinality (CARD) of the provider. A <code class="file docutils literal"><span class="pre">ReportData</span></code> object has to be returned for the result cardinality CARD_1; a <code class="file docutils literal"><span class="pre">ReportDataList</span></code> has to be returned for the result cardinality CARD_N. The construction of this result object is described in the following.</p>
</div>
<div class="section" id="reportdata">
<span id="officelink-usermanual-excel-powerreports-implementation-reportdata"></span><h2>ReportData<a class="headerlink" href="#reportdata" title="Permalink to this headline">Â¶</a></h2>
<p>Result object for data providers with the result cardinality CARD_1.</p>
<p><code class="file docutils literal"><span class="pre">ReportData</span></code> objects are always constructed by specifying the constructing provider as the first parameter. Thus <code class="file docutils literal"><span class="pre">self</span></code> is always transferred as the first parameter. The following example constructs an empty <code class="file docutils literal"><span class="pre">ReportData</span></code> object and returns this as the result.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SampleProvider</span><span class="p">(</span><span class="n">CustomDataProvider</span><span class="p">):</span>
    <span class="n">CARD</span> <span class="o">=</span> <span class="n">CARD_1</span>
    <span class="o">...</span>
    <span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="hll">        <span class="k">return</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>
</div>
<p>The access to the elements of a <code class="file docutils literal"><span class="pre">ReportData</span></code> object corresponds to the usual methods for accessing Python dictionaries. The <code class="file docutils literal"><span class="pre">keys,</span> <span class="pre">values</span></code> and <code class="file docutils literal"><span class="pre">items</span></code> methods are available. Individual attributes are set and read by the index operator.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="hll">    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;cdb_project_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;4711&quot;</span>
</span><span class="hll">    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;project_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Test project&quot;</span>
</span>    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p><code class="file docutils literal"><span class="pre">ReportData</span></code> objects can be directly constructed from a cdb.objects object or sqlapi.Record. For this purpose, the object or record is transferred to the constructor as the second parameter.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="hll">    <span class="n">project</span> <span class="o">=</span> <span class="n">pcs</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;P000001&#39;</span><span class="p">)</span>
</span><span class="hll">    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">)</span>
</span>    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>In addition, any number of fields can be added.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">project</span> <span class="o">=</span> <span class="n">pcs</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;P000001&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">)</span>
<span class="hll">    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;calculated_attribute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">42</span>
</span>    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p><code class="file docutils literal"><span class="pre">ReportData</span></code> objects that are constructed from cdb.objects objects can also return the long texts belonging to the object as a result. For this purpose, a list of long text relations can be specified as a third parameter.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">project</span> <span class="o">=</span> <span class="n">pcs</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;P000001&#39;</span><span class="p">)</span>
<span class="hll">    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;cdbpcs_proj_txt&#39;</span><span class="p">])</span>
</span>    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>For data combined by row, for example, parts with an associated project, <code class="file docutils literal"><span class="pre">ReportData</span></code> objects can be linked with the plus operator. For attributes of the same name, a prefix has to be specified as the third parameter in the participating relations that ensures that the attribute names are unique. The same prefix must be used as the one used for creating the schema in the implementation of <code class="file docutils literal"><span class="pre">getSchema</span></code>. The following example shows the creation of a <code class="file docutils literal"><span class="pre">ReportData</span></code> object from a part, followed by expansion by adding the associated project.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">item</span> <span class="o">=</span> <span class="n">pdd</span><span class="o">.</span><span class="n">Item</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;4711&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="hll">    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
</span><span class="hll">    <span class="n">data</span> <span class="o">+=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">Project</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;Project_&quot;</span><span class="p">)</span>
</span>    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
</div>
<div class="section" id="reportdatalist">
<span id="officelink-usermanual-excel-powerreports-implementation-reportdatalist"></span><h2>ReportDataList<a class="headerlink" href="#reportdatalist" title="Permalink to this headline">Â¶</a></h2>
<p>Result object for data providers with the result cardinality CARD_N.</p>
<p><code class="file docutils literal"><span class="pre">ReportDataList</span></code> objects are always constructed by specifying the constructing provider as the first parameter. The following example constructs an empty <code class="file docutils literal"><span class="pre">ReportDataList</span></code> and returns this as the result.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SampleProvider</span><span class="p">(</span><span class="n">CustomDataProvider</span><span class="p">):</span>
    <span class="n">CARD</span> <span class="o">=</span> <span class="n">CARD_N</span>
    <span class="o">...</span>
    <span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="hll">        <span class="k">return</span> <span class="n">ReportDataList</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>
</div>
<p><code class="file docutils literal"><span class="pre">ReportDataList</span></code> objects consist of a list of <code class="file docutils literal"><span class="pre">ReportData</span></code> objects and provide the usual methods for accessing Python lists to access list elements: <code class="file docutils literal"><span class="pre">append,</span> <span class="pre">count,</span> <span class="pre">extend,</span> <span class="pre">index,</span> <span class="pre">insert,</span> <span class="pre">pop,</span> <span class="pre">remove,</span> <span class="pre">reverse</span></code> and <code class="file docutils literal"><span class="pre">sort</span></code>. Moreover, all list operators can be used. The following example shows how the plus operator can be used to add two list elements, each of which contains a project.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportDataList</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="hll">    <span class="n">data</span> <span class="o">+=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pcs</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;P000001&#39;</span><span class="p">))</span>
</span><span class="hll">    <span class="n">data</span> <span class="o">+=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pcs</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;P000002&#39;</span><span class="p">))</span>
</span>    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>A sqlapi.Record or cdb.objects object can also be added directly as an abbreviated form using the plus operator, without first having to construct a ReportData object yourself.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportDataList</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="hll">    <span class="n">data</span> <span class="o">+=</span> <span class="n">pcs</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;P000001&#39;</span><span class="p">)</span>
</span><span class="hll">    <span class="n">data</span> <span class="o">+=</span> <span class="n">pcs</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;P000002&#39;</span><span class="p">)</span>
</span>    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>ReportDataList objects can be constructed directly from a list of cdb.objects objects or a sqlapi.RecordSet2. In doing so, ReportData objects are automatically constructed and added for every list element.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="hll">    <span class="n">projects</span> <span class="o">=</span> <span class="n">pcs</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">Query</span><span class="p">(</span><span class="s2">&quot;status&gt;0&quot;</span><span class="p">)</span>
</span><span class="hll">    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportDataList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">projects</span><span class="p">)</span>
</span>    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>A list of long text relations to be included can be specified as a third parameter during the construction from cdb.objects objects.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">projects</span> <span class="o">=</span> <span class="n">pcs</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">Query</span><span class="p">(</span><span class="s2">&quot;status&gt;0&quot;</span><span class="p">)</span>
<span class="hll">    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportDataList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">projects</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;cdbpcs_proj_txt&#39;</span><span class="p">])</span>
</span>    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>During the construction of results lists, take into account that the list elements must not be heterogeneous. It is also not possible, for example, to return projects and documents mixed in a ReportDataList.</p>
</div>
<div class="section" id="getclass-self">
<span id="officelink-usermanual-excel-powerreports-implementation-getclass"></span><h2>getClass(self)<a class="headerlink" href="#getclass-self" title="Permalink to this headline">Â¶</a></h2>
<p>Gives the cdb.objects class back to the returned data if the provider data is returned in the form of cdb.objects objects. If the data is not constructed from cdb.objects objects, this method is not implemented. The following example shows the implementation for a provider that returns projects as a result.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getClass</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">pcs</span><span class="o">.</span><span class="n">Projects</span><span class="o">.</span><span class="n">Project</span>
</pre></div>
</div>
<p>If a separate provider returns combined data, such as parts with a project, specify the type of the primary object. The primary object is the initial object that was used for the ReportData construction.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">item</span> <span class="o">=</span> <span class="n">pdd</span><span class="o">.</span><span class="n">Item</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;4711&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="hll">    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="c1"># &lt;- Primary object</span>
</span>    <span class="n">data</span> <span class="o">+=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">Project</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;Project_&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
<span class="k">def</span> <span class="nf">getClass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="hll">    <span class="k">return</span> <span class="n">pdd</span><span class="o">.</span><span class="n">Item</span> <span class="c1"># &lt;- Primary object</span>
</span></pre></div>
</div>
<p>The implementation of <code class="file docutils literal"><span class="pre">getClass</span></code> enables the use of relationship providers as subproviders to separate providers. Thus separate providers can be directly integrated into the object model of the cdb.objects framework. For example, if a separate provider returns projects, all relationships proceeding from projects can be appended to the separate provider as subproviders. Therefore open issues, tasks or documents, for example, can be integrated into the data source in this way for the self-determined projects without additional programming.</p>
<p>Moreover, by this method the report framework recognizes cdb.objects-based providers, so that if implementation is missing, for example, the parameters described in <a class="reference internal" href="officelink-usermanual-excel-powerreports-source-and-provider.html#officelink-usermanual-excel-powerreports-source-and-provider-provider-parameter"><span class="std std-ref">Provider parameters</span></a> are not automatically created.</p>
</div>
<div class="section" id="getdefaultparameters-self">
<span id="officelink-usermanual-excel-powerreports-implementation-getdefaultparameters"></span><h2>getDefaultParameters(self)<a class="headerlink" href="#getdefaultparameters-self" title="Permalink to this headline">Â¶</a></h2>
<p>Returns a dictionary with parameter names and default values. These are automatically created when a provider of this type is created, and they can be subsequently adjusted in the &#8216;Parameters&#8217; tab of the provider. The parameter names returned through this method can be used in the provider implementation in order to make the provider configurable in the application context. In this manner, you can implement universal and configurable data providers yourself.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getDefaultParameters</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;My Parameter&quot;</span> <span class="p">:</span> <span class="s2">&quot;My Value&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>cdb.objects-based data providers also always receive the following default parameters automatically, insofar as the <code class="file docutils literal"><span class="pre">getClass</span></code> method was implemented.</p>
<div class="figure align-center" id="id2">
<span id="officelink-usermanual-excel-powerreports-implementation-defaultparameters"></span><img alt="_images/excel_powerreports_implementation_defaultparameters.png" src="_images/excel_powerreports_implementation_defaultparameters.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - default parameters</span></p>
</div>
<p>Assessment of these parameters takes place automatically; you do not need to implement it yourself for separate providers.</p>
<p>Access to separate parameters of a provider takes place via the <code class="file docutils literal"><span class="pre">getParameter(name)</span></code> method.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="hll">    <span class="n">param</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParameter</span><span class="p">(</span><span class="s2">&quot;My Parameter&quot;</span><span class="p">)</span>
</span><span class="hll">    <span class="k">if</span> <span class="n">param</span> <span class="o">==</span> <span class="s2">&quot;My Value&quot;</span><span class="p">:</span>
</span>        <span class="o">...</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="o">...</span>
        <span class="o">...</span>
</pre></div>
</div>
</div>
<div class="section" id="getargumentdefinitions-self">
<span id="officelink-usermanual-excel-powerreports-implementation-getargumentdefinitions"></span><h2>getArgumentDefinitions(self)<a class="headerlink" href="#getargumentdefinitions-self" title="Permalink to this headline">Â¶</a></h2>
<p>The set of results for data providers can be affected by a preceding report dialog (see also <a class="reference internal" href="officelink-usermanual-excel-powerreports-creation.html#officelink-usermanual-excel-powerreports-creation-dialogs"><span class="std std-ref">Creating report dialogs</span></a>). Usually, the user then runs interactive queries with additional restrictive search conditions. So that later, it is possible to trace which data are represented in a report, and thus which query parameters led to the specific result, it is frequently advisable that the query parameters used be included in the report.</p>
<p>The <span class="guilabel">getArgumentDefinitions</span> method can be implemented for this purpose. This method returns a dictionary with parameter names and the associated data types. The returned argument names are automatically added to the XML schema with the specified data type under the schema name <span class="guilabel">Arguments</span> and are exported along with the data export.</p>
<p>The argument names are automatically expanded to include the provider names so that a unique assignment to the data provider is ensured (similar to the dialog configuration as described in <a class="reference internal" href="officelink-usermanual-excel-powerreports-creation.html#officelink-usermanual-excel-powerreports-creation-dialogs"><span class="std std-ref">Creating report dialogs</span></a>).</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">The attribute names may not contain any uppercase letters.</p>
</div>
<p>Usage in detail, exemplified by a report on projects with a preceding dialog for optional constraint to a specific category (the dialog contains the attribute <span class="guilabel">projects category</span>, making it possible to enter a category evaluated by the <span class="guilabel">projects</span> data provider):</p>
<div class="figure align-center" id="id3">
<span id="officelink-usermanual-excel-powerreports-implementation-getargumentdefinitions-dlg"></span><img alt="_images/excel_powerreports_implementation_getargumentdefinitions_dlg.png" src="_images/excel_powerreports_implementation_getargumentdefinitions_dlg.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - report dialog using a project category query as an example</span></p>
</div>
<p>The data provider implementation displayed in the following code example evaluates the queried category, thereby restricting the set of results. The <span class="guilabel">getArgumentDefinitions</span> method returns the <span class="guilabel">category</span> attribute and communicates to the PowerReports Framework that this argument should also be exported.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Projekte</span><span class="p">(</span><span class="n">CustomDataProvider</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">getSchema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;cdbpcs_project&quot;</span>
    <span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="hll">        <span class="n">category</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span> <span class="c1"># Parameter from dialog</span>
</span>        <span class="n">cond</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">category</span><span class="p">:</span>
            <span class="n">cond</span> <span class="o">=</span> <span class="s2">&quot;category=&#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">category</span>
        <span class="k">return</span> <span class="n">ReportDataList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pcs</span><span class="o">.</span><span class="n">Projects</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">Query</span><span class="p">(</span><span class="n">cond</span><span class="p">))</span>
<span class="hll">    <span class="k">def</span> <span class="nf">getArgumentDefinitions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;category&quot;</span> <span class="p">:</span> <span class="n">sqlapi</span><span class="o">.</span><span class="n">SQL_CHAR</span><span class="p">}</span>
</span></pre></div>
</div>
<p>Due to the above implementation of <span class="guilabel">getArgumentDefinitions</span>, the attribute used in the report dialog is available under <span class="guilabel">Arguments</span> and can be used in the data connection for the Excel template.</p>
<div class="figure align-center" id="id4">
<span id="officelink-usermanual-excel-powerreports-implementation-getargumentdefinitions-schematree"></span><img alt="_images/excel_powerreports_implementation_getargumentdefinitions_schematree.png" src="_images/excel_powerreports_implementation_getargumentdefinitions_schematree.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - XML schema for arguments</span></p>
</div>
<p>After the data connection is created, reports contain the search condition used for the project category.</p>
<div class="figure align-center" id="id5">
<span id="officelink-usermanual-excel-powerreports-implementation-getargumentdefinitions-result1"></span><img alt="_images/excel_powerreports_implementation_getargumentdefinitions_result1.png" src="_images/excel_powerreports_implementation_getargumentdefinitions_result1.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - report with a restricted search condition (1)</span></p>
</div>
<p>The search condition can be modified directly within the report and the <span class="guilabel">report update</span> link function can be subsequently called up.</p>
<p>The report is updated with the modified search conditions, without these needing to be called up again from the system.</p>
<div class="figure align-center" id="id6">
<span id="officelink-usermanual-excel-powerreports-implementation-getargumentdefinitions-result2"></span><img alt="_images/excel_powerreports_implementation_getargumentdefinitions_result2.png" src="_images/excel_powerreports_implementation_getargumentdefinitions_result2.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - report with a restricted search condition (2)</span></p>
</div>
</div>
<div class="section" id="hinzufugen-weiterer-hyperlinks">
<span id="officelink-usermanual-excel-powerreports-implementation-hyperlinks"></span><h2>Adding additional hyperlinks<a class="headerlink" href="#hinzufugen-weiterer-hyperlinks" title="Permalink to this headline">Â¶</a></h2>
<p>Hyperlinks are created automatically for the objects returned by a provider, dependent upon the provider configuration. If these objects are to contain further links to referenced objects, these must be explicitly added. Note that the XSD schema must be expanded accordingly. Creation of hyperlinks is carried out with the <code class="file docutils literal"><span class="pre">MakeReportURL</span></code> method. The following example shows how a hyperlink is added for the assigned project of a part.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getSchema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">XSDType</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;teile_stamm&#39;</span><span class="p">)</span>
<span class="hll">    <span class="n">t</span><span class="o">.</span><span class="n">add_attr</span><span class="p">(</span><span class="s2">&quot;project_hyperlink&quot;</span><span class="p">,</span> <span class="n">sqlapi</span><span class="o">.</span><span class="n">SQL_CHAR</span><span class="p">)</span>
</span>    <span class="k">return</span> <span class="n">t</span>
<span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">item</span> <span class="o">=</span> <span class="n">pdd</span><span class="o">.</span><span class="n">Item</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;4711&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
<span class="hll">    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;project_hyperlink&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">MakeReportURL</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">Project</span><span class="p">)</span>
</span>    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>In the example above, the hyperlink is created with the CDB_ShowObject default action and the configured object description from the class directory.</p>
<p>As the second and third parameters, the <code class="file docutils literal"><span class="pre">MakeReportURL</span></code> method can be passed to any other action and to a label to be displayed. If an attribute name of the object is specified as a label, the value of this attribute is used. Otherwise, the specified character string is invariably used as the label.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">item</span> <span class="o">=</span> <span class="n">pdd</span><span class="o">.</span><span class="n">Item</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;4711&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
<span class="hll">    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;project_hyperlink&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MakeReportURL</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">Project</span><span class="p">,</span> <span class="s2">&quot;CDB_Modify&quot;</span><span class="p">,</span> <span class="s2">&quot;project_name&quot;</span><span class="p">)</span>
</span>    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>In the case of combined data, the hyperlinks are automatically created for the primary object only. The following example shows report data for a part, expanded by the data of the associated project. No hyperlink is automatically created for the project object in this case. If a hyperlink is to be included in the project, it must be added manually as described previously.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent_result</span><span class="p">,</span><span class="n">source_args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">item</span> <span class="o">=</span> <span class="n">pdd</span><span class="o">.</span><span class="n">Item</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;4711&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="hll">    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>  <span class="c1"># &lt;- Primary object</span>
</span>    <span class="n">data</span> <span class="o">+=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">Project</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;Project_&quot;</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;project_hyperlink&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MakeReportURL</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">Project</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
</div>
<div class="section" id="hinzufugen-von-bilddateien">
<span id="officelink-usermanual-excel-powerreports-implementation-images"></span><h2>Adding image files<a class="headerlink" href="#hinzufugen-von-bilddateien" title="Permalink to this headline">Â¶</a></h2>
<p>If a data provider is to return dynamic image contents (see also <a class="reference internal" href="officelink-usermanual-excel-powerreports-creation.html#officelink-usermanual-excel-powerreports-creation-dynamic-images"><span class="std std-ref">Displaying dynamic image contents</span></a>), then the XSD schema must first be expanded accordingly, as in the previous chapter.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getSchema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="n">XSDType</span><span class="p">(</span><span class="n">CARD_N</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="n">teile_stamm</span><span class="s1">&#39;)</span>
<span class="hll">    <span class="n">schema</span><span class="o">.</span><span class="n">add_attr</span><span class="p">(</span><span class="s1">&#39;cdbxml_image_preview&#39;</span><span class="p">,</span> <span class="n">sqlapi</span><span class="o">.</span><span class="n">SQL_CHAR</span><span class="p">)</span>
</span>    <span class="k">return</span> <span class="n">schema</span>
</pre></div>
</div>
<p>Image links are added via the <span class="guilabel">add_image</span> method.</p>
<p class="rubric">add_image(self, image=None, attr_name=&#8217;cdbxml_image&#8217;, hyperlink=&#8217;openfile&#8217;, <strong>args</strong>)</p>
<dl class="docutils">
<dt><span class="guilabel">image</span></dt>
<dd><p class="first">Possible values:</p>
<ul class="last simple">
<li><p class="first">CDB_File object:</p>
<ul>
<li><p class="first">for example CDB_File.ByKeys(cdb_object_id=&#8217;...&#8217;)</p>
</li>
<li><p class="first">The file is transferred together with the other report data.</p>
</li>
</ul>
</li>
<li><p class="first">Object ID of a CDB_File object:</p>
<ul>
<li><p class="first">For example, some_preview_file_obj.cdb_object_id</p>
</li>
<li><p class="first">The file is transferred together with the other report data.</p>
</li>
</ul>
</li>
<li><p class="first">Simple path:</p>
<ul>
<li><p class="first">For example, &#8220;C:\temp\image.jpg&#8221;</p>
</li>
<li><p class="first">The file is transferred together with the other report data.</p>
</li>
</ul>
</li>
<li><p class="first">Absolute URI path:</p>
<ul>
<li><p class="first">For example, &#8220;<a class="reference external" href="file:///C">file:///C</a>:\temp\image.jpg&#8221;</p>
</li>
<li><p class="first">The file is <span class="guilabel">not</span> transferred to the other report data, but rather later imported directly from the link during report generation. Of course, you have to ensure that the respective machine compiling the report has access to this path (e.g. network path).</p>
</li>
</ul>
</li>
<li><p class="first">HTTP path:</p>
<ul>
<li><p class="first">For example, &#8220;<a class="reference external" href="http://local.myserver.com/image.jpg">http://local.myserver.com/image.jpg</a>&#8220;</p>
</li>
<li><p class="first">The file is <span class="guilabel">not</span> transferred to the other report data, but rather later imported directly from the link during report generation. Of course, here too, ensure that the respective machine compiling the report has access to this Internet path.</p>
</li>
</ul>
</li>
</ul>
</dd>
<dt><span class="guilabel">attr_name</span></dt>
<dd><p class="first last">The attribute previously used to expand the XSD schema at another location (see <span class="guilabel">add_attr</span>).</p>
</dd>
<dt><span class="guilabel">hyperlink</span></dt>
<dd><p class="first last">By default, every image in the PowerReport is connected with a hyperlink that points directly to the local image file. By clicking on it, one usually sees the image in its (enlarged) original state in Internet Explorer.</p>
</dd>
</dl>
<p>The following example shows how to add an image file.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_result</span><span class="p">,</span> <span class="n">source_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">item</span> <span class="o">=</span> <span class="n">pdd</span><span class="o">.</span><span class="n">Item</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;4711&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">_getPreviewImageFile</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>  <span class="c1"># some custom method for retrieving regarding preview images</span>
    <span class="n">data</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;cdbxml_image_preview&#39;</span><span class="p">)</span>
<span class="hll">    <span class="k">return</span> <span class="n">data</span>
</span></pre></div>
</div>
<p>An additional example shows how to install your own additional hyperlinks.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_result</span><span class="p">,</span> <span class="n">source_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">item</span> <span class="o">=</span> <span class="n">pdd</span><span class="o">.</span><span class="n">Item</span><span class="o">.</span><span class="n">ByKeys</span><span class="p">(</span><span class="s1">&#39;4711&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">_getPreviewImageFile</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>  <span class="c1"># some custom method for retrieving regarding preview images</span>
    <span class="n">hyperlink</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">MakeURL</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">plain</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="hll">    <span class="n">data</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;cdbxml_image_preview&#39;</span><span class="p">,</span> <span class="n">hyperlink</span><span class="p">)</span>
</span><span class="hll">    <span class="k">return</span> <span class="n">data</span>
</span></pre></div>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">When updating a PowerReport, image files are <span class="guilabel">not</span> also updated.</p>
</div>
</div>
<div class="section" id="hinzufugen-von-hierarchieinformationen-bei-hierarchischen-daten">
<span id="officelink-usermanual-excel-powerreports-implementation-indentation"></span><h2>Adding hierarchy information for hierarchical data<a class="headerlink" href="#hinzufugen-von-hierarchieinformationen-bei-hierarchischen-daten" title="Permalink to this headline">Â¶</a></h2>
<p>Hierarchical data, such as product structures or task structures, can be correspondingly represented in PowerReports. Hierarchy levels can be expanded or collapsed in PowerReports and can be color-coded and indented for better overview.</p>
<div class="figure align-center" id="id7">
<span id="officelink-usermanual-excel-powerreports-implementation-indentation-pic"></span><img alt="_images/excel_powerreports_implementation_indentation.png" src="_images/excel_powerreports_implementation_indentation.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - hierarchical representation using the product structure as an example</span></p>
</div>
<p>To represent hierarchical data, the Excel link requires information regarding the hierarchy depth. This information is imparted to the link through a further attribute with the fixed name <code class="file docutils literal"><span class="pre">cdbxml_level</span></code>.</p>
<p>Using the product structure as an example, the following code shows how <code class="file docutils literal"><span class="pre">cdbxml_level</span></code> is added to the schema and how it can be added during data export. Note that the <code class="file docutils literal"><span class="pre">getComponents2</span></code> method used in the example to determine the product structure is not part of a system standard distribution. Therefore, the code can not be copied for a separate provider without additional adjustments.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getSchema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">XSDType</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="s2">&quot;einzelteile&quot;</span><span class="p">)</span>
<span class="hll">    <span class="n">t</span><span class="o">.</span><span class="n">add_attr</span><span class="p">(</span><span class="s2">&quot;cdbxml_level&quot;</span><span class="p">,</span> <span class="n">sqlapi</span><span class="o">.</span><span class="n">SQL_INTEGER</span><span class="p">)</span>
</span>    <span class="k">return</span> <span class="n">t</span>
<span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_result</span><span class="p">,</span> <span class="n">source_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">item</span> <span class="o">=</span> <span class="n">parent_result</span><span class="o">.</span><span class="n">getObject</span><span class="p">()</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">ReportDataList</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="c1"># Custom method getComponents2 provides product structure tuples containing item and depth</span>
    <span class="k">for</span> <span class="n">lev</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">getComponents2</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
        <span class="n">d</span><span class="p">[</span><span class="s2">&quot;cdbxml_level&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lev</span>
<span class="hll">        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</span>    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
<p>You can find the description for creating Excel templates with representation of hierarchical data in <a class="reference internal" href="officelink-usermanual-excel-powerreports-creation.html#officelink-usermanual-excel-powerreports-creation-indentation"><span class="std std-ref">Displaying hierarchical data</span></a>.</p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="officelink-usermanual-excel-powerreports-activation.html" class="btn btn-neutral float-right" title="Activating PowerReports" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="officelink-usermanual-excel-powerreports-source-and-provider.html" class="btn btn-neutral" title="Data sources and data providers" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, CONTACT Software GmbH.
      Last updated on 25.09.2018.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'15.5.0.9',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>