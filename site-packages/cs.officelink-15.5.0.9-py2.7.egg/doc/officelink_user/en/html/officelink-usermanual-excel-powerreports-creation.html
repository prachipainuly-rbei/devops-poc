

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Creating report templates &mdash; OfficeLink</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="OfficeLink" href="index.html"/>
        <link rel="up" title="PowerReports" href="officelink-usermanual-excel-powerreports.html"/>
        <link rel="next" title="Running PowerReports" href="officelink-usermanual-excel-powerreports-execution.html"/>
        <link rel="prev" title="Activating PowerReports" href="officelink-usermanual-excel-powerreports-activation.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="/doc/en" class="icon fa-book">
            Documentation Portal
          </a>
        

        
          <a href="index.html" class="icon icon-home"> OfficeLink
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="teaser.html">Introduction</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="officelink-usermanual-excel.html">Excel</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-excel-preface.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-excel-documents.html">Editing documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-excel-metadata.html">Synchronizing data</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="officelink-usermanual-excel-powerreports.html">PowerReports</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-outlook.html">Outlook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-outlook-preface.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-outlook-mails.html">E-mails and attachments</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-powerpoint.html">PowerPoint</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-powerpoint-preface.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-powerpoint-documents.html">Editing documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-powerpoint-metadata.html">Synchronizing data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-project.html">Project</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-project-preface.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-project-documents.html">Editing documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-project-sync.html">Project synchronization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-visio.html">Visio</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-visio-preface.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-visio-documents.html">Editing documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-visio-metadata.html">Synchronizing data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="officelink-usermanual-word.html">Word</a><ul>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-word-preface.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-word-documents.html">Editing documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="officelink-usermanual-word-metadata.html">Synchronizing data</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">OfficeLink</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="officelink-usermanual-excel.html">Excel</a> &raquo;</li>
      
          <li><a href="officelink-usermanual-excel-powerreports.html">PowerReports</a> &raquo;</li>
      
    <li>Creating report templates</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/officelink-usermanual-excel-powerreports-creation.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="reportvorlagen-erstellen">
<span id="officelink-usermanual-excel-powerreports-creation"></span><h1>Creating report templates<a class="headerlink" href="#reportvorlagen-erstellen" title="Permalink to this headline">¶</a></h1>
<p class="rubric">New reports are created supported by the Excel link in three steps:</p>
<ol class="arabic">
<li><p class="first"><span class="guilabel">Selecting data sources</span></p>
<p>The data source is selected using the link function <span class="guilabel">[ Select data source ]</span>.</p>
<p>A dialog is displayed for selecting a data source configured in the system.</p>
<div class="figure align-center" id="id1">
<span id="officelink-usermanual-excel-powerreports-creation-sourcedialog"></span><img alt="_images/excel_powerreports_creation_sourcedialog.png" src="_images/excel_powerreports_creation_sourcedialog.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - selection dialog for data sources</span></p>
</div>
</li>
<li><p class="first"><span class="guilabel">Establish data connection and design layout</span></p>
<p>After selecting the data source, the associated XSD schema is loaded and displayed. The XSD schema is used to establish the data connection. The data connection is established by dragging and dropping schema elements to the desired position in the Excel sheet. Here, you can position individual attributes as well as complete objects at once.</p>
<div class="figure align-center" id="id2">
<span id="officelink-usermanual-excel-powerreports-creation-dragdrop"></span><img alt="_images/excel_powerreports_creation_dragdrop.png" src="_images/excel_powerreports_creation_dragdrop.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Establishing data connection using drag and drop</span></p>
</div>
</li>
<li><p class="first"><span class="guilabel">Save document as a report template</span></p>
<p>Finally, the newly created report has to be saved as a report template for the data source. You can do so using the link function <span class="guilabel">[ Create template ]</span>.</p>
<p>Report templates are attached in the system to the respective report directly as files. Here, you can create multiple language-specific templates for one and the same report (see <a class="reference internal" href="#officelink-usermanual-excel-powerreports-creation-multilang"><span class="std std-ref">Creating language-specific reports</span></a>).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since report templates are not created as separate documents but are rather directly attached to the reports, report templates cannot be opened later via the <span class="guilabel">[ Load ]</span> function of the link for re-editing. You can open for re-editing either in the client (e.g. in the project overview) or after running a report via the <span class="guilabel">[ Edit template ]</span> function.</p>
</div>
<p>After successfully creating the file, the report template is assigned to the data source automatically. The report can then be called up immediately. Depending on the data source, this can be done context-free or in the pop-up menu of a corresponding object for the report creator.</p>
<p>All reports created for a data source are listed in the reports folder of a data source. There, you can adjust the authorizations, the title of the report and, if applicable, a preceding dialog. As an example, figure 32 shows the project portfolio report for the data source of the same name. Any number of reports with varying characteristics and in any of the different language versions can be created for a data source.</p>
<div class="figure align-center" id="id3">
<span id="officelink-usermanual-excel-powerreports-creation-reportoverview"></span><img alt="_images/excel_powerreports_creation_reportoverview.png" src="_images/excel_powerreports_creation_reportoverview.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Report for data source</span></p>
</div>
<p>The report title and a preceding dialog, if applicable, can be configured in the data sheet for assigning a template to the data source. The <code class="file docutils literal"><span class="pre">Authorizations</span></code> tab controls the visibility of reports in the report selection dialog. The report creator is authorized automatically by a corresponding assignment upon creation. Other users can call up the report only after they have also become authorized by a role assignment or by direct personal assignment.</p>
<p>Furthermore, various additional settings for the type of the report generation and its layout can be configured in the data sheet (see <a class="reference internal" href="officelink-usermanual-excel-powerreports-execution.html#officelink-usermanual-excel-powerreports-execution-selectionconfig"><span class="std std-ref">Selection configuration</span></a>).</p>
</li>
</ol>
<div class="section" id="reportdialoge-erstellen">
<span id="officelink-usermanual-excel-powerreports-creation-dialogs"></span><h2>Creating report dialogs<a class="headerlink" href="#reportdialoge-erstellen" title="Permalink to this headline">¶</a></h2>
<p>A report can be optionally preceded by a dialog that asks the user to set parameters that can be forwarded to the data providers when calling up a report and influence the data retrieval there. This always useful if users are to be able to influence the report result by making their own entries. For example, by entering a time period to be considered or other filtering condition in combination with SimpleQuery data providers.</p>
<div class="figure align-center" id="id4">
<span id="officelink-usermanual-excel-powerreports-creation-dialogs-predialog"></span><img alt="_images/excel_powerreports_creation_dialogs_predialog.png" src="_images/excel_powerreports_creation_dialogs_predialog.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - report dialog for querying projects</span></p>
</div>
<p>The parameters are addressed to data providers by naming conventions for the attribute names of the mask fields: &lt;Providername&gt;-&lt;Attributname&gt;, where the attribute names must not contain any capital letters. The relation field of the mask field configuration remains empty.</p>
<div class="figure align-center" id="id5">
<span id="officelink-usermanual-excel-powerreports-creation-dialogs-addressing"></span><img alt="_images/excel_powerreports_creation_dialogs_addressing.png" src="_images/excel_powerreports_creation_dialogs_addressing.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - addressing the dialog fields to data provider as parameters</span></p>
</div>
<p>The options for setting parameters of the universal standard providers using dialogs can be found in <a class="reference internal" href="officelink-usermanual-excel-powerreports-source-and-provider.html#officelink-usermanual-excel-powerreports-source-and-provider-provider-details"><span class="std std-ref">Types of providers in detail</span></a> for the respective provider type.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If fields are changed, deleted or added in the report dialogs, note that the XML schema has to be updated in the report templates that use the respective dialog.</p>
</div>
<p>Moreover, each dialog can be supplemented by the option to save all presettings. This can be used to potentially prevent repeated entries when re-running reports. To achieve this, you must add three elements to the dialog in question: the 2 (hidden, but which identify the respective report) text fields <span class="guilabel">cdbxml_source_name</span> and <span class="guilabel">cdbxml_report_title</span>; 1 button which triggers the component <span class="guilabel">cdbxml_set_defaults</span> when pushed (see <a class="reference internal" href="#officelink-usermanual-excel-powerreports-creation-dialogs-predialog-set-defaults"><span class="std std-ref">Excel: PowerReports - Saving the entry values of report dialogs</span></a>).</p>
<div class="figure align-center" id="id6">
<span id="officelink-usermanual-excel-powerreports-creation-dialogs-predialog-set-defaults"></span><img alt="_images/excel_powerreports_creation_dialogs_predialog_set_defaults.png" src="_images/excel_powerreports_creation_dialogs_predialog_set_defaults.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Saving the entry values of report dialogs</span></p>
</div>
</div>
<div class="section" id="darstellung-hierarchischer-daten">
<span id="officelink-usermanual-excel-powerreports-creation-indentation"></span><h2>Displaying hierarchical data<a class="headerlink" href="#darstellung-hierarchischer-daten" title="Permalink to this headline">¶</a></h2>
<p>In PowerReports, data organized in a hierarchical manner can be displayed accordingly. Typical examples of hierarchical data are product structures or task structures.</p>
<p>A prerequisite for the hierarchical representation is that the data provider provides the hierarchy information in the attribute <code class="file docutils literal"><span class="pre">cdbxml_level</span></code>. If this prerequisite is met, the hierarchy levels can be expanded or collapsed in the PowerReport and color-coded and indented for a better overview.</p>
<p>To create a list organized in a hierarchical manner, the attribute <code class="file docutils literal"><span class="pre">cdbxml_level</span></code> must be contained in the list. Ideally, this attribute is appended to the end of the header and set as invisible after completing the layout work by setting the column width to 0. If the attribute <code class="file docutils literal"><span class="pre">cdbxml_level</span></code> is contained in the list, the results table is structured automatically using Excel functions, as illustrated in the figure below in the left edge.</p>
<div class="figure align-center" id="id7">
<span id="officelink-usermanual-excel-powerreports-creation-indentation-example-layout"></span><img alt="_images/excel_powerreports_creation_indentation_example_layout.png" src="_images/excel_powerreports_creation_indentation_example_layout.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - hierarchical representation using the product structure as an example</span></p>
</div>
<p>This organization can be additionally highlighted by indenting any column and by color-coding. For this purpose, you have to add a specific expression in each of the column labels of the <code class="file docutils literal"><span class="pre">cdbxml_level</span></code> attribute. The expressions have to be separated from each other by a colon. Indentation of a column:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>indent(column)
</pre></div>
</div>
<p>Color coding:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>colorize(&lt;rgb_start_color&gt;),(&lt;rgb_offset&gt;)
</pre></div>
</div>
<p><code class="file docutils literal"><span class="pre">column</span></code> specifies the column index in which the indentations are to be carried out.</p>
<p><code class="file docutils literal"><span class="pre">rgb_start_color</span></code> specifies the start color as a RGB color code for the hierarchy level 0. For the levels below that, the row color is determined by adding the <code class="file docutils literal"><span class="pre">rgb_offsets</span></code>.</p>
<div class="example container">
<p class="rubric">Excel: PowerReports - hierarchical representation with indentation of the first column and color coding</p>
<p>Only indentation of the 1st column:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>level:indent(1)
</pre></div>
</div>
<p>Indentation of the 1st column + blue color coding:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>level:colorize(230,230,255),(20,15,12):indent(1)
</pre></div>
</div>
</div>
<p>The expression level:colorize(230,230,255),(20,15,12):indent(1), for example, results in the following representation.</p>
<div class="figure align-center" id="id8">
<span id="officelink-usermanual-excel-powerreports-creation-indentation-example-report"></span><img alt="_images/excel_powerreports_creation_indentation_example_report.png" src="_images/excel_powerreports_creation_indentation_example_report.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - hierarchical representation with indentation of the first column and color coding</span></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Groupings with the setting &#8216;Main rows below detail data&#8217; are displayed in Excel by default. However, the user usually prefers them above the detail data, as shown in the example above. Therefore, make sure that this setting is disabled when creating the PowerReport template (<span class="menuselection">Data ‣ Organization ‣ Settings</span>).</p>
</div>
<div class="figure align-center" id="id9">
<span id="officelink-usermanual-excel-powerreports-creation-indentation-example-settings"></span><img alt="_images/excel_powerreports_creation_indentation_example_settings.png" src="_images/excel_powerreports_creation_indentation_example_settings.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - hierarchical representation - grouping settings</span></p>
</div>
</div>
<div class="section" id="darstellung-dynamischer-spaltentitel-in-listen">
<span id="officelink-usermanual-excel-powerreports-creation-dynamic-headers"></span><h2>Displaying dynamic column titles in lists<a class="headerlink" href="#darstellung-dynamischer-spaltentitel-in-listen" title="Permalink to this headline">¶</a></h2>
<p>In PowerReports, you have the option to dynamically assign values to the column titles of lists that are filled by providers. The PowerReport is used as an example:</p>
<div class="figure align-center" id="id10">
<span id="officelink-usermanual-excel-powerreports-creation-dynamic-headers-example-a"></span><img alt="_images/excel_powerreports_creation_dynamic_headers_example_a.png" src="_images/excel_powerreports_creation_dynamic_headers_example_a.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - displaying dynamic column titles</span></p>
</div>
<p>This PowerReport for displaying the employee workload shows a time period specified by the user before generating in a list. Afterwards, the time period can be changed in the field highlighted in red and the PowerReport can be updated. This makes the column titles dependent on the time period since they display the respective calendar weeks. This is implemented by adding an additional provider (&#8216;PersonnelLoadWeekly_Label&#8217;), which provides the current column titles each time a PowerReport is created/updated. You have to place the values in the row directly above the list so that the Excel link can find, export and commit them to the list. Upon completion, this row must be hidden in the template.</p>
<div class="figure align-center" id="id11">
<span id="officelink-usermanual-excel-powerreports-creation-dynamic-headers-example-b"></span><img alt="_images/excel_powerreports_creation_dynamic_headers_example_b.png" src="_images/excel_powerreports_creation_dynamic_headers_example_b.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - displaying dynamic column titles (Layout)</span></p>
</div>
</div>
<div class="section" id="darstellung-dynamischer-bildinhalte">
<span id="officelink-usermanual-excel-powerreports-creation-dynamic-images"></span><h2>Displaying dynamic image contents<a class="headerlink" href="#darstellung-dynamischer-bildinhalte" title="Permalink to this headline">¶</a></h2>
<p>In PowerReports, you have the option to fill both simple fields as well as list fields with image files (in all formats supported by Excel). Section <a class="reference internal" href="officelink-usermanual-excel-powerreports-implementation.html#officelink-usermanual-excel-powerreports-implementation-images"><span class="std std-ref">Adding image files</span></a> describes which images you can provide and how you can provide them. A corresponding sample image must be inserted in the report template so that the image files dynamically loaded when generating a report are correctly inserted resp. receive a desired uniform size or position within the cell. Either the image name has to start with &#8220;cdb_image&#8221; or the attribute name assigned to the associated field by the data provider has to start with &#8220;cdbxml_image&#8221; so that this image can be recognized by the link as a sample. Furthermore, certain formatting rules in the alternative text box can be defined in the properties dialog of the respective image.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">The upper left corner of the sample image has to be definitely placed into the regarding cell, else Excel links the image to another cell and the dynamic image content possibly won&#8217;t get inserted at all.</p>
</div>
<p>In some cases there are unexpected results in lists with dynamic image content (e.g. distorted or invisible content). Currently this mainly effects Excel 2010 and usually can be avoided by arranging the sample image inside of the cell, so that it (resp. the dynamic image content later on) does not exceed the cell borders. If a PowerReport is intentionally designed in a way so that the user might wish to filter or sort a list which contains dynamic image content, then the regarding sample images have to be formatted with the property &#8220;Move and size with cells&#8221;, else list row movements caused by filtering or sorting might result in wrong image positions.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Dynamic image contents are not currently supported in complex reports.</p>
</div>
<p class="rubric">Formatting options:</p>
<ul class="simple">
<li><p class="first"><span class="guilabel">KeepWidth</span>: The width of the sample image is transfered to the dynamic image content. This variable is activated internally by default since keeping the column width is usually desired.</p>
</li>
<li><p class="first"><span class="guilabel">KeepHeight</span>: The height of the sample image is transfered to the dynamic image content.</p>
</li>
<li><p class="first"><span class="guilabel">MinBorderHeight</span>: The minimum distance between image height and cell height. For example, a value of &#8220;1&#8221; guarantees that the respective row height is enlarged when filling images that are too tall. This prevents overlapping image contents. Higher values such as &#8220;20&#8221; or &#8220;30&#8221; provide a visual border between the image and the cell.</p>
</li>
<li><p class="first"><span class="guilabel">MinBorderWidth</span>: The minimum distance between image width and cell width.</p>
</li>
<li><p class="first"><span class="guilabel">CenterWidth</span>: The dynamic image content is centered horizontally within the cell.</p>
</li>
<li><p class="first"><span class="guilabel">CenterHeight</span>: The dynamic image content is centered vertically within the cell.</p>
</li>
</ul>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">The entire formatting text must begin with the prefix <span class="guilabel">&#8220;cdb:&#8221;</span>.</p>
</div>
<div class="figure align-center" id="id12">
<span id="officelink-usermanual-excel-powerreports-creation-dynamic-images-placeholder"></span><img alt="_images/excel_powerreports_creation_dynamic_images_placeholder.png" src="_images/excel_powerreports_creation_dynamic_images_placeholder.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - dynamic image contents (sample image)</span></p>
</div>
<ul>
<li><p class="first">Formatting example 1: <span class="guilabel">&#8220;cdb:KeepHeight=1,CenterWidth=1&#8221;</span></p>
<div class="figure align-center" id="id13">
<span id="officelink-usermanual-excel-powerreports-creation-dynamic-images-example-a"></span><img alt="_images/excel_powerreports_creation_dynamic_images_example_a.png" src="_images/excel_powerreports_creation_dynamic_images_example_a.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - dynamic image contents (example 1)</span></p>
</div>
</li>
<li><p class="first">Formatting example 2: <span class="guilabel">&#8220;cdb:MinBorderHeight=1,KeepWidth=1&#8221;</span></p>
<div class="figure align-center" id="id14">
<span id="officelink-usermanual-excel-powerreports-creation-dynamic-images-example-b"></span><img alt="_images/excel_powerreports_creation_dynamic_images_example_b.png" src="_images/excel_powerreports_creation_dynamic_images_example_b.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - dynamic image contents (example 2)</span></p>
</div>
</li>
</ul>
</div>
<div class="section" id="darstellung-komplexer-zeilen-bei-multi-export-datenquellen">
<span id="officelink-usermanual-excel-powerreports-creation-multiexport"></span><h2>Displaying complex rows for multi-export data sources<a class="headerlink" href="#darstellung-komplexer-zeilen-bei-multi-export-datenquellen" title="Permalink to this headline">¶</a></h2>
<p>Microsoft Excel does not allow lists consisting of more complex rows to be created. A list row always consists of only one row of Excel cells. However, displaying more complex data in list form is often required. The following display of a part list, each with a list of the assigned documents, cannot be implemented with Excel lists alone, for example. Instead, you have to create these types of lists by joining a layout that repeats itself. This type of complex list element is indicated in red in the figure below. This element repeats as frequently as desired. This is done to form a complex list.</p>
<div class="figure align-center" id="id15">
<span id="officelink-usermanual-excel-powerreports-creation-multiexport-example-report"></span><img alt="_images/excel_powerreports_creation_multiexport_example_report.png" src="_images/excel_powerreports_creation_multiexport_example_report.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Complex rows using a part list as an example</span></p>
</div>
<p>The layout and data connection for a complex list element has to occur on a special template sheet with the fixed name <code class="file docutils literal"><span class="pre">cdb_template</span></code>. Only one complex row is implemented on the template sheet.</p>
<p>When running reports, the complex rows of a data source are exported in individual XML files. They are then imported into the template sheet individually using the Excel link. Between the import processes, the result from the template sheet is copied to the target sheet.</p>
<div class="figure align-center" id="id16">
<span id="officelink-usermanual-excel-powerreports-creation-multiexport-complex-row"></span><img alt="_images/excel_powerreports_creation_multiexport_complex_row.png" src="_images/excel_powerreports_creation_multiexport_complex_row.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Definition of a complex row</span></p>
</div>
<p>The target sheet and a target cell can be specified in the top left cell of the template sheet. This target address describes the target for the top left cell of the first complex cell to be copied. All other rows are attached to each other starting there. If no target address is specified, the top left cell of the first sheet contained in the workbook is used as a starting cell.</p>
<p>The PowerReports Framework automatically identifies data that has to be imported and exported as complex rows based on the result and call cardinalities of linked data providers.</p>
<p>A multi-export configuration exists whenever the higher-level provider provides a list as a result (result cardinality N) and if an assigned subprovider has the call cardinality 1. Thus, the subprovider provides data that relates to individual list elements of the higher-level provider.</p>
<div class="figure align-center" id="id17">
<span id="officelink-usermanual-excel-powerreports-creation-multiexport-schema"></span><img alt="_images/excel_powerreports_creation_multiexport_schema.png" src="_images/excel_powerreports_creation_multiexport_schema.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - schema for multi-export</span></p>
</div>
<p>For example, if a SimpleQuery provider provides a list of parts and a relationship provider provides the assigned documents as an assigned subprovider, a configuration exists that can only be displayed as a complex list in Excel.</p>
<p>An assigned GroupBy provider, on the other hand, would not represent a multi-export configuration since GroupBy providers are called up with the entire result of the higher-level provider, i.e. have the call cardinality N. GroupBy providers do not provide results that relate to individual list elements of the parent provider, but rather aggregated information that relates exclusively to the entire list.</p>
</div>
<div class="section" id="darstellung-von-langtexten">
<span id="officelink-usermanual-excel-powerreports-creation-longtext"></span><h2>Displaying longtexts<a class="headerlink" href="#darstellung-von-langtexten" title="Permalink to this headline">¶</a></h2>
<p>For rows where cells are only or sometimes filled with longtexts, the property <span class="guilabel">line break</span> &#8221; of the <span class="guilabel">complete row</span> has to be set so that the link recognizes this and can adjust its row height automatically.</p>
<p>If longtexts are to be shown in cells consisting of multiple composite cells, the correct display can only be achieved via a detour:</p>
<ol class="arabic simple">
<li><p class="first">The actual link with the longtext attribute of the data source must not occur with the desired target cell, but rather with a <span class="guilabel">hidden cell</span> at the end located in the <span class="guilabel">same row</span>.</p>
</li>
<li><p class="first">So that the longtexts are not displayed as cut off with empty rows at the beginning, this helper cell must have the <span class="guilabel">same width</span>.</p>
</li>
<li><p class="first">The &#8220;<span class="guilabel">line break</span> &#8221; property has to be set for the entire row.</p>
</li>
</ol>
</div>
<div class="section" id="nachbearbeitung-fertiger-powerreports-durch-vba">
<span id="officelink-usermanual-excel-powerreports-creation-vbacode"></span><h2>Re-editing finished PowerReports using VBA<a class="headerlink" href="#nachbearbeitung-fertiger-powerreports-durch-vba" title="Permalink to this headline">¶</a></h2>
<p>Sometimes, you might want to carry out certain programming tasks using VBA and the Excel object model after a report has been completed by the link (e.g. to format filled diagrams correctly or put the focus on something). For this purpose, the link searches for a VBA function with a certain name in the Excel workbook. If it is found, it is called up each time after completing/updating a report.</p>
<p class="rubric">Adding a VBA function for automated re-editing of finished PowerReports</p>
<ol class="arabic simple">
<li><p class="first">Open the VBA editor in Excel.</p>
</li>
<li><p class="first">Insert a module in the PowerReport template.</p>
</li>
<li><p class="first">Integrate a function with the name &#8216;CDBReportDone&#8217;:</p>
</li>
</ol>
<div class="highlight-none"><div class="highlight"><pre><span></span>Public Sub CDBReportDone()
    &#39; ...
End Sub
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>If the security settings in Office are set to automatically disable macros which are not digitally signed, then the report templates must be signed with a certificate before they are stored in the system. The standard PowerReports supplied with the system, which contain VBA code for post-processing, are already signed with a Contact GmbH certificate and under usage of a timestamp server. In order to sign custom report templates or modified standard report templates with an own certificate and under usage of a timestamp server, following registry entries must be manually set, since it is not possible to configure a certificate timestamp server via the Office interface:</p>
<div class="highlight-registry"><div class="highlight"><pre><span></span>Windows Registry Editor Version 5.00

<span class="k">[</span><span class="nb">HKEY_CURRENT_USER</span><span class="k">\Software\Microsoft\VBA\Security]</span>
<span class="na">&quot;TimeStampURL&quot;</span><span class="o">=</span><span class="s">&quot;http://timestamp.some-ca.com/scripts/timestamp.dll&quot;</span>
<span class="na">&quot;TimeStampRetryCount&quot;</span><span class="o">=</span><span class="nv">dword</span><span class="p">:</span><span class="m">00000005</span>
<span class="na">&quot;TimeStampRetryDelay&quot;</span><span class="o">=</span><span class="nv">dword</span><span class="p">:</span><span class="m">00000005</span>
</pre></div>
</div>
<p class="last">If the digital signing is proceeded without a timestamp, then the validity of the signature expires after the expiry of the certificate. By using a timestamp the signature is valid without any time limitation.</p>
</div>
</div>
<div class="section" id="erstellung-personlicher-reports">
<span id="officelink-usermanual-excel-powerreports-creation-personalreports"></span><h2>Creating personal reports<a class="headerlink" href="#erstellung-personlicher-reports" title="Permalink to this headline">¶</a></h2>
<p>Users have the option to modify the layout and data connection of a called up report directly and save it as a personal report. Thus, a personal report can be created spontaneously if the user is not pleased with report result or if it is not suitable for his/her purposes.</p>
<p>The modified report is saved as a personal report with the Excel link function Create <span class="menuselection">Reports ‣ Create report template</span>. The modified report is created by calling up this function as a new report template for the underlying data source and authorized for the user implementing this. Other users do not have access to this report, but could become authorized later by the administrator via role and personnel assignments.</p>
<div class="figure align-center" id="id18">
<span id="officelink-usermanual-excel-powerreports-creation-personalreports-example"></span><img alt="_images/excel_powerreports_creation_personalreports_example.png" src="_images/excel_powerreports_creation_personalreports_example.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Personal report using employee workload as an example</span></p>
</div>
<p>When creating a personal report, the preceding report dialog, if present, is taken over by the original report. The change of the report dialog is not provided by the user.</p>
</div>
<div class="section" id="erstellung-sprachspezifischer-reports">
<span id="officelink-usermanual-excel-powerreports-creation-multilang"></span><h2>Creating language-specific reports<a class="headerlink" href="#erstellung-sprachspezifischer-reports" title="Permalink to this headline">¶</a></h2>
<p>The designer of a PowerReport has the option to adapt an existing report template for a certain language and then provide it for the same higher-level report so that the users running the report later can choose between the different languages. If you open an already created report template for editing and run <span class="guilabel">[ Create template ]</span> later, the link, in an intermediate dialog, offers to create a language-specific report template for already existing reports.</p>
<div class="figure align-center" id="id19">
<span id="officelink-usermanual-excel-powerreports-creation-multilang-predlg"></span><img alt="_images/excel_powerreports_creation_multilang_predlg.png" src="_images/excel_powerreports_creation_multilang_predlg.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Report for data source</span></p>
</div>
<p>In the dialog following this, you only have to select the language and a unique title.</p>
<div class="figure align-center" id="id20">
<span id="officelink-usermanual-excel-powerreports-creation-multilang-cdbpcdlg"></span><img alt="_images/excel_powerreports_creation_multilang_newtmpl.png" src="_images/excel_powerreports_creation_multilang_newtmpl.png" />
<p class="caption"><span class="caption-text">Excel: PowerReports - Report for data source</span></p>
</div>
</div>
<div class="section" id="besondere-hinweise">
<span id="officelink-usermanual-excel-powerreports-creation-hints"></span><h2>Special notes<a class="headerlink" href="#besondere-hinweise" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p class="first">When linking between list attributes of a provider scheme and the Excel cells, i.e. if table columns develop due to the linking in the sheet, you have to take particular care that the respective table is set up as a whole in a logical sequence from left to right. If columns are deleted or inserted from this table later, this can cause the report generation to have errors or even be aborted in some cases, since the columns potentially no longer form an entire table in this case, but rather multiple tables next to each other. You can tell whether a table consists of multiple tables by the small triangles on the bottom right edge of each table. Especially since Excel 2010, this has been giving users problems that can only be solved by removing tables and setting up new ones.</p>
</li>
<li><p class="first">Filling data in composite cells can cause unexpected malfunctions. In these cases, you can use the option &#8220;Text alignment &gt; Horizontal &gt; Center via selection&#8221; instead of the &#8220;Combine cells&#8221; option.</p>
</li>
<li><p class="first">For cells preconfigured with date formats or user-defined number formats, the option &#8220;Line break&#8221; must not be set at the same time since this can lead to a loss of the formatting.</p>
</li>
<li><p class="first">When linking between a schema attribute and a cell, Excel formats the cell automatically with the number category that fits the respective attribute value type. Since now, cells that are to be filled with floating points later are assigned the number category &#8216;standard&#8217; by Excel automatically, potential decimal places are only displayed if they do not equal zero. If a fixed decimal place format (0.00) is desired, you have to change the number category according to the link in &#8216;Number&#8217;.</p>
</li>
<li><p class="first">A lower table must never be wider than the table(s) above it if multiple dynamically filled tables are used on top of each other in any sheet. Thus, it may only be as wide or, of course, narrower since internal problems will be caused otherwise, which would cancel the report generation as a result. If lower tables have to be wider based on their design, the higher tables have to be broadened, for example, by using invisible dummy columns.</p>
</li>
</ul>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="officelink-usermanual-excel-powerreports-execution.html" class="btn btn-neutral float-right" title="Running PowerReports" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="officelink-usermanual-excel-powerreports-activation.html" class="btn btn-neutral" title="Activating PowerReports" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, CONTACT Software GmbH.
      Last updated on 25.09.2018.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'15.5.0.9',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>