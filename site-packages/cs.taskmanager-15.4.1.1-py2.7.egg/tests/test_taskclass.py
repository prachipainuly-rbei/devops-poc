#!/usr/bin/env powerscript
# -*- python -*- coding: utf-8 -*-
#
# Copyright (C) 1990 - 2018 CONTACT Software GmbH
# All rights reserved.
# http://www.contact-software.com
#

__docformat__ = "restructuredtext en"
__revision__ = "$Id: test_taskclass.py 180439 2018-07-12 08:48:23Z cso $"

import unittest
from cdb import testcase
from cs.taskmanager import TaskClass
from cs.taskmanagertest import TestTaskOLC


def setUpModule():
    testcase.run_level_setup()


class TaskClassTestCase(testcase.RollbackTestCase):
    def test_getMappedTasks(self):
        raise self.skipTest("only works in isolation")
        amount = 1001  # ORACLE only accepts 1000 expressions for IN clauses

        for x in range(amount):
            name = "test-{}".format(x)
            TestTaskOLC.Create(name=name, status=0)

        result = TaskClass.getMappedTasks()

        expected = amount + 1
        self.assertEqual(
            (len(result[0]), len(result[1])),
            (expected, expected))


if __name__ == "__main__":
    unittest.main()
