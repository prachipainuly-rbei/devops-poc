# -*- mode: feature; coding: utf-8 -*-
#
# Copyright (C) 1990 - 2018 CONTACT Software GmbH
# All rights reserved.
# http://www.contact.de/
#

@slow
Feature: Filter Tasks


Background:
    GIVEN test task "Test OLC 1" is active
        AND test task "Test OLC 2" is active
        AND test task "Test OLC 3" is active
        AND simple test task "Simple Test 1" is active
        AND simple test task "Simple Test 2" is active


Scenario Outline: Filter by Type
    WHEN user opens the Task Manager
        AND user filters by type "<type>"
    THEN <amount> tasks are shown
        AND user has to confirm leaving the page

    Examples:
        | type               | amount |
        | Testaufgaben       | 2      |
        | Testaufgaben (OLC) | 2      |
        | Alle Typen         | 4      |


Scenario Outline: Filter by Context
    WHEN user opens the Task Manager
        AND user filters by context "<context>"
    THEN <amount> tasks are shown
        AND user has to confirm leaving the page

    Examples:
        | context       | amount |
        | parent task   | 1      |
        | Alle Kontexte | 4      |


Scenario Outline: Filter by Deadline Days
    # Mocking the current date from the backend is hard,
    # so set up test tasks with relative deadlines
    GIVEN test task "Test OLC 1" is due in <days_1> days
        AND test task "Test OLC 2" is due in <days_2> days
    WHEN user opens the Task Manager
        AND user filters by deadline days "<days>"
    THEN <amount> tasks are shown
        AND user has to confirm leaving the page

    Examples:
        | days_1 | days_2 | days | amount |
        | -1     | 0      | -2   | 0      |
        | -1     | 0      | -1   | 1      |
        | -1     | 0      | 0    | 2      |
        | -1     | 0      | 1    | 2      |
        | 1      | 2      | 1    | 1      |


Scenario Outline: Filter by Deadline Range
    GIVEN test task "Test OLC 1" is due on "2018-07-16T00:00:00"
        AND test task "Test OLC 2" is due on "2018-07-19T23:59:59"
    WHEN user opens the Task Manager
        AND user filters by deadline range "<range>"
    THEN <amount> tasks are shown
        AND user has to confirm leaving the page

    Examples:
        | range                   | amount |
        | 01.07.2018 - 15.07.2018 | 0      |
        | 01.07.2018 - 16.07.2018 | 1      |
        | 15.07.2018 - 17.07.2018 | 1      |
        | 16.07.2018 - 17.07.2018 | 1      |
        | 16.07.2018 - 19.07.2018 | 2      |
        | 16.09.2017 - 19.04.2019 | 2      |


Scenario Outline: Filter by Person
    WHEN user opens the Task Manager
        AND user filters by person "<person>"
        AND user filter <roles> include role tasks
    THEN <amount> tasks are shown
        AND user has to confirm leaving the page

    Examples:
        | person         | roles    | amount |
        | test_dummy     | does     | 2      |
        | test_dummy     | does not | 2      |
        | Meine Aufgaben | does     | 5      |
        | Administrator  | does     | 3      |
        | Administrator  | does not | 2      |
