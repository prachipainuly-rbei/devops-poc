/* -*- mode: javascript; coding: utf-8 -*-
 * $Id: webpack.config.js 183484 2018-09-06 19:53:02Z cso $
 *
 * Copyright (c) 1990 - 2018 CONTACT Software GmbH
 * All rights reserved.
 * http://www.contact-software.com
 */
const webpack = require('webpack');
const configModule = require(process.env.WEBPACK_CONFIG_COMMON);
const commonConfig = configModule.makeConfig();
const componentNameSpace = configModule.getComponentNameSpace();

const STORIES_APP = `${componentNameSpace}-stories`;

const Environment = new webpack.DefinePlugin({
    'process.env.NODE_ENV': JSON.stringify(process.env.NODE_ENV || 'development')
});

const moreExternals = Object.assign({}, commonConfig.externals, {
    "cs-activitystream-web": "cs-activitystream-web",
    "cs-web-components-storybook": "cs-web-components-storybook"
});

const moreEntries = Object.assign({}, commonConfig.entry, {
    [STORIES_APP]: './src/stories'
});

module.exports = Object.assign({}, commonConfig, {
    plugins: commonConfig.plugins.concat([Environment]),
    externals: moreExternals,
    entry: moreEntries
});
