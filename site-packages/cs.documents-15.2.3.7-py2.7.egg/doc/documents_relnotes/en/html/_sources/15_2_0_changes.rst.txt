.. _`15_2_0_changes`:

Release Notes for 15.2.0
########################


Internationalization
====================

|con15| and its applications contain many newly translated and updated terms.
The following paragraphs list all affected elements in this application, while
details concerning the actual conversion (called "internationalization" for
simplicity) can be found in each product's release notes.


.. _15_2_0_cs-documents-rs-acc:

Translated Relationship Access Profiles
---------------------------------------

The following Relationship Access Profiles have been renamed:

:envvar:`Ã„nderungsmitteilung`
    Renamed to :envvar:`Change Notification`

Please rename any usages in custom relationships accordingly.


.. _15_2_0_cs-documents-cat-1-n:

Translated Catalogs
-------------------

The following catalogs previously not supporting multiple languages are updated
as detailed in the product release notes:

* Change Cause (``cdb_mod_event``)
* Change Source (``cdb_mod_source``)
* Change Type (``cdb_mod_kind``)

The catalogs are used in these classes, which are also updated accordingly:

* Change Notification (Document) (``aenderung``)
* Engineering Change (``cdbecm_ec``) (part of cs.ec)
* Change Notification (Part) (``cdbecm_item_ecn``) (part of cs.vp.ec_items)


.. _15_2_0_cs-documents-cat-n-n:

Internationalized Catalogs
--------------------------

The catalog class Document Categories (``cdb_doc_categ``) has been
internationalized. Affected classes:

* Document (``document``)
* Folder (``cdb_folder``)


.. _15_2_0_cs-documents-status:

Translated Status Names
-----------------------

Status names have been internationalized for the classes:

* Document (``document``)
* Status Protocol Document (``cdb_z_statiprot``)


.. _15_2_0_cs-documents-cat-values:

Translated Catalog Values
-------------------------

The following catalog's values have been newly translated:

* Change Type (``cdb_mod_kind``)
* Change Cause (``cdb_mod_event``)
* Change Source (``cdb_mod_source``)

Keys remain unchanged.

The new translations will be automatically updated.

  .. note::
    This does only apply to catalog values not changed by any custom module.


Changes to Document Categories
==============================

Due to internationalization document categories are now referenced by id, instead of by value.
This means that from now on the attributes ``z_categ1`` and ``z_categ2`` of
the class ``document`` must contain the ``categ_id`` of the referenced
category (so far they contained the german name of the category).

As long as a category is referenced by some document, it cannot be deleted.
Categories now have an :guilabel:`obsolete` flag. If the flag is set to true
the category will be ignored when generating the ``DOC`` decomposition
(i.e. it will not appear in the navigation tree).

Other references to document categories from other packages have been also converted to ids.
These include:

- The classes ``cdbpcs_cl2doctmpl``, ``cdbpcs_cli2doctmpl``,
  ``cdbpcs_prj2doctmpl``, ``cdbpcs_task2doctmpl`` and ``cdb_folder`` from ``cs.pcs``
- The object rule ``2D Drawings`` from ``cs.documents``
- The object rules ``mBOM Manager: 2D documents`` and ``mBOM Manager: 3D documents``
  from ``cs.vp``

Furthermore the masks and the tables of the classes ``document`` and ``model``
have been modified accordingly.

The following browsers have also been modified and return now different values:

- ``cdb_doc_categ_brows``
- ``cdb_doc_categ_brows2``

If you use them in your masks, please check your configuration.

On updating the exiting data must be migrated. This is done automatically by
the update task ``cs.documents.updates.v15_2_0_2.MigrateCategories``.
The task works as follows:

- The existing documents are checked against the configured categories.
  The value of the attribute ``z_categ*`` is checked against the
  german name of the category.

- If a unique category can be determined for a document,
  the value in ``z_categ*`` is replaced by the id of the category.
  Otherwise a new category is generated and marked as obsolete.

- In standard there are only two level of categories, however customers
  can introduce more level through customizing.
  This scripts will migrate all the levels. Some assumptions are made:

      * The attributes in the class documents must be named according to the
        schema ``z_categ<level>`` (e.g. ``z_categ1``, ``z_categ2``, ``z_categ3``, etc.)

- Favorites are also migrated. Searches for documents with the keys
  ``z_categ<level>=<search term>`` are migrated into searches with the keys
  ``category<level>_name=<search term>``.

  .. NOTE::

    Only favorites for the classes ``document`` and ``model`` and for
    the operations ``query`` and ``CDB_Search`` are migrated.
    Other classnames and operations, which may be present in your customizing,
    are not automatically migrated.


Change Notifications
====================

All classes related to Document Change Notifications have been relocated from
|cs.ec| to |cs.documents|:

* Change Notification (Document) (``aenderung``)
* Change Type (``cdb_mod_kind``)
* Change Cause (``cdb_mod_event``)
* Change Source (``cdb_mod_source``)

This is also true for the Powerscript class :py:class:`DocumentECN`, which was
relocated from :py:mod:`cs.ec_documents` to :py:mod:`cs.documents`.


Purging of file history entries on status change
================================================

After a successful status change to ``Released``, the file history entries for
all files attached to the document will be deleted. If this behaviour is not
desired for an installation, the method ``Document.purgeFileHistoriesAfterRelease``
can be overwritten.


.. |con15| replace:: CONTACT Elements 15
