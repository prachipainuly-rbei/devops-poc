# Copyright (C) 1990 - 2012 CONTACT Software GmbH
# All rights reserved.
# http://www.contact.de/
#

Feature: Basic CIM DATABASE Operations on Documents

In order to manage documents in CIM DATABASE
As a writer
I want to be able to perform basic operations like
  create, copy, delete etc. on documents.

Note: with 'writer' we mean somebody who handles documents in CIM Database.


Scenario: Create New Document
    WHEN writer creates a new document
    THEN a new document is generated


Scenario: Change Document
    GIVEN a document exists
    WHEN writer changes this document
    THEN the changed document is saved


Scenario: Copy Document
    GIVEN a document exists
    WHEN writer copies this document
    THEN the document is copied

Scenario: Delete Document
    GIVEN a document exists
    WHEN writer deletes this document
    THEN the document is deleted


Scenario: Generate An Index Of A Document
    GIVEN a released document exists
    WHEN writer generates an index of this document
    THEN an index of the original document is generated
        AND the original document is in revision


Scenario: Change State Of A Document
    GIVEN a document exists
    WHEN writer changes the state of this document
        | FROM  | TO     |
        | Draft | Review |
    THEN the changed state of the document is saved


Scenario: Change a released Document
    GIVEN a released document exists
    WHEN writer changes this document
    THEN the changed document is not saved


Scenario: Release an Index
    GIVEN a released document exists
        AND an index of this document is generated
    WHEN writer releases the index of the document
    THEN the index of the document is released
    AND the state of the original document is invalid


Scenario: Import A File Into A Document
    GIVEN a file exists
        AND a document exists
    WHEN writer imports this file into the document
    THEN the file is associated with the document


Scenario: Overriding primary file in a document
    GIVEN a document exists
        AND a primary file is linked to it
        AND a secondary file derives from the primary file
    WHEN writer overrides the primary file
    THEN all secondary files are deleted


Scenario: Purging file history on release
    GIVEN a document exists
        AND a primary file is linked to it
    WHEN writer overrides the primary file
    AND writer changes the state of this document
        | FROM  | TO     |
        | Draft | Review |
    AND writer changes the state of this document
        | FROM   | TO       |
        | Review | Released |
    THEN the state of the original document is approved
        AND no file history entries exist
