/*
 * Copyright (C) 2015 CONTACT Software GmbH
 * All rights reserved.
 * http://www.contact-software.com
 *
 * Revision "$Id: timeout.js 148519 2016-10-28 09:52:36Z psz $"
 */

"use strict";

class Timeout {
    constructor() {
        this._callbacks = [];
        this._timeout = undefined;
    }

    register(callback) {
        this._callbacks.push(callback);
    }

    __callback() {
        this._callbacks.forEach((cb) => {
            cb();
        });
    }

    unregister(callback) {
        const idx = this._callbacks.indexOf(callback);
        if (idx > -1) {
            this._callbacks.splice(idx, 1);
        }
    }
    clear() {
        if (this._timeout !== undefined) {
            window.clearTimeout(this._timeout);
            this._timeout = undefined;
        }
    }

    reset() {
        this.clear();
        this._callbacks = [];
    }

    set(delay) {
        this.clear();
        this._timeout = window.setTimeout(this.__callback.bind(this), delay);
    }
}

export const timeout = new Timeout();
