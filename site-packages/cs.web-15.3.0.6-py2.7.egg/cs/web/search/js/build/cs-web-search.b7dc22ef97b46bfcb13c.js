!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("cs-web-components-externals"),require("cs-web-components-base"),require("React"),require("Immutable"),require("ReactBootstrap"),require("moment")):"function"==typeof define&&define.amd?define(["cs-web-components-externals","cs-web-components-base","React","Immutable","ReactBootstrap","moment"],t):"object"==typeof exports?exports["cs-web-search"]=t(require("cs-web-components-externals"),require("cs-web-components-base"),require("React"),require("Immutable"),require("ReactBootstrap"),require("moment")):e["cs-web-search"]=t(e["cs-web-components-externals"],e["cs-web-components-base"],e.React,e.Immutable,e.ReactBootstrap,e.moment)}(this,function(e,t,r,n,o,a){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=9)}([function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t,r){"use strict";function n(e){return"cs-web-search-"+e}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o={searchtext:e};return void 0!==t&&(void 0!==t.get("classname")&&(o.classname=t.get("classname").join(",")),n||void 0===t.get("page")||(o.page=t.get("page")),void 0!==t.get("r")&&r&&(o.r=t.get("r")),void 0!==t.get("obsolete")&&(o.obsolete=t.get("obsolete")),void 0!==t.get("sortDate")&&(o.sortDate=t.get("sortDate")),void 0!==t.get("df")&&(o.df=t.get("df"))),o}function a(e){var t={};return void 0!==e.searchtext&&null!==e.searchtext&&(t.query=e.searchtext),void 0!==e.classname&&(t.classname=e.classname.split(",")),t.r=e.r,t.obsolete=e.obsolete,t.sortDate=e.sortDate,t.df=e.df,t}function s(e,t,r){var n={searchtext:e};return void 0!==r&&(void 0!==r.get("classname")&&(n.classname=r.get("classname").join(",")),void 0!==r.get("obsolete")&&(n.obsolete=r.get("obsolete")),void 0!==r.get("sortDate")&&(n.sortDate=r.get("sortDate")),void 0!==r.get("df")&&(n.df=r.get("df"))),t+"/"+(0,f.getAppSetup)().getIn(["links","cs-web-search","fulltext_search_route"])+"?"+p.qs.stringify(n).replace(/\+/g,"%20")}function i(e,t){var r="0"===e?0:e;r="1"===e?1:r;var n="0"===t?0:t;return n="1"===t?1:n,void 0===r&&0===n||void 0===n&&0===r||void 0===r&&void 0===n||r===n}function c(e,t){return void 0===e&&""===t||void 0===t&&""===e||void 0===t&&void 0===e||e.trim()===t.trim()}function u(e,t){return void 0===e&&h.default.is(t,h.default.List([""]))||void 0===t&&h.default.is(e,h.default.List([""]))||void 0===t&&void 0===e||h.default.is(h.default.List(e),h.default.List(t))}function l(e,t){return!(c(e.get("df"),t.get("df"))&&c(e.get("query"),t.get("query"))&&i(e.get("sortDate"),t.get("sortDate"))&&i(e.get("obsolete"),t.get("obsolete"))&&u(e.get("classname"),t.get("classname")))}Object.defineProperty(t,"__esModule",{value:!0}),t.prefixNS=n,t.getQueryParams=o,t.parseQueryParams=a,t.getDisplayURL=s,t.compareRelevantSearchSettings=l;var f=r(1),p=r(0),d=r(6),h=function(e){return e&&e.__esModule?e:{default:e}}(d)},function(e,t){e.exports=r},function(e,t,r){"use strict";function n(e){return(0,b.getAppSetup)().getIn(["links","cs-web-search",e])}function o(e){return{type:S,meta:{url:e}}}function a(e,t){return function(r){r({type:E,payload:{classname:e,add:t}})}}function s(){return{type:x,payload:null}}function i(e){return function(t){t({type:T,payload:e})}}function c(e){return{type:O,payload:e}}function u(e){return function(t){t({type:P,payload:e}),t(s())}}function l(e){return function(t){t({type:R,payload:e}),t(s())}}function f(e){return function(t){t({type:w,payload:e}),t(s())}}function p(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(s,i){var u=i().search.settings,l=u.get("query"),f=(0,_.getQueryParams)(l,u,e,t),p=(0,_.getDisplayURL)(l,F,u),d=n("fulltext_search_api")+"?"+y.qs.stringify(f);return i().search.fetchingById.has(d)?null:(s(o(d)),a?y.browserHistory.replace(p,{hist:!0}):y.browserHistory.push(p,{hist:!0}),(0,b.getJSON)(d).then(function(e){s({type:r,payload:e.result,meta:{url:d}}),s(c(e.result.settings))},function(e){s({type:v,err:{status:e.status,statusText:e.statusText,responseText:e.responseText,responseJSON:e.responseJSON},meta:{url:d}})}))}}function d(){return p(!1,!1,m,!0)}function h(){return p(!0,!1,g,!0)}Object.defineProperty(t,"__esModule",{value:!0}),t.OP_RESET_OFFSET=t.OP_SET_SORT_DATE=t.OP_SET_FILTER_DATE=t.OP_TOGGLE_OBSOLETE=t.OP_UPDATE_SETTINGS=t.OP_SET_SEARCH_TEXT=t.OP_SET_FACET=t.IS_FETCHING=t.SEARCH_FAILED=t.FULL_TEXT_SEARCH_APPEND_RESULT=t.FULL_TEXT_SEARCH_RESULT=void 0,t.fetching=o,t.setFacet=a,t.resetOffset=s,t.setSearchText=i,t.updateSettings=c,t.toggleObsolete=u,t.setFilterDate=l,t.setSortDate=f,t.doSearch=p,t.doSearchHistoryReplace=d,t.fetchNextSearchResult=h;var y=r(0),_=r(2),b=r(1),m=t.FULL_TEXT_SEARCH_RESULT=(0,_.prefixNS)("FULL_TEXT_SEARCH_RESULT"),g=t.FULL_TEXT_SEARCH_APPEND_RESULT=(0,_.prefixNS)("FULL_TEXT_SEARCH_APPEND_RESULT"),v=t.SEARCH_FAILED=(0,_.prefixNS)("SEARCH_FAILED"),S=t.IS_FETCHING=(0,_.prefixNS)("IS_FETCHING"),E=t.OP_SET_FACET=(0,_.prefixNS)("OP_SET_FACET"),T=t.OP_SET_SEARCH_TEXT=(0,_.prefixNS)("OP_SET_SEARCH_TEXT"),O=t.OP_UPDATE_SETTINGS=(0,_.prefixNS)("OP_UPDATE_SETTINGS"),P=t.OP_TOGGLE_OBSOLETE=(0,_.prefixNS)("OP_TOGGLE_OBSOLETE"),R=t.OP_SET_FILTER_DATE=(0,_.prefixNS)("OP_SET_FILTER_DATE"),w=t.OP_SET_SORT_DATE=(0,_.prefixNS)("OP_SET_SORT_DATE"),x=t.OP_RESET_OFFSET=(0,_.prefixNS)("OP_RESET_OFFSET"),F=(0,b.getAppSetup)().getIn(["appSettings","basePath"])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatStr=t.Format=void 0;var n=r(1);t.Format=n.i18ndb.makeFormat("web-search"),t.formatStr=n.i18ndb.makeFormatStr("web-search")},function(e,t){e.exports=n},function(e,t){e.exports=o},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(3),c=function(e){return e&&e.__esModule?e:{default:e}}(i),u=r(0),l=r(1),f=function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"render",value:function(){return c.default.createElement(l.Throbber,{hidden:!this.props.isFetching})}}]),t}(i.Component);t.default=f,f.propTypes={isFetching:u.PropTypes.bool.isRequired},f.defaultProps={isFetching:!1}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=r(1),a=r(2),s=r(10),i=n(s),c=r(11),u=n(c);o.Registry.registerComponent((0,a.prefixNS)("SearchApp"),u.default),o.Registry.registerReducer("search",i.default)},function(e,t,r){"use strict";function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.default.Map(),t=arguments[1];switch(t.type){case u.FULL_TEXT_SEARCH_RESULT:return e.set("searchResult",i.default.fromJS(t.payload));case u.FULL_TEXT_SEARCH_APPEND_RESULT:var r=i.default.fromJS(t.payload.result),n=e.getIn(["searchResult","result"]);return e.setIn(["searchResult","result"],n.concat(r));case u.SEARCH_FAILED:return e.set("searchError",t.err);default:return e}}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.default.Set(),t=arguments[1];switch(t.type){case u.IS_FETCHING:return e.add(t.meta.url);case u.FULL_TEXT_SEARCH_RESULT:case u.FULL_TEXT_SEARCH_APPEND_RESULT:case u.SEARCH_FAILED:return e.delete(t.meta.url);default:return e}}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.default.Map(),t=arguments[1];switch(t.type){case u.OP_SET_FACET:var r=t.payload.classname,n=t.payload.add,o=e.get("classname",i.default.Set()).toSet();return n?""===r?e.set("classname",i.default.Set.of(r)):e.set("classname",o.delete("").add(r)):e.set("classname",o.delete(r));case u.OP_SET_SEARCH_TEXT:return e.set("query",t.payload);case u.OP_UPDATE_SETTINGS:return i.default.fromJS(t.payload);case u.OP_TOGGLE_OBSOLETE:return e.set("obsolete",t.payload?1:0);case u.OP_RESET_OFFSET:return e.set("page",0);case u.OP_SET_FILTER_DATE:return e.set("df",t.payload);case u.OP_SET_SORT_DATE:return e.set("sortDate",t.payload?1:0);default:return e}}Object.defineProperty(t,"__esModule",{value:!0}),t.result=n,t.fetchingById=o,t.settings=a;var s=r(6),i=function(e){return e&&e.__esModule?e:{default:e}}(s),c=r(0),u=r(4);t.default=(0,c.combineReducers)({result:n,fetchingById:o,settings:a})},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(3),u=n(c),l=r(0),f=r(1),p=r(12),d=n(p),h=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),i(t,[{key:"render",value:function(){var e=(0,f.getAppSetup)().getIn(["appSettings","basePath"]),t=(0,f.getAppSetup)().getIn(["links","cs-web-search","fulltext_search_route"]),r=e+"/"+t;return u.default.createElement(f.PageFrame.ApplicationFrame,null,u.default.createElement(l.ReactRouter.Router,{history:l.browserHistory},u.default.createElement(l.ReactRouter.Switch,null,u.default.createElement(l.ReactRouter.Route,{path:r,component:d.default}),u.default.createElement(l.ReactRouter.Redirect,{from:e,to:r}))))}}]),t}(c.Component);t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){return{searchResult:e.search.result.get("searchResult"),searchError:e.search.result.get("searchError"),isFetching:e.search.fetchingById.size>0,searchSettings:e.search.settings}}Object.defineProperty(t,"__esModule",{value:!0}),t.Content=void 0;var c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(3),l=n(u),f=r(13),p=n(f),d=r(14),h=n(d),y=r(7),_=r(0),b=r(1),m=r(4),g=r(2),v=r(6),S=n(v),E=t.Content=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),c(t,[{key:"componentDidMount",value:function(){var e=(0,b.parseQuery)(this.props.location),t=e.searchtext,r=(0,g.parseQueryParams)(e);r&&this.props.updateSettings(r),void 0!==t&&""!==t&&(this.props.setSearchText(t),this.props.doSearchHistoryReplace())}},{key:"componentWillReceiveProps",value:function(e){if(e.location.state&&e.location.state.hist){var t=(0,b.parseQuery)(e.location),r=S.default.Map((0,g.parseQueryParams)(t));!e.isFetching&&(0,g.compareRelevantSearchSettings)(e.searchSettings,r)&&(this.props.updateSettings(r),this.props.doSearchHistoryReplace())}}},{key:"renderSearchResultSection",value:function(){var e=this.props,t=e.searchResult,r=e.isFetching,n=e.searchError,o=t.getIn(["settings","query"]);return 0!==t.size||null!==n?l.default.createElement(h.default,{searchResult:t,isFetching:r,searchError:n,searchText:o}):null}},{key:"render",value:function(){var e=this.props.isFetching;return l.default.createElement(y.Grid,{className:"page-content",fluid:!0},l.default.createElement(p.default,{isFetching:e}),this.renderSearchResultSection())}}]),t}(l.default.Component);E.propTypes={location:_.PropTypes.object,doSearch:_.PropTypes.func,doSearchHistoryReplace:_.PropTypes.func,updateSettings:_.PropTypes.func,setSearchText:_.PropTypes.func,searchResult:_.PropTypes.instanceOf(S.default.Map),searchError:_.PropTypes.object,isFetching:_.PropTypes.bool.isRequired,searchSettings:_.PropTypes.instanceOf(S.default.Map)},E.defaultProps={searchResult:S.default.Map(),searchError:null,isFetching:!1};var T={doSearch:m.doSearch,doSearchHistoryReplace:m.doSearchHistoryReplace,updateSettings:m.updateSettings,setSearchText:m.setSearchText};t.default=(0,_.connect)(i,T)(E)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){return{searchText:e.search.settings.get("query")}}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(3),l=n(u),f=r(7),p=r(0),d=r(1),h=r(4),y=r(8),_=n(y),b=r(2),m=(0,d.getAppSetup)().getIn(["appSettings","title"]),g=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.state={speechActive:!1},r.doSearch=r.doSearch.bind(r),r.requestSearch=r.requestSearch.bind(r),r.toggleSpeechActive=r.toggleSpeechActive.bind(r),r.speechRecognized=r.speechRecognized.bind(r),r}return s(t,e),c(t,[{key:"doSearch",value:function(e){this.props.setSearchText(e.trim()),this.props.doSearch()}},{key:"requestSearch",value:function(e){this.searchField.onSearchRequested(e)}},{key:"toggleSpeechActive",value:function(){this.setState(function(e){return{speechActive:!e.speechActive}})}},{key:"speechRecognized",value:function(e){this.props.setSearchText(e),this.searchField.search(e),this.setState({speechActive:!1})}},{key:"getButtons",value:function(e,t){var r=l.default.createElement(d.Button.IconButton,{key:"search",size:"sm",title:m,onClick:this.requestSearch,iconName:"csweb_search_icon_svg",buttonStyle:"primary"});return e?[l.default.createElement(d.Button.IconButton,{key:"speech",size:"sm",title:d.i18ndb.formatString("speech","base"),onClick:this.toggleSpeechActive,iconName:t?"csweb_microphone":"csweb_microphone_off"}),r]:r}},{key:"render",value:function(){var e=this,t=this.props,r=t.searchText,n=t.isFetching,o=this.state.speechActive;return l.default.createElement(f.Row,null,l.default.createElement(f.Col,{xs:9,smOffset:3},l.default.createElement("div",{className:(0,b.prefixNS)("search-box")+" center-block"},l.default.createElement(d.WithSpeechRecognition,{allowSpeech:o,onTextRecognized:this.speechRecognized},function(t){var a=t.speechAvailable,s=t.finalTranscript;return l.default.createElement(d.SearchField,{ref:function(t){return e.searchField=t},className:"elements-formcontrol-grid",isFetching:n,searchCallback:e.doSearch,productName:m,searchText:o?s:r,afterControl:e.getButtons(a,o)})}),l.default.createElement(_.default,{left:"100%",isFetching:n}))))}}]),t}(l.default.Component);g.propTypes={doSearch:p.PropTypes.func.isRequired,setSearchText:p.PropTypes.func.isRequired,searchText:p.PropTypes.string,isFetching:p.PropTypes.bool.isRequired};var v={doSearch:h.doSearch,setSearchText:h.setSearchText};t.default=(0,p.connect)(i,v)(g)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(3),u=n(c),l=r(0),f=r(7),p=r(5),d=r(2),h=r(15),y=n(h),_=r(17),b=n(_),m=r(18),g=n(m),v=r(19),S=n(v),E=r(20),T=n(E),O=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),i(t,[{key:"renderFacetInfo",value:function(){var e=this.props,t=e.searchResult,r=e.searchError,n=e.isFetching,o=t.get("facetInfo");return null!==r?null:void 0!==o&&o.count()>0?u.default.createElement("div",{className:(0,d.prefixNS)("filter-panel")},u.default.createElement(y.default,{facetInfo:o,isFetching:n}),u.default.createElement(b.default,{isFetching:n}),u.default.createElement(g.default,{filters:[{name:(0,p.formatStr)("all"),value:""},{name:(0,p.formatStr)("7days"),value:"7"},{name:(0,p.formatStr)("4weeks"),value:"28"},{name:(0,p.formatStr)("3months"),value:"3M"},{name:(0,p.formatStr)("12months"),value:"12M"},{name:(0,p.formatStr)("3years"),value:"3Y"}],isFetching:n}),u.default.createElement(S.default,{isFetching:n})):null}},{key:"renderResult",value:function(){var e=this.props,t=e.searchResult,r=e.searchText,n=this.props,o=n.isFetching,a=n.searchError,s=t.get("result");return""===r?u.default.createElement("p",{className:"no_search_results"},(0,p.formatStr)("no_searchtext")):null!==a?u.default.createElement(P,{error:a}):void 0===s||0===s.count()?o?null:u.default.createElement("p",{className:"no_search_results"},(0,p.formatStr)("no_search_results",[r])):u.default.createElement(T.default,{resultList:s,isFetching:o})}},{key:"render",value:function(){return u.default.createElement(f.Row,null,u.default.createElement(f.Col,{sm:3,className:""},this.renderFacetInfo()),u.default.createElement(f.Col,{sm:9,xs:12},this.renderResult()))}}]),t}(u.default.Component);t.default=O,O.propTypes={searchResult:l.PropTypes.object.isRequired,isFetching:l.PropTypes.bool.isRequired,searchError:l.PropTypes.object,searchText:l.PropTypes.string},O.defaultProps={searchResult:null,isFetching:!1,searchText:""};var P=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),i(t,[{key:"render",value:function(){var e=this.props.error,t=e.responseText,r=e.responseJSON,n=void 0!==r?r:t;return u.default.createElement("p",{className:"search-error"},(0,p.formatStr)("search_error",[n]).replace(/\\n/g,"\n"))}}]),t}(u.default.Component);P.propTypes={error:l.PropTypes.object.isRequired}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(3),u=n(c),l=r(6),f=n(l),p=r(2),d=r(5),h=r(16),y=n(h),_=r(0),b=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),i(t,[{key:"render",value:function(){var e=this.props,t=e.facetInfo,r=e.isFetching;return u.default.createElement("div",null,u.default.createElement("div",{className:""+(0,p.prefixNS)("filter_title")},(0,d.formatStr)("es_category_label")),u.default.createElement("div",{className:(0,p.prefixNS)("result-facets")},t.map(function(e){return u.default.createElement(y.default,{key:e.get("name"),facet:e,isFetching:r,active:e.get("active")})})))}}]),t}(u.default.Component);t.default=b,b.propTypes={facetInfo:_.PropTypes.instanceOf(f.default.List),isFetching:_.PropTypes.bool.isRequired}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(3),c=function(e){return e&&e.__esModule?e:{default:e}}(i),u=r(0),l=r(2),f=r(4),p=r(1),d=function(e){function t(e){n(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.selectFacet=r.selectFacet.bind(r),r}return a(t,e),s(t,[{key:"selectFacet",value:function(e){var t=this.props.facet;this.props.setFacet(t.get("name"),e.currentTarget.checked),this.props.doSearch()}},{key:"getLabel",value:function(e){return c.default.createElement(p.SVGIconAndLabel,{src:e.get("iconUri"),label:e.get("title")})}},{key:"render",value:function(){var e=this.props,t=e.facet,r=e.active,n=e.isFetching,o=[(0,l.prefixNS)("result-facets__facet"),"checkbox"];r&&o.push((0,l.prefixNS)("result-facets__facet--active"));var a=""!==t.get("name")?t.get("name"):"all";return c.default.createElement("li",{className:(0,u.classNames)(o)},c.default.createElement(p.FormControl.CheckBox,{onChange:this.selectFacet,name:a,checked:r,disabled:n,label:this.getLabel(t)}))}}]),t}(c.default.Component);d.propTypes={facet:u.PropTypes.object.isRequired,active:u.PropTypes.bool.isRequired,isFetching:u.PropTypes.bool.isRequired,setFacet:u.PropTypes.func.isRequired,doSearch:u.PropTypes.func.isRequired};var h={setFacet:f.setFacet,doSearch:f.doSearch};t.default=(0,u.connect)(null,h)(d)},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return{withObsolete:e.search.settings.get("obsolete",0)>0}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(3),u=function(e){return e&&e.__esModule?e:{default:e}}(c),l=r(0),f=r(5),p=r(2),d=r(4),h=r(1),y=function(e){function t(e){n(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.onChange=r.onChange.bind(r),r}return a(t,e),i(t,[{key:"onChange",value:function(e){this.props.toggleObsolete(e.target.checked),this.props.doSearch()}},{key:"render",value:function(){return u.default.createElement("div",null,u.default.createElement("div",{className:""+(0,p.prefixNS)("filter_title")},(0,f.formatStr)("es_obsolete_label")),u.default.createElement("div",{className:(0,p.prefixNS)("filter-obsolete")},u.default.createElement(h.FormControl.CheckBox,{name:"checkBox",checked:this.props.withObsolete,onChange:this.onChange,disabled:this.props.isFetching,label:(0,f.formatStr)("es_obsolete")})))}}]),t}(u.default.Component);y.propTypes={isFetching:l.PropTypes.bool.isRequired,withObsolete:l.PropTypes.bool.isRequired,toggleObsolete:l.PropTypes.func.isRequired,doSearch:l.PropTypes.func.isRequired};var _={toggleObsolete:d.toggleObsolete,doSearch:d.doSearch};t.default=(0,l.connect)(s,_)(y)},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){var t=e.search.settings.get("df");return{activeFilter:void 0===t?"":t}}Object.defineProperty(t,"__esModule",{value:!0}),t.SearchFilterDate=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(3),u=function(e){return e&&e.__esModule?e:{default:e}}(c),l=r(0),f=r(2),p=r(5),d=r(4),h=r(1),y=t.SearchFilterDate=function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),i(t,[{key:"filterByDate",value:function(e){this.props.setFilterDate(e),this.props.doSearch()}},{key:"renderFilter",value:function(e){var t=this.props,r=t.activeFilter,n=t.isFetching;return u.default.createElement(h.FormControl.Radio,{key:e.name,onChange:this.filterByDate.bind(this,e.value),name:"filterDate",value:e.value,checked:r===e.value,disabled:n,label:e.name})}},{key:"render",value:function(){var e=this,t=this.props.filters;return u.default.createElement("div",null,u.default.createElement("div",{className:""+(0,f.prefixNS)("filter_title")},(0,p.formatStr)("es_last_change_label")),u.default.createElement("div",{className:(0,f.prefixNS)("date-filter")+" "+(0,f.prefixNS)("radio-list")+" form-group"},t.map(function(t){return e.renderFilter(t)})))}}]),t}(u.default.Component);y.propTypes={filters:l.PropTypes.arrayOf(l.PropTypes.shape({name:l.PropTypes.string,value:l.PropTypes.string})),isFetching:l.PropTypes.bool.isRequired,activeFilter:l.PropTypes.string.isRequired,setFilterDate:l.PropTypes.func.isRequired,doSearch:l.PropTypes.func.isRequired},y.defaultProps={filters:[]};var _={setFilterDate:d.setFilterDate,doSearch:d.doSearch};t.default=(0,l.connect)(s,_)(y)},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){var t=e.search.settings.get("sortDate");return{sortByDate:Boolean(t)}}Object.defineProperty(t,"__esModule",{value:!0}),t.SearchFilterSort=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(3),u=function(e){return e&&e.__esModule?e:{default:e}}(c),l=r(0),f=r(5),p=r(2),d=r(4),h=r(1),y=t.SearchFilterSort=function(e){function t(e){n(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.onChange=r.onChange.bind(r),r}return a(t,e),i(t,[{key:"onChange",value:function(e){this.props.setSortDate(e),this.props.doSearch()}},{key:"render",value:function(){var e=this.props,t=e.isFetching,r=e.sortByDate;return u.default.createElement("div",null,u.default.createElement("div",{className:""+(0,p.prefixNS)("filter_title")},(0,f.formatStr)("es_sort_label")),u.default.createElement("div",{className:(0,p.prefixNS)("sort-type")+" "+(0,p.prefixNS)("radio-list")+" form-group"},u.default.createElement("div",null,u.default.createElement(h.FormControl.Radio,{name:"sortMode",value:"sortByRelevance",checked:!r,onChange:this.onChange.bind(this,!1),disabled:t,label:(0,f.formatStr)("es_rel_sort")})),u.default.createElement("div",null,u.default.createElement(h.FormControl.Radio,{name:"sortMode",value:"sortByDate",checked:r,onChange:this.onChange.bind(this,!0),disabled:t,label:(0,f.formatStr)("es_date_sort")}))))}}]),t}(u.default.Component);y.propTypes={isFetching:l.PropTypes.bool.isRequired,sortByDate:l.PropTypes.bool.isRequired,setSortDate:l.PropTypes.func.isRequired,doSearch:l.PropTypes.func.isRequired};var _={setSortDate:d.setSortDate,doSearch:d.doSearch};t.default=(0,l.connect)(s,_)(y)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){return e?e.offsetTop+i(e.offsetParent):0}function c(e){var t=e.search.settings.get("has_more");return{searchText:e.search.settings.get("query"),hasMore:void 0!==t&&t}}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(21),f=n(l),p=r(6),d=n(p),h=r(3),y=n(h),_=r(4),b=r(0),m=r(1),g=r(2),v=r(5),S=r(8),E=n(S),T=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),u(t,[{key:"renderTitle",value:function(e){var t=y.default.createElement("span",{dangerouslySetInnerHTML:{__html:e.getIn(["attrs","title"])}});return y.default.createElement(m.SVGIconAndLink,{label:t,to:e.getIn(["self","system:ui_link"]),src:e.getIn(["self","system:icon_link"])})}},{key:"renderExtract",value:function(e){var t=e.get("extract");return"-"===t?"":""===t?"":y.default.createElement("div",{className:(0,g.prefixNS)("result__extract"),dangerouslySetInnerHTML:{__html:t}})}},{key:"renderDetailInformation",value:function(e){var t=e.get("attrs");return y.default.createElement("div",{className:(0,g.prefixNS)("result__detail")},y.default.createElement("div",{className:(0,g.prefixNS)("result__detail-line")+" text-muted"},[t.get("heading"),t.get("person"),(0,f.default)(e.get("date")).format("ll")].reduce(function(e,t){return""!==e&&void 0!==e&&null!==e?e+", "+t:t})))}},{key:"renderFile",value:function(e){var t=e.get("attrs"),r=y.default.createElement("span",{dangerouslySetInnerHTML:{__html:t.get("title")}});return y.default.createElement("div",{key:e.get("cdb_object_id"),className:(0,g.prefixNS)("result__file")},y.default.createElement(m.SVGIconAndLink,{label:r,to:e.get("system:ui_link"),src:e.get("icon")}),y.default.createElement("div",{className:""+(0,g.prefixNS)("result__file-extract"),dangerouslySetInnerHTML:{__html:e.get("extract")}}),y.default.createElement("div",{className:""+(0,g.prefixNS)("result__file-detail")},y.default.createElement("div",{className:(0,g.prefixNS)("result__file-detail-heading")+" text-muted"},t.get("heading"),",",(0,f.default)(e.get("date")).format("ll"),",",t.get("person"))))}},{key:"renderFileList",value:function(e){var t=this;return e.get("files").filter(function(e){return""!==e}).map(function(e){return t.renderFile(e)})}},{key:"renderHeader",value:function(e){return y.default.createElement("div",{className:(0,g.prefixNS)("result__header")},this.renderTitle(e),this.renderDetailInformation(e),this.renderExtract(e))}},{key:"render",value:function(){var e=this.props.searchResult,t=!!e.get("files")&&e.get("files").size>0;return y.default.createElement("div",{className:(0,g.prefixNS)("result")},t?y.default.createElement(m.Collapsible,{header:this.renderHeader(e)},y.default.createElement("div",{className:(0,g.prefixNS)("result__file_list")},this.renderFileList(e))):this.renderHeader(e))}}]),t}(y.default.Component);T.propTypes={searchResult:b.PropTypes.instanceOf(d.default.Map).isRequired};var O=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.scrollListener=r.scrollListener.bind(r),r}return s(t,e),u(t,[{key:"componentWillUnmount",value:function(){this.detachScrollListener()}},{key:"componentDidMount",value:function(){this.attachScrollListener()}},{key:"componentDidUpdate",value:function(){this.attachScrollListener()}},{key:"scrollListener",value:function(){var e=this.domNode,t=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop,r=this.props,n=r.offset;!r.isFetching&&i(e)+e.offsetHeight-t-window.innerHeight<n&&(this.detachScrollListener(),this.props.hasMore&&this.props.fetchNextSearchResult())}},{key:"attachScrollListener",value:function(){this.props.hasMore&&(this.detachScrollListener(),window.addEventListener("scroll",this.scrollListener),window.addEventListener("resize",this.scrollListener))}},{key:"detachScrollListener",value:function(){window.removeEventListener("scroll",this.scrollListener),window.removeEventListener("resize",this.scrollListener)}},{key:"renderSpinner",value:function(){var e=this.props,t=e.resultList,r=e.isFetching;return t.count()>0?y.default.createElement(E.default,{isFetching:r}):null}},{key:"renderMoreButton",value:function(){var e=this,t=this.props,r=t.hasMore,n=t.isFetching;return r?y.default.createElement(m.Button.TextButton,{disabled:n,label:(0,v.formatStr)("more"),onClick:function(){e.props.fetchNextSearchResult()}}):null}},{key:"render",value:function(){var e=this,t=this.props.resultList;return y.default.createElement("div",{className:(0,g.prefixNS)("result-list"),ref:function(t){e.domNode=t}},t.map(function(e){return y.default.createElement(T,{key:e.get("cdb_object_id"),searchResult:e})}),this.renderMoreButton(),this.renderSpinner())}}]),t}(y.default.Component);O.propTypes={offset:b.PropTypes.number,resultList:b.PropTypes.instanceOf(d.default.List),isFetching:b.PropTypes.bool.isRequired,hasMore:b.PropTypes.bool,searchText:b.PropTypes.string,fetchNextSearchResult:b.PropTypes.func},O.defaultProps={offset:350,resultList:[],hasMore:!1,isFetching:!0};var P={fetchNextSearchResult:_.fetchNextSearchResult};t.default=(0,b.connect)(c,P)(O)},function(e,t){e.exports=a}])});
//# sourceMappingURL=cs-web-search.b7dc22ef97b46bfcb13c.js.map