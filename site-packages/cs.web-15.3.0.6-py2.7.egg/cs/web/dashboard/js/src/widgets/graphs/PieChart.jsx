/*
 * Copyright (C) 2017 CONTACT Software GmbH
 * All rights reserved.
 * http://www.contact-software.com
 *
 * Revision "$Id: PieChart.jsx 160779 2017-06-23 08:33:13Z sla $"
 */

import React from 'react';
import {displayPie} from './Pie';
import {predefinedData, getIDPostix} from './Data';

/* global d3 */

function generateFakeData() {
    const data = predefinedData;

    return data.map((d) => {
        return {
            label: d.label,
            value: 1000 * Math.random(),
            color: d.color
        };
    });
}

function drawPie(containerID, wrapperID) {
    const selfID = "dataPie" + getIDPostix();
    const viewport = d3.select("#" + wrapperID);
    viewport.append("g").attr("id", selfID);

    const circleDim = {
        x: 150,
        y: 150,
        rx: 130,
        ry: 100,
        h: 30,
        ir: 0.4
    };

    displayPie(selfID, generateFakeData(), circleDim, containerID);
}


export default class PieChart extends React.Component {
    constructor(props) {
        super(props);
        this.id = "dashboard-graph-intern" + getIDPostix();
        this.wrapperID = "dashboard-histogram" + getIDPostix();
    }

    shouldComponentUpdate() {
        return false;
    }

    componentDidMount() {
        drawPie(this.id, this.wrapperID);
    }

    render() {
        const style = {
            minWidth: '350px'
        };

        return (
            <div id={this.id}>
                <svg id={this.wrapperID} width="50%" height="300" style={style} />
            </div>
        );
    }
}
