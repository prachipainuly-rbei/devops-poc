/*
 * Copyright (C) 2016 CONTACT Software GmbH
 * All rights reserved.
 * http://www.contact-software.com
 *
 * Revision "$Id: Throbber.jsx 183110 2018-08-30 12:59:31Z vov $"
 */

import React from 'react';
import {PropTypes, classNames} from 'cs-web-components-externals';
import {prefixNS} from '../helpers';

import throbberSrc from '../../../resources/throbber.svg';
const SVGB64TYPE = "data:image/svg+xml;base64,";
const B64ICONDATAOFFSET = SVGB64TYPE.length;

/**
 * A control that shows a loading animation.
 *
 */

export default class Throbber extends React.Component {
    renderSVG() {
        const iconData = throbberSrc.substring(B64ICONDATAOFFSET);
        return {
            __html: atob(iconData)
        };
    }

    render() {
        const classes =
            classNames(
                prefixNS(`throbber-wrap-${this.props.size}`),
                {
                    [prefixNS("throbber-hidden")]: this.props.hidden
                }
            );
        if (this.props.throbberImage) {
            return (
                <div className={classes}>
                    <img
                        className={prefixNS("throbber")}
                        src={this.props.throbberImage}/>
                </div>
            );
        } else {
            return (
                <div className={classes}>
                    <div
                        className={prefixNS("throbber")}
                        dangerouslySetInnerHTML={this.renderSVG()}/>
                </div>
            );
        }
    }
}

Throbber.propTypes = {
    hidden: PropTypes.bool,
    throbberImage: PropTypes.string,
    size: PropTypes.oneOf([
        'sm', 'md'
    ])
};

Throbber.defaultProps = {
    hidden: false,
    size: 'md'
};
