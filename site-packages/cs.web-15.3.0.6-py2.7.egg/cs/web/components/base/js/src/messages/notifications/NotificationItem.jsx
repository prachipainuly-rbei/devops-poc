/*
 * Copyright (C) 2016 CONTACT Software GmbH
 * All rights reserved.
 * http://www.contact-software.com
 *
 * Revision "$Id: NotificationItem.jsx 174212 2018-03-08 10:50:39Z vov $"
 */

import React from 'react';
import {Alert} from 'react-bootstrap';
import {PropTypes, ImmutablePropTypes} from 'cs-web-components-externals';
import {prefixNS} from '../../helpers';
import SVGIcon from '../../components/SVGIcon';

export default class NotificationItem extends React.Component {
    constructor(props) {
        super(props);
        this.onClose = this.onClose.bind(this);
        this.pinNotification = this.pinNotification.bind(this);
    }

    onClose() {
        this.props.onClose(this.props.notification.getIn(['message', 'id']));
    }

    pinNotification() {
        const {notification} = this.props;
        notification.getIn(['displayInfo', 'cancelTimeout']).call();
        this.props.onPin(notification.getIn(['message', 'id']));
    }

    render() {
        const {notification} = this.props;
        const cancelTimeout = notification.getIn(['displayInfo', 'cancelTimeout']);
        const pin = cancelTimeout ?
                    (<SVGIcon className="pin" name='csweb_pushpin' size="sm"
                              onClick={this.pinNotification}/>) : null;
        return (
            <Alert className={prefixNS('NotificationItem')}
                   bsStyle={notification.getIn(['displayInfo', 'type'])}
                   onDismiss={this.onClose}>
                {pin}
                <div className="notification-title">
                    {notification.getIn(['message', 'title'])}
                </div>
                <div className={prefixNS('NotificationContainer__notification')}>
                    {notification.getIn(['message', 'message'])}
                </div>
            </Alert>
        );
    }
}

NotificationItem.propTypes = {
    onClose: PropTypes.func,
    onPin: PropTypes.func,
    notification: ImmutablePropTypes.map
};
