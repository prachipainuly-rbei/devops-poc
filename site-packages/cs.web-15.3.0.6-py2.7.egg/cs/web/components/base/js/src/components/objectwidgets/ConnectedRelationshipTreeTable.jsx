/*
 * Copyright (C) 2017 CONTACT Software GmbH
 * All rights reserved.
 * http://www.contact-software.com
 *
 * Revision "$Id: ConnectedRelationshipTreeTable.jsx 176920 2018-05-07 13:23:57Z gwe $"
 */

import React from 'react';
import {PropTypes, ImmutablePropTypes} from 'cs-web-components-externals';
import RelationshipTable from './RelationshipTable.jsx';
import ExpandedStateHelper from './ExpandedStateHelper.jsx';
import ClassRelshipLoader from './ClassRelshipLoader.jsx';

/**
 * Wraps a RelationshipTable that renders a TreeTable with logic to retrieve
 * relationship configuration data from the application setup, and handles
 * expanded state.
 * This component is intended for use from page configuration files.
 *
 * @class ConnectedRelationshipTreeTable
 * @extends React.Component
 */
export default function ConnectedRelationshipTreeTable(props) {
    return (
        <ExpandedStateHelper initialExpanded={props.expanded}>
            {(expanded, onExpanded) => (
                <div style={{width: props.width}}>
                    <ClassRelshipLoader contextObject={props.contextObject}>
                        {relships => (
                            <RelationshipTable {...props}
                                asTree={true}
                                relshipLabel={relships.getIn([props.relshipName, 'label'])}
                                relshipIconUrl={relships.getIn([props.relshipName, 'icon_url'])}
                                expanded={expanded}
                                onExpanded={onExpanded}
                            />
                        )}
                    </ClassRelshipLoader>

                </div>
            )}
        </ExpandedStateHelper>
    );
}
ConnectedRelationshipTreeTable.propTypes = {
    contextObject: ImmutablePropTypes.map,
    relshipName: PropTypes.string.isRequired,
    treeParentColumnID: PropTypes.string.isRequired,
    treeIDColumnID: PropTypes.string.isRequired,
    treeColumnID: PropTypes.string.isRequired,
    expanded: PropTypes.bool,
    width: PropTypes.string,
    height: PropTypes.string
};
ConnectedRelationshipTreeTable.defaultProps = {
    expanded: true,
    height: "auto"
};
