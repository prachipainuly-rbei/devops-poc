/*
 * Copyright (C) 2017 CONTACT Software GmbH
 * All rights reserved.
 * http://www.contact-software.com
 *
 * Revision "$Id: object-store.js 169704 2017-12-01 10:15:26Z gwe $"
 */

/* eslint-env jest */

import Immutable from 'immutable';
import {receivedObject} from '../../actions/object-actions.js';
import {objectsById} from '../object-store.js';

describe('The reducer', () => {

    describe('for the object store', () => {

        it('is initially an empty Map', () => {
            const store = objectsById(undefined, {type: 'dummy'});
            expect(Immutable.Map.isMap(store)).toBe(true);
            expect(store.isEmpty()).toBe(true);
        });

        it('stores an object under its @id', () => {
            const obj = {
                '@id': 'http://demo/12345',
                data: 42
            };
            const action = receivedObject(obj['@id'], obj);
            const store = objectsById(undefined, action);
            expect(store.toJS()).toEqual({[obj['@id']]: obj});
        });

        it('stores an object under its URL', () => {
            const url = 'http://demo/abcde';
            const obj = {
                '@id': 'http://demo/12345',
                data: 42
            };
            const action = receivedObject(url, obj);
            const store = objectsById(undefined, action);
            expect(store.toJS()).toEqual({
                [url]: obj,
                [obj['@id']]: obj
            });
        });

    });

});
