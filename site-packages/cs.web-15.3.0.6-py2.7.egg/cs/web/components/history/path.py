#!/usr/bin/env powerscript
# -*- python -*- coding: iso-8859-1 -*-
#
# Copyright (C) 2016 CONTACT Software GmbH
# All rights reserved.
# http://www.contact-software.com
#

"""
Morepath path declaration for Web UI history
"""

__revision__ = "$Id: path.py 149524 2016-11-21 13:40:09Z heiko $"

from webob.exc import HTTPBadRequest

from .main import HistoryApp
from .model import HistoryCollection
from . import get_history_size


@HistoryApp.path(model=HistoryCollection, path='')
def _get_history_collection(rest_name='', amount=-1, as_table=None):
    if as_table is not None and rest_name == '':
        return HTTPBadRequest(detail='as_table not allowed without rest_name')
    if amount == -1:
        amount = get_history_size()
    return HistoryCollection(rest_name, amount, as_table)
