.. _`10_1_1_service_levels`:

cs.metrics 10.1.1 Service Levels
################################


Service Level 14
================


Aggregation Service as Message Queue
------------------------------------

The asynchronous service calculating aggregated values for Quality
Characteristics is now implemented as a Message Queue.

This reduces waiting times, as jobs are not executed once a day, but at any time
the Message Queue is idle.


Service Level 15
================


New Export Format
-----------------

The format of ``metrics.json`` files has been changed slightly.

When using ``cdbpkg build`` on your custom module, you will see differences like
the following in your ``metrics.json`` files:

.. code-block:: sourcecode

    --- metrics.json    (revision 117151)
    +++ metrics.json    (revision 117152)
    @@ -16,7 +16,7 @@
             }
           }
         ],
    -    "CONTENT_DOMAIN": "Metrics",
    +    "CONTENT_DOMAIN": "",
         "UPDATE_POLICY": "NEVER UPDATED"
       },

These changes are by design.

Service Level 17
===============================

Additional parameter in method ``QualityCharacteristic.getWhereCondition``
--------------------------------------------------------------------------

This service level adds a second parameter ``relation`` to ``QualityCharacteristic.getWhereCondition``.
In all customer classes inherited from ``QualityCharacteristic`` the method signature must be adjusted.

old:

.. code-block:: python

    def getWhereCondition(self):

new:

.. code-block:: python

    def getWhereCondition(self, relation):

Service Level 18
===============================

Additional parameter in method ``QualityCharacteristic.getWhereCondition``
--------------------------------------------------------------------------

This service level adds a third parameter ``root_alias`` to ``QualityCharacteristic.getWhereCondition``.
In all customer classes inherited from ``QualityCharacteristic`` the method signature must be adjusted.

old:

.. code-block:: python

    def getWhereCondition(self, relation):

new:

.. code-block:: python

    def getWhereCondition(self, relation, root_alias):