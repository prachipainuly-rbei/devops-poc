.. _`15_2_0_service_levels`:

cs.metrics 15.2.0 Service Levels
################################

Service Level 15
================

To avoid some licensing problems this service level adds the system service users ``qcaggregationengine`` and ``qccomputationengine`` and changes the service options of the ``cs.metrics.qc_engine.QCAggregationEngine`` and ``cs.metrics.qc_engine.QCComputationEngine`` services to use their matching service user if there is no user configured already.

Service Level 11
===============================

Additional parameter in method ``QualityCharacteristic.getWhereCondition``
--------------------------------------------------------------------------

This service level adds a third parameter ``root_alias`` to ``QualityCharacteristic.getWhereCondition``.
In all customer classes inherited from ``QualityCharacteristic`` the method signature must be adjusted.

old:

.. code-block:: python

    def getWhereCondition(self, relation):

new:

.. code-block:: python

    def getWhereCondition(self, relation, root_alias):

Service Level 10
==========================

Additional attributes for ``QualityCharacteristic``
--------------------------------------------------

The attribute ``cdbqc_qgrade_object_id`` (a reference the corresponding quality grade) has been added to ``QualityCharacteristic`` for performance reasons.
As ``QualityCharacteristic.getGrade`` no longer looks up the latest quality grade from history, for not computed quality characteristics you have to execute the update tool :samp:`cs.metrics.tools.migration` with the following parameters for all quality characteristics within a module:

.. code-block:: console

    powerscript -m cs.metrics.tools.migration update-qgrade -im cs.metrics

Since this action may take a long time if you have a huge quantity of data, you can also directly update a specific KPI:

.. code-block:: console

    powerscript -m cs.metrics.tools.migration update-qgrade -ic INSERT_KPI_CODE_HERE
    
Until you have executed the update tool the quality grade will not be shown correctly within the KPI Cockpit. 
But all future changes of KPI values using ``QualityCharacteristic.set_actual_value`` will automatically set the quality grade value given.

Service Level 9
==========================

Additional parameter in method ``QualityCharacteristic.getWhereCondition``
--------------------------------------------------------------------------

This service level adds a second parameter ``relation`` to ``QualityCharacteristic.getWhereCondition``.
In all customer classes inherited from ``QualityCharacteristic`` the method signature must be adjusted.

old:

.. code-block:: python

    def getWhereCondition(self):

new:

.. code-block:: python

    def getWhereCondition(self, relation):