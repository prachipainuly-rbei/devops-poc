.. _`qc-management-comp-rules-custom`:

Custom Berechnungsregel
#######################

Wie bereits mehrfach im Beschreibungsverlauf erwähnt, wird eine Customregel im Python-Code implementiert. Dabei ist es wichtig, dass an der betreffenden Stelle der Konfigurationen ein voll qualifizierter Python-Name eingetragen wird, der ein gültiges, aufrufbares Objekt referenziert. 

Beim Aufruf bzw. bei der Abfrage wird dabei ein einziger Parameter übergeben: das passende Kennzahlenobjekt. Anhand dieses Parameters kann unter anderem 

- das notwendige Fachobjekt
- die Kennzahldefinition
- die Klassenzuordnung
- die Klasse der Klassenzuordnung
- die (mögliche) Gruppierung 

etc. ermittelt werden. Gültige Rückgabewerte der Abfrage sind ein nummerischer Wert, als Ergebnis der Berechnung oder der Ausdruck ``cdb.objects.NULL``. 

.. note::
	Der Aufruf der Customregel soll den neuen Wert zurückgeben, ohne die Kennzahl selbst zu aktualisieren. Sollte es nicht möglich sein, die Kennzahl zu berechnen, dann sollte eine Exception geworfen werden. Das System aktualisiert den Kennzahlwert und protokolliert sämtliche Exceptions.
 
