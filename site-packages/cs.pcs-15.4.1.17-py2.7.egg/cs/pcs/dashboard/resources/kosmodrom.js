// === Activates Picture Uploader plug-in ===
var pictureUploader = new cdbElinkPictureUploader();
// impl. the data preparing function
pictureUploader.prepareModal = function(event) {
  var target = $(event.currentTarget);
  // project image(overview page, detail page)
  var projectId = target.closest(
      '.projecttiles, div.projectdetail.main-area.kosmodrom'
    ).attr('data-elink-cdb_project_id');
  if(projectId !== '' && (typeof projectId !== 'undefined')){
      this.setWindowTitle(projectId);
      this.popupWindow.find('input[name=cdb_project_id]').val(projectId);
  }

  // team member picture(detail page)
  var personId = target.closest('.team-member').find('span.hide.person-id').text();
  var personName = target.closest('.team-member').find('strong').text();
  if(personId !== '' && (typeof personId !== 'undefined')){
    this.setWindowTitle(personName);
    this.popupWindow.find('input[name=person_id]').val(personId);
  }
};
//Tells cdb.elink to run uploader.
cdb.elink.addApplication('cdb.elink.pictureuploader4kosmodrom', pictureUploader);

// === Activates Collapsible Blocks plug-in ===
var collapsibleBlocks = new cdbElinkCollapsibleBlocks();
collapsibleBlocks.blockSettingID = 'cdb.elink.kosmodrom';
//Tells cdb.elink to run that plug-in.
cdb.elink.addApplication('cdb.elink.collapsibleblocks4kosmodrom', collapsibleBlocks);

//=== Blog app. ===
if(typeof cdbElinkBlogPosting != 'undefined') {
  var cdbBlogApp = new cdbElinkBlogPosting('#elink_page_content div.projectactivities');
  // Uses standard reloading feature
  cdbBlogApp.reloadPostingURL = cdbBlogApp.defaultReloadPostingURL;
  //Tells cdb.elink to run blog.
  cdb.elink.addApplication('cdb.elink.cdbblog4kosmodrom', cdbBlogApp);
}

// Tells cdb.elink to run this application.
cdb.elink.addApplication('cdb.elink.kosmodrom', new cdbElinkKosmodrom());
