!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("cs-web-components-base"),require("React"),require("cs-web-components-externals"),require("ReactBootstrap"),require("Immutable")):"function"==typeof define&&define.amd?define(["cs-web-components-base","React","cs-web-components-externals","ReactBootstrap","Immutable"],t):"object"==typeof exports?exports["cs-pcs-msp-web-imports"]=t(require("cs-web-components-base"),require("React"),require("cs-web-components-externals"),require("ReactBootstrap"),require("Immutable")):e["cs-pcs-msp-web-imports"]=t(e["cs-web-components-base"],e.React,e["cs-web-components-externals"],e.ReactBootstrap,e.Immutable)}(this,function(e,t,n,r,o){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=5)}([function(t,n){t.exports=e},function(e,t,n){"use strict";function r(e){return"cs-pcs-msp-web-imports-"+e}Object.defineProperty(t,"__esModule",{value:!0}),t.prefixNS=r},function(e,n){e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatStr=t.Format=void 0;var r=n(0);t.Format=r.i18ndb.makeFormat("msp-imports"),t.formatStr=r.i18ndb.makeFormatStr("msp-imports")},function(e,t){e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MainComponent=void 0;var r=n(0),o=n(1),a=n(6),i=function(e){return e&&e.__esModule?e:{default:e}}(a);r.Registry.registerComponent((0,o.prefixNS)("MainComponent"),i.default),t.MainComponent=i.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(2),l=r(u),s=n(0),f=n(7),p=r(f),d=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),c(t,[{key:"render",value:function(){return l.default.createElement(s.SinglePage,{frameComponent:s.PageFrame.ApplicationFrame,pageContent:p.default})}}]),t}(l.default.Component);t.default=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(2),l=r(u),s=n(8),f=n(9),p=r(f),d=n(0),m=n(3),b=n(10),g=r(b),y=n(11),h=r(y),x=n(1),v=d.Registry.findComponent("cs-web-components-base-ContentBlockGroup"),w=d.Registry.findComponent("cs-web-components-base-Icon"),E=(0,d.getAppSetup)().getIn(["links","cs-pcs-msp-web-imports","dataLink"]),_=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={data:null,error:null,busy:!1},n.previewImport=n.previewImport.bind(n),n.executeImport=n.executeImport.bind(n),n.closeWindow=n.closeWindow.bind(n),n}return i(t,e),c(t,[{key:"componentDidMount",value:function(){this.previewImport()}},{key:"previewImport",value:function(){var e=this;(0,d.getJSON)(E).then(function(t){return e.setState({data:p.default.fromJS(t)})},function(t){t.response.json().then(function(t){e.setState({error:t})})})}},{key:"executeImport",value:function(){var e=this;this.setState({busy:!0}),(0,d.postJSON)(E).then(function(t){return e.setState({data:p.default.fromJS(t),busy:!1})},function(t){t.response.json().then(function(t){e.setState({error:t})})})}},{key:"closeWindow",value:function(){window.close()}},{key:"render",value:function(){var e=this.state,t=e.data,n=e.error,r=e.busy;if(n)return l.default.createElement("div",null,l.default.createElement("h1",null,l.default.createElement("b",null,n.title)),l.default.createElement("h3",null,n.explanation),l.default.createElement("p",null,l.default.createElement("i",null,n.detail)));var o=l.default.createElement("div",{className:(0,x.prefixNS)("result-please-wait")},l.default.createElement(d.Throbber,null),l.default.createElement("br",null),(0,m.formatStr)("please_wait"));if(!t)return o;var a=t.get("project"),i=t.get("tasks"),c=t.get("info"),u=!1;if(c.get("dryRun")){var f=c.get("exceptedCount");f+=c.get("deletedCount"),f+=c.get("addedPercentage"),f+=c.get("modifiedCount"),0===f&&(u=!0)}else if(0===c.get("exceptedCount"))return this.previewImport(),null;return l.default.createElement("div",{className:(0,x.prefixNS)("result")},l.default.createElement("div",{className:(0,x.prefixNS)("result-header")},l.default.createElement(s.Button,{onClick:this.executeImport,disabled:r||u},l.default.createElement(w,{size:"xs",name:"Import"}),"   ",(0,m.formatStr)("execute_import")),l.default.createElement(s.Button,{onClick:this.closeWindow,disabled:r},l.default.createElement(w,{size:"sm",name:"csweb_cancel"}),"   ",u?(0,m.formatStr)("close"):(0,m.formatStr)("cancel")),l.default.createElement(h.default,{width:"100%",height:"36",exceptedPercentage:c.get("exceptedPercentage"),exceptedCount:c.get("exceptedCount"),deletedPercentage:c.get("deletedPercentage"),deletedCount:c.get("deletedCount"),addedPercentage:c.get("addedPercentage"),addedCount:c.get("addedCount"),modifiedPercentage:c.get("modifiedPercentage"),modifiedCount:c.get("modifiedCount")})),r?o:null,l.default.createElement(g.default,{diffObject:a}),u?l.default.createElement("div",{className:(0,x.prefixNS)("result-synced")},(0,m.formatStr)("synced")):l.default.createElement(v,null,i.map(function(e,t){return l.default.createElement(g.default,{key:t,diffObject:e})})))}}]),t}(l.default.Component);t.default=_},function(e,t){e.exports=r},function(e,t){e.exports=o},function(e,t,n){"use strict";function r(e){function t(e){return e.get("diffs").size>0||e.get("references").size>0||e.get("exceptions").size>0}var n=e.diffObject,a=n.get("references");return i.default.createElement(f,{className:function(e){return t(e)?(0,s.prefixNS)("object-"+e.get("diff_type")):(0,c.classNames)((0,s.prefixNS)("object-"+e.get("diff_type")),(0,s.prefixNS)("object-not-collapsible"))}(n),title:function(e){var t=null,n=e.get("exceptions").size;return e.get("references").valueSeq().map(function(e){return e.valueSeq().map(function(e){return n+=e.get("exceptions").size}),e}),1===n?t="1 "+(0,l.formatStr)("error"):n>1&&(t=n+" "+(0,l.formatStr)("errors")),null==t?i.default.createElement("span",null,i.default.createElement("a",{href:e.get("hyperlink"),onClick:function(e){e.stopPropagation()}},e.get("title"))):i.default.createElement("span",null,i.default.createElement("a",{href:e.get("hyperlink"),onClick:function(e){e.stopPropagation()}},e.get("title")),i.default.createElement("span",{className:(0,s.prefixNS)("error-badge")},t))}(n),icon:function(e){switch(e.get("diff_type")){case"added":case"modified":case"deleted":return i.default.createElement("span",null,i.default.createElement(d,{size:"xs",name:"cdbpcs_msp_object_"+e.get("diff_type")}),i.default.createElement(d,{className:(0,s.prefixNS)("class-icon"),size:"xs",name:e.get("icon_name")}));default:return i.default.createElement("span",null,i.default.createElement("span",{style:{display:"inline-block","min-width":"16px"}}),i.default.createElement(d,{className:(0,s.prefixNS)("class-icon"),size:"xs",name:e.get("icon_name")}))}}(n),collapsible:t(n),expanded:function(e){return e.get("exceptions").size>0||"cdbpcs_project"===e.get("classname")&&e.get("diffs").size>0}(n)},i.default.createElement(f.Body,null,i.default.createElement("div",{className:(0,s.prefixNS)("diff-body")},i.default.createElement("table",{className:(0,s.prefixNS)("exceptions")},n.get("exceptions").map(function(e,t){return i.default.createElement("tr",{key:t},i.default.createElement("td",null,e))})),a.valueSeq().map(function(e,t){return i.default.createElement(p,{className:(0,s.prefixNS)("references"),key:t},e.valueSeq().map(function(e,t){return i.default.createElement(r,{diffObject:e,key:t})}))}),i.default.createElement(o,{diffs:n.get("diffs")}))))}function o(e){var t=e.diffs;return i.default.createElement("table",{className:(0,s.prefixNS)("diff-table")},t.valueSeq().map(function(e,t){return i.default.createElement("tr",{key:t},i.default.createElement("td",{className:(0,s.prefixNS)("diff-label")},e.get("label")),i.default.createElement("td",{className:(0,s.prefixNS)("diff-old-value")},e.get("old_value")),i.default.createElement("td",{className:(0,s.prefixNS)("diff-new-value")},e.get("new_value")))}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var a=n(2),i=function(e){return e&&e.__esModule?e:{default:e}}(a),c=n(4),u=n(0),l=n(3),s=n(1),f=u.Registry.findComponent("cs-web-components-base-ContentBlock"),p=u.Registry.findComponent("cs-web-components-base-ContentBlockGroup"),d=u.Registry.findComponent("cs-web-components-base-Icon");r.propTypes={diffObject:c.PropTypes.object},o.propTypes={diffs:c.PropTypes.object}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(2),u=function(e){return e&&e.__esModule?e:{default:e}}(c),l=n(4),s=n(1),f=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.stretchItems=n.stretchItems.bind(n),n}return a(t,e),i(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.stretchItems),this.stretchItems()}},{key:"componentDidUpdate",value:function(){this.stretchItems()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.stretchItems)}},{key:"stretchItems",value:function(){var e=document.getElementsByClassName((0,s.prefixNS)("percentage-bar"))[0].getBoundingClientRect().width;document.getElementsByClassName((0,s.prefixNS)("percentage-bar-empty"))[0].setAttribute("width",e-4);var t=document.getElementsByClassName((0,s.prefixNS)("percentage-bar-excepted"))[0],n=(e-6)*this.props.exceptedPercentage/100;t.setAttribute("width",n);var r=document.getElementsByClassName((0,s.prefixNS)("percentage-bar-deleted"))[0],o=(e-6)*this.props.deletedPercentage/100;r.setAttribute("x",n+3),r.setAttribute("width",o);var a=document.getElementsByClassName((0,s.prefixNS)("percentage-bar-added"))[0],i=(e-6)*this.props.addedPercentage/100;a.setAttribute("x",n+o+3),a.setAttribute("width",i);var c=document.getElementsByClassName((0,s.prefixNS)("percentage-bar-modified"))[0],u=(e-6)*this.props.modifiedPercentage/100;c.setAttribute("x",n+o+i+3),c.setAttribute("width",u)}},{key:"render",value:function(){return u.default.createElement("svg",{className:(0,s.prefixNS)("percentage-bar"),width:this.props.width,height:this.props.height},u.default.createElement("rect",{className:(0,s.prefixNS)("percentage-bar-empty"),x:"2",y:"2",rx:"2",ry:"2",height:this.props.height-4}),u.default.createElement("rect",{className:(0,s.prefixNS)("percentage-bar-excepted"),x:"3",y:"3",height:this.props.height-6},u.default.createElement("title",null,this.props.exceptedCount)),u.default.createElement("rect",{className:(0,s.prefixNS)("percentage-bar-deleted"),y:"3",height:this.props.height-6},u.default.createElement("title",null,this.props.deletedCount)),u.default.createElement("rect",{className:(0,s.prefixNS)("percentage-bar-added"),y:"3",height:this.props.height-6},u.default.createElement("title",null,this.props.addedCount)),u.default.createElement("rect",{className:(0,s.prefixNS)("percentage-bar-modified"),y:"3",height:this.props.height-6},u.default.createElement("title",null,this.props.modifiedCount)))}}]),t}(u.default.Component);t.default=f,f.propTypes={exceptedPercentage:l.PropTypes.number,deletedPercentage:l.PropTypes.number,addedPercentage:l.PropTypes.number,modifiedPercentage:l.PropTypes.number,width:l.PropTypes.number,height:l.PropTypes.number,exceptedCount:l.PropTypes.number,deletedCount:l.PropTypes.number,addedCount:l.PropTypes.number,modifiedCount:l.PropTypes.number}}])});
//# sourceMappingURL=cs-pcs-msp-web-imports.js.map