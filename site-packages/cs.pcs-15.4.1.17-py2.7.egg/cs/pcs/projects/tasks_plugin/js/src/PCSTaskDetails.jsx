/* -*- mode: javascript; coding: utf-8 -*-
 * $Id: PCSTaskDetails.jsx 182658 2018-08-22 11:58:52Z cso $
 *
 * Copyright (c) 1990 - 2018 CONTACT Software GmbH
 * All rights reserved.
 * http://www.contact-software.com
 */

import React from 'react';
import Immutable from 'immutable';
import {formatStr} from './i18n';
import {prefixNS} from './helpers';
import {Registry} from 'cs-web-components-base';
import {ImmutablePropTypes} from 'cs-web-components-externals';

const LongText = Registry.findComponent('cs-taskmanager-web-LongText');
const DateCell = Registry.findComponent('cs-taskmanager-web-DateCell');
const AttributeList = Registry.findComponent('cs-taskmanager-web-AttributeList');

/**
 * A Component to display a cs.pcs.projects.tasks.Task object's details.
 *
 * React Properties
 * ................
 *
 * +----------------+---------------+------------------+-------------------------------------------+
 * | Property       | Type          | Default          | Use                                       |
 * +================+===============+==================+===========================================+
 * | task           | Immutable.Map | \-               | The object as returned by the REST API.   |
 * +----------------+---------------+------------------+-------------------------------------------+
 *
 */

function PCSTaskDetails({task}) {
    const planned_start = Immutable.fromJS({'iso': task.get('start_time_plan')});
    const planned_end = Immutable.fromJS({'iso': task.get('end_time_plan')});

    return (
        <div className={prefixNS('details')}>
            <AttributeList
                attributes={[
                    {
                        label: formatStr('time_planned'),
                        value: (
                            <span className={prefixNS('dates')}>
                                <DateCell
                                    unstyled
                                    value={planned_start}
                                    row={Immutable.Map()}
                                    column={Immutable.Map()}
                                />
                                -
                                <DateCell
                                    unstyled
                                    value={planned_end}
                                    row={Immutable.Map()}
                                    column={Immutable.Map()}
                                />
                            </span>
                        )
                    },
                    {
                        label: `${formatStr('effort')} [${formatStr('hour')}]`,
                        value: task.get('effort_fcast')
                    },
                    {
                        label: `${formatStr('completion')} [%]`,
                        value: task.get('percent_complet')
                    }
                ]}
            />

            <br />
            <LongText text={task.get('cdbpcs_task_txt')} />
        </div>
    );
}

PCSTaskDetails.propTypes = {
    task: ImmutablePropTypes.map.isRequired
};

export default PCSTaskDetails;
