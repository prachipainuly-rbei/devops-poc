#!/usr/bin/env powerscript
# -*- python -*- coding: utf-8 -*-
#
# Copyright (C) 2017 CONTACT Software GmbH
# All rights reserved.
# http://www.contact-software.com
#

__docformat__ = "restructuredtext en"
__revision__ = "$Id: test_ml_responsibles.py 182034 2018-08-10 12:22:21Z umu $"

import unittest

from cdb import testcase
from cdb.constants import kOperationNew
from cdb.objects.operations import operation

from cs.pcs.projects import Project
from cs.pcs.projects.tasks import Task


class MLResponsibles(testcase.RollbackTestCase):

    def _setup_project(self):
        self.project = operation(kOperationNew, Project, cdb_project_id="#")
        self.task_one = operation(
            kOperationNew,
            Task,
            cdb_project_id=self.project.cdb_project_id,
            task_id="#",
            task_name='One',
            subject_id='caddok',
            subject_type='Person'
        )
        self.task_two = operation(
            kOperationNew,
            Task,
            cdb_project_id=self.project.cdb_project_id,
            task_id="#",
            task_name='Two',
            subject_id='Projektleiter',
            subject_type='PCS Role'
        )
        self.task_three = operation(
            kOperationNew,
            Task,
            cdb_project_id=self.project.cdb_project_id,
            task_id="#",
            task_name='Three',
            subject_id='Documentation',
            subject_type='Common Role'
        )

    def test_ml_responsibles_of_pcs_tasks(self):
        self._setup_project()
        self.assertEqual(self.task_one.mapped_subject_name_de, "Administrator")
        self.assertEqual(self.task_one.mapped_subject_name_en, "Administrator")
        self.assertEqual(self.task_two.mapped_subject_name_de, "Projektleiter")
        self.assertEqual(self.task_two.mapped_subject_name_en, "Project Manager")
        self.assertEqual(self.task_three.mapped_subject_name_de, "Dokumentation")
        self.assertEqual(self.task_three.mapped_subject_name_en, "Documentation")


# Allow running this testfile directly
if __name__ == "__main__":
    unittest.main()
