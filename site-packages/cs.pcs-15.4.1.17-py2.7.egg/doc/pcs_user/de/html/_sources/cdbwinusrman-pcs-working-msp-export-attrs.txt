.. _`cdbwinusrman-pcs-working-msp-export-attrs`:

Rückabgleich bestimmter Aufgabenattribute
#########################################

Über eine :ref:`Kontextmenüoperation <cdbwinusrman-pcs-projects-kontextmenue-export-attrs>`
können bestimmte Aufgabeneigenschaften in eine Excel-Datei ausgeleitet werden. Diese Datei kann
anschließend direkt in |tm.project| in den entsprechenden Terminplan importiert werden. Dabei ist
folgendermaßen vorzugehen:

1. In |tm.project| im *Öffnen* Dialog den Dateiendungsfilter auf *.xlsx* ändern
   und die zuvor generierte Excel-Datei auswählen.
2. In dem sich nun öffnenden *Import-Assistenten* ein *Neues Schema* definieren.
3. Dabei die Option *Daten mit dem aktiven Projekt zusammenführen* auswählen.
4. Nun die Option *Vorgänge* auswählen und auf *Weiter* klicken.
5. Im *Vorgangsschema* Dialog den Excel-Blattnamen *PcsTaskAttributesToMsp*
   auswählen.
6. Folgende Excel-Felder und |tm.project|-Felder verknüpfen:

      +-------------------+-------------+
      |msp_uid            |Einmalige Nr.|
      +-------------------+-------------+
      |status             |Zahl10       |
      +-------------------+-------------+
      |joined_status_name |Text15       |
      +-------------------+-------------+
      |mapped_subject_name|Text14       |
      +-------------------+-------------+

   Wobei nur die erste Verknüpfung obligatorisch ist. Alle weiteren Verknüpfungen sind optional
   bzw. können auch mit anderen |tm.project|-Feldern verknüpft werden.
7. Die erste Verknüpfung (*Einmalige Nr.*) zusätzlich als *Fusionsschlüssel
   setzen*.
8. Im folgenden abschließen Dialogformular kann das soeben definierte Schema global gespeichert
   werden, so dass bei allen folgenden Rückabgleichen nur noch das Schema gewählt werden muss und
   somit die Schritte 2 bis 7 entfallen.

.. note::

   Ein global gespeichertes Schema kann auch bereits im Vorfeld in jede beliebige MPP-Datei
   übertragen werden, beispielsweise in eine gemeinsam genutzte Terminplanvorlage. Dadurch entfällt
   die Notwendigkeit, das Schema auf jedem Arbeitsplatz zu definieren.

.. toctree::
   :maxdepth: 2
