.. _`cdbwinusrman-pcs-doctemplates`:

Dokumentvorlagen in Projektstrukturen
#####################################

Bei der Durchführung eines Projektes werden je nach Projektart sehr viele
Dokumente unterschiedlicher Art erzeugt. Das Spektrum reicht dabei von 
Planungsdokumente über Konzeptions- und Spezifikationsdokumente bis hin zu
QM-Dokumente. Für die Erstellung derartiger Projektdokumente werden häufig
Vorlagen verwendet, um eine möglichst hohe Standardisierung zu erreichen
und dem Ersteller einen geeigneten Rahmen vorzugeben.

.. _`cdbwinusrman-pcs-doctemplates-processing-context`:

Das System unterstützt diese vorlagenbasierte Arbeitsweise durch Zuordnungsmöglichkeiten
von Dokumentvorlagen innerhalb der Projektstruktur. Die Zuordnung von Vorlagen
kann dabei für beliebige Bearbeitungskontexte auf allen Ebenen der Projektstruktur
erfolgen:

  - Allgemeine Vorlagen auf Projektebene
  - Aufgabenspezifischen Vorlagen auf Projektphasen-, Arbeitspaket- und
    Einzelaufgabenebene
  - Vorlagen auf Checklisten-, Qualitygate- und Deliverableebene
  - Vorlagen für einzelne Prüfpunkte von Checklisten, Qualitygates und
    Deliverables

Als Dokumentvorlagen können in Projektstrukturen beliebige :guilabel:`Dokumente`
verwendet werden. Das als Vorlage zugeordnete Dokument muss nicht zwingend
als Vorlage gekennzeichnet sein. Dadurch können Vorlagen im Projektkontext
verwendet werden, ohne diese innerhalb der allgemeinen Vorlagenverwaltung
für alle Projektmitarbeiter verfügbar zu machen.

Die Zuordnung von Dokumentvorlagen ist besonders bei standardisierten
Projektabläufen in Verbindung mit Projektvorlagen sinnvoll. Die Dokumentvorlagen
werden dabei nur einmalig der Projektvorlage zugeordnet und stehen anschließend
in allen aus der Projektvorlage erzeugten Projekten zur Verfügung. Die
Vorlagenzuordnungen der konkreten Projekte können während der Projektlaufzeit
jederzeit ergänzt und geändert werden.

Auch bei individuellen Projekten ist die Zuordnung von Dokumentvorlagen sinnvoll.
Beispielsweise für spezielle Vorlagen, die ausschließlich im Rahmen eines
bestimmten Projekts verwendet werden sollen oder um den Aufgabenbearbeitern
die eigenverantwortliche Recherche nach den richtigen Vorlagen abzunehmen.

Durch die Zuordnung von Dokumentvorlagen lässt sich auf einfache Art und Weise
sicherstellen, dass in den Projekten die jeweils richtigen Dokumentvorlagen verwendet werden.
Der Bearbeiter muss die Vorlage nicht
in Eigenverantwortung suchen und verwenden, sondern findet die zur Erledigung
seiner Aufgaben benötigten Vorlagen in seinem Bearbeitungskontext vor.

.. _`cdbwinusrman-pcs-doctemplates-assign`:

Dokument als Vorlage im Projekt zuordnen
========================================

Dokumente oder Dokumentvorlagen ordnen Sie bevorzugt via |dragndrop| zu und gehen dabei wie folgt vor:

#. Navigieren Sie in der Projektstruktur in den gewünschten :ref:`Bearbeitungskontext <cdbwinusrman-pcs-doctemplates-processing-context>`
#. Navigieren Sie zur Beziehung :guilabel:`Dokumentvorlagen`
#. Öffnen Sie in einem weiteren Register eine Ergebnisliste über Dokumente oder Dokumentvorlagen
#. Markieren Sie ein oder mehrere Dokumente, die Sie zuordnen wollen.
#. Ziehen Sie die Dokumente in das Beziehungsregister :guilabel:`Dokumentvorlagen`
#. Bestätigen Sie die Zuordnung durch klicken der Schaltfläche :guilabel:`Neu`

Damit haben Sie das Dokument im Bearbeitungskontext als Vorlage zugeordnet.

.. _`cdbwinusrman-pcs-doctemplates-assignment-master-date`:

Eigenschaften der Zuordnung von Dokumenten als Vorlagen in Projekten
====================================================================

:guilabel:`Projektnummer`
    Hier müssen Sie die Projektnummer auswählen.

:guilabel:`Aufgabe`
   Nur im :ref:`Bearbeitungskontext <cdbwinusrman-pcs-doctemplates-processing-context>` einer Projektaufgabe:
   Hier müssen Sie eine Aufgabe auswählen.

:guilabel:`Checkliste`
   Nur im :ref:`Bearbeitungskontext <cdbwinusrman-pcs-doctemplates-processing-context>` einer Checkliste oder eines
   Prüfpunkts: Hier müssen Sie eine Checkliste auswählen.

:guilabel:`Aufgabe`
   Nur im :ref:`Bearbeitungskontext <cdbwinusrman-pcs-doctemplates-processing-context>` eines Prüfpunkts:
   Hier müssen Sie einen Prüfpunkt auswählen.

:guilabel:`Dokumentnummer`
   Hier müssen Sie eine Dokumentnummer auswählen.

:guilabel:`Index`
   Hier können Sie einen Dokumentindex auswählen.

.. _`cdbwinusrman-pcs-doctemplates-source-index`:

:guilabel:`Immer diesen Index verwenden`
   Wenn Sie diese Option aktivieren, teilen Sie dem System mit, dass immer dieser Index des Dokuments als Vorlage
   verwendet soll, unabhängig davon, ob neuere Index existieren. Der Index muss sich im Status :guilabel:`Freigegeben`,
   :guilabel:`Änderung` oder :guilabel:`Gesperrt` befinden.
   Die Voraussetzungen können von Ihrem Systemadministrator
   :ref:`abweichend konfiguriert <pcs_admin_en:configurable_rule_index_dependent_valid_documents_for_instantiation>`
   sein.

   Wenn Sie diese Option nicht aktivieren, verwendet das System immer den aktuell gültigen Index des Dokuments,
   unabhängig davon, welcher Index im Feld :guilabel:`Index` zugeordnet ist. Ein Index ist dann gültig, wenn er sich
   im Status :guilabel:`Freigegeben` oder :guilabel:`Änderung` befindet.
   Die Definition eines gültigen Index kann von Ihrem Systemadministrator
   :ref:`abweichend konfiguriert <pcs_admin_en:configurable_rule_documents_valid_for_instantiation>`
   sein.

.. _`cdbwinusrman-pcs-doctemplates-status_change`:

:guilabel:`Kopie erzeugen bei Status`
   Hier können Sie einen Status des Fachobjekts auswählen, in dessen
   :ref:`Bearbeitungskontext <cdbwinusrman-pcs-doctemplates-processing-context>` Sie das Dokument zuordnen.

   Wenn Sie einen Status eintragen, dann erzeugt das System automatisch ein Dokument aus der Dokumentvorlage, wenn
   das Fachobjekt den eingetragenen Status erreicht. Mehr zu diesem Thema finden Sie in Kapitel
   :ref:`cdbwinusrman-pcs-doctemplates-automatic-creation`.

   Wenn Sie keinen Status eintragen, erzeugt das System kein Dokument automatisch. Sie können ein Dokument aus der
   Dokumentvorlage manuell erzeugen. Mehr zu diesem Thema finden Sie in Kapitel
   :ref:`cdbwinusrman-pcs-doctemplates-manual-creation`.

.. _`cdbwinusrman-pcs-doctemplates-manual-creation`:

Manuelle Neuerstellung eines Dokuments
======================================

Die Erstellung eines neuen Dokuments aus einer Vorlage erfolgt durch Aufruf der
Operation :guilabel:`Neues Dokument erzeugen...` im Kontextmenü der jeweiligen
Dokumentvorlage. Bei Aufruf der Operation wird die Vorlage kopiert und das neue
Dokument automatisch dem Bearbeitungskontext zugeordnet. Das Dokument ist damit
in der Projektablage und in der Beziehung :guilabel:`Dokumente` des entsprechenden Fachobjekts sichtbar.
Abschließend wird das Informationsdatenblatt geöffnet über das Sie Zugriff auf weitere Operationen des Dokuments haben.
Sie können entscheiden, ob sie z. B. Stammdaten ändern oder das Dokument bearbeiten wollen.

Die Operation :guilabel:`Neues Dokument erzeugen...` kann für eine
Vorlage mehrfach aufgerufen werden, um mehrere Dokumente aus der selben Vorlage
zu erzeugen.

Dokumente können nur aus gültigen Vorlagen erzeugt werden. Mehr zu diesem Thema finden Sie in der
:ref:`Beschreibung der Eigenschaften <cdbwinusrman-pcs-doctemplates-source-index>` einer Zuordnung.

.. _`cdbwinusrman-pcs-doctemplates-automatic-creation`:

Automatische Neuerstellung eines Dokuments bei Statusänderung
=============================================================

Die zugeordneten Dokumentvorlagen können wahlweise so eingestellt werden, dass
das Dokument bei einer :ref:`bestimmten Statusänderung <cdbwinusrman-pcs-doctemplates-status_change>` des zugehörigen
:ref:`Fachobjekts <cdbwinusrman-pcs-doctemplates-processing-context>`
automatisch aus der Vorlage erzeugt wird. Die Projektmitarbeiter können direkt mit
der Bearbeitung des Dokuments beginnen, ohne dieses noch selbst anlegen zu müssen.
Dokumente, die automatisch angelegt und zugeordnet werden, erkennt der Bearbeiter
an einem speziellen Icon der Vorlage.

Die Operation :guilabel:`Neues Dokument erzeugen...` kann auch für Vorlagen verwendet
werden, für die eine automatische Dokumentenerzeugung aktiviert ist.

.. note::
   Wird das
   Dokument vor der automatischen Erzeugung durch Aufruf dieser Operation manuell
   angelegt, ist die automatische Dokumentenanlage damit deaktiviert, d.h. das Dokument
   wird bei Erreichen des eingestellten Status nicht erneut angelegt.

Dokumente können nur aus gültigen Vorlagen erzeugt werden. Mehr zu diesem Thema finden Sie in der
:ref:`Beschreibung der Eigenschaften <cdbwinusrman-pcs-doctemplates-source-index>` einer Zuordnung.


.. _`cdbwinusrman-pcs-doctemplates-usage`:

Verwendung von Dokumenten als Dokumentvorlagen in Projektstrukturen
===================================================================

Wenn Sie sich anschauen wollen, ob und in welchen Projekten ein Dokument als Vorlage
verwendet wird, gehen Sie wie folgt vor:

#. Markieren Sie das ausgewählten Dokument in einer Ergebnisliste
#. Öffnen Sie das Kontextmenü durch Klicken der rechten Maustaste
#. Wählen Sie die Operation :guilabel:`Information`.
#. Es öffnet sich das Datenblatt für das Dokument
#. Navigieren Sie zum Maskenregister :guilabel:`Verwendung als Vorlage in Projekten`
#. Hier sehen Sie eine Liste aller Projekt, in denen das Dokument als Vorlage verwendet wird.

Im Auslieferungszustand ist das Maskenregister :guilabel:`Verwendung als Vorlage in Projekten` ausgeblendet.
Bei Bedarf müssen Sie das Maskenregister zunächst einblenden.

.. toctree::
   :maxdepth: 2
