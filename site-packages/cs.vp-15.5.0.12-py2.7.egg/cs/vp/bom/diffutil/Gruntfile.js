module.exports = function(grunt) {
    grunt.initConfig({
        pkg: grunt.file.readJSON('package.json'),
        emberTemplates: {
            compile: {
                options: {
                    templateBasePath: /resources\/hbs\//
                },
                files: {
                    'resources/templates.js': 'resources/hbs/**/*.hbs'
                }
            }
        },
        concat: {
            dist: {
                src: [
                        'resources/templates.js',
                        'resources/app-utils.js',
                        'resources/app.js',
                        'resources/app-selection.js',
                        'resources/app-cache.js',
                        'resources/app-model.js',
                        'resources/components/diff-table.js',
                        'resources/components/tree-searches.js',
                        'resources/components/tree-view.js',
                        'resources/components/preview.js',
                        'resources/components/generic-table.js',
                        'resources/app-components.js',
                        'resources/app-controllers.js',
                        'resources/app-views.js',
                        'resources/app-router.js'
                    ],
                dest: 'resources/app-built.js'
            }
        },
        lineending: {
            dist: {
                options: {
                    // eol: 'crlf'
                    eol: 'lf'
                },
                files: {
                    'resources/templates.js': ['resources/templates.js']
                }
            }
        },
        watch: {
            emberTemplates: {
                files: 'resources/hbs/**/*.hbs',
                tasks: ['emberTemplates', 'lineending']
            },
            concat: {
                files: ['resources/**/*.js', '!resources/app-built.js'],
                tasks: ['concat']
            }
        }
    });
    grunt.loadNpmTasks('grunt-contrib-watch');
    grunt.loadNpmTasks('grunt-ember-templates');
    grunt.loadNpmTasks('grunt-contrib-concat');
    grunt.loadNpmTasks('grunt-lineending');
    // Default task(s).
    grunt.registerTask('default', ['emberTemplates', 'lineending', 'concat']);
};
