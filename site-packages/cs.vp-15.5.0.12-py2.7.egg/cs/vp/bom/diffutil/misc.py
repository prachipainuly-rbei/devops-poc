#!/usr/bin/env python
# -*- mode: python; coding: iso-8859-1 -*-
#
# Copyright (C) 1990 - 2014 CONTACT Software GmbH
# All rights reserved.
# http://www.contact.de/
#
__docformat__ = "restructuredtext en"
__revision__ = "$Id: misc.py 121014 2015-02-24 15:41:26Z gda $"

# Some imports
import functools
import math

profile_returns = {}

CHUNK_SIZE = 300


def with_profile(path):
    import cProfile

    def wrapper(fun):
        def result(fun, *args, **kwargs):
            cProfile.runctx("profile_returns['value'] = fun(*args, **kwargs)", globals(), locals(), path)
            return profile_returns['value']
        return functools.partial(result, fun)
    return wrapper


def _chunked(lst, size=CHUNK_SIZE):
    steps = int(math.ceil(len(lst) / float(size)))
    for i in range(steps):
        yield lst[i * size:(i + 1) * size]
