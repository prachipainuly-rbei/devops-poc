App.HeaderRawCellView = Ember.Table.HeaderCell.extend({
    templateName: 'header-raw-cell'
});

App.GenericTableComponent =
    Ember.Component
        .extend({
            classNames: ['container-fluid', 'generic-table'],
            filterText: null,
            pageSize: 10,
            title: '',
            filter_placeholder: 'search ...',
            selectedItem: null,
            headerContent: Ember.A([]),
            init: function() {
                this._super();
            },

            didInsertElement: function() {
                var self = this;
                $('input, textarea').placeholder();
                self.$('form.filter_form').submit(function(ev) {
                    ev.preventDefault();
                    ev.stopPropagation();
                    self.sendAction('filter', self.get('filterText'));
                    return false;
                });
            },
            columns: function() {
                var optionals = ['maxWidth', 'defaultColumnWidth', 'canAutoResize'];
                var result = this.get('headerContent').map(function(item) {
                    var column =  Ember.Table.ColumnDefinition.create({
                        headerCellName: item.get('label'),
                        contentPath: item.get('id'),
                        headerCellView: 'App.HeaderRawCellView',
                        textAlign: 'left'
                    });

                    // Set optional attributes
                    for (var i = 0; i < optionals.length; i++) {
                        var attr = optionals[i];
                        if (item.get(attr) !== undefined) {
                            column.set(attr, item.get(attr));
                        }
                    }
                    return column;
                });
                return result;
            }.property('headerContent')
        });
