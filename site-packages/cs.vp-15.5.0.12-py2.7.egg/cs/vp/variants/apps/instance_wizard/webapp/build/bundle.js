!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("Immutable"),require("cs-vp-table-component"),require("cs-web-components-base"),require("jQuery"),require("cs-web-components-externals"),require("cs-vp-rest-tree-component"),require("React"),require("ReactBootstrap"),require("cs-vp-utils"),require("cs-vp-tree-component")):"function"==typeof define&&define.amd?define(["Immutable","cs-vp-table-component","cs-web-components-base","jQuery","cs-web-components-externals","cs-vp-rest-tree-component","React","ReactBootstrap","cs-vp-utils","cs-vp-tree-component"],t):"object"==typeof exports?exports.CanvasUIApp=t(require("Immutable"),require("cs-vp-table-component"),require("cs-web-components-base"),require("jQuery"),require("cs-web-components-externals"),require("cs-vp-rest-tree-component"),require("React"),require("ReactBootstrap"),require("cs-vp-utils"),require("cs-vp-tree-component")):e.CanvasUIApp=t(e.Immutable,e["cs-vp-table-component"],e["cs-web-components-base"],e.jQuery,e["cs-web-components-externals"],e["cs-vp-rest-tree-component"],e.React,e.ReactBootstrap,e["cs-vp-utils"],e["cs-vp-tree-component"])}(this,function(e,t,n,r,o,i,a,s,c,l){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=13)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t){e.exports=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ToDoListActions=t.ToDoListContainer=t.ToDoListContainerId=t.BOMRestTreeActions=t.BOMTreeActions=t.BOMTreeContainer=t.BOMTreeContainerId=t.PropertyRestTreeActions=t.PropertyTreeContainer=t.PropertyTreeContainerId=t.namespace=void 0;var o=n(2),i=n(4),a=n(16),s=r(a),c=n(1),l=r(c),d=n(6),u=n(17),p=t.namespace="cs-vp-instance-wizard",f=t.PropertyTreeContainerId="propertyTree",m=f+"_rest",h=t.PropertyTreeContainer=(0,s.default)(p,f);t.PropertyRestTreeActions=(0,d.actions)(p,m);o.Registry.registerComponent("cs.vp.variants.apps.instance_wizard.property_tree",h);var g=t.BOMTreeContainerId="bomTree",v=g+"_rest",b=t.BOMTreeContainer=(0,s.default)(p,g);t.BOMTreeActions=(0,a.actions)(p,g),t.BOMRestTreeActions=(0,d.actions)(p,v);o.Registry.registerComponent("cs.vp.variants.apps.instance_wizard.bom_tree",b);var y=t.ToDoListContainerId="todoList",_=t.ToDoListContainer=(0,l.default)(p,y);t.ToDoListActions=(0,c.actions)(p,y);o.Registry.registerComponent("cs.vp.variants.apps.instance_wizard.todo_list",_);var T={};T[f]=(0,a.reducer)(f),T[g]=(0,a.reducer)(g),T[y]=(0,c.reducer)(y),T[m]=(0,d.reducer)(m),T[v]=(0,d.reducer)(v),T.config=u.config,T.context=u.context,T.instance=u.instance,T.loading=u.loading,o.Registry.registerReducer(p,(0,i.combineReducers)(T))},function(e,t){e.exports=i},function(e,t,n){"use strict";function r(e){return{type:"SET_CONFIG",config:e}}function o(e){return{type:"SET_CONTEXT",context:e}}function i(){return function(e,t){var n=t(),r=n[E.namespace],o=r.config,i=r.context,a=n.objectsById.get(o.getIn(["links","base_urls","product"])+"/"+i.product_object_id),s=a.get("system:description"),c=s+" ("+o.get("title")+")";document.title=c}}function a(e){return function(t,n){var r=n(),o=r.objectsById,i=r.relshipsById,a=r.fetchingById,l=r[E.namespace].context,d=e,u=d.get(S.constants.ROW_ID).split(";"),p=o.get(u.pop()),f=s(r,p),m=f.getIn(["system:relships","relships","Instantiations"]);i.get(m)?t(c(m,d)()):a.some(function(e,t){return t.includes(m)})||t((0,x.fetchRelship)(m,"variant",l,[c(m,d)]))}}function s(e,t){var n=e.objectsById,r=e.relshipsById,o=e[E.namespace].config;if(t.get("@type")===o.getIn(["links","type_urls","part"]))return t;var i=r.get(t.getIn(["system:relships","relships","Item"]));return n.get(i)}function c(e,t){return function(){return function(n,r){var o=r(),i=o.relshipsById,a=o.objectsById,s=o[E.namespace].config,c=i.get(e),l=O.default.Map({_text:s.getIn(["labels","cdbvp_variants_new_article"]),_id:"NEW"});if(c){var d=c.map(function(e){return a.get(e)}),u=O.default.List(d).map(function(e){return e.merge({_text:e.get("system:description"),_id:e.get("@id")})}).insert(0,l);n(I(t,"_item_list",u))}else n(I(t,"_item_list",O.default.List([l])))}}}function l(e,t){return function(n,r){var o=r(),i=o.objectsById,a=o[E.namespace].config;if(!o[E.namespace][E.ToDoListContainerId].get("initialised")&&"backend-bom-predicate-search"===e){var s=O.default.fromJS(t.map(function(e){var n=e.split(";").pop(),r=i.get(n),s=void 0;return r&&r.get("@type")===a.getIn(["links","type_urls","part"])?s=r:r&&r.get("@type")===a.getIn(["links","type_urls","bom_item"])&&(s=(0,x.referencedObjects)(o,r,"Item")),{assembly:s.get("system:description"),item:a.getIn(["labels","cdbvp_variants_new_article"]),_item_id:"NEW",_id:e,_selected:e===t[0]}}));n(E.ToDoListActions.setContent(s))}}}function d(e){return function(t,n){var r=n(),o=r.objectsById,i=r[E.namespace].config,a=function(){return"NEW"===e?i.getIn(["labels","cdbvp_variants_new_article"]):o.get(e).get("system:description")}(),s=r[E.namespace][E.ToDoListContainerId],c=s.get("rows"),l=c.filter(function(e){return e.get("_selected")}).map(function(e){return e.get("_id")}).get(0),d=c.map(function(t){return!0===t.get("_selected")?t.merge({item:a,_item_id:e}):-1!==t.get("_id").indexOf(l)?t.merge({item:i.getIn(["labels","cdbvp_variants_new_article"]),_item_id:"NEW",_visible:"NEW"===e}):t});t(E.ToDoListActions.setContent(d)),l&&t(E.ToDoListActions.selectRow(l))}}function u(e,t){if(t){var n=t.get("_item_id"),r=t.get(S.constants.ROW_ID),o=r.split(";");if(o.pop(),"NEW"!==n)return o.length>0?o.join(";")+";"+n:n}}function p(e){return function(t,n){if("_item_id"===e.key){var r=n(),o=r.objectsById,i=e.row,a=e.value,s=i.get("_id"),c="NEW"!==a?o.get(a):o.get(s.split(";").pop());if("NEW"===a){var l=E.BOMRestTreeActions.resetReplacedNodeById(E.BOMTreeContainerId,s);t(l)}else{var d=E.BOMRestTreeActions.setReplacedNodeById(E.BOMTreeContainerId,s,c);t(d)}setTimeout(function(){t((0,R.bomTreeSearchResyncAction)(c,(0,B.getParentId)(s)))},1)}}}function f(e){return function(t,n){var r=n(),o=r[E.namespace][E.ToDoListContainerId],i=o.get("rows"),a=void 0,s=!0;e&&o.get("initialised")&&(i.forEach(function(t){if(t.get("_selected")&&t.get("_id")===e)s=!1;else if(t.get("_selected")||t.get("_id")!==e){if(t.get("_item_id")){var n=t.get("_id").split(";");n.pop();var r=n.concat(t.get("_item_id")).join(";");t.get("_selected")&&r===e?s=!1:t.get("_selected")||r!==e||(a=t)}}else a=t}),a?setTimeout(function(){t(E.ToDoListActions.selectRow(a))},1):s&&setTimeout(function(){t(E.ToDoListActions.resetRowSelection())},1))}}function m(e){return function(t,n){if(void 0!==e){var r=n(),o=r[E.namespace][E.BOMTreeContainerId],i=u(r,e),a=i||e.get(S.constants.ROW_ID);if(o.get("selectedId")!==a){var s=a.split(";"),c=s.pop(),l=r.objectsById.get(c),d=s.join(";").replace(c,"");d&&t(E.BOMTreeActions.expandTreeNode(d)),t(w(a,l))}}}}function h(){return function(e,t){var n=t(),r=n.objectsById,o=n[E.namespace],i=o.context,a=o.config,s=o.todoList,c=a.getIn(["links","base_urls"]),l=Object.assign({data:s.get("rows").map(function(e){return{path:e.get("_id").split(";").map(function(e){return r.get(e)}),id:e.get("_item_id"),obj:r.get(e.get("_item_id"))}}).toJS()},i),d=c.get("part");e(g()),e((0,x.createObject)(d+"/+instance",[l],[])).then(function(t){e(b(t)),e(v())})}}function g(){return{type:"START_LOADING"}}function v(){return{type:"STOP_LOADING"}}function b(e){return{type:"INSTANCE_CREATED",payload:e}}function y(){return function(e,t,n){return function(e){var r=n.get(S.constants.KEY)+"_opened";e(I(t,r,!0))}}}function _(e){return function(t){var n=!0,r=!1,o=void 0;try{for(var a,s=e.objects[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var c=a.value;t((0,B.receivedObject)(c["@id"],c))}}catch(e){r=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw o}}var l=!0,d=!1,u=void 0;try{for(var p,f=e.relships[Symbol.iterator]();!(l=(p=f.next()).done);l=!0){var m=p.value;t((0,B.receivedRelship)(m))}}catch(e){d=!0,u=e}finally{try{!l&&f.return&&f.return()}finally{if(d)throw u}}t(E.PropertyRestTreeActions.buildTree(e)),t(E.BOMRestTreeActions.buildTree(e)),t((0,R.bomTreePredicateSearchAction)(e)),t(i(e))}}function T(e,t,n,r){return function(o){var i=E.BOMTreeActions.searchTree(e,t,n,r),a=o(i);o(l(t,a))}}function w(e,t){return function(n){var r=E.BOMTreeActions.selectTreeNodeById(e,t);n(r),n(f(r.id))}}function I(e,t,n){return function(r){var o=E.ToDoListActions.editCell(e,t,n);r(o),r(p(o))}}Object.defineProperty(t,"__esModule",{value:!0}),t.setConfig=r,t.setContext=o,t.setTitle=i,t.loadPartListForTreeNode=a,t.getItem=s,t.setPartList=c,t.initToDoList=l,t.updateToDoEntry=d,t.updateTreeNode=p,t.syncTodoListSelectionToTree=f,t.selectBOMTreeNode=m,t.instantiatePart=h,t.startLoading=g,t.stopLoading=v,t.instanceCreated=b,t.openDropdown=y,t.fetchProduct=_,t.searchBomTree=T,t.selectBomTreeNodeById=w,t.editTodoListCell=I;var x=n(2),C=n(0),O=function(e){return e&&e.__esModule?e:{default:e}}(C),E=n(5),R=n(12),S=n(1),B=n(6)},function(e,t){e.exports=a},function(e,t,n){e.exports=n(14)()},function(e,t){e.exports=s},function(e,t){e.exports=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.mergeSearches=t.bomTreeSearchResyncAction=t.bomTreePredicateSearchAction=t.bomTreeSimpleSearchAction=t.searchAction=t.bomTreePredicateSearch=t.bomTreeSimpleSearch=t.propertyTreeSimpleSearch=void 0;var o=n(3),i=r(o),a=n(0),s=r(a),c=n(1),l=n(6),d=n(5),u=n(7),p=n(11),f=(t.propertyTreeSimpleSearch={"simple-text-search":{cssclass:"simple-text-search-match",match:function(e,t){return""!==t&&-1!==e.getIn(["content","system:description"]).indexOf(t)},resultCnt:0,navigatedIdx:0,navigationCSSClasses:"simple-text-search-navigated",matchedNodeIds:[],idFieldPathList:["id"]}},t.bomTreeSimpleSearch={"simple-backend-text-search":{cssclass:"simple-backend-text-search-match",match:function(e,t){var n=t.matched;return n.length>0&&(-1!==n.indexOf(e.getIn(["content","cdb_object_id"]))||-1!==n.indexOf(e.getIn(["additional_content","Item","cdb_object_id"])))},resultCnt:0,navigatedIdx:0,navigationCSSClasses:"simple-backend-text-search-navigated",matchedNodeIds:[],idFieldPathList:["id"]}},t.bomTreePredicateSearch={"backend-bom-predicate-search":{cssclass:"backend-bom-predicate-search-match",match:function(e,t){return t.length>0&&(-1!==t.indexOf(e.getIn(["content","cdb_object_id"]))||-1!==t.indexOf(e.getIn(["additional_content","Item","cdb_object_id"])))},resultCnt:0,navigatedIdx:0,navigationCSSClasses:"backend-bom-predicate-search-navigated",matchedNodeIds:[],idFieldPathList:["id"]}},t.searchAction=function(e,t,n,r){return function(o,a){var s=a(),c=s.objectsById;o((0,u.startLoading)()),i.default.getJSON(e,t).then(function(e){var t=e.expanded,i=e.matched;t.relships.forEach(function(e){return o((0,l.receivedRelship)(e))}),t.ids.forEach(function(e){var t=c.get(e);t&&o(r(e,t))}),o(n(i)),o((0,u.stopLoading)())},function(){})}}),m=function(e,t){return t.split(";").map(function(t){var n=e.objectsById.get(t),r=(0,u.getItem)(e,n);return r?r.get("cdb_object_id"):void 0}).filter(function(e){return void 0!==e})},h=function(e){var t=e[d.ToDoListContainerId],n=t.get(c.constants.ROWS),r={};return n.forEach(function(t){var n=t.get("_item_id");"NEW"!==n&&(r[m(e,t.get(c.constants.ROW_ID))]=m(e,n))}),r},g=t.bomTreeSimpleSearchAction=function(e,t,n,r,o,i){return function(a,c){var l=c(),m=l[d.namespace],g=m.context,v=m.config;if(""===e)return void a((0,u.searchBomTree)({matched:[],text:""},t));var b=v.getIn(["links","util_urls","bom_text_search"]),y=s.default.Map(g);y=y.set("text",e);var _=h(l[d.namespace]);y=y.set("mapping",JSON.stringify(_)),void 0!==n&&(y=y.set("teilenummer",n)),void 0!==r&&(y=y.set("t_index",r));var T=function(n){var r=n;return void 0!==o&&(r=s.default.Set(n.concat(o)).toJS()),(0,u.searchBomTree)({matched:r,text:e},t)},w=function(e,t){var n=e,r=t;if(void 0!==i){var o=p.TreeTools.walkTopDownDepthFirst(l[d.namespace][d.BOMTreeContainerId].get("node")),a=!0,s=!1,c=void 0;try{for(var u,f=o[Symbol.iterator]();!(a=(u=f.next()).done);a=!0){var m=u.value;if(m.getIn(["content","@id"])===t.get("@id")||m.getIn(["additional_content","Item","@id"])===t.get("@id")){n=m.get("id"),r=m.get("content");break}}}catch(e){s=!0,c=e}finally{try{!a&&f.return&&f.return()}finally{if(s)throw c}}}return d.BOMRestTreeActions.updateTreeNodeById(d.BOMTreeContainerId,n,r)};return f(b,y.toJS(),T,w)(a,c)}};t.bomTreePredicateSearchAction=function(){return function(e,t){var n=t()[d.namespace],r=n.config,o=n.context,i=r.getIn(["links","util_urls","bom_predicate_search"]);return f(i,o,function(e){return(0,u.searchBomTree)(e,"backend-bom-predicate-search")},function(e,t){return d.BOMRestTreeActions.updateTreeNodeById(d.BOMTreeContainerId,e,t)})(e,t)}},t.bomTreeSearchResyncAction=function(e,t){return function(n,r){var o=r()[d.namespace][d.BOMTreeContainerId],i=o.getIn(["searches","backend-bom-predicate-search","searchCondition"]),a=o.getIn(["searches","simple-backend-text-search","searchCondition"]);i&&n((0,u.searchBomTree)(i,"backend-bom-predicate-search")),a&&a.text&&n(g(a.text,"simple-backend-text-search",e?e.get("teilenummer"):void 0,e?e.get("t_index"):void 0,a.matched,t))}},t.mergeSearches=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return Object.assign.apply(Object,[{}].concat(t))}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(3),l=r(c),d=n(8),u=r(d),p=n(9),f=r(p),m=n(0),h=r(m),g=n(2),v=n(4),b=n(10),y=n(1),_=n(5),T=n(18),w=n(12),I=n(7);n(19);var x=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={showLeftColumn:!1,focussedContainerId:void 0,showErrorDialog:!1},n}return a(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){e.errorsById.size>this.props.errorsById.size&&this.setState({showErrorDialog:!0})}},{key:"componentDidMount",value:function(){var e=this.props,t=e.fetchProduct,n=e.setContext,r=e.setConfig,o=e.setPropertyRestTreeConfig,i=e.setBOMRestTreeConfig,a=e.startLoading,s=e.setInitialTodoListState,c=(0,g.getAppSetup)().get("cs-vp-instance-wizard");r(c),(0,l.default)(".index-component").focusin(this.updateFocussedComponent.bind(this));var d=c.get("product_object_id"),u=c.get("variant_id"),p=c.get("teilenummer"),f=c.get("t_index");n({product_object_id:d,variant_id:u,teilenummer:p,t_index:f});var m=c.getIn(["links","base_urls","variant"])+"/"+u+"@"+d,v=f||"",b=c.getIn(["links","base_urls","part"])+"/"+p+"@"+v,x=(0,w.mergeSearches)(w.bomTreePredicateSearch,w.bomTreeSimpleSearch);o(c.get("labels"),m,c.getIn(["treeDownReferences",_.PropertyTreeContainerId]),null,_.PropertyTreeContainerId,!0,w.propertyTreeSimpleSearch,"simple-text-search"),i(c.get("labels"),b,c.getIn(["treeDownReferences",_.BOMTreeContainerId]),T.BomTreeRenderer,_.BOMTreeContainerId,!0,x,"simple-backend-text-search",this.props.bomTreeSimpleSearchAction);var C=h.default.fromJS({filterField:{callback:function(e){return function(t){return t.get("assembly").indexOf(e)>-1||t.get("item").indexOf(e)>-1}},placeholder:c.getIn(["labels","cdbvp_variants_web_filter_placeholder"]),visible:!0},header:{visible:!0},cols:[{key:"assembly",label:c.getIn(["labels","baugruppe"]),classNameHeader:"assembly-header",classNameHeaderLabel:"assembly-header-label",classNameHeaderIcon:"assembly-header-icon",classNameCell:"assembly-cell",classNameCellContent:"assembly-cell-content",indent:15,selectionMode:y.constants.SELECTION_MODE_ROW,visible:!0},{key:"item",label:c.getIn(["labels","cdbvp_variants_assigned_part"]),classNameHeader:"part-header",classNameHeaderLabel:"part-header-label",classNameHeaderIcon:"part-header-icon",classNameCell:"part-cell",classNameCellContent:"part-cell-content",cellComponent:T.ToDoArticleSelectionRenderer,cellComponentUpdateCallback:T.shallUpdateToDoArticleSelectionRenderer,selectionMode:y.constants.SELECTION_MODE_ROW,visible:!0,keyMapping:{"alt+down":I.openDropdown}}],rows:[]});a(),s(C),t(c.get("initial_data").toJS())}},{key:"updateFocussedComponent",value:function(e){var t=void 0;[_.BOMTreeContainerId,_.PropertyTreeContainerId,_.ToDoListContainerId].forEach(function(n){((0,l.default)(e.target).hasClass(n)||(0,l.default)("."+n).find(e.target).length>0)&&(t=n)}),this.setState({focussedContainerId:t})}},{key:"toggleLeft",value:function(){this.setState({showLeftColumn:!this.state.showLeftColumn})}},{key:"toggleLeftKeyHandler",value:function(e){-1!==[13,32,37,39].indexOf(e.keyCode)&&(32===e.keyCode&&e.preventDefault(),this.setState({showLeftColumn:!this.state.showLeftColumn})),e.stopPropagation()}},{key:"saveInstance",value:function(){this.props.instantiatePart()}},{key:"close",value:function(e){if(this.props.config.get("isCDBPC"))try{window.open(e["system:structure_url"]),window.onbeforeunload=null,window.external.cdbEFClose()}catch(e){}}},{key:"ackErrors",value:function(e){this.setState({showErrorDialog:!1}),e.stopPropagation(),e.preventDefault()}},{key:"render",value:function(){var e=this.props,t=e.config,n=e.errorsById,r=e.loading,o=e.loadPartListForTreeNode,i=e.selectBOMTreeNode,a=e.syncTodoListSelectionToTree,s=this.state,c=s.showLeftColumn,l=s.focussedContainerId;if(!t||0===t.size)return u.default.createElement("div",null);var d=t.get("title"),p=t.get("labels"),f=u.default.createElement("span",{className:"visible-lg-inline visible-md-inline"},d),m=u.default.createElement(b.Button,{bsSize:"sm",className:"toggle-icon",onClick:this.toggleLeft.bind(this),onKeyDown:this.toggleLeftKeyHandler.bind(this),tabIndex:11,title:c?p.get("cdbvp_variants_web_hide_variant_details"):p.get("cdbvp_variants_web_show_variant_details")},u.default.createElement(b.Glyphicon,{glyph:c?"menu-left":"menu-right"})),h=p.get("cdbvp_variants_variant"),g=p.get("cdbvp_variants_todo"),v=p.get("cs_items_bom"),y=u.default.createElement(b.Navbar,{fixedTop:!0,fluid:!0,id:"navbar-head"},u.default.createElement(b.Navbar.Header,null,u.default.createElement(b.Navbar.Brand,null,f)),u.default.createElement(b.Button,{bsStyle:"primary",className:"navbar-btn",onClick:this.saveInstance.bind(this),tabIndex:1},p.get("cdbvp_variants_shape_now"),u.default.createElement(b.Glyphicon,{glyph:"ok",style:{marginLeft:"10px"}}))),T=c?3:0,w=c?4:6,I=c?5:6,x=c?u.default.createElement(b.Col,{className:"col",id:"left-column",lg:T},u.default.createElement("div",{className:"label-line"},u.default.createElement("h4",null,h)),u.default.createElement("div",{className:"content-line"},u.default.createElement(_.PropertyTreeContainer,{className:_.PropertyTreeContainerId,hasFocus:_.PropertyTreeContainerId===l,key:_.PropertyTreeContainerId,tabIndex:20}))):void 0,C=this.props.instance&&this.props.instance.length>0?this.props.instance[0]:{};this.props.instance&&this.props.instance.length>0&&this.close(C);var O=this.props.instance?u.default.createElement(b.Modal,{show:this.props.instance},u.default.createElement(b.Modal.Header,null,u.default.createElement(b.Modal.Title,null,p.get("cdbvp_instance_created"))),u.default.createElement(b.Modal.Body,null,u.default.createElement("a",{href:C["system:url"]},C["system:description"])),u.default.createElement(b.Modal.Footer,null,u.default.createElement(b.Button,{bsStyle:"primary",onClick:this.close.bind(this)},p.get("cdbvp_variants_web_close")))):void 0,E=this.state.showErrorDialog?u.default.createElement(b.Modal,{show:this.state.showErrorDialog},u.default.createElement(b.Modal.Header,null,u.default.createElement(b.Modal.Title,null,p.get("cdbvp_variants_web_error"))),u.default.createElement(b.Modal.Body,null,Object.keys(n.toJS()).map(function(e){var t=n.get(e),r=t.status>0?p.get("cdbvp_variants_web_ajax_err").replace("{status_code}",t.status):p.get("cdbvp_variants_web_ajax_0");return u.default.createElement("div",{key:e},r)})),u.default.createElement(b.Modal.Footer,null,u.default.createElement(b.Button,{bsStyle:"primary",onClick:this.ackErrors.bind(this)},p.get("cdbvp_variants_web_close")))):void 0;return u.default.createElement("div",null,r?u.default.createElement("div",{className:"loader"},u.default.createElement("div",{className:"waiting-with-huge-endless-loader"}," ")):void 0,u.default.createElement("div",{className:"index-component",role:"application"},y,m,u.default.createElement(b.Grid,{className:"grid"},u.default.createElement(b.Row,null,x,u.default.createElement(b.Col,{className:"col",id:"main-column",lg:w},u.default.createElement("div",{className:"label-line"},u.default.createElement("h4",null,g)),u.default.createElement("div",{className:"content-line"},u.default.createElement(_.ToDoListContainer,{className:_.ToDoListContainerId,config:t,hasFocus:_.ToDoListContainerId===l,key:_.ToDoListContainerId,keyBlacklistSelector:".dropdown-toggle, a[role=menuitem]",loadPartListForTreeNode:o,onSelection:i,tabIndex:30}))),u.default.createElement(b.Col,{className:"col "+_.BOMTreeContainerId,id:"right-column",lg:I},u.default.createElement("div",{className:"label-line"},u.default.createElement("h4",null,v)),u.default.createElement("div",{className:"content-line"},u.default.createElement(_.BOMTreeContainer,{config:t,hasFocus:_.BOMTreeContainerId===l,onSelection:a,tabIndex:40}))))),O,E))}},{key:"shouldComponentUpdate",value:function(e,t){return this.props.instance!==e.instance||!this.props.errorsById.equals(e.errorsById)||this.props.loading!==e.loading||this.state!==t}}]),t}(u.default.Component);x.propTypes={bomTreeSimpleSearchAction:f.default.func.isRequired,config:v.ImmutablePropTypes.map.isRequired,errorsById:v.ImmutablePropTypes.map.isRequired,fetchCollection:f.default.func.isRequired,fetchProduct:f.default.func.isRequired,instance:f.default.any.isRequired,instantiatePart:f.default.func.isRequired,loadPartListForTreeNode:f.default.func.isRequired,loading:f.default.bool.isRequired,selectBOMTreeNode:f.default.func.isRequired,setBOMRestTreeConfig:f.default.func.isRequired,setConfig:f.default.func.isRequired,setContext:f.default.func.isRequired,setInitialTodoListState:f.default.func.isRequired,setPropertyRestTreeConfig:f.default.func.isRequired,startLoading:f.default.func.isRequired,syncTodoListSelectionToTree:f.default.func.isRequired};var C=(0,v.connect)(function(e){var t=e.errorsById;return Object.assign({errorsById:t},e["cs-vp-instance-wizard"])},{bomTreeSimpleSearchAction:w.bomTreeSimpleSearchAction,setConfig:I.setConfig,setContext:I.setContext,loadPartListForTreeNode:I.loadPartListForTreeNode,instantiatePart:I.instantiatePart,fetchCollection:g.fetchCollection,fetchProduct:I.fetchProduct,selectBOMTreeNode:I.selectBOMTreeNode,setInitialTodoListState:_.ToDoListActions.setInitialState,setBOMRestTreeConfig:_.BOMRestTreeActions.setConfig,setPropertyRestTreeConfig:_.PropertyRestTreeActions.setConfig,startLoading:I.startLoading,stopLoading:I.stopLoading,syncTodoListSelectionToTree:I.syncTodoListSelectionToTree})(x);g.Registry.registerComponent("cs.vp.variants.apps.instance_wizard.index_component",C)},function(e,t,n){"use strict";function r(){}var o=n(15);e.exports=function(){function e(e,t,n,r,i,a){if(a!==o){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t};return n.checkPropTypes=r,n.PropTypes=n,n}},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t){e.exports=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loading=t.instance=t.context=t.config=void 0;var r=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(r);t.config=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.default.Map(),t=arguments[1];switch(t.type){case"SET_CONFIG":return t.config;default:return e}},t.context=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case"SET_CONTEXT":return t.context;default:return e}},t.instance=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments[1];switch(t.type){case"INSTANCE_CREATED":return t.payload;default:return e}},t.loading=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];switch(arguments[1].type){case"START_LOADING":return!0;case"STOP_LOADING":return!1;default:return e}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ToDoArticleSelectionRenderer=t.shallUpdateToDoArticleSelectionRenderer=t.BomTreeRenderer=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(8),l=r(c),d=n(9),u=r(d),p=n(0),f=r(p),m=n(3),h=r(m),g=n(11),v=n(10),b=n(2),y=n(4),_=n(1),T=n(7);(t.BomTreeRenderer=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.config,n=e.node,r=n.getIn(["content","system:description"]),o=n.getIn(["content","system:icon_link"]),i=n.getIn(["content","system:current_status","color"]),a="tree-node-renderer";t.getIn(["links","type_urls","item"])===n.getIn(["content","@type"])&&(a="tree-node-renderer item"),t.getIn(["links","type_urls","bom_item"])===n.getIn(["content","@type"])&&(r=n.getIn(["content","system:bom_item_description"]),a="tree-node-renderer bom_item");var s=i?{fillColor:i}:void 0;return l.default.createElement(g.RestObjectRenderer,{cssClasses:a,description:r,iconSrc:o,statusIcon:s})}},{key:"shouldComponentUpdate",value:function(e){return this.props.config!==e.config||!this.props.node.equals(e.node)}}]),t}(l.default.Component)).propTypes={config:u.default.object.isRequired,node:u.default.object.isRequired};var w=t.shallUpdateToDoArticleSelectionRenderer=function(){return!0},I=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"shouldComponentUpdate",value:function(e){return w(this.props,e)}},{key:"componentDidUpdate",value:function(){var e=this.props,t=e.row,n=e.col,r=e.loadPartListForTreeNode,o=e.setGrabFocus,i=t.get(n.get(_.constants.KEY)+"_opened"),a=this.dropDown;if(i){t.get("_item_list")||r(t);var s=(0,h.default)(a).find(".dropdown-menu li a").first();s&&(s.focus(),o(!1))}}},{key:"getConfig",value:function(){return(0,b.getAppSetup)().get("cs-vp-instance-wizard")}},{key:"changeAssignedPart",value:function(e,t){t.preventDefault(),t.stopPropagation();var n=this.getConfig(),r=f.default.Map({_text:n.getIn(["labels","cdbvp_variants_new_article"]),_id:"NEW"}),o=this.props.row.get("_item_list")?this.props.row.get("_item_list"):f.default.List([r]),i=o.filter(function(t){return t.get("_id")===e}).get(0);this.props.editCell(this.props.row,"_item_id",e),this.props.editCell(this.props.row,"item",i.get("_text"))}},{key:"onToggle",value:function(e){!1===e&&this.props.setGrabFocus(!0),this.props.editCell(this.props.row,this.props.col.get(_.constants.KEY)+"_opened",e)}},{key:"render",value:function(){var e=this,t=this.props,n=t.row,r=t.col,o=t.hasFocus,i=t.table,a=this.getConfig(),s=f.default.Map({_text:a.getIn(["labels","cdbvp_variants_new_article"]),_id:"NEW"}),c=this.props.row.get("_item_list")?this.props.row.get("_item_list"):f.default.List([s]),d=o&&i.getIn([_.constants.TABLE,_.constants.FOCUSED_COL_KEY])===r.get(_.constants.KEY)&&i.getIn([_.constants.TABLE,_.constants.FOCUSED_ROW_ID])===n.get(_.constants.ROW_ID),u=n.get(r.get(_.constants.KEY)+"_opened"),p=d&&u?d&&u:void 0,m=l.default.createElement(v.ButtonGroup,{justified:!0},l.default.createElement(v.DropdownButton,{bsSize:"xsmall",className:"app-dropdown",id:"dropdown-"+this.props.row.get(_.constants.ROW_ID),key:"dropdown",onSelect:this.changeAssignedPart.bind(this),onToggle:this.onToggle.bind(this),open:p,pullRight:!0,ref:function(t){return e.dropDown=t},title:l.default.createElement("span",{className:"dropdown-title",title:this.props.row.get("item")},this.props.row.get("item"))},c.map(function(e){return l.default.createElement(v.MenuItem,{eventKey:e.get("_id"),href:"#",id:"option "+e.get("_id"),key:e.get("_id"),title:e.get("_text")},e.get("_text"))})));return l.default.createElement("div",{className:"table-cell-content"},m)}}]),t}(l.default.Component);I.propTypes={col:y.ImmutablePropTypes.map.isRequired,editCell:u.default.func.isRequired,hasFocus:u.default.bool.isRequired,loadPartListForTreeNode:u.default.func.isRequired,row:y.ImmutablePropTypes.map.isRequired,setGrabFocus:u.default.func.isRequired,table:u.default.object.isRequired},I.defaultProps={keys:{}};t.ToDoArticleSelectionRenderer=(0,y.connect)(function(e){return e},{editCell:T.editTodoListCell})(I)},function(e,t,n){var r=n(20);"string"==typeof r&&(r=[[e.i,r,""]]);n(22)(r,{});r.locals&&(e.exports=r.locals)},function(e,t,n){t=e.exports=n(21)(),t.push([e.i,"body{overflow:auto}#root,.application-root,.index-component{box-sizing:border-box;height:100%;max-height:100%;max-width:100%;min-width:800px;width:100%;overflow:hidden;background-color:#fff}.index-component>.grid.container{width:calc(100% - 80px);padding:0;margin-left:40px;margin-right:40px}.loader{background:rgba(0,0,0,.1);width:100%;height:100vh;z-index:1050;left:0;top:0;right:0;bottom:0;position:fixed}.loader>.waiting-with-huge-endless-loader{width:100vw;height:100vh}.grid{position:relative;margin-top:40px;margin-left:25px;overflow:hidden}.grid,.row{height:calc(100% - 40px)}.row{margin-bottom:10px;padding:0}.list-entry-icons{margin-top:-15px;padding:1px 3px 0}.simple-backend-text-search-match,.simple-backend-text-search-navigated,.simple-text-search-navigated{color:#f03}.backend-bom-predicate-search-match,.backend-bom-predicate-search-navigated{color:#33f}.toggle-icon{position:absolute;top:40px}.col{box-sizing:border-box;height:calc(100vh - 80px)}.assembly-cell,.assembly-header,.part-cell,.part-header{width:50%}.content-line{height:calc(100% - 39px)}.label-line{height:39px}.todoList table{table-layout:fixed}.todoList button{text-align:left}.todoList button :last-child{position:absolute;right:10px;top:10px}.app-dropdown{width:100%}.app-dropdown>span:first-child{padding-left:5px;width:calc(100% - 15px)}.app-dropdown>span:first-child,.assembly-cell-content{display:inline-block;overflow:hidden;text-overflow:ellipsis;vertical-align:middle;white-space:nowrap}.assembly-cell-content{width:100%}div.table-wrapper{overflow-x:auto;overflow-y:auto}@media (min-width:1200px){.container{width:1175px}}@media (min-width:1300px){.container{width:1275px}}@media (min-width:1400px){.container{width:1375px}}@media (min-width:1500px){.container{width:1475px}}@media (min-width:1600px){.container{width:1575px}}@media (min-width:1700px){.container{width:1675px}}@media (min-width:1800px){.container{width:1775px}}@media (min-width:1900px){.container{width:1875px}}",""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(r[i]=!0)}for(o=0;o<t.length;o++){var a=t[o];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(e,t){function n(e,t){for(var n=0;n<e.length;n++){var r=e[n],o=p[r.id];if(o){o.refs++;for(var i=0;i<o.parts.length;i++)o.parts[i](r.parts[i]);for(;i<r.parts.length;i++)o.parts.push(c(r.parts[i],t))}else{for(var a=[],i=0;i<r.parts.length;i++)a.push(c(r.parts[i],t));p[r.id]={id:r.id,refs:1,parts:a}}}}function r(e){for(var t=[],n={},r=0;r<e.length;r++){var o=e[r],i=o[0],a=o[1],s=o[2],c=o[3],l={css:a,media:s,sourceMap:c};n[i]?n[i].parts.push(l):t.push(n[i]={id:i,parts:[l]})}return t}function o(e,t){var n=h(),r=b[b.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),b.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}function i(e){e.parentNode.removeChild(e);var t=b.indexOf(e);t>=0&&b.splice(t,1)}function a(e){var t=document.createElement("style");return t.type="text/css",o(e,t),t}function s(e){var t=document.createElement("link");return t.rel="stylesheet",o(e,t),t}function c(e,t){var n,r,o;if(t.singleton){var c=v++;n=g||(g=a(t)),r=l.bind(null,n,c,!1),o=l.bind(null,n,c,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=s(t),r=u.bind(null,n),o=function(){i(n),n.href&&URL.revokeObjectURL(n.href)}):(n=a(t),r=d.bind(null,n),o=function(){i(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}function l(e,t,n,r){var o=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=y(t,o);else{var i=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}function d(e,t){var n=t.css,r=t.media;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function u(e,t){var n=t.css,r=t.sourceMap;r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var o=new Blob([n],{type:"text/css"}),i=e.href;e.href=URL.createObjectURL(o),i&&URL.revokeObjectURL(i)}var p={},f=function(e){var t;return function(){return void 0===t&&(t=e.apply(this,arguments)),t}},m=f(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),h=f(function(){return document.head||document.getElementsByTagName("head")[0]}),g=null,v=0,b=[];e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");t=t||{},void 0===t.singleton&&(t.singleton=m()),void 0===t.insertAt&&(t.insertAt="bottom");var o=r(e);return n(o,t),function(e){for(var i=[],a=0;a<o.length;a++){var s=o[a],c=p[s.id];c.refs--,i.push(c)}if(e){n(r(e),t)}for(var a=0;a<i.length;a++){var c=i[a];if(0===c.refs){for(var l=0;l<c.parts.length;l++)c.parts[l]();delete p[c.id]}}}};var y=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()}])});
//# sourceMappingURL=bundle.js.map