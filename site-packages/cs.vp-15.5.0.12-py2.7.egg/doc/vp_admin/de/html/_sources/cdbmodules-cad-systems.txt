.. _`cdbmodules-cad-systems`:

Varianten-Editor
################

Anzeigen in CAD-Systemen
========================

Der Varianten-Editor bietet die Möglichkeit eine Variante in einem CAD-System
anzuzeigen. Sie können diese Funktionalität erweitern, um weitere Autorensysteme
zu unterstützen. Dafür müssen Sie ein Plugin schreiben und dieses im
Varianten-Editor registrieren. Die Definition
des Plugins kann dabei in jedem beliebigen Modul erfolgen.

Zur Registrierung von Plugins wird die Methode :guilabel:`register_plugin`
aus dem Modul :envvar:`cs.vp.variants.apps.generatorui` benötigt.
Sie wird folgendermaßen importiert:

.. code-block:: python

      from cs.vp.variants.apps.generatorui import register_plugin

Die Methode :envvar:`register_plugin` erwartet als Parameter
ein Python-Dictionary, in dem folgende Schlüssel/Wert-Paare vorhanden
sein müssen:

   * :envvar:`icon`: Name des Icons für den Button

   * :envvar:`label`: Name des Labels für den Tooltip

   * :envvar:`json`: eine JSON-Methode

   * :envvar:`json_name`: der öffentliche Name der JSON-Methode

Diese Parameter **müssen** mit Werten belegt sein, um ein neues CAD-System
erfolgreich dem Dropdown-Menü zuordnen zu können.


Außerdem gibt es noch die folgenden optionalen Parameter:
   * :envvar:`position`: Gibt die Position in dem Dropdown-Menü an.
   * :envvar:`open_new_window`: Bestimmt, ob die Operation ein neues
     Browser-Fenster öffnen soll. Der Defaultwert ist ``True``.

Die CAD-Systeme werden in absteigender Reihenfolge anhand der Positionsnummern
im Dropdown-Menü der Toolbar angezeigt.

Wird der Parameter :envvar:`position` nicht explizit mit einem Wert belegt,
so erhält er den Default-Wert 0. D.h. dass alle registrierten Plugins
ohne explizite Wertbelegung des Attributes :envvar:`position` an das Ende
des Dropdown-Menüs angehangen werden. Alle Plugins, die hingegen
mit einer expliziten Wertbelegung des Attributes :envvar:`position` > 0
registriert wurden, nehmen im Umkehrschluss eine höhere Position
im Dropdown-Menü ein.

Ein beispielhafter Aufruf der :envvar:`register_plugin` Methode sähe
folgendermaßen aus:

.. code-block:: python

   register_plugin({"icon": "cdbvp_show_in_catia",
                    "label": "cdbvp_show_in_catia",
                    "json_name": "show_in_catia",
                    "json": show_in_catia,
                    "position": 10})

Es wird die ID eines konfigurierten Icons
sowie die ID eines konfigurierten Labels übergeben.
Des Weiteren wird eine JSON-Methode sowie der Name der JSON-Methode
als Label übergeben.
Zuletzt wird der optional Parameter :envvar:`position` gesetzt,
um die Reihenfolge des Dropdown-Menüs zu beeinflussen.

Die JSON-Methode soll ein Python-Dictionary zurückgeben, das sowohl den Schlüssel :envvar:`url`
als auch einen Wert, den der Client verarbeiten kann, enthält. Dies kann zum Beispiel
die URL einer Operation sein. Ein Beispiel einer solchen JSON-Methode
finden Sie in :envvar:`cs.vp.variants.apps.generatorui.show_in_catia`.


Embedded Modus
==============

Um den Varianten-Editor als Panel im Client oder in einer externer Anwendung
einbetten zu können, bietet der Varianten-Editor einen *Embedded Modus*.
Wenn dieser Modus eingeschaltet ist, wird die Titelleiste nicht angezeigt
und der Bereich :guilabel:`Produktdetails` wird per default zusammengeklappt.

Um der *Embedded Modus* einzuschalten, rufen Sie den Varianteneditor mit dem
URL-Parameter :option:`embedded=1` auf.


Spalten Fixierung
=================

Um im Varianten-Editor bei einer größeren Anzahl von Spalten die beschreibenden ersten vier Spalten stets sehen zu können, bietet der Varianten-Editor die Möglichkeit, die ersten vier Spalten zu fixieren.
Sie können mittels der Property :guilabel:`vecf` einstellen, ob diese Funktion standardmäßig aktiv ist.
Dazu muss diese auf den Wert :guilabel:`true` gesetzt werden.
Sie finden die Property unter
:menuselection:`Administration/Konfiguration -> Konfiguration -> Properties`.

Der Anwender hat zusätzlich im Varianten-Editor die Möglichkeit mittels eines Buttons die Fixierung ein- bzw. abzuschalten.
