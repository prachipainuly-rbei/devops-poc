!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("React"),require("cs-web-components-externals"),require("cs-web-components-base"),require("ReactBootstrap"),require("Immutable")):"function"==typeof define&&define.amd?define(["React","cs-web-components-externals","cs-web-components-base","ReactBootstrap","Immutable"],t):"object"==typeof exports?exports["cs-sharing"]=t(require("React"),require("cs-web-components-externals"),require("cs-web-components-base"),require("ReactBootstrap"),require("Immutable")):e["cs-sharing"]=t(e.React,e["cs-web-components-externals"],e["cs-web-components-base"],e.ReactBootstrap,e.Immutable)}(this,function(e,t,r,n,o){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=13)}([function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t,r){"use strict";function n(e){return"cs-sharing-"+e}function o(){window.external.cdbEFClose()}function a(e){return e.get(s,"").split("/").reverse()[0]}function i(e){e.preventDefault(),e.stopPropagation()}Object.defineProperty(t,"__esModule",{value:!0}),t.prefixNS=n,t.closeTab=o,t.getRecipientClass=a,t.stopPropagation=i;var s="@type"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DEBUG=!1,t.TYPEAHEAD_LIMIT=7,t.SEARCH_DELAY=250,t.ATTACHMENT_BLOCK="attachment_block",t.SHARING_BLOCK="sharing_block",t.ERROR_BLOCK="error_block",t.URL_MY_SHARING_GROUPS="/api/v1/collection/sharing_group",t.URL_ATTACHMENTS="/internal/share_objects/attachments",t.URL_RECIPIENTS_POOL="/internal/share_objects/recipients",t.URL_GROUP_SIZE="/internal/share_objects/group_size",t.URL_SAVE_RECIPIENTS="/internal/share_objects/save_recipients",t.URL_GET_GROUP_MEMBERS="/internal/share_objects/get_group_members",t.URL_DELETE_OBJECT="/internal/share_objects/delete_object",t.URL_SHARE="/internal/share_objects",t.URL_FULLTEXTSEARCH="/share_objects/search/attachment?fulltextsearch=",t.APP_IS_DIRTY="app_is_dirty",t.SUCCESS_MESSAGE="success_message",t.CLOSE="close",t.SUCCESS_CLOSE="success_close",t.NO_ENTRIES="no_entries",t.SEARCH_PLACEHOLDER="search_placeholder",t.MESSAGE_PLACEHOLDER="message_placeholder",t.RECIPIENTS_PLACEHOLDER="recipients_placeholder",t.SAVE_RECIPIENTS_DESC="save_recipients_desc",t.SAVE_RECIPIENTS="save_recipients",t.NAME_GROUP="name_group",t.SUBMIT="submit",t.BACK="back",t.CANCEL="cancel",t.OK="ok",t.HELP="help",t.SHARED_OBJECTS="shared",t.REMOVE="remove",t.CANNOT_REMOVE="cannot_remove",t.ADD_GROUP="add_group",t.RESOLVE_USERS="resolve_users",t.EXISTING_LISTS="existing_lists",t.CLEAR_USER_LIST="clear_user_list",t.CLEAR_ATTACHMENTS="clear_attachments",t.MANAGE_RECIPIENTS="manage_recipients",t.FETCHING="fetching",t.CDB_OBJECT_ID="cdb_object_id",t.OBJECT_ICON="system:icon_link",t.DESC="system:description",t.FILES="relship:files",t.TARGETS="targets",t.ID="@id",t.CLASS="@type",t.ICON_INFO="CDBWin Info",t.ICON_COMMENT="/resources/icons/byname/cdb_sharing_comment",t.ICON_PERSON="/resources/icons/byname/cdb_sharing_person",t.ICON_SAVE="/resources/icons/byname/cdb_sharing_save",t.ICON_ATTACHMENT="cdb_attachment_24",t.ICON_RECIPIENTS_LIST_S="/resources/icons/byname/cdb_recipients_list",t.ICON_SHARING_APP="/resources/icons/byname/elements_share",t.USER_PIC_FALLBACK="csweb_person_fallback",t.ICON_COMMON_ROLE="cdb_common_role_61",t.ICON_RECIPIENTS_LIST_L="cdb_recipients_list_61"},function(e,t){e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatBaseStr=t.formatStr=t.Format=void 0;var n=r(4);t.Format=n.i18ndb.makeFormat("share_objects"),t.formatStr=n.i18ndb.makeFormatStr("share_objects"),t.formatBaseStr=n.i18ndb.makeFormatStr("base")},function(e,t,r){"use strict";function n(e){return{type:C,payload:{isDirty:e}}}function o(e,t){return{type:N,payload:{isDirty:!1,attachments:e,selectedRecipients:[],showSaveRecipientsModal:!1,showAddUserModal:!1,groups:t,dirtyState:{isDirty:!1,isInitialized:!0,success:!1}}}}function a(e){return{type:I,payload:{groups:e}}}function i(e){return{type:M,payload:{selectedRecipients:e}}}function s(e){return{type:L,payload:{recipient:e}}}function c(e){return{type:A,payload:{showSaveRecipientsModal:e}}}function u(e){return{type:j,payload:{showAddUserModal:e}}}function l(e){return{type:D,payload:{attachment:e}}}function p(e){return{type:k,payload:{removedObject:e}}}function f(){return{type:x,payload:{}}}function d(e){return{type:U,payload:{success:e}}}function h(e){return function(t){t(d(e))}}function m(e){return function(t){t(n(e))}}function y(){return function(e){e(f())}}function _(e){return function(t){t(l(e))}}function b(e){return function(t){t(p(e))}}function S(e){return function(t){t(i(e))}}function E(e){return function(t){t(s(e))}}function v(e){return function(t){t(c(e))}}function g(e){return function(t){t(u(e))}}function O(){return function(e){(0,R.getJSON)(P.URL_MY_SHARING_GROUPS).then(function(t){if(t.error)e((0,R.notifyError)(t.error.statusText,"",t.error.message));else{var r=t.objects.filter(function(e){return e[P.CLASS].indexOf("cdb_personal_sharing_group")>-1&&e.subject_id===window.appSetup["cs-sharing"].user_id});e(a(r))}})}}function T(){return function(e){return(0,R.getJSON)(P.URL_ATTACHMENTS+window.location.search).then(function(t){t.error?e((0,R.notifyError)(t.error.statusText,"",t.error.message)):(0,R.getJSON)(P.URL_MY_SHARING_GROUPS).then(function(r){if(r.error)e((0,R.notifyError)(r.error.statusText,"",r.error.message));else{var n=r.objects.filter(function(e){return e[P.CLASS].indexOf("cdb_personal_sharing_group")>-1&&e.subject_id===window.appSetup["cs-sharing"].user_id});e(o(t.attachments,n))}})})}}Object.defineProperty(t,"__esModule",{value:!0}),t.SUCCESS_STATE_MODIFIED=t.RECIPIENT_ADDED=t.ATTACHMENTS_CLEARED=t.ATTACHMENT_REMOVED=t.ATTACHMENT_ADDED=t.MY_SHARING_GROUPS_REFETCHED=t.SET_SHOW_ADD_USER_MODAL=t.SET_SHOW_SAVE_RECIPIENTS_MODAL=t.SET_SELECTED_RECIPIENTS=t.SET_DIRTY_STATE=t.GET_DIRTY_STATE=t.INIT_SHARING_STATE=void 0,t.setSuccessState=h,t.setDirtyState=m,t.clearAttachments=y,t.addAttachment=_,t.removeAttachment=b,t.setSelectedRecipients=S,t.addRecipient=E,t.setShowSaveRecipientModal=v,t.setShowAddUserModal=g,t.refetchMySharingGroups=O,t.initSharingState=T;var R=r(4),w=r(3),P=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(w),N=t.INIT_SHARING_STATE="cs-sharing-INIT_SHARING_STATE",C=(t.GET_DIRTY_STATE="cs-sharing-GET_DIRTY_STATE",t.SET_DIRTY_STATE="cs-sharing-SET_DIRTY_STATE"),M=t.SET_SELECTED_RECIPIENTS="cs-sharing-SET_SELECTED_RECIPIENTS",A=t.SET_SHOW_SAVE_RECIPIENTS_MODAL="cs-sharing-SET_SHOW_SAVE_RECIPIENTS_MODAL",j=t.SET_SHOW_ADD_USER_MODAL="cs-sharing- SET_SHOW_ADD_USER_MODAL",I=t.MY_SHARING_GROUPS_REFETCHED="cs-sharing-MY_SHARING_GROUPS_REFETCHED",D=t.ATTACHMENT_ADDED="cs-sharing-ATTACHMENT_ADDED",k=t.ATTACHMENT_REMOVED="cs-sharing-ATTACHMENT_REMOVED",x=t.ATTACHMENTS_CLEARED="cs-sharing-ATTACHMENTS_CLEARED",L=t.RECIPIENT_ADDED="cs-sharing-RECIPIENT_ADDED",U=t.SUCCESS_STATE_MODIFIED="cs-sharing-SUCCESS_STATE_MODIFIED"},function(e,t,r){"use strict";function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f.default.Map(),t=arguments[1];switch(t.type){case d.INIT_SHARING_STATE:return e.withMutations(function(e){e.set("attachments",f.default.List(t.payload.attachments)),e.set("selectedRecipients",f.default.fromJS(t.payload.selectedRecipients)),e.set("showSaveRecipientsModal",t.payload.showSaveRecipientsModal),e.set("showAddUserModal",t.payload.showAddUserModal),e.set("groups",t.payload.groups),e.set("dirtyState",f.default.fromJS(t.payload.dirtyState))});case d.GET_DIRTY_STATE:return e;case d.SET_DIRTY_STATE:return e.set("dirtyState",e.get("dirtyState").set("isDirty",t.payload.isDirty));case d.SUCCESS_STATE_MODIFIED:return e.set("dirtyState",e.get("dirtyState").set("success",t.payload.success));case d.SET_SELECTED_RECIPIENTS:return e.set("selectedRecipients",f.default.List(t.payload.selectedRecipients));case d.SET_SHOW_SAVE_RECIPIENTS_MODAL:return e.set("showSaveRecipientsModal",t.payload.showSaveRecipientsModal);case d.SET_SHOW_ADD_USER_MODAL:return e.set("showAddUserModal",t.payload.showAddUserModal);case d.MY_SHARING_GROUPS_REFETCHED:return e.set("groups",t.payload.groups);case d.ATTACHMENT_REMOVED:var r=e.get("attachments",f.default.List()).filter(function(e){return e!==t.payload.removedObject});return e.set("attachments",r);case d.ATTACHMENT_ADDED:var n=t.payload.attachment;return e.get("attachments",f.default.List()).find(function(e){return e.cdb_object_id===n.cdb_object_id})?e:e.set("attachments",e.get("attachments",f.default.List()).push(n));case d.ATTACHMENTS_CLEARED:return e.set("attachments",f.default.List());case d.RECIPIENT_ADDED:var o=t.payload.recipient;return e.get("selectedRecipients",f.default.List()).find(function(e){return e.cdb_object_id===o.cdb_object_id})?e:e.set("selectedRecipients",e.get("selectedRecipients",f.default.List()).push(o));default:return e}}function o(e){return(e.sharing.get("dirtyState",f.default.fromJS({isDirty:!1})).get("isDirty")||0!==e.sharing.get("selectedRecipients",f.default.List()).count())&&!e.sharing.get("dirtyState",f.default.fromJS({success:!1})).get("success")}function a(e){return e.sharing.get("attachments",f.default.List()).toJS()}function i(e){return e.sharing.get("selectedRecipients",f.default.List())}function s(e){return e.sharing.get("showSaveRecipientsModal",!1)}function c(e){return e.sharing.get("showAddUserModal",!1)}function u(e){return e.sharing.get("groups",[])}function l(e){return e.sharing.get("dirtyState",f.default.fromJS({isDirty:!1,isInitialized:!1}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n,t.getDirtyState=o,t.getAttachments=a,t.getSelectedRecipients=i,t.getShowSaveRecipientsModal=s,t.getShowAddUserModal=c,t.getSharingGroups=u,t.getDirtyInfo=l;var p=r(9),f=function(e){return e&&e.__esModule?e:{default:e}}(p),d=r(6)},function(e,t){e.exports=n},function(e,t){e.exports=o},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(0),c=function(e){return e&&e.__esModule?e:{default:e}}(s),u=r(1),l=r(8),p=r(2),f=function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),i(t,[{key:"render",value:function(){var e=this.props.additionalClassNames,t=e?(0,p.prefixNS)("app-row ")+e:(0,p.prefixNS)("app-row");return c.default.createElement(l.Row,{className:t,id:this.props.id},c.default.createElement(l.Col,{xs:0,sm:1,md:2,className:(0,p.prefixNS)("share-objects-app-gutter-left")}),c.default.createElement(l.Col,{xs:1,className:(0,p.prefixNS)("share-objects-app-col-left")},this.props.left),c.default.createElement(l.Col,{xs:10,sm:8,md:6,lg:5,className:(0,p.prefixNS)("share-objects-app-col-center")},this.props.center),c.default.createElement(l.Col,{xs:1,className:(0,p.prefixNS)("share-objects-app-col-right")},this.props.right),c.default.createElement(l.Col,{xs:0,sm:1,md:2,lg:3,className:(0,p.prefixNS)("share-objects-app-gutter-right")}))}}]),t}(c.default.Component);t.default=f,f.propTypes={additionalClassNames:u.PropTypes.string,id:u.PropTypes.string,left:u.PropTypes.element,center:u.PropTypes.element,right:u.PropTypes.element}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(0),c=function(e){return e&&e.__esModule?e:{default:e}}(s),u=r(1),l=r(2),p=function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),i(t,[{key:"focused",value:function(e){var t=document.getElementById("floating-label-"+this.props.id);e?t.classList.add((0,l.prefixNS)("floating-label-on")):t.classList.remove((0,l.prefixNS)("floating-label-on"))}},{key:"getLabelStyle",value:function(){var e=document.getElementById(String(this.props.id)),t=[(0,l.prefixNS)("floating-label-field-wrapper-label")];if(!e)return t.join(" ");var r=e.value,n=document.activeElement===e,o=Boolean(-1!==navigator.userAgent.indexOf("Trident"));return(r||n&&o)&&t.push((0,l.prefixNS)("floating-label-show")),n&&t.push((0,l.prefixNS)("floating-label-on")),t.join(" ")}},{key:"render",value:function(){var e=this,t=this.props,r=t.input,n=t.id,o=t.placeholder;return c.default.createElement("div",{className:(0,l.prefixNS)("floating-label-field-wrapper"),onFocus:function(){e.focused(!0)},onBlur:function(){e.focused(!1)}},c.default.createElement("label",{htmlFor:n,id:"floating-label-"+n,className:this.getLabelStyle()},o),r)}}]),t}(c.default.Component);t.default=p,p.propTypes={id:u.PropTypes.string.isRequired,input:u.PropTypes.object.isRequired,placeholder:u.PropTypes.string.isRequired}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(0),c=function(e){return e&&e.__esModule?e:{default:e}}(s),u=r(1),l=r(2),p=function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),i(t,[{key:"render",value:function(){var e=this.props,t=e.img_url,r=e.imgName,n=t||"/resources/icons/byname/"+r;return c.default.createElement("div",{className:(0,l.prefixNS)("recipients-img-wrapper"),style:{backgroundImage:"url('"+n+"')"}})}}]),t}(c.default.Component);t.default=p,p.propTypes={img_url:u.PropTypes.string,imgName:u.PropTypes.string}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(4),a=r(2),i=r(14),s=n(i),c=r(7),u=n(c);o.Registry.registerComponent((0,a.prefixNS)("ShareObjectsApp"),s.default),o.Registry.registerReducers({sharing:u.default}),t.default={ShareObjectsApp:s.default}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return{isDirty:(0,m.getDirtyState)(e)}}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(0),l=n(u),p=r(1),f=r(4),d=r(15),h=n(d),m=r(7),y=r(6),_=r(5),b=r(3),S=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(b),E=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.onBeforeUnload=r.onBeforeUnload.bind(r),r.onKeyUp=r.onKeyUp.bind(r),r.appBarItems=[{active:!0,key:"cs-sharing-app",name:(0,_.formatStr)("submit"),icon:S.ICON_SHARING_APP,link:window.location,onIconClick:void 0,onTextClick:void 0}],r}return i(t,e),c(t,[{key:"onBeforeUnload",value:function(e){this.props.isDirty?e.returnValue=(0,_.formatStr)(S.APP_IS_DIRTY):e.returnValue=""}},{key:"onKeyUp",value:function(e){var t=window.appSetup["cs-sharing"].helpURL;"F1"===e.key&&t&&window.open(t)}},{key:"componentWillMount",value:function(){this.props.initSharingState()}},{key:"componentDidMount",value:function(){window.addEventListener("beforeunload",this.onBeforeUnload),window.addEventListener("keyup",this.onBeforeUnload),document.getElementById("recipients-query").focus()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("beforeunload",this.onBeforeUnload),window.removeEventListener("keyup",this.onKeyUp)}},{key:"openHelp",value:function(){window.open(window.appSetup["cs-sharing"].helpURL)}},{key:"render",value:function(){var e=window.appSetup["cs-sharing"].is_cdbpc?null:l.default.createElement(f.ApplicationBar,{items:this.appBarItems},l.default.createElement(f.IconButton,{onClick:this.openHelp,title:(0,_.formatBaseStr)("help_reference"),iconName:"csapp_documentation_portal",buttonStyle:"info"}));return l.default.createElement("div",null,e,l.default.createElement(h.default,{busy:!1}))}}]),t}(l.default.Component);E.propTypes={isDirty:p.PropTypes.bool,initSharingState:p.PropTypes.func};var v=(0,p.connect)(s,{initSharingState:y.initSharingState})(E),g=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),c(t,[{key:"render",value:function(){return l.default.createElement(f.SinglePage,{frameComponent:f.PageFrame.ApplicationFrame,pageContent:v})}}]),t}(l.default.Component);t.default=g},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return{attachments:(0,N.getAttachments)(e),selectedRecipients:(0,N.getSelectedRecipients)(e)}}Object.defineProperty(t,"__esModule",{value:!0});var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),p=n(l),f=r(8),d=r(1),h=r(4),m=r(2),y=r(5),_=r(6),b=r(3),S=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(b),E=r(16),v=n(E),g=r(20),O=n(g),T=r(32),R=n(T),w=r(10),P=n(w),N=r(7),C=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.is_cdbpc=window.appSetup["cs-sharing"].is_cdbpc,r.state={submitMessage:"",busy:!1,success:!1},r}return i(t,e),u(t,[{key:"cancel",value:function(){this.is_cdbpc?(this.props.setDirtyState(!1),(0,m.closeTab)()):window.close()}},{key:"submit",value:function(){var e=this;this.setState({busy:!0});var t={attachments:this.props.attachments,recipients:this.props.selectedRecipients,message:this.state.submitMessage};(0,h.postJSON)(S.URL_SHARE,t).then(function(){e.setState({busy:!1,success:!0},function(){e.is_cdbpc&&(0,m.closeTab)(),e.props.setDirtyState(!1),e.props.setSuccessState(!0)})})}},{key:"messageChanged",value:function(e){""===this.state.submitMessage&&""!==e&&this.props.setDirtyState(!0),this.setState({submitMessage:e})}},{key:"getFooter",value:function(){var e=this;if(this.state.success)return this.is_cdbpc?null:p.default.createElement("div",{className:(0,m.prefixNS)("share-objects-app-footer-buttons")},p.default.createElement(h.Button.TextButton,{bsStyle:"primary",onClick:function(){window.close()},title:(0,y.formatStr)(S.CLOSE)}));var t=!(0!==this.props.attachments.length&&0!==this.props.selectedRecipients.size),r=this.is_cdbpc?(0,y.formatStr)(S.CANCEL):(0,y.formatStr)(S.CLOSE);return p.default.createElement(P.default,c({},this.props,{additionalClassNames:(0,m.prefixNS)("share-objects-app-footer-buttons"),center:p.default.createElement("div",{className:(0,m.prefixNS)("app-separate-btns")},p.default.createElement(h.Button.TextButton,{buttonStyle:"primary",onClick:function(){e.submit()},disabled:t,title:(0,y.formatStr)(S.SUBMIT)}),p.default.createElement(h.Button.TextButton,{buttonStyle:"default",onClick:function(){e.cancel()},title:r}))}))}},{key:"renderProgressIndicator",value:function(){return p.default.createElement("div",{className:(0,m.prefixNS)("detail-loading")},p.default.createElement(h.Throbber,null))}},{key:"renderApplicationPanel",value:function(){var e=this;return p.default.createElement(f.Grid,null,this.state.success?p.default.createElement(R.default,null):null,p.default.createElement(v.default,c({},this.props,{key:S.ATTACHMENT_BLOCK,success:this.state.success})),p.default.createElement(O.default,c({},this.props,{key:S.SHARING_BLOCK,messageChanged:function(t){return e.messageChanged(t)},success:this.state.success,submitMessage:this.state.submitMessage})),this.getFooter())}},{key:"render",value:function(){return this.state.busy?this.renderProgressIndicator():this.renderApplicationPanel()}}]),t}(p.default.Component);C.propTypes={busy:d.PropTypes.bool,setDirtyState:d.PropTypes.func,setSuccessState:d.PropTypes.func,attachments:d.PropTypes.array.isRequired,selectedRecipients:d.ImmutablePropTypes.list};var M=(0,d.connect)(s,{setDirtyState:_.setDirtyState,setSuccessState:_.setSuccessState})(C);t.default=M},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return{attachments:(0,P.getAttachments)(e),isInitialized:(0,P.getDirtyInfo)(e).get("isInitialized")}}Object.defineProperty(t,"__esModule",{value:!0});var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),p=n(l),f=r(1),d=r(4),h=r(8),m=r(10),y=n(m),_=r(17),b=n(_),S=r(18),E=n(S),v=r(19),g=n(v),O=r(3),T=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(O),R=r(2),w=r(5),P=r(7),N=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"renderAttachmentSection",value:function(){var e=this,t=this.props.success?null:p.default.createElement(h.Row,{id:"attachments-row",className:(0,R.prefixNS)("attachments-row")},p.default.createElement(g.default,this.props));return p.default.createElement("div",{id:"attachments-block"},p.default.createElement(y.default,c({},this.props,{center:null})),this.props.attachments.map(function(t,r){return p.default.createElement(b.default,c({},e.props,{attachment:t,attachment_index:r,key:"attachment-"+r}))}),0===this.props.attachments.length?p.default.createElement(y.default,c({},this.props,{left:p.default.createElement(d.SVGIcon,{className:(0,R.prefixNS)("app-block-icon"),size:"md",title:(0,w.formatStr)(T.SHARED_OBJECTS),name:T.ICON_ATTACHMENT}),center:p.default.createElement(h.Grid,{fluid:!0,id:"attachments-grid",className:(0,R.prefixNS)("attachments-alert")},p.default.createElement(h.Alert,{bsStyle:"info"},this.props.isInitialized?(0,w.formatStr)("no_entries"):(0,w.formatStr)(T.FETCHING)))})):null,p.default.createElement(y.default,c({},this.props,{center:p.default.createElement(h.Grid,{fluid:!0,id:"attachments-grid"},t),right:this.props.success?null:p.default.createElement(E.default,null)})))}},{key:"renderSuccessMessage",value:function(){return p.default.createElement("div",{id:"attachments-block"},p.default.createElement("div",{className:"text-muted"},(0,w.formatStr)(T.SHARED_OBJECTS)),this.renderAttachmentSection())}},{key:"render",value:function(){return this.props.success?this.renderSuccessMessage():this.renderAttachmentSection()}}]),t}(p.default.Component);N.propTypes={success:f.PropTypes.bool,isInitialized:f.PropTypes.bool,attachments:f.PropTypes.array.isRequired};var C=(0,f.connect)(s)(N);t.default=C},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(0),l=n(u),p=r(8),f=r(4),d=r(1),h=r(10),m=n(h),y=r(2),_=r(5),b=r(6),S=r(3),E=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(S),v=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.helpURL=window.appSetup["cs-sharing"].helpURL,r.language=window.appSetup["cs-sharing"].language,r}return i(t,e),c(t,[{key:"removeAttachment",value:function(){this.props.removeAttachment(this.props.attachment),this.props.setDirtyState(!0)}},{key:"addGroup",value:function(e){this.props.addRecipient(e)}},{key:"getAttachmentActions",value:function(e){var t=this,r=this.props.attachment.object_groups;if(r&&0!==r.length){var n="attachments-add-group-dropdown-"+e;return l.default.createElement(f.DropdownIconButton,{iconSrc:E.ICON_RECIPIENTS_LIST_S,size:"sm",buttonStyle:"success",id:n,title:(0,_.formatStr)(E.ADD_GROUP),noCaret:!0},r.map(function(e,r){return l.default.createElement(p.MenuItem,{eventKey:e,onSelect:function(e){t.addGroup(e)},key:"object-group-"+r},e["name_"+t.language])}))}return null}},{key:"getAttachmentRow",value:function(e){var t=this,r=this.props,n=r.attachments,o=r.attachment,a=r.attachment_index,i=(0,_.formatStr)(E.REMOVE);if(e)return l.default.createElement(p.Row,{className:(0,y.prefixNS)("attachments-attachment-success")},l.default.createElement(f.SVGIcon,{className:(0,y.prefixNS)("app-object-icon"),src:o[E.OBJECT_ICON]}),l.default.createElement("span",{className:(0,y.prefixNS)("attachments-desc")},o[E.DESC]));var s=l.default.createElement(f.IconButton,{buttonStyle:"danger",iconName:"csweb_remove",title:(0,_.formatStr)(E.CANNOT_REMOVE),disabled:!0});return n&&n.length>0&&(s=l.default.createElement(f.IconButton,{buttonStyle:"danger",iconName:"csweb_remove",title:i,onClick:function(){t.removeAttachment()}})),l.default.createElement(p.Row,{className:(0,y.prefixNS)("attachments-attachment ")+(0,y.prefixNS)("attachments-attachment-inner")},l.default.createElement("span",{className:(0,y.prefixNS)("flex-container")},l.default.createElement("span",{className:(0,y.prefixNS)("attachments-icon-flex")},l.default.createElement(f.SVGIcon,{className:(0,y.prefixNS)("app-object-icon"),src:o[E.OBJECT_ICON]})),l.default.createElement("span",{className:(0,y.prefixNS)("attachments-desc")},l.default.createElement("span",{className:(0,y.prefixNS)("attachments-text-wrapping-container")},o[E.DESC])),l.default.createElement("span",{className:(0,y.prefixNS)("attachments-btns")},s,this.getAttachmentActions(a))))}},{key:"render",value:function(){if(this.props.success)return this.getAttachmentRow(!0);var e=this.props.attachment_index;return l.default.createElement(m.default,s({},this.props,{additionalClassNames:(0,y.prefixNS)("attachments-attachment"),left:0===e?l.default.createElement(f.SVGIcon,{className:(0,y.prefixNS)("app-block-icon"),title:(0,_.formatStr)(E.SHARED_OBJECTS),size:"md",name:E.ICON_ATTACHMENT}):void 0,center:this.getAttachmentRow(),right:null}))}}]),t}(l.default.Component);v.propTypes={attachment_index:d.PropTypes.number.isRequired,attachments:d.PropTypes.array.isRequired,attachment:d.PropTypes.object.isRequired,success:d.PropTypes.bool.isRequired,removeAttachment:d.PropTypes.func.isRequired,addRecipient:d.PropTypes.func.isRequired,setDirtyState:d.PropTypes.func.isRequired};var g={removeAttachment:b.removeAttachment,addRecipient:b.addRecipient,setDirtyState:b.setDirtyState},O=(0,d.connect)(void 0,g)(v);t.default=O},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){return{attachments:(0,f.getAttachments)(e)}}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(0),u=function(e){return e&&e.__esModule?e:{default:e}}(c),l=r(4),p=r(1),f=r(7),d=r(6),h=r(2),m=r(5),y=r(3),_=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(y),b=function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"render",value:function(){var e=this,t=0===this.props.attachments.length;return u.default.createElement(l.IconButton,{disabled:t,buttonStyle:"danger",onClick:function(){e.props.clearAttachments(),e.props.setDirtyState(!0)},className:(0,h.prefixNS)("delete-all-attachments-button"),iconName:"csweb_remove",title:(0,m.formatStr)(_.CLEAR_ATTACHMENTS)})}}]),t}(u.default.Component);b.propTypes={attachments:p.PropTypes.array,clearAttachments:p.PropTypes.func,setDirtyState:p.PropTypes.func};var S={clearAttachments:d.clearAttachments,setDirtyState:d.setDirtyState},E=(0,p.connect)(i,S)(b);t.default=E},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(0),c=function(e){return e&&e.__esModule?e:{default:e}}(s),u=r(4),l=r(1),p=r(5),f=r(2),d=r(6),h=r(3),m=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(h),y=function(e){function t(e){n(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.addAttachment=r.addAttachment.bind(r),r}return a(t,e),i(t,[{key:"addAttachment",value:function(e){var t=this;(0,u.getJSON)(e.get("rest_url")).then(function(e){e.error?t.props.notifyError(e.error.statusText,"",e.error.message):(t.props.addAttachment(e),t.props.setDirtyState(!0))})}},{key:"render",value:function(){var e=(0,p.formatStr)(m.SEARCH_PLACEHOLDER);return c.default.createElement("div",{className:(0,f.prefixNS)("object-search-wrapper"),id:"object-search-wrapper"},c.default.createElement(u.ObjectWidgets.ObjectSearch,{onSelectItem:this.addAttachment,searchPlaceholder:e,id:"sharing-object-search"}))}}]),t}(c.default.Component);y.propTypes={notifyError:l.PropTypes.func,addAttachment:l.PropTypes.func,setDirtyState:l.PropTypes.func};var _={notifyError:u.notifyError,addAttachment:d.addAttachment,setDirtyState:d.setDirtyState},b=(0,l.connect)(void 0,_)(y);t.default=b},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return{selectedRecipients:(0,O.getSelectedRecipients)(e)}}Object.defineProperty(t,"__esModule",{value:!0});var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),p=n(l),f=r(8),d=r(4),h=r(1),m=r(11),y=n(m),_=r(10),b=n(_),S=r(21),E=n(S),v=r(5),g=r(2),O=r(7),T=r(6),R=r(3),w=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(R),P=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.showAddUserModal=r.showAddUserModal.bind(r),r.showSaveRecipientsModal=r.showSaveRecipientsModal.bind(r),r.state={message:""},r}return i(t,e),u(t,[{key:"setMessage",value:function(e){this.setState({message:e.target.value}),this.props.messageChanged(e.target.value)}},{key:"showAddUserModal",value:function(){this.props.setShowAddUserModal(!0)}},{key:"showSaveRecipientsModal",value:function(){this.props.setShowSaveRecipientModal(!0)}},{key:"render",value:function(){var e=this;if(this.props.success)return p.default.createElement("div",{id:"sharing-block-success",className:(0,g.prefixNS)("sharing-block-success")},p.default.createElement("div",{className:"text-muted"},(0,v.formatStr)(w.RECIPIENTS_PLACEHOLDER)),p.default.createElement("div",null,this.props.selectedRecipients.map(function(e){return e[w.DESC]}).join(", ")),p.default.createElement("div",{id:"sharing-message-row"},p.default.createElement("div",{className:"text-muted"},(0,v.formatStr)(w.MESSAGE_PLACEHOLDER)),p.default.createElement("pre",{className:(0,g.prefixNS)("unstyled")},this.props.submitMessage)));var t=0===this.props.selectedRecipients.size,r=(0,v.formatStr)(w.MESSAGE_PLACEHOLDER),n=p.default.createElement(d.FormControl.TextArea,{id:"sharing-message",name:"sharing-message",rows:"4",placeholder:r,onChange:function(t){e.setMessage(t)},value:this.state.message}),o=p.default.createElement(d.DropdownIconButton,{iconName:"cdb_common_role_61",size:"sm",buttonStyle:"success",id:(0,g.prefixNS)("recipient-actions"),className:(0,g.prefixNS)("recipient-actions"),title:(0,v.formatStr)(w.MANAGE_RECIPIENTS),noCaret:!0},p.default.createElement(f.MenuItem,{onSelect:this.showAddUserModal},(0,v.formatStr)(w.RESOLVE_USERS)),p.default.createElement(f.MenuItem,{divider:!0}),p.default.createElement(f.MenuItem,{onSelect:this.showSaveRecipientsModal,disabled:t},(0,v.formatStr)(w.SAVE_RECIPIENTS_DESC)),p.default.createElement(f.MenuItem,{onSelect:function(){e.props.setSelectedRecipients([])},disabled:t},(0,v.formatStr)(w.CLEAR_USER_LIST)));return p.default.createElement("div",{id:"sharing-block",className:(0,g.prefixNS)("sharing-block")},null,p.default.createElement(b.default,c({},this.props,{left:p.default.createElement(d.SVGIcon,{src:w.ICON_PERSON,size:"md",title:(0,v.formatStr)(w.RECIPIENTS_PLACEHOLDER),className:(0,g.prefixNS)("app-block-icon")}),center:p.default.createElement(E.default,this.props),right:o})),p.default.createElement(b.default,c({},this.props,{id:"sharing-message-row",left:p.default.createElement(d.SVGIcon,{src:w.ICON_COMMENT,size:"md",title:(0,v.formatStr)(w.MESSAGE_PLACEHOLDER),className:(0,g.prefixNS)("app-block-icon")}),center:p.default.createElement(y.default,{input:n,id:"sharing-message",placeholder:r})})))}}]),t}(p.default.Component);P.propTypes={selectedRecipients:h.ImmutablePropTypes.list,setShowSaveRecipientModal:h.PropTypes.func.isRequired,setShowAddUserModal:h.PropTypes.func.isRequired,messageChanged:h.PropTypes.func,setSelectedRecipients:h.PropTypes.func,success:h.PropTypes.bool,submitMessage:h.PropTypes.string};var N={setShowSaveRecipientModal:T.setShowSaveRecipientModal,setShowAddUserModal:T.setShowAddUserModal,setSelectedRecipients:T.setSelectedRecipients},C=(0,h.connect)(s,N)(P);t.default=C},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return{showSaveRecipientsModal:(0,A.getShowSaveRecipientsModal)(e),showAddUserModal:(0,A.getShowAddUserModal)(e),selectedRecipients:(0,A.getSelectedRecipients)(e)}}Object.defineProperty(t,"__esModule",{value:!0});var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(9),p=n(l),f=r(0),d=n(f),h=r(4),m=r(1),y=r(11),_=n(y),b=r(22),S=n(b),E=r(26),v=n(E),g=r(27),O=n(g),T=r(31),R=n(T),w=r(5),P=r(3),N=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(P),C=r(2),M=r(6),A=r(7),j=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.state={searchTerm:"",recipientSuggestions:[],hasMore:!1},r.typeAheadRecipients=h.FormControl.WithTypeAhead(h.FormControl.TextInput),r.recipientSelected=r.recipientSelected.bind(r),r.removeRecipient=r.removeRecipient.bind(r),r.resolveRecipient=r.resolveRecipient.bind(r),r.timeoutID=null,r}return i(t,e),u(t,[{key:"componentWillReceiveProps",value:function(e){this.props.selectedRecipients!==e.selectedRecipients&&this.setState({searchTerm:"",recipientSuggestions:[],hasMore:!1})}},{key:"focus",value:function(e){e?document.getElementById("recipients-frame").classList.add("focus"):document.getElementById("recipients-frame").classList.remove("focus")}},{key:"updateSearchTerm",value:function(e){var t=this,r=e.target.value.trimLeft();this.setState({searchTerm:r},function(){""!==r?t.queryRecipients():t.setState({recipientSuggestions:[],hasMore:!1})})}},{key:"keyDownHandler",value:function(e){if("Backspace"===e.key&&0===this.state.searchTerm.length){var t=this.props.selectedRecipients.size;0!==t&&this.removeRecipient(t-1)}}},{key:"queryRecipients",value:function(){var e=this;this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=setTimeout(function(){(0,h.getJSON)(N.URL_RECIPIENTS_POOL,{query:e.state.searchTerm,limit:N.TYPEAHEAD_LIMIT}).then(function(t){e.setState({recipientSuggestions:t.recipients,hasMore:t.has_more})})},N.SEARCH_DELAY)}},{key:"recipientSelected",value:function(e){var t=this.state.recipientSuggestions[e];this.userExists(this.props.selectedRecipients,t)||this.props.setSelectedRecipients(this.props.selectedRecipients.push(t)),this.setState({searchTerm:"",recipientSuggestions:[]})}},{key:"removeRecipient",value:function(e){this.props.setSelectedRecipients(this.props.selectedRecipients.remove(e))}},{key:"userExists",value:function(e,t){return e.find(function(e){return e.cdb_object_id?e.cdb_object_id===t.cdb_object_id:e["@id"]===t["@id"]})}},{key:"resolveRecipient",value:function(e){var t=this,r={group:this.props.selectedRecipients.get(e)};(0,h.postJSON)(N.URL_GROUP_SIZE,r).then(function(r){if(r.error||0===r.size)return void t.props.notifyError(r.error.statusText,"",r.error.message);var n=t.props.selectedRecipients.remove(e);r.users.forEach(function(e){t.userExists(n,e)||(n=n.push(e))}),t.props.setSelectedRecipients(n)})}},{key:"getSaveRecipientsModal",value:function(){return this.props.showSaveRecipientsModal?d.default.createElement(O.default,this.props):null}},{key:"getAddUserModal",value:function(){return this.props.showAddUserModal?d.default.createElement(R.default,c({},this.props,{searchTerm:this.state.searchTerm})):null}},{key:"render",value:function(){var e=this,t=(0,w.formatStr)(N.RECIPIENTS_PLACEHOLDER),r=this.typeAheadRecipients,n=d.default.createElement("div",{id:"recipients-frame",className:"form-control "+(0,C.prefixNS)("recipients-frame")},this.props.selectedRecipients.map(function(t,r){return d.default.createElement(v.default,c({key:"recipients-selected-"+r,index:r,recipient:t,onRemoveRecipient:e.removeRecipient,onResolveRecipient:e.resolveRecipient},e.props))}),d.default.createElement(r,{value:this.state.searchTerm,matched:p.default.fromJS(this.state.recipientSuggestions),hasMoreMatches:this.state.hasMore,autoSelectFirstMatch:!0,id:"recipients-query",name:"recipients-query",type:"text",autoComplete:"off",placeholder:t,onFocus:function(){e.focus(!0)},onBlur:function(){e.focus(!1)},onChange:function(t){e.updateSearchTerm(t)},onKeyDown:function(t){e.keyDownHandler(t)},TypeAheadItemRenderer:S.default,onSelectAt:this.recipientSelected}));return d.default.createElement("div",{id:"recipients-wrapper",className:(0,C.prefixNS)("recipients-wrapper")},d.default.createElement(_.default,{input:n,id:"recipients-query",className:"recipients-query",placeholder:t}),this.getSaveRecipientsModal(),this.getAddUserModal())}}]),t}(d.default.Component);j.propTypes={notifyError:m.PropTypes.func,setSelectedRecipients:m.PropTypes.func,showSaveRecipientsModal:m.PropTypes.bool.isRequired,showAddUserModal:m.PropTypes.bool.isRequired,selectedRecipients:m.ImmutablePropTypes.list};var I={notifyError:h.notifyError,setSelectedRecipients:M.setSelectedRecipients},D=(0,m.connect)(s,I)(j);t.default=D},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(0),u=n(c),l=r(1),p=r(23),f=n(p),d=r(24),h=n(d),m=r(25),y=n(m),_=r(2),b=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.item;switch((0,_.getRecipientClass)(e)){case"angestellter":return u.default.createElement(h.default,this.props);case"cdb_global_role":return u.default.createElement(f.default,this.props);case"cdb_personal_sharing_group":return u.default.createElement(y.default,this.props)}return null}}]),t}(u.default.Component);t.default=b,b.propTypes={item:l.ImmutablePropTypes.map}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(0),u=n(c),l=r(1),p=r(12),f=n(p),d=r(3),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(d),m=r(2),y=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"getRoleDescriptionAttribute",value:function(){var e=window.appSetup["cs-sharing"].language;return"de"===e?"description":"description_ml_"+e}},{key:"render",value:function(){var e=this.props.item;return u.default.createElement("div",{className:(0,m.prefixNS)("recipients-role")},u.default.createElement(f.default,{imgName:h.ICON_COMMON_ROLE}),u.default.createElement("ul",{className:(0,m.prefixNS)("recipients-recipient-data")},u.default.createElement("li",null,u.default.createElement("strong",null,e.get(h.DESC))),u.default.createElement("li",{className:(0,m.prefixNS)("text-muted")},e.get(this.getRoleDescriptionAttribute()))))}}]),t}(u.default.Component);t.default=y,y.propTypes={item:l.ImmutablePropTypes.map}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(0),u=n(c),l=r(1),p=r(12),f=n(p),d=r(3),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(d),m=r(2),y=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"getUserPicture",value:function(e){try{return u.default.createElement(f.default,{img_url:e.get(h.FILES).get(h.TARGETS).get(0).get(h.ID)})}catch(e){return u.default.createElement(f.default,{imgName:h.USER_PIC_FALLBACK})}}},{key:"render",value:function(){var e=this.props.item;return u.default.createElement("div",{className:(0,m.prefixNS)("recipients-user")},this.getUserPicture(e),u.default.createElement("ul",{className:(0,m.prefixNS)("recipients-recipient-data")},u.default.createElement("li",null,u.default.createElement("strong",null,e.get("lastname"),", ",e.get("firstname"))),u.default.createElement("li",{className:(0,m.prefixNS)("text-muted")},e.get("org_name")),u.default.createElement("li",{className:(0,m.prefixNS)("text-muted app-separate-children")},e.get("abt_nummer")," ",e.get("beruf"))))}}]),t}(u.default.Component);t.default=y,y.propTypes={item:l.ImmutablePropTypes.map}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(0),u=n(c),l=r(12),p=n(l),f=r(1),d=r(2),h=r(3),m=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(h),y=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.item;return u.default.createElement("div",{className:(0,d.prefixNS)("recipients-group")},u.default.createElement(p.default,{imgName:m.ICON_RECIPIENTS_LIST_L}),u.default.createElement("ul",{className:(0,d.prefixNS)("recipients-recipient-data")},u.default.createElement("li",null,u.default.createElement("strong",null,e.get(m.DESC)))))}}]),t}(u.default.Component);t.default=y,y.propTypes={item:f.ImmutablePropTypes.map}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(0),c=function(e){return e&&e.__esModule?e:{default:e}}(s),u=r(8),l=r(1),p=r(4),f=r(2),d=r(5),h=r(3),m=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(h),y=function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),i(t,[{key:"getResolveButton",value:function(){var e=this.props.recipient[m.CLASS].split("/").reverse()[0];return"cdb_global_role"===e||"cdb_personal_sharing_group"===e?c.default.createElement(u.Glyphicon,{glyph:"new-window",className:(0,f.prefixNS)("recipients-resolve-to-users"),title:(0,d.formatStr)(m.RESOLVE_USERS),onClick:this.resolveRecipient.bind(this)}):null}},{key:"removeRecipient",value:function(){var e=this.props,t=e.onRemoveRecipient,r=e.index;t&&t(r)}},{key:"resolveRecipient",value:function(){var e=this.props,t=e.onResolveRecipient,r=e.index;t&&t(r)}},{key:"render",value:function(){var e=this.props.recipient;return c.default.createElement("div",{className:(0,f.prefixNS)("app-separate-children")+" label"},this.getResolveButton(),e[m.DESC],c.default.createElement(p.IconButton,{buttonStyle:"link",iconName:"csweb_remove",title:(0,d.formatStr)(m.REMOVE),onClick:this.removeRecipient.bind(this),className:(0,f.prefixNS)("recipients-remove-recipient")}))}}]),t}(c.default.Component);t.default=y,y.propTypes={index:l.PropTypes.number.isRequired,recipient:l.PropTypes.object.isRequired,onRemoveRecipient:l.PropTypes.func,onResolveRecipient:l.PropTypes.func}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return{recipients:(0,m.getSelectedRecipients)(e)}}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(0),l=n(u),p=r(8),f=r(4),d=r(1),h=r(5),m=r(7),y=r(6),_=r(11),b=n(_),S=r(28),E=n(S),v=r(2),g=r(3),O=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(g),T=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.state={name:"",errorMessage:""},r}return i(t,e),c(t,[{key:"updateValue",value:function(){var e=document.getElementById("save-recipients-modal-group-name");if(e){var t=e.value;this.setState({name:t})}}},{key:"keyHandler",value:function(e){var t=document.getElementById("save-recipients-modal-group-name");document.activeElement===t&&"Enter"===e.key&&((0,v.stopPropagation)(e),this.submit())}},{key:"close",value:function(){this.props.setShowSaveRecipientModal(!1)}},{key:"submit",value:function(){var e=this,t={name:this.state.name,recipients:this.props.recipients.toJS()};(0,f.postJSON)(O.URL_SAVE_RECIPIENTS,t).then(function(t){t.error?e.setState({errorMessage:t.error.message+" "+t.error.statusText}):(e.props.refetchMySharingGroups(),e.close())})}},{key:"render",value:function(){var e=this,t=(0,h.formatStr)(O.NAME_GROUP),r=l.default.createElement(f.FormControl.TextInput,{id:"save-recipients-modal-group-name",name:"save-recipients-modal-group-name",autoComplete:"off",placeholder:t,onChange:function(){e.updateValue()},onKeyUp:function(t){e.keyHandler(t)}});return l.default.createElement(f.Dialog.Dialog,{onHide:function(){e.close()},show:!0,showCancel:!0,buttons:[l.default.createElement(f.Dialog.Buttons.Ok,{key:"ok",onClick:function(){e.submit()}}),l.default.createElement(f.Dialog.Buttons.Cancel,{key:"cancel",onClick:function(){e.close()}})],title:(0,h.formatStr)(O.SAVE_RECIPIENTS)},""!==this.state.errorMessage?l.default.createElement(p.Alert,{bsStyle:"danger"},this.state.errorMessage):null,l.default.createElement(b.default,{input:r,id:"save-recipients-modal-group-name",placeholder:t}),l.default.createElement(E.default,this.props))}}]),t}(l.default.Component);T.propTypes={setShowSaveRecipientModal:d.PropTypes.func.isRequired,refetchMySharingGroups:d.PropTypes.func.isRequired,recipients:d.ImmutablePropTypes.list};var R={setShowSaveRecipientModal:y.setShowSaveRecipientModal,refetchMySharingGroups:y.refetchMySharingGroups},w=(0,d.connect)(s,R)(T);t.default=w},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return{pool:(0,b.getSharingGroups)(e)}}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(0),l=n(u),p=r(9),f=n(p),d=r(29),h=n(d),m=r(1),y=r(5),_=r(2),b=r(7),S=r(3),E=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(S),v=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.state={treeData:f.default.fromJS({id:"groupsRootNode",content:null,expanded:!0,children:r.convertPoolToNodes(r.props.pool),has_children:!0})},r}return i(t,e),c(t,[{key:"convertPoolToNodes",value:function(e){return e.map(function(e,t){return{id:"groupsNode_"+t,groupIndex:t,content:e,expanded:!1,children:[],has_children:!0}})}},{key:"componentWillReceiveProps",value:function(e){this.props.pool!==e.pool&&this.setState({treeData:f.default.fromJS({id:"groupsRootNode",content:null,expanded:!0,children:this.convertPoolToNodes(e.pool),has_children:!0})})}},{key:"render",value:function(){return l.default.createElement("div",{className:(0,_.prefixNS)("existing-lists")},0!==this.props.pool.length?l.default.createElement("div",{className:(0,_.prefixNS)("spaced-tree")},l.default.createElement(h.default,{title:(0,y.formatStr)(E.EXISTING_LISTS),rootNode:this.state.treeData})):l.default.createElement("div",{className:(0,_.prefixNS)("spaced-tree")},l.default.createElement("h3",null,(0,y.formatStr)(E.EXISTING_LISTS),":"),l.default.createElement("div",{className:(0,_.prefixNS)("empty-existing-list")},(0,y.formatStr)(E.NO_ENTRIES))))}}]),t}(l.default.Component);v.propTypes={pool:m.PropTypes.array.isRequired};var g=(0,m.connect)(s,void 0)(v);t.default=g},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=function e(t,r,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,r,n)}if("value"in o)return o.value;var i=o.get;if(void 0!==i)return i.call(n)},u=r(0),l=(n(u),r(9)),p=n(l),f=r(4),d=r(1),h=r(3),m=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(h),y=r(30),_=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r._bindInterface({fetchNodeChildren:r.fetchNodeChildren.bind(r)}),r}return i(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){this.props.rootNode!==e.rootNode&&this.setState({rootNode:e.rootNode})}},{key:"fetchNodeChildren",value:function(e){var r=this,n=e.get("content").toJS(),o=e.get("groupIndex"),a={group:n,index:o};return(0,f.postJSON)(m.URL_GET_GROUP_MEMBERS,a).then(function(n){if(n.error)return r.props.notifyError(n.error.statusText,"",n.error.message),null;var o=e.set("children",n.members.map(function(t,r){return p.default.fromJS({id:e.get("id")+"_"+r,content:t,parentGroup:e.get("content"),expanded:!1,children:[],has_children:!1})}));return c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateTreeNode",r).call(r,o)})}}]),t}(f.TreeModule.Tree);_.propTypes=Object.assign({},f.TreeModule.Tree.propTypes,{notifyError:d.PropTypes.func}),_.defaultProps=Object.assign({},f.TreeModule.Tree.defaultProps,{TreeRenderer:f.TreeModule.ModalTreeContainer.DefaultRenderer,NodeRenderer:y.RecipientTreeNodeRenderer,hideRoot:!0});var b={notifyError:f.notifyError},S=(0,d.connect)(void 0,b)(_);t.default=S},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RecipientTreeNodeRenderer=void 0;var c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(9),l=n(u),p=r(0),f=n(p),d=r(4),h=r(6),m=r(1),y=r(2),_=r(5),b=r(3),S=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(b),E=function(e){var t=function(t){function r(e){a(this,r);var t=i(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e));return t.state={isLinkVisible:!1},t}return s(r,t),c(r,[{key:"setLinkVisible",value:function(e){this.setState({isLinkVisible:e})}},{key:"deleteEntry",value:function(e,t){var r=this,n=void 0;n=e?{group:e.toJS(),member:t.toJS(),error:null}:{group:t.toJS(),error:null},(0,d.postJSON)(S.URL_DELETE_OBJECT,n).then(function(e){e.error?r.props.notifyError(e.error.statusText,"",e.error.message):r.props.refetchMySharingGroups()})}},{key:"render",value:function(){var t=this,r=(0,m.classNames)((0,y.prefixNS)("svg-tree-button"),o({},"cs-web-components-base-tree-node-renderer-link-unselected",!(this.state.isLinkVisible||this.props.node.get("is_selected"))));return f.default.createElement("span",{onMouseEnter:this.setLinkVisible.bind(this,!0),onMouseLeave:this.setLinkVisible.bind(this,!1),className:"cs-web-components-base-tree-node-renderer-component"},f.default.createElement(e,this.props),f.default.createElement(d.SVGIcon,{className:r,name:"csweb_remove",size:"sm",onClick:function(){var e=t.props.node.get("content"),r=t.props.node.get("parentGroup");t.deleteEntry(r,e)},alt:(0,_.formatStr)(S.REMOVE),title:(0,_.formatStr)(S.REMOVE)}))}}]),r}(f.default.Component);t.propTypes={refetchMySharingGroups:m.PropTypes.func,notifyError:m.PropTypes.func,node:m.ImmutablePropTypes.map};var r={refetchMySharingGroups:h.refetchMySharingGroups,notifyError:d.notifyError};return(0,m.connect)(void 0,r)(t)};t.RecipientTreeNodeRenderer=d.TreeModule.NodeRenderer.create(d.TreeModule.NodeRenderer.NodeRenderer(["content","system:description"]),d.TreeModule.NodeRenderer.WithIcons(function(e){return l.default.fromJS([{url:e.getIn(["content","system:icon_link"]),title:e.getIn(["content","system:description"])}])}),E)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(0),l=n(u),p=r(9),f=n(p),d=r(1),h=r(4),m=r(5),y=r(6),_=r(3),b=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(_),S=function(e){function t(e){a(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.close=r.close.bind(r),r.onSelectionChanged=r.onSelectionChanged.bind(r),r.onDoSelect=r.onDoSelect.bind(r),r.state={selectedIDs:f.default.List()},r}return s(t,e),c(t,[{key:"onDoSelect",value:function(){var e,t=this,r=(0,h.getAppSetup)();(0,h.postJSON)(r.getIn(["cs-sharing","user_catalog","select_url"]),{catalog_field:"angestellter.name",selected_ids:this.state.selectedIDs.toArray(),form_data:(e={personalnummer:"",cdb_object_id:"",name:""},o(e,"system:description",""),o(e,"cdb::argument.catalogcall_cldef","angestellter"),o(e,"cdb::argument.catalogfieldactivelang","de"),e)}).then(function(e){var r=[];for(var n in e.selected_values)if(e.selected_values.hasOwnProperty(n))for(var a=e.selected_values[n].split(";"),i=0;i<a.length;i++)r[i]||r.push(o({},"@type","angestellter")),r[i][n]=a[i];r.forEach(function(e){t.props.addRecipient(e)})}),this.props.setShowAddUserModal(!1)}},{key:"onSelectionChanged",value:function(e){this.setState({selectedIDs:e})}},{key:"close",value:function(){this.props.setShowAddUserModal(!1)}},{key:"render",value:function(){var e=(0,h.getAppSetup)(),t={form_data:{name:"*"+this.props.searchTerm+"*"},catalog_field:"name"};return l.default.createElement(h.Dialog.Dialog,{onHide:this.close,show:!0,showCancel:!0,buttons:[l.default.createElement(h.Dialog.Buttons.Ok,{key:"ok",onClick:this.onDoSelect}),l.default.createElement(h.Dialog.Buttons.Cancel,{key:"cancel",onClick:this.close})],title:(0,m.formatStr)(b.RESOLVE_USERS)},l.default.createElement(h.FormControl.TableCatalogWrapper,{tabdefURL:e.getIn(["cs-sharing","user_catalog","tabdef_url"]),onSelectionChanged:this.onSelectionChanged,formData:t,height:300}))}}]),t}(l.default.Component);S.propTypes={setShowAddUserModal:d.PropTypes.func,addRecipient:d.PropTypes.func,searchTerm:d.PropTypes.string};var E={setShowAddUserModal:y.setShowAddUserModal,addRecipient:y.addRecipient},v=(0,d.connect)(void 0,E)(S);t.default=v},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(0),c=function(e){return e&&e.__esModule?e:{default:e}}(s),u=r(4),l=r(5),p=r(2),f=r(3),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(f),h=function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),i(t,[{key:"render",value:function(){return c.default.createElement("div",{className:(0,p.prefixNS)("success-message")},c.default.createElement(u.SVGIcon,{name:d.ICON_INFO,size:"sm"}),c.default.createElement("span",null," "),(0,l.formatStr)(d.SUCCESS_MESSAGE),c.default.createElement("span",null," "),window.appSetup["cs-sharing"].is_cdbpc?(0,l.formatStr)(d.SUCCESS_CLOSE):null)}}]),t}(c.default.Component);t.default=h}])});
//# sourceMappingURL=cs-sharing.js.map