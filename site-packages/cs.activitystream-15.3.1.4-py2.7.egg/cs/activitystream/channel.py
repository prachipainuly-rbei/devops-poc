#!/usr/bin/env python
# -*- mode: python; coding: iso-8859-1 -*-
#
# Copyright (C) 1990 - 2013 CONTACT Software GmbH
# All rights reserved.
# http://www.contact.de/
#
"""
The file contains some stuff for activity stream channels.
"""

__docformat__ = "restructuredtext en"
__revision__ = "$Id: channel.py 106986 2014-02-24 14:18:26Z ych $"

# Some imports


# Exported objects
__all__ = ["Channel"]

from cdb.objects import blog


class Channel(blog.Channel):
    """
    """
    def _handle_registers(self, ctx):
        """
        The activity stream eLink-Register is only available
        for info and modify.
        In info mode we want to see only the thread.
        """
        if ctx.action != "info" and ctx.action != "modify":
            try:
                ctx.disable_registers(["cdb_elink_activitystream"])
            except:
                # Some context adaptors does not support disable_registers
                pass

        if ctx.action == "info":
            # Disable the data register
            ctx.disable_registers(["cdbblog_channel_reg"])
            # If cs.platform changes the register name
            # this code guarantees that the thread is the
            # active register
            ctx.set_active_register("cdb_elink_activitystream")

    event_map = {("*", "pre_mask"): "_handle_registers"}


# Guard importing as main module
if __name__ == "__main__":
    pass
