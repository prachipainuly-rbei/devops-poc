/*
 * Copyright (C) 2016 CONTACT Software GmbH
 * All rights reserved.
 * http://www.contact-software.com
 *
 * Revision "$Id: PostingURL.jsx 174199 2018-03-08 08:59:24Z vov $"
 */

import React from 'react';
import {FormControl, Button} from 'cs-web-components-base';
import {formatStr} from '../i18n';
import {prefixNS} from '../helpers';
import {ImmutablePropTypes} from 'cs-web-components-externals';


export default function PostingURL(props) {
    const {posting} = props;
    const link = posting.get('system:ui_link');
    const name = posting.getIn(['author', 'name']);
    const subject = encodeURIComponent(formatStr('mail-title', {name}));
    const mailTo = `mailto:?to=&subject=${subject}&body=${encodeURIComponent(link)}`;
    const toButton = (
        <Button.IconButton
            title={formatStr('mail-to')}
            href={mailTo}
            size="sm"
            buttonStyle="success"
            iconName="csweb_envelope" />
    );
    return (
        <FormControl.TextInput
            name="mailTo"
            className={prefixNS('posting-url')}
            value={link}
            beforeControl={toButton}
            readOnly={true}/>
    );
}

PostingURL.propTypes = {
    posting: ImmutablePropTypes.map.isRequired
};
