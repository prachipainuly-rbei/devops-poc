!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("React"),require("cs-web-components-externals"),require("cs-web-components-base"),require("Immutable"),require("ReactBootstrap"),require("moment"),require("ReactDOM"),require("cs-web-dashboard")):"function"==typeof define&&define.amd?define(["React","cs-web-components-externals","cs-web-components-base","Immutable","ReactBootstrap","moment","ReactDOM","cs-web-dashboard"],t):"object"==typeof exports?exports["cs-activitystream-web"]=t(require("React"),require("cs-web-components-externals"),require("cs-web-components-base"),require("Immutable"),require("ReactBootstrap"),require("moment"),require("ReactDOM"),require("cs-web-dashboard")):e["cs-activitystream-web"]=t(e.React,e["cs-web-components-externals"],e["cs-web-components-base"],e.Immutable,e.ReactBootstrap,e.moment,e.ReactDOM,e["cs-web-dashboard"])}(this,function(e,t,n,r,o,a,i,s){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=24)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return"cs-activitystream-web-"+e}function a(e,t){if(void 0!==t){if("string"==typeof t)return e.objectsById.get(t);return t.map(function(t){return e.objectsById.get(t)}).filter(function(e){return void 0!==e})}}function i(e){return(0,h.default)(e,h.default.ISO_8601).calendar()}function s(e){var t=(0,m.getAppSetup)().getIn(["cs-activitystream-web","dataURL"]);return void 0===e?t:t+"/"+e}function c(e){return d.TOPIC_LINK+"/"+e}function l(e){return(0,m.getLocalPathForURL)(e,b)}function u(e){return y.default.Map({cdb_object_id:e.get("cdb_object_id"),description:e.get("title"),object_icon:e.get("icon"),object_id:e.get("rest_url")})}function f(e,t){if(!t)return e;var n=t.toLowerCase();return e.filter(function(e){return e.get("description").toLowerCase().indexOf(n)>-1})}Object.defineProperty(t,"__esModule",{value:!0}),t.APPBASE=void 0,t.prefixNS=o,t.getReferencedPostings=a,t.formatDate=i,t.getPostingURL=s,t.byTopicURL=c,t.getToLink=l,t.convertSearchResultItem=u,t.filterChannels=f;var p=n(25),h=r(p),m=n(3),d=n(7),g=n(4),y=r(g),b=t.APPBASE=(0,m.getAppSetup)().getIn(["appSettings","basePath"])},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatStr=t.Format=void 0;var r=n(3);t.Format=r.i18ndb.makeFormat("activitystream"),t.formatStr=r.i18ndb.makeFormatStr("activitystream")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.DateFilter=t.SystemPostingFilter=t.AssignTopics=t.AssignAttachments=t.Share=t.Comment=void 0;var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=n(0),f=r(u),p=n(5),h=n(2),m=n(3),d=n(1),g=n(4),y=r(g),b=n(11),v=r(b),w=n(19),x=r(w),_=n(7);t.Comment=function(e){return f.default.createElement(m.Button.IconButton,l({buttonStyle:"success",size:"sm",className:(0,h.prefixNS)("actions-comment"),title:(0,p.formatStr)("answer"),iconName:"cs_activitystream_web_comment"},e))};(t.Share=function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),c(t,[{key:"render",value:function(){var e=this.props,t=e.activityEntry,n=o(e,["activityEntry"]),r=(0,m.getAppSetup)().getIn(["cs-sharing-web-share_objects","objectsSharing"]),a=r.get("URL")+t.get("cdb_object_id");return f.default.createElement(m.Button.IconButton,l({buttonStyle:"primary",size:"sm",title:r.get("label"),iconName:r.get("iconName"),className:(0,h.prefixNS)("actions-share")},n,{href:a,target:"_blank"}))}}]),t}(f.default.PureComponent)).propTypes={activityEntry:d.ImmutablePropTypes.map.isRequired},(t.AssignAttachments=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={showForm:!1,entry:y.default.Map(e.activityEntry)},n.showForm=n.showForm.bind(n),n.closeForm=n.closeForm.bind(n),n.submitForm=n.submitForm.bind(n),n.onSelectItem=n.onSelectItem.bind(n),n.onDeleteItem=n.onDeleteItem.bind(n),n}return s(t,e),c(t,[{key:"componentWillReceiveProps",value:function(e){e.activityEntry!==this.props.activityEntry&&this.setState({entry:y.default.Map(e.activityEntry)})}},{key:"showForm",value:function(){this.setState({showForm:!0})}},{key:"closeForm",value:function(){this.setState({showForm:!1})}},{key:"submitForm",value:function(){var e=this.props.assignAttachments;e&&e(this.state.entry.getIn(["attachments","attachments"])),this.closeForm()}},{key:"onSelectItem",value:function(e){var t=this.state.entry,n=t.getIn(["attachments","attachments"]);if(!n.find(function(t){return t.get("cdb_object_id")===e.get("cdb_object_id")})){var r=(0,h.convertSearchResultItem)(e);this.setState({entry:t.setIn(["attachments","attachments"],n.push(r))})}}},{key:"onDeleteItem",value:function(e){var t=this.state.entry,n=t.getIn(["attachments","attachments"]),r=n.indexOf(e);r>-1&&this.setState({entry:t.setIn(["attachments","attachments"],n.delete(r))})}},{key:"renderDialog",value:function(){var e=this.state.entry,t=(0,h.prefixNS)("object-search-dialog");return f.default.createElement(m.Dialog.Dialog,{title:(0,p.formatStr)("assign-attachments"),buttons:[f.default.createElement(m.Dialog.Buttons.Select,{key:"select",onClick:this.submitForm}),f.default.createElement(m.Dialog.Buttons.Cancel,{key:"cancel",onClick:this.closeForm})],show:!0,showCancel:!0,onHide:this.closeForm,dialogClassName:t},f.default.createElement(v.default,{activityEntry:e,onDelete:this.onDeleteItem}),f.default.createElement(m.ObjectWidgets.ObjectSearch,{id:(0,h.prefixNS)("attachment-search"),onSelectItem:this.onSelectItem,searchPlaceholder:(0,p.formatStr)("search-object")}))}},{key:"render",value:function(){var e=this.props,t=e.activityEntry,n=o(e,["activityEntry"]);return t.getIn(["attachments","addable"])?(delete n.assignAttachments,f.default.createElement("div",{className:(0,h.prefixNS)("actions-assign-attachments")},f.default.createElement(m.Button.TextButton,l({label:(0,p.formatStr)("assign-attachments"),onClick:this.showForm},n)),this.state.showForm?this.renderDialog():null)):null}}]),t}(f.default.Component)).propTypes={activityEntry:d.ImmutablePropTypes.map.isRequired,assignAttachments:d.PropTypes.func},(t.AssignTopics=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={showForm:!1,selected:y.default.List()},n.showForm=n.showForm.bind(n),n.closeForm=n.closeForm.bind(n),n.submitForm=n.submitForm.bind(n),n.onSelectItem=n.onSelectItem.bind(n),n.onDeleteItem=n.onDeleteItem.bind(n),n}return s(t,e),c(t,[{key:"showForm",value:function(){this.setState({showForm:!0,selected:this.state.selected.clear()})}},{key:"closeForm",value:function(){this.setState({showForm:!1})}},{key:"submitForm",value:function(){var e=this.props,t=e.activityEntry,n=e.assignTopics,r=this.state.selected.map(function(e){return e.get("cdb_object_id")}),o=t.getIn(["topics","topics"]).map(function(e){return e.get("cdb_object_id")}),a=r.filter(function(e){return!o.contains(e)});n&&n(a),this.closeForm()}},{key:"onSelectItem",value:function(e){var t=this.state.selected;t.find(function(t){return t.get("cdb_object_id")===e.get("cdb_object_id")})||this.setState({selected:t.push((0,h.convertSearchResultItem)(e))})}},{key:"onDeleteItem",value:function(e){var t=this.state.selected,n=t.indexOf(e);n>-1&&this.setState({selected:t.delete(n)})}},{key:"renderDialog",value:function(){var e=this,t=(0,h.prefixNS)("object-search-dialog"),n=this.state.selected;return f.default.createElement(m.Dialog.Dialog,{title:(0,p.formatStr)("assign-topics"),buttons:[f.default.createElement(m.Dialog.Buttons.Select,{key:"select",onClick:this.submitForm}),f.default.createElement(m.Dialog.Buttons.Cancel,{key:"cancel",onClick:this.closeForm})],show:!0,showCancel:!0,onHide:this.closeForm,dialogClassName:t},n.map(function(t){return f.default.createElement(x.default,{key:t.get("cdb_object_id"),referenceObject:t,onDelete:e.onDeleteItem})}),f.default.createElement(m.ObjectWidgets.ObjectSearch,{id:(0,h.prefixNS)("topic-search"),onSelectItem:this.onSelectItem,searchPlaceholder:(0,p.formatStr)("search-object"),excludeClasses:_.EXCLUDE_TOPIC_CLASSES.toArray()}))}},{key:"render",value:function(){var e=o(this.props,[]);return delete e.activityEntry,delete e.assignTopics,f.default.createElement("div",{className:(0,h.prefixNS)("actions-assign-topics")},f.default.createElement(m.Button.IconButton,l({buttonStyle:"success",size:"sm",title:(0,p.formatStr)("assign-topics"),iconName:"cs_activitystream_web_tags",onClick:this.showForm},e)),this.state.showForm?this.renderDialog():null)}}]),t}(f.default.Component)).propTypes={activityEntry:d.ImmutablePropTypes.map.isRequired,assignTopics:d.PropTypes.func};var P=t.SystemPostingFilter=function(e){var t=e.filterState,n=e.onChange;return f.default.createElement("div",{className:(0,h.prefixNS)("systemposting-filter")},f.default.createElement(m.FormControl.CheckBox,{checked:"off"!==t,onChange:n,label:(0,p.formatStr)("systempostings"),name:"systemPostingFilter"}))};P.propTypes={filterState:d.PropTypes.string,onChange:d.PropTypes.func},P.toggleFilterState=function(e){return"off"===e?void 0:"off"};(t.DateFilter=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={dateFormat:(0,m.getAppSetup)().getIn(["formats","dateFormat"])},n}return s(t,e),c(t,[{key:"ignoreInvalidDate",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.onFilterChange,n=e.value,r=o(e,["onFilterChange","value"]);return f.default.createElement(m.FormControl.Calendar,l({},r,{name:(0,h.prefixNS)("date-filter"),value:n,allowExpression:!0,dateConverter:m.DataType.CalendarSimpleConverter,dateOnlyFormat:this.state.dateFormat,displayFormat:this.state.dateFormat,valueFormat:"DD.MM.YYYY",onDateChange:t,onInvalidInput:this.ignoreInvalidDate,placeholder:(0,p.formatStr)("filter_by_date")}))}}]),t}(f.default.Component)).propTypes={value:d.PropTypes.string,onFilterChange:d.PropTypes.func}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EXCLUDE_TOPIC_CLASSES=t.STANDALONE_INSTANCE=t.TOPIC_LINK=t.SUBSCRIPTION_LINK=t.CHANNLE_LINK=void 0;var r=n(3),o=n(4),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=a.default.fromJS({topicURL:"/internal/activitystream/topic",excludeTopicClasses:["cdbblog_posting","cdbblog_user_posting","cdbblog_system_posting","cdbblog_comment"]}),s=(0,r.getAppSetup)().get("cs-activitystream-web",i);t.CHANNLE_LINK=s.get("channelURL"),t.SUBSCRIPTION_LINK=s.get("subscriptionURL"),t.TOPIC_LINK=s.get("topicURL"),t.STANDALONE_INSTANCE="standalone",t.EXCLUDE_TOPIC_CLASSES=s.get("excludeTopicClasses")},function(e,t,n){"use strict";function r(e,t,n,r){return{type:k,payload:r,meta:{url:t,filter:n,instanceName:e}}}function o(e,t,n,r){return{type:j,payload:r,meta:{url:t,param:n,instanceName:e}}}function a(e,t,n,r){return{type:C,payload:r,meta:{url:t,param:n,instanceName:e}}}function i(e,t){return{type:R,payload:t,meta:{instanceName:e}}}function s(e,t){return{type:M,payload:t,meta:{instanceName:e}}}function c(e,t){return{type:I,payload:t,meta:{instanceName:e}}}function l(e){return{type:A,meta:{instanceName:e}}}function u(e,t){return{type:D,payload:t,meta:{instanceName:e}}}function f(e){return{type:F,payload:e}}function p(e){return{type:q,payload:e}}function h(e){return function(t){return t((0,S.fetchObject)(e))}}function m(e,t,n){return function(o){return o((0,S.fetchCollection)(t,n.toJS(),function(e){return e.postings})).then(function(a){return o(r(e,t,n,a)),a})}}function d(e,t,n){return function(r,a){var i=a()["cs-activitystream-web"].collections.get(e),s=Object.assign(n.toJS(),{last_comment_date:i.get("lastCommentDate"),last_object_id:i.get("lastObjectId")});r((0,S.fetchCollection)(t,s,function(e){return e.postings})).then(function(n){return r(o(e,t,s,n))})}}function g(e,t){return function(n){var r=e.file_upload_url;if(!r)return(0,S.makeSequence)([]);var o=t.map(function(e){return function(){var t=new FormData;return t.append("content",e),t.append("metadata",JSON.stringify({cdbf_original_name:e.name,cdbf_name:e.name})),(0,S.postForm)(r,t)}});return(0,S.makeSequence)(o).catch(function(e){var t=e;e instanceof S.NetworkError&&(t=new S.NetworkError((0,O.formatStr)("upload-aborted"))),n((0,S.notifyError)(t,null,(0,O.formatStr)("activities")))}).then(function(){return e})}}function y(e,t){return function(n){return n(h(t)).then(function(){return n(l(e))})}}function b(e,t,n,r,o){return function(a){var s={text:n};return r.count()&&(s.attachment_ids=r.toArray()),a((0,S.createObject)(t,s)).then(function(t){return a(i(e,t)),t}).catch(function(e){var n=e,r=e.response;throw r&&404===r.status&&r.url===t?(n=new Error((0,O.formatStr)("context-not-found")),n.response=r):e instanceof S.NetworkError&&(n=new S.NetworkError((0,O.formatStr)("network-error"))),a((0,S.notifyError)(n,null,(0,O.formatStr)("activities"))),n}).then(function(e){return a(g(e,o))}).then(function(t){return a(y(e,t["@id"]))})}}function v(e,t,n){var r=n.posting,o=n.text,a=n.attachments,i=n.files;return function(n){var u={text:o},f=r.get("@id");return a.count()&&(u.attachment_ids=a.toArray()),n(c(e,r.get("cdb_object_id"))),n((0,S.createObject)(t,u)).catch(function(r){var o=r,a=r.response;throw a&&404===a.status&&a.url===t?(o=new Error((0,O.formatStr)("posting-not-found")),o.response=a,n((0,S.notifyError)(o)),n(l(e)),n(s(e,f))):r instanceof S.NetworkError&&(o=new S.NetworkError((0,O.formatStr)("network-error"))),n((0,S.notifyError)(o,null,(0,O.formatStr)("activities"))),o}).then(function(e){return n(g(e,i))}).then(function(){return n(y(e,f))})}}function w(e,t,n){return function(r){var o=t.getIn(["topics","@id"]);r(c(e,t.get("cdb_object_id"))),(0,S.postJSON)(o,{topic_ids:n.toArray()}).then(function(){return r(y(e,t.get("@id")))})}}function x(e,t){return function(n){return n(u(e,t))}}function _(e,t,n){return function(r,o){var i=o()["cs-activitystream-web"].collections.get(e),s=Object.assign(n.toJS(),{since:i.get("updatedAt"),posting_count:99999});r((0,S.fetchCollection)(t,s,function(e){return e.postings})).then(function(n){return r(a(e,t,s,n))}).catch(function(){})}}function P(){return function(e){return e((0,S.singleFetch)(N.CHANNLE_LINK,function(t){return e(f(t))}))}}function E(){return function(e){return e((0,S.singleFetch)(N.SUBSCRIPTION_LINK,function(t){return e(p(t))}))}}Object.defineProperty(t,"__esModule",{value:!0}),t.RECEIVED_SUBSCRIPTIONS=t.RECEIVED_CHANNELS=t.UPDATE_CONFIRMED=t.POSTING_UPDATED=t.POSTING_UPDATING=t.POSTING_REMOVED=t.POSTING_CREATED=t.INCOMING_POSTINGS=t.APPEND_POSTINGS=t.RECEIVED_POSTINGS=void 0,t.fetchPosting=h,t.fetchPostings=m,t.fetchMorePostings=d,t.uploadFiles=g,t.reloadPosting=y,t.createPosting=b,t.createComment=v,t.assignTopics=w,t.confirmUpdate=x,t.checkNewPostings=_,t.fetchChannels=P,t.fetchSubscriptions=E;var T=n(2),S=n(3),N=n(7),O=n(5),k=t.RECEIVED_POSTINGS=(0,T.prefixNS)("RECEIVED_POSTINGS"),j=t.APPEND_POSTINGS=(0,T.prefixNS)("APPEND_POSTINGS"),C=t.INCOMING_POSTINGS=(0,T.prefixNS)("INCOMING_POSTINGS"),R=t.POSTING_CREATED=(0,T.prefixNS)("POSTING_CREATED"),M=t.POSTING_REMOVED=(0,T.prefixNS)("POSTING_REMOVED"),I=t.POSTING_UPDATING=(0,T.prefixNS)("POSTING_UPDATING"),A=t.POSTING_UPDATED=(0,T.prefixNS)("POSTING_UPDATED"),D=t.UPDATE_CONFIRMED=(0,T.prefixNS)("UPDATE_CONFIRMED"),F=t.RECEIVED_CHANNELS=(0,T.prefixNS)("RECEIVED_CHANNELS"),q=t.RECEIVED_SUBSCRIPTIONS=(0,T.prefixNS)("RECEIVED_SUBSCRIPTIONS")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g.default.Map();return void 0===e?void 0:e.sortBy(function(e){return t.get(N(e),k(e))}).reverse()}function c(e,t){return void 0===e?e:e.filter(function(e){return k(e)<=t})}function l(e){if(void 0!==e)return g.default.Map(e.map(function(e){return[N(e),k(e)]}))}function u(e,t){var n=t.instanceName,r=e["cs-activitystream-web"];return{postings:void 0===r?void 0:(0,w.getReferencedPostings)(e,r.collections.getIn([n,"postings"])),resultComplete:r.collections.getIn([n,"result_complete"]),topicDesc:r.collections.getIn([n,"description"]),defaultTopic:r.collections.getIn([n,"default_topic"]),updatedAt:r.collections.getIn([n,"updatedAt"]),updatingPosting:r.collections.getIn([n,"updatingPosting"]),showForm:"sharing"!==r.collections.getIn([n,"cdb_object_id"])}}function f(e,t){var n=t.instanceName;return{fetchPostings:function(t,r){return e((0,v.fetchPostings)(n,t,r))},fetchMorePostings:function(t,r){return e((0,v.fetchMorePostings)(n,t,r))},checkNewPostings:function(t,r){return e((0,v.checkNewPostings)(n,t,r))},createPosting:function(r,o,a){return e((0,v.createPosting)(n,t.initDataURL,r,o,a))},confirmUpdate:function(t){return e((0,v.confirmUpdate)(n,t))}}}Object.defineProperty(t,"__esModule",{value:!0});var p=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),h=n(0),m=r(h),d=n(4),g=r(d),y=n(1),b=n(3),v=n(8),w=n(2),x=n(20),_=r(x),P=n(22),E=r(P),T=n(5),S=n(16),N=function(e){return e.get("cdb_object_id")},O=function(e,t){return e.find(function(e){return N(e)===t})},k=function(e){return e.get("last_comment_date")},j=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={dateMap:void 0,postings:void 0,newest:e.updatedAt,incoming:!1},n.createPosting=n.createPosting.bind(n),n.loadMorePostings=n.loadMorePostings.bind(n),n.confirmUpdate=n.confirmUpdate.bind(n),n.checkNewPostings=n.checkNewPostings.bind(n),n.stopChecker=n.stopChecker.bind(n),n._checker=null,n}return i(t,e),p(t,[{key:"componentWillMount",value:function(){var e=this.props;(0,e.fetchPostings)(e.initDataURL,e.filter)}},{key:"componentDidMount",value:function(){this.checkNewPostings()}},{key:"componentWillUnmount",value:function(){this.stopChecker()}},{key:"stopChecker",value:function(){null!==this._checker&&window.clearTimeout(this._checker),this._checker=null}},{key:"checkNewPostings",value:function(){var e=this;this.stopChecker(),this._checker=window.setTimeout(function(){var t=e.props;(0,t.checkNewPostings)(t.initDataURL,t.filter),e.checkNewPostings()},9e5)}},{key:"componentWillReceiveProps",value:function(e){var t=this;if(e.initDataURL!==this.props.initDataURL||e.filter!==this.props.filter)this.setState({dateMap:void 0,incoming:!1}),this.stopChecker(),e.fetchPostings(e.initDataURL,e.filter).then(this.checkNewPostings);else if(void 0===this.state.dateMap){var n=s(e.postings);this.setState({postings:n,dateMap:l(n),incoming:!1})}else if(e.updatedAt!==this.props.updatedAt){this.stopChecker();var r=s(c(e.postings,e.updatedAt));this.setState({postings:r,dateMap:l(r),incoming:e.postings.count()!==r.count()}),this.checkNewPostings()}else{var o=e.updatingPosting,a=o?O(this.state.postings,o):void 0,i=o?O(e.postings,o):void 0,u=a!==i;if(!e.postings.equals(this.props.postings)||u){var f=e.postings.map(N),p=this.state.postings;p=p.filter(function(e){return f.contains(N(e))}),u&&(p=p.delete(a).add(i));var h=c(e.postings,e.updatedAt),m=h.map(N);p=p.filterNot(function(e){return m.contains(N(e))}).union(h),p=s(p,this.state.dateMap);var d=p.reduce(function(e,n){var r=N(n);return e.set(r,t.state.dateMap.get(r,k(n)))},g.default.Map());this.setState({postings:p,dateMap:d,incoming:e.postings.subtract(p).count()>0})}}}},{key:"createPosting",value:function(e,t,n){return(0,this.props.createPosting)(e,t,n)}},{key:"loadMorePostings",value:function(){var e=this.props,t=e.initDataURL,n=e.filter;(0,e.fetchMorePostings)(t,n)}},{key:"renderPostings",value:function(){var e=this.props,t=e.instanceName,n=e.updatedAt,r=this.state.postings;return void 0===r?null:r.map(function(e){return m.default.createElement(_.default,{key:e.get("cdb_object_id"),instanceName:t,posting:e,lastUpdatedAt:n})})}},{key:"confirmUpdate",value:function(){var e=this.props,t=e.confirmUpdate,n=e.postings;t&&n&&t(k(n.maxBy(k)))}},{key:"render",value:function(){var e=this.props,t=e.topicDesc,n=e.defaultTopic,r=e.resultComplete,o=e.className,a=e.showForm,i=t||n,s=(0,T.formatStr)("new-posting",{topic:i}),c=(0,y.classNames)(o,(0,w.prefixNS)("posting-list"));return m.default.createElement("div",{className:c},m.default.createElement(S.Collapse,{in:this.state.incoming},m.default.createElement(S.Alert,{bsStyle:"info"},m.default.createElement(b.Button.TextButton,{label:(0,T.formatStr)("incoming-postings"),buttonStyle:"primary",onClick:this.confirmUpdate}))),a?m.default.createElement(E.default,{label:s,placeholder:s,createEntry:this.createPosting}):null,this.renderPostings(),!1===r?m.default.createElement(b.Button.TextButton,{label:(0,T.formatStr)("load-more"),className:(0,w.prefixNS)("load-more"),buttonStyle:"primary",onClick:this.loadMorePostings}):null)}}]),t}(m.default.Component);j.propTypes={instanceName:y.PropTypes.string.isRequired,initDataURL:y.PropTypes.string.isRequired,resultComplete:y.PropTypes.bool,topicDesc:y.PropTypes.string,defaultTopic:y.PropTypes.string,updatedAt:y.PropTypes.string,postings:y.ImmutablePropTypes.orderedSet,filter:y.ImmutablePropTypes.map,updatingPosting:y.PropTypes.string,confirmUpdate:y.PropTypes.func,fetchPostings:y.PropTypes.func,checkNewPostings:y.PropTypes.func,createPosting:y.PropTypes.func,fetchMorePostings:y.PropTypes.func,className:y.PropTypes.string,showForm:y.PropTypes.bool},j.defaultProps={filter:g.default.Map()},t.default=(0,y.connect)(u,f)(j)},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){var t=e.channel,n=e.location,o=e.currentTopic,a=t.get("cdb_object_id"),u=t.get("description"),f=o===a,p=(0,s.updateQuery)(n,{topic:a}),h=(0,c.classNames)(e.className,(0,l.prefixNS)("channel"),r({},(0,l.prefixNS)("channel-active"),f));return i.default.createElement(s.Navigation.Link,{to:p,title:u,className:h},u)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var a=n(0),i=function(e){return e&&e.__esModule?e:{default:e}}(a),s=n(3),c=n(1),l=n(2);o.propTypes={channel:c.ImmutablePropTypes.map,className:c.PropTypes.string,currentTopic:c.PropTypes.string,location:c.PropTypes.object}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),l=r(c),u=n(1),f=n(2),p=n(19),h=r(p),m=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.activityEntry,n=e.onDelete,r=t.get("attachments");return l.default.createElement("ul",{className:(0,u.classNames)((0,f.prefixNS)("attachments"),"list-unstyled")},r.get("attachments").map(function(e){return l.default.createElement("li",{key:e.get("cdb_object_id")},l.default.createElement(h.default,{referenceObject:e,onDelete:n}))}))}}]),t}(l.default.PureComponent);t.default=m,m.propTypes={activityEntry:u.ImmutablePropTypes.map.isRequired,onDelete:u.PropTypes.func}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),l=r(c),u=n(35),f=r(u),p=n(36),h=r(p),m=n(1),d=n(2),g=function(e){var t=e.children;return l.default.createElement("div",{className:(0,d.prefixNS)("posting-title")},t)},y=function(e){var t=e.children;return l.default.createElement("nav",{className:(0,d.prefixNS)("posting-nav")},t)},b=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.posting,n=e.className,r=t.get("author");return l.default.createElement("div",{className:(0,m.classNames)(n,(0,d.prefixNS)("posting-layout"))},l.default.createElement("div",{className:(0,d.prefixNS)("posting-icon")},l.default.createElement(f.default,{person:r})),l.default.createElement("div",{className:(0,d.prefixNS)("posting-detail")},this.props.children))}}]),t}(l.default.Component);t.default=b,b.propTypes={posting:m.ImmutablePropTypes.map.isRequired,className:m.PropTypes.string},b.Title=g,b.Nav=y,b.Footer=h.default},function(e,t,n){"use strict";function r(e){var t=e.activityEntry,n=(0,s.formatDate)(t.get("datetime")),r=t.get("system:ui_link");if(r){var o=(0,s.getToLink)(r),c=o&&r!==o?{pathname:o}:r;return a.default.createElement(i.Navigation.Link,{to:c,className:"text-muted"},n)}return a.default.createElement("span",{className:"text-muted"},n)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var o=n(0),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=n(3),s=n(2),c=n(1);r.propTypes={activityEntry:c.ImmutablePropTypes.map.isRequired}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function c(e){var t=e.toLowerCase();return 0!==t.indexOf("cdb:")&&0!==t.indexOf("cdbcmsg:")&&-1===t.indexOf(E)}function l(e){return d.default.createElement("span",null,d.default.createElement("span",null,"..."),d.default.createElement(g.Button.TextButton,h({buttonStyle:"link",label:(0,x.formatStr)("more")},e)))}function u(e,t,n,r){var o=n-t;if(o<0||e.length<o)return[e];var a=e.indexOf(" ",o);(-1===a||a-o>r)&&(a=o+r);var i=[],s=e.slice(0,a),c=e.slice(a);return s&&i.push(s),i.push(l),c&&i.push(c),i}function f(e){var t=[],n=0;return e.forEach(function(e){var r=void 0;r="string"!=typeof e?null:e.split("\n"),null===r||1===r.length?t.push(e):r.forEach(function(e,o){""!==e&&t.push(e),o<r.length-1&&(t.push(d.default.createElement("br",{key:n})),n++)})}),t}Object.defineProperty(t,"__esModule",{value:!0});var p=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},m=n(0),d=r(m),g=n(3),y=n(37),b=r(y),v=n(38),w=r(v),x=n(5),_=n(1),P=new b.default({newWindow:!0,stripPrefix:!1,urls:{schemeMatches:!0,wwwMatches:!0,tldMatches:!1},email:!1,phone:!1,twitter:!1,hashtag:!1}),E=window.location.protocol+"//"+window.location.hostname.toLowerCase()+(window.location.port?":"+window.location.port.toLowerCase():""),T=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={digest:!0,parts:n.parseActivityText(e)},n.showMore=n.showMore.bind(n),n}return s(t,e),p(t,[{key:"componentWillReceiveProps",value:function(e){e.activityEntry!==this.props.activityEntry&&this.setState({parts:this.parseActivityText(e)})}},{key:"parseActivityText",value:function(e){var t=e.activityEntry,n=e.digestLength,r=e.digestTolerance,a=[],i=(0,w.default)(t.get("text")),s=P.parse(i),p=0;return n===p&&a.push(l),s.forEach(function(e,t){var s=e.getOffset(),l=e.getMatchedText(),f=i.substring(p,s);""!==f&&a.push.apply(a,o(u(f,p,n,r)));var h=e.getAnchorHref(),m=c(h)?"_extern":"_blank";a.push(d.default.createElement(g.Navigation.Link,{key:"link-"+t,to:h,title:h,target:m},e.getAnchorText())),p=s+l.length}),p<i.length&&a.push.apply(a,o(u(i.substring(p),p,n,r))),f(a)}},{key:"showMore",value:function(){this.setState({digest:!1})}},{key:"render",value:function(){var e=this.state,t=e.digest,n=e.parts,r=void 0;if(t){var o=n.indexOf(l);r=-1===o?n:n.slice(0,o).concat(d.default.createElement(l,{key:"showMore",onClick:this.showMore}))}else r=n;return d.default.createElement("div",{className:"cs-activitystream-web-detail-text"},r.length?r:null)}}]),t}(d.default.Component);t.default=T,T.propTypes={activityEntry:_.ImmutablePropTypes.map.isRequired,digestLength:_.PropTypes.number,digestTolerance:_.PropTypes.number},T.defaultProps={digestLength:300,digestTolerance:50}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function c(e){return e.get("system:content_type")}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),f=r(u),p=n(4),h=r(p),m=n(3),d=n(16),g=n(2),y=n(5),b=n(1),v=function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),l(t,[{key:"render",value:function(){var e=this.props.file,t=(0,m.isSupportedVideoType)(c(e)),n=e.get("@id");return t?f.default.createElement("video",{src:n,controls:!0}):f.default.createElement("img",{src:n})}}]),t}(f.default.PureComponent);v.propTypes={file:b.ImmutablePropTypes.map.isRequired};var w=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={lightBox:!1,showing:0,direction:null},n.closeLightBox=n.closeLightBox.bind(n),n.openLightBox=n.openLightBox.bind(n),n.selectItem=n.selectItem.bind(n),n.dialogSizes=h.default.List([m.Dialog.SIZE_MEDIUM,m.Dialog.SIZE_LARGE]),n}return s(t,e),l(t,[{key:"openLightBox",value:function(){this.setState({lightBox:!0,showing:0,direction:null})}},{key:"closeLightBox",value:function(){this.setState({lightBox:!1})}},{key:"selectItem",value:function(e,t){this.setState({showing:e,direction:t.direction})}},{key:"renderLightBox",value:function(e){var t=(0,g.prefixNS)("file-viewer-lightbox__image"),n=(0,g.prefixNS)("file-viewer-lightbox__caption"),r=(0,b.classNames)((0,g.prefixNS)("file-viewer-lightbox"),o({},(0,g.prefixNS)("file-viewer-lightbox--single"),e.count()<=1));return f.default.createElement(m.Dialog.Dialog,{show:!0,hideFooter:!0,showCancel:!0,sizes:this.dialogSizes,dialogClassName:r,onHide:this.closeLightBox,title:(0,y.formatStr)("images")},f.default.createElement(d.Carousel,{activeIndex:this.state.showing,direction:this.state.direction,onSelect:this.selectItem},e.map(function(e){return f.default.createElement(d.Carousel.Item,{key:e.get("@id")},f.default.createElement("div",{className:t},f.default.createElement(v,{file:e})),f.default.createElement("span",{className:n},e.get("cdbf_name")))})))}},{key:"render",value:function(){var e=this.props.activityEntry,t=e.getIn(["relship:files","targets"],h.default.List()),n=t.filter(function(e){return(0,m.isSupportedImageType)(c(e))||(0,m.isSupportedVideoType)(c(e))});if(n.count()<1)return null;var r=this.state.lightBox?this.renderLightBox(n):null;return f.default.createElement("div",{className:(0,g.prefixNS)("file-viewer")},r,f.default.createElement("div",{className:(0,g.prefixNS)("file-viewer-preview")},f.default.createElement("div",{className:(0,g.prefixNS)("file-viewer-preview-image"),onClick:this.openLightBox},f.default.createElement(v,{file:n.get(0)}),f.default.createElement(d.Label,{bsStyle:"default",className:(0,g.prefixNS)("file-viewer-preview-counter")},(0,y.formatStr)("one-of",{n:n.count()})))))}}]),t}(f.default.PureComponent);t.default=w,w.propTypes={activityEntry:b.ImmutablePropTypes.map.isRequired,onSubmit:b.PropTypes.func}},function(e,t){e.exports=o},function(e,t,n){"use strict";function r(e){var t=e.posting,n=t.get("author"),r=n.get("system:ui_link"),o=n.get("name");return r?a.default.createElement(i.Navigation.Link,{to:r},o):a.default.createElement("span",null,o)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var o=n(0),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=n(3),s=n(1);r.propTypes={posting:s.ImmutablePropTypes.map.isRequired}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e){var t=e.location,n=e.noSidebar,r=e.children,a=1===parseInt((0,p.parseQuery)(t).embedded),i=(0,f.classNames)((0,c.prefixNS)("app"),o({},(0,c.prefixNS)("embedded"),a)),l=s.default.createElement("div",{className:i},s.default.createElement("div",{className:(0,c.prefixNS)("app-sidebar")},n||a?null:s.default.createElement(u.default,null)),s.default.createElement("div",{className:(0,c.prefixNS)("app-content")},r));return a?l:s.default.createElement(p.PageFrame.ApplicationFrame,null,l)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var i=n(0),s=r(i),c=n(2),l=n(29),u=r(l),f=n(1),p=n(3);a.propTypes={location:f.PropTypes.object,noSidebar:f.PropTypes.bool}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),c=function(e){return e&&e.__esModule?e:{default:e}}(s),l=n(3),u=n(1),f=n(2),p=n(5),h=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onDelete=n.onDelete.bind(n),n}return a(t,e),i(t,[{key:"onDelete",value:function(){this.props.onDelete&&this.props.onDelete(this.props.referenceObject)}},{key:"render",value:function(){var e=this.props,t=e.referenceObject,n=e.onDelete;return c.default.createElement("div",{className:(0,f.prefixNS)("reference-object"),title:t.get("description")},n?c.default.createElement(l.Button.IconButton,{buttonStyle:"danger",size:"sm",iconName:"csweb_cancel",onClick:this.onDelete,className:(0,f.prefixNS)("reference-object-delete"),title:(0,p.formatStr)("delete")}):null,c.default.createElement(l.SVGIconAndLink,{src:t.get("object_icon"),to:t.get("object_ui_link"),label:t.get("description")}))}}]),t}(c.default.PureComponent);t.default=h,h.propTypes={referenceObject:u.ImmutablePropTypes.map.isRequired,onDelete:u.PropTypes.func}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){var n=t.instanceName,r=t.posting;return{createComment:function(t,o,a,i){return e((0,x.createComment)(n,t,{posting:r,text:o,attachments:a,files:i}))},assignTopics:function(t){return e((0,x.assignTopics)(n,r,t))}}}Object.defineProperty(t,"__esModule",{value:!0}),t.Posting=void 0;var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),f=r(u),p=n(34),h=r(p),m=n(39),d=r(m),g=n(40),y=r(g),b=n(22),v=r(b),w=n(1),x=n(8),_=n(5),P=n(2),E=t.Posting=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={replyingTo:null},n.createComment=n.createComment.bind(n),n.onComment=n.onComment.bind(n),n.onCommentPosting=n.onCommentPosting.bind(n),n.onCloseForm=n.onCloseForm.bind(n),n}return i(t,e),l(t,[{key:"onComment",value:function(e){var t=this;this.setState({replyingTo:e?e.get("@id"):null},function(){return t.refs.commentForm.expandForm()})}},{key:"onCommentPosting",value:function(){this.onComment(null)}},{key:"onCloseForm",value:function(){this.setState({replyingTo:null})}},{key:"createComment",value:function(e,t,n){var r=this.props,o=r.posting;return(0,r.createComment)(this.state.replyingTo?this.state.replyingTo:o.get("comments").get("@id"),e,t,n)}},{key:"isSystemPosting",value:function(){var e=this.props.posting;return void 0!==e&&e.get("is_system_posting")}},{key:"render",value:function(){var e=this.props,t=e.posting,n=e.instanceName,r=this.isSystemPosting()?h.default:d.default,o=this.state.replyingTo?(0,g.findCommentToPosting)(t,this.state.replyingTo):t,a=o.getIn(["author","name"]);return f.default.createElement(r,c({},this.props,{className:(0,P.prefixNS)("posting"),onComment:this.onCommentPosting}),f.default.createElement(y.default,{posting:t,onComment:this.onComment,instanceName:n}),f.default.createElement(v.default,{label:(0,_.formatStr)("new-comment",{name:a}),placeholder:(0,_.formatStr)("write-answer"),createEntry:this.createComment,onClose:this.onCloseForm,ref:"commentForm"}))}}]),t}(f.default.Component);E.propTypes={instanceName:w.PropTypes.string.isRequired,createComment:w.PropTypes.func.isRequired,assignTopics:w.PropTypes.func.isRequired,lastUpdatedAt:w.PropTypes.string,posting:w.ImmutablePropTypes.map.isRequired},t.default=(0,w.connect)(function(){return{}},s)(E)},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){var t=e.topic,n=t.get("object_ui_link"),r=t.get("object_icon"),o=t.get("description"),a=(0,l.classNames)((0,u.prefixNS)("posting-topics-item"),e.className);return s.default.createElement("div",{className:a,title:o},s.default.createElement(c.SVGIconAndLink,{label:o,src:r,to:n}))}function a(e){var t=e.getIn(["topics","topics"]);return t?t.map(function(e,t){return s.default.createElement(o,{topic:e,key:e.get("cdb_object_id"),className:(0,l.classNames)(r({},(0,u.prefixNS)("main-topic"),0===t))})}):null}Object.defineProperty(t,"__esModule",{value:!0}),t.Topic=o,t.default=a;var i=n(0),s=function(e){return e&&e.__esModule?e:{default:e}}(i),c=n(3),l=n(1),u=n(2);o.propTypes={topic:l.ImmutablePropTypes.map.isRequired,className:l.PropTypes.string}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),f=n(4),p=r(f),h=n(3),m=n(1),d=n(2),g=n(5),y=n(6),b=n(11),v=r(b),w=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={src:n.getPreview(e),isVideo:(0,h.isSupportedVideoType)(e.file.type)},n}return s(t,e),c(t,[{key:"getPreview",value:function(e){return h.FileDropzone.getPreview(e.file)}},{key:"componentWillReceiveProps",value:function(e){e.file!==this.props.file&&this.setState({src:this.getPreview(e),isVideo:(0,h.isSupportedVideoType)(e.file.type)})}},{key:"componentWillUnmount",value:function(){h.FileDropzone.revokePreview(this.state.src)}},{key:"render",value:function(){var e=this.state,t=e.src;return e.isVideo?u.default.createElement("video",{src:t}):u.default.createElement("img",{src:t})}}]),t}(u.default.PureComponent);w.propTypes={file:m.PropTypes.any.isRequired};var x=(0,d.prefixNS)("form__height-calculator"),_=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={newEntry:n.makeNewEntry(),expanded:!1,height:null,submitting:!1},n.onChange=n.onChange.bind(n),n.onSubmit=n.onSubmit.bind(n),n.onClose=n.onClose.bind(n),n.expandForm=n.expandForm.bind(n),n.assignAttachments=n.assignAttachments.bind(n),n.onAddFiles=n.onAddFiles.bind(n),n.onDeleteFile=n.onDeleteFile.bind(n),n.onDeleteAttachment=n.onDeleteAttachment.bind(n),n._form=null,n}return s(t,e),c(t,[{key:"onChange",value:function(e){var t=this;this.setState({newEntry:this.state.newEntry.set("text",e.target.value)},function(){if(t._form){var e=t._form.getElementsByClassName(x);if(e.length){var n=e[0].getElementsByTagName("textarea");if(n.length){var r=n[0].scrollHeight+(n[0].offsetHeight-n[0].clientHeight);t.setState({height:r})}}}})}},{key:"makeNewEntry",value:function(){return p.default.fromJS({text:"",attachments:{addable:!0,attachments:[]},files:[]})}},{key:"expandForm",value:function(){this.setState({expanded:!0})}},{key:"onAddFiles",value:function(e){var t=this.state.newEntry.get("files"),n=t.map(function(e){return e.name});this.setState({newEntry:this.state.newEntry.set("files",t.concat(p.default.List(e).filter(function(e){return!n.contains(e.name)&&((0,h.isSupportedImageType)(e.type)||(0,h.isSupportedVideoType)(e.type))})))})}},{key:"onDeleteFile",value:function(e){var t=this.state.newEntry.get("files"),n=t.indexOf(e);n>-1&&this.setState({newEntry:this.state.newEntry.set("files",t.delete(n))})}},{key:"assignAttachments",value:function(e){this.setState({newEntry:this.state.newEntry.setIn(["attachments","attachments"],e)})}},{key:"onDeleteAttachment",value:function(e){var t=this.state.newEntry.getIn(["attachments","attachments"]),n=t.indexOf(e);n>-1&&this.setState({newEntry:this.state.newEntry.setIn(["attachments","attachments"],t.delete(n))})}},{key:"onSubmit",value:function(){var e=this;this.setState({submitting:!0},function(){var t=e.props.createEntry,n=e.state.newEntry;t(n.get("text",""),n.getIn(["attachments","attachments"]).map(function(e){return e.get("cdb_object_id")}),n.get("files")).then(e.onClose).catch(function(){e.setState({submitting:!1})})})}},{key:"onClose",value:function(){this.setState({expanded:!1,height:null,newEntry:this.makeNewEntry(),submitting:!1});var e=this.props.onClose;e&&e()}},{key:"render",value:function(){var e=this,t=this.props,n=t.label,r=t.placeholder,a=this.state.newEntry.get("text"),i=this.state.newEntry.get("files"),s=(0,m.classNames)((0,d.prefixNS)("form"),(0,d.prefixNS)("form--compact")),c=(0,m.classNames)((0,d.prefixNS)("form__cover"),o({},(0,d.prefixNS)("form__cover--submitting"),this.state.submitting)),l=this.state.height?{height:this.state.height}:void 0;return this.state.expanded?u.default.createElement("form",{className:(0,d.prefixNS)("form"),ref:function(t){return e._form=t}},u.default.createElement("div",{className:c},u.default.createElement(h.Throbber,null)),u.default.createElement(h.FormControl.TextArea,{label:n,value:a,onChange:this.onChange,name:"newActivity",rows:3,style:l,autoFocus:!0}),u.default.createElement(h.FileDropzone,{className:(0,d.prefixNS)("form-upload-margin"),onDrop:this.onAddFiles},u.default.createElement(h.FileDropzone.Preview,{files:i,onDelete:this.onDeleteFile,Renderer:w}),u.default.createElement("div",{className:(0,d.prefixNS)("form-upload-placeholder")},(0,g.formatStr)("file-drop-text"))),u.default.createElement(v.default,{activityEntry:this.state.newEntry,onDelete:this.onDeleteAttachment}),u.default.createElement(h.ButtonGroup,null,u.default.createElement(h.Button.TextButton,{label:(0,g.formatStr)("publish"),onClick:this.onSubmit,buttonStyle:"primary",disabled:""===a}),u.default.createElement(h.Button.TextButton,{label:(0,g.formatStr)("cancel"),onClick:this.onClose})),u.default.createElement(h.ButtonGroup,null,u.default.createElement(y.AssignAttachments,{activityEntry:this.state.newEntry,assignAttachments:this.assignAttachments})),u.default.createElement("div",{className:x,"aria-hidden":!0},u.default.createElement(h.FormControl.TextArea,{value:a,name:"heightCalculator",rows:3}))):u.default.createElement("form",{className:s},u.default.createElement(h.FormControl.TextInput,{name:"formTrigger",placeholder:r,onFocus:this.expandForm}))}}]),t}(u.default.Component);t.default=_,_.propTypes={label:m.PropTypes.string,placeholder:m.PropTypes.string,createEntry:m.PropTypes.func.isRequired,onClose:m.PropTypes.func}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=r(o),i=n(4),s=r(i),c=n(9),l=r(c),u=n(7),f=n(1),p=function(e){var t=e.contextObject,n=e.instanceName,r=e.filter;if(void 0===t)return null;var o=u.TOPIC_LINK+"/"+t.get("cdb_object_id");return a.default.createElement(l.default,{instanceName:n,initDataURL:o,filter:r})};p.propTypes={instanceName:f.PropTypes.string.isRequired,contextObject:f.ImmutablePropTypes.map,filter:f.ImmutablePropTypes.map},p.defaultProps={filter:s.default.Map()},t.default=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),a=n(2),i=n(1),s=n(26),c=n(27),l=r(c),u=n(9),f=r(u),p=n(44),h=r(p),m=n(45),d=r(m),g=n(46),y=r(g);o.Registry.registerComponent((0,a.prefixNS)("App"),l.default),o.Registry.registerComponent((0,a.prefixNS)("PostingList"),f.default),o.Registry.registerComponent((0,a.prefixNS)("ObjectActivities"),h.default),o.Registry.registerComponent((0,a.prefixNS)("ObjectActivitiesBlock"),d.default),o.Registry.registerComponent((0,a.prefixNS)("DashboardWidget"),y.default),o.Registry.registerReducer("cs-activitystream-web",(0,i.combineReducers)({collections:s.collections,channels:s.channels,subscriptions:s.subscriptions,links:s.links})),t.default={App:l.default,PostingList:f.default,ObjectActivities:h.default,ObjectActivitiesBlock:d.default}},function(e,t){e.exports=a},function(e,t,n){"use strict";function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.default.Map(),t=arguments[1],n=t.meta&&t.meta.instanceName;if(t.type===l.RECEIVED_POSTINGS)return e.set(n,c.default.Map(t.payload).merge(u(t.payload)).merge(p(t.payload)));if(n&&void 0===e.get(n))return e;switch(t.type){case l.APPEND_POSTINGS:var r=e.getIn([n,"postings"]),o=u(t.payload).update("postings",function(e){return r.union(e)});return e.mergeIn([n],o);case l.INCOMING_POSTINGS:var a=u(t.payload);return e.update(n,function(e){return e.update("postings",function(e){return a.get("postings").union(e)})});case l.POSTING_CREATED:var i=t.payload;return e.update(n,function(e){return e.update("postings",function(e){return c.default.OrderedSet([i["@id"]]).union(e)}).set("updatingPosting",i.cdb_object_id)});case l.POSTING_REMOVED:var s=t.payload;return e.update(n,function(e){return e.update("postings",function(e){return e.delete(s)})});case l.POSTING_UPDATING:return e.update(n,function(e){return e.set("updatingPosting",t.payload)});case l.POSTING_UPDATED:return e.update(n,function(e){return e.set("updatingPosting",void 0)});case l.UPDATE_CONFIRMED:return e.update(n,function(e){return e.set("updatedAt",t.payload).set("updatingPosting",void 0)});default:return e}}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.default.Map(),t=arguments[1];switch(t.type){case l.RECEIVED_CHANNELS:return c.default.fromJS(t.payload);default:return e}}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.default.Map(),t=arguments[1];switch(t.type){case l.RECEIVED_SUBSCRIPTIONS:return c.default.fromJS(t.payload);default:return e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.default.Map(),t=arguments[1];switch(t.type){case l.RECEIVED_CHANNELS:return e.withMutations(function(e){t.payload.predefined&&t.payload.predefined.forEach(function(t){return e.set(t.cdb_object_id,t["@id"])}),t.payload.channels&&t.payload.channels.forEach(function(t){return e.set(t.cdb_object_id,t["@id"])})});case l.RECEIVED_SUBSCRIPTIONS:return e.withMutations(function(e){t.payload.subscriptions&&t.payload.subscriptions.forEach(function(t){t.subscriptions&&t.subscriptions.forEach(function(t){return e.set(t.cdb_object_id,t["@id"])})})});default:return e}}Object.defineProperty(t,"__esModule",{value:!0}),t.collections=r,t.channels=o,t.subscriptions=a,t.links=i;var s=n(4),c=function(e){return e&&e.__esModule?e:{default:e}}(s),l=n(8),u=function(e){var t=c.default.Map({}),n=e.postings,r=c.default.OrderedSet(n.map(function(e){return e["@id"]}));if(t=t.set("postings",r).set("result_complete",e.result_complete),n.length>0){var o=n[n.length-1];t=t.set("lastCommentDate",o.last_comment_date).set("lastObjectId",o.cdb_object_id)}return t},f=function(e){var t=e.postings;if(t.length>0){return t[0].last_comment_date}},p=function(e){var t=c.default.Map({}),n=f(e);return n&&(t=t.set("updatedAt",n)),t}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),l=r(c),u=n(28),f=r(u),p=n(43),h=r(p),m=n(1),d=n(2),g=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=d.APPBASE+"/posting/:postingID";return l.default.createElement(m.ReactRouter.Router,{history:m.browserHistory},l.default.createElement(m.ReactRouter.Switch,null,l.default.createElement(m.ReactRouter.Route,{path:e,component:h.default}),l.default.createElement(m.ReactRouter.Route,{component:f.default})))}}]),t}(l.default.Component);t.default=g},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return x.default.Map((0,P.parseQuery)(e))}function c(e){return{links:e["cs-activitystream-web"].links}}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),f=r(u),p=n(18),h=r(p),m=n(32),d=r(m),g=n(9),y=r(g),b=n(2),v=n(7),w=n(4),x=r(w),_=n(1),P=n(3),E=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={query:s(e.location)},n}return i(t,e),l(t,[{key:"componentWillReceiveProps",value:function(e){e.location.search!==this.props.location.search&&this.setState({query:s(e.location)})}},{key:"render",value:function(){var e=this.props,t=e.links,n=e.location,r=this.state.query.get("topic"),o=void 0===r?(0,b.getPostingURL)():t.get(r,(0,b.byTopicURL)(r));return f.default.createElement(h.default,{location:n},f.default.createElement(d.default,null),f.default.createElement(y.default,{instanceName:v.STANDALONE_INSTANCE,initDataURL:o,filter:this.state.query}))}}]),t}(f.default.Component);E.propTypes={links:_.ImmutablePropTypes.map,location:_.PropTypes.object},t.default=(0,_.connect)(c)(E)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),l=r(c),u=n(30),f=r(u),p=n(10),h=r(p),m=n(31),d=r(m),g=n(4),y=r(g),b=n(5),v=n(2),w=n(1),x=n(3),_=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={filter:""},n.setFilter=n.setFilter.bind(n),n}return i(t,e),s(t,[{key:"setFilter",value:function(e){this.setState({filter:e})}},{key:"render",value:function(){var e=this.props.location,t=y.default.Map({cdb_object_id:void 0,description:(0,b.formatStr)("all")}),n=(0,x.parseQuery)(e).topic,r=this.state.filter;return l.default.createElement("div",{className:(0,v.prefixNS)("sidebar-navigations")},l.default.createElement("div",{className:(0,v.prefixNS)("filter-bar")},l.default.createElement("div",{className:(0,v.prefixNS)("filter-bar-filter")},l.default.createElement(x.FormControl.TextInput,{name:(0,v.prefixNS)("channel-filter"),placeholder:(0,b.formatStr)("filter_by_channel"),value:r,onValueChange:this.setFilter}))),l.default.createElement("div",{className:"clearfix"}),l.default.createElement(h.default,{className:(0,v.prefixNS)("channel-show-all"),channel:t,currentTopic:n,location:e}),l.default.createElement(f.default,{location:e,currentTopic:n,filter:r}),l.default.createElement(d.default,{location:e,currentTopic:n,filter:r}))}}]),t}(l.default.PureComponent);_.propTypes={location:w.PropTypes.object},t.default=w.ReactRouter.withRouter(_)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return{channels:e["cs-activitystream-web"].channels}}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),f=n(5),p=n(2),h=n(3),m=n(1),d=n(8),g=n(10),y=r(g),b=n(4),v=r(b),w=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={channels:n.getChannels(e)},n}return i(t,e),c(t,[{key:"componentDidMount",value:function(){this.props.fetchChannels()}},{key:"componentWillReceiveProps",value:function(e){e.filter===this.props.filter&&e.channels===this.props.channels||this.setState({channels:this.getChannels(e)})}},{key:"getChannels",value:function(e){var t=e.channels,n=e.filter,r=v.default.OrderedSet();if(!t)return r;var o=t.get("predefined");o&&(r=r.union(o));var a=t.get("channels");return a&&(r=r.union(a)),(0,p.filterChannels)(r,n)}},{key:"renderPredefined",value:function(){var e=this.props.channels;if(!e)return null;var t=e.get("predefined");return t?t.map(function(e){return u.default.createElement(y.default,{key:e.get("cdb_object_id"),channel:e})}):null}},{key:"renderOthers",value:function(){var e=this.props.channels;if(!e)return null;var t=e.get("channels");return t?t.map(function(e){return u.default.createElement(y.default,{key:e.get("cdb_object_id"),channel:e})}):null}},{key:"render",value:function(){var e=this.props,t=e.location,n=e.currentTopic,r=e.filter,o=this.state.channels,a=r||o.find(function(e){return e.get("cdb_object_id")===n});return u.default.createElement("div",{className:(0,p.prefixNS)("channels")},u.default.createElement(h.Collapsible,{initialCollapsed:!a,header:(0,f.formatStr)("channels")},o.map(function(e){return u.default.createElement(y.default,{key:e.get("cdb_object_id"),channel:e,currentTopic:n,location:t})})))}}]),t}(u.default.PureComponent);w.propTypes={channels:m.ImmutablePropTypes.map,fetchChannels:m.PropTypes.func,currentTopic:m.PropTypes.string,location:m.PropTypes.object,filter:m.PropTypes.string},t.default=(0,m.connect)(s,{fetchChannels:d.fetchChannels})(w)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return{subscriptions:e["cs-activitystream-web"].subscriptions}}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),f=n(2),p=n(3),h=n(1),m=n(8),d=n(10),g=r(d),y=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.renderEntries=n.renderEntries.bind(n),n}return i(t,e),c(t,[{key:"componentDidMount",value:function(){this.props.fetchSubscriptions()}},{key:"renderGroups",value:function(){var e=this.props.subscriptions;if(!e)return null;var t=e.get("subscriptions");return t?t.map(this.renderEntries):null}},{key:"renderEntries",value:function(e){var t=this.props,n=t.currentTopic,r=t.location,o=t.filter,a=e.get("subscriptions");if(!a)return null;a=(0,f.filterChannels)(a,o);var i=o||a.find(function(e){return e.get("cdb_object_id")===n}),s=e.get("description");return u.default.createElement("div",{className:(0,f.prefixNS)("subscriptions-group"),key:s},u.default.createElement(p.Collapsible,{initialCollapsed:!i,header:s},a.map(function(e){return u.default.createElement(g.default,{key:e.get("cdb_object_id"),channel:e,currentTopic:n,location:r})})))}},{key:"render",value:function(){return u.default.createElement("div",{className:(0,f.prefixNS)("subscriptions")},this.renderGroups())}}]),t}(u.default.Component);y.propTypes={fetchSubscriptions:h.PropTypes.func,subscriptions:h.ImmutablePropTypes.map,currentTopic:h.PropTypes.string,location:h.PropTypes.object,filter:h.PropTypes.string},t.default=(0,h.connect)(s,{fetchSubscriptions:m.fetchSubscriptions})(y)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){var t=(0,g.parseQuery)(e);return{author:t.author,pn:t.pn,date:t.date,systemposting:t.systemposting}}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),f=n(2),p=n(5),h=n(6),m=n(33),d=r(m),g=n(3),y=n(1),b=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state=s(e.location),n.onPersonChange=n.onPersonChange.bind(n),n.onDateChange=n.onDateChange.bind(n),n.onFilter=n.onFilter.bind(n),n.onClearFilter=n.onClearFilter.bind(n),n.toggleSystemPostingFilter=n.toggleSystemPostingFilter.bind(n),n}return i(t,e),c(t,[{key:"componentWillReceiveProps",value:function(e){e.location.search!==this.props.location.search&&this.setState(s(e.location))}},{key:"onPersonChange",value:function(e){var t=e.author,n=e.pn;this.setState({author:t,pn:n})}},{key:"onDateChange",value:function(e){this.setState({date:e||void 0})}},{key:"toggleSystemPostingFilter",value:function(){this.setState({systemposting:h.SystemPostingFilter.toggleFilterState(this.state.systemposting)},this.onFilter)}},{key:"onFilter",value:function(){var e=this.props,t=e.location,n=e.history,r=this.state,o=r.author,a=r.pn,i=r.date,s=r.systemposting,c=(0,g.updateQuery)(t,{author:o,pn:a,date:i,systemposting:s});n.push(c)}},{key:"onClearFilter",value:function(){this.setState({author:void 0,pn:void 0,date:void 0,systemposting:void 0},this.onFilter)}},{key:"render",value:function(){var e=this.state,t=e.author,n=e.date,r=e.systemposting,o=!t&&!n;return u.default.createElement("div",{className:(0,f.prefixNS)("filter-bar")},u.default.createElement("div",{className:(0,f.prefixNS)("filter-bar-filter")},u.default.createElement(d.default,{onFilterChange:this.onPersonChange,value:t})),u.default.createElement("div",{className:(0,f.prefixNS)("filter-bar-filter")},u.default.createElement(h.DateFilter,{onFilterChange:this.onDateChange,value:n})),u.default.createElement("div",{className:(0,f.prefixNS)("filter-bar-systemposting")},u.default.createElement(h.SystemPostingFilter,{filterState:r,onChange:this.toggleSystemPostingFilter})),u.default.createElement("div",{className:(0,f.prefixNS)("filter-bar-buttons")},u.default.createElement(g.Button.TextButton,{title:(0,p.formatStr)("filter"),buttonStyle:"primary",onClick:this.onFilter,disabled:o}),u.default.createElement(g.Button.TextButton,{title:(0,p.formatStr)("reset"),buttonStyle:"warning",onClick:this.onClearFilter})))}}]),t}(u.default.Component);b.propTypes={location:y.PropTypes.object,history:y.PropTypes.object},t.default=y.ReactRouter.withRouter(b)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){var t=e.item,n=t.get("cs_activitystream_data"),r=n.get("orgname");return f.default.createElement("div",{className:(0,g.prefixNS)("person-filter-tile")},f.default.createElement(p.Tiles.Tile,{contextObject:n,fallbackImg:(0,p.getIcon)("csweb_person_fallback"),headerAttr:"name",plain:!0,thumbnailSize:"lg"},f.default.createElement("div",{title:r},r)))}function c(e){return void 0===e?"":e}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),f=r(u),p=n(3),h=n(1),m=n(4),d=r(m),g=n(2),y=n(5),b=(0,p.getAppSetup)().getIn(["cs-activitystream-web","personSearchURL"]),v=p.FormControl.WithTypeAhead(p.FormControl.TextInput);s.propTypes={item:h.ImmutablePropTypes.map};var w=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={text:c(e.value),matches:d.default.List(),hasMore:!1},n._searchRequest=null,n.ontextChange=n.ontextChange.bind(n),n.onSelectAt=n.onSelectAt.bind(n),n.onBlur=n.onBlur.bind(n),n}return i(t,e),l(t,[{key:"componentWillUnmount",value:function(){this.cancelRequest()}},{key:"componentWillReceiveProps",value:function(e){e.value!==this.props.value&&this.setState({text:c(e.value)})}},{key:"cancelRequest",value:function(){null!==this._searchRequest&&clearTimeout(this._searchRequest)}},{key:"fetchMatches",value:function(){var e=this,t=this.state.text;if(this.cancelRequest(),!t)return void this.setState({matches:d.default.List(),hasMore:!1});this._searchRequest=setTimeout(function(){(0,p.getJSON)(b,{fulltextsearch:t+"*"}).then(function(t){e._searchRequest=null,e.setState({matches:d.default.fromJS(t.result.result),hasMore:t.result.links.length>0})})},250)}},{key:"ontextChange",value:function(e){this.setState({text:e},this.fetchMatches),e||this.props.onFilterChange&&this.props.onFilterChange({})}},{key:"onSelectAt",value:function(e){var t=this.state.matches.get(e);this.setState({text:t.getIn(["cs_activitystream_data","name"]),matches:this.state.matches.clear().push(t),hasMore:!1}),this.props.onFilterChange&&this.props.onFilterChange({pn:t.getIn(["cs_activitystream_data","personalnummer"]),author:t.getIn(["cs_activitystream_data","name"])})}},{key:"onBlur",value:function(){var e=c(this.props.value);this.state.text!==e&&this.setState({text:e})}},{key:"render",value:function(){return f.default.createElement(v,{name:(0,g.prefixNS)("person-filter"),className:(0,g.prefixNS)("person-filter"),TypeAheadItemRenderer:s,value:this.state.text,matched:this.state.matches,onValueChange:this.ontextChange,onSelectAt:this.onSelectAt,hasMoreMatches:this.state.hasMore,placeholder:(0,y.formatStr)("filter_by_person"),onBlur:this.onBlur,autoSelectFirstMatch:!0})}}]),t}(f.default.Component);t.default=w,w.propTypes={value:h.PropTypes.string,onFilterChange:h.PropTypes.func}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),f=n(12),p=r(f),h=n(2),m=n(6),d=n(13),g=r(d),y=n(21),b=r(y),v=n(14),w=r(v),x=n(15),_=r(x),P=n(17),E=r(P),T=n(1),S=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),c(t,[{key:"render",value:function(){var e=this.props,t=e.posting,n=e.onComment,r=e.assignTopics,o=e.className,a=(0,b.default)(t);return u.default.createElement(p.default,s({},this.props,{showAuthor:!0,className:(0,T.classNames)(o,(0,h.prefixNS)("system-posting"))}),u.default.createElement(p.default.Title,null,u.default.createElement("span",null,this.props.posting.get("title"))),u.default.createElement(p.default.Nav,null,u.default.createElement(E.default,{posting:t}),u.default.createElement(g.default,{activityEntry:t,className:"text-muted"}),a,u.default.createElement(m.AssignTopics,{activityEntry:t,assignTopics:r})),u.default.createElement(w.default,{activityEntry:t}),u.default.createElement(_.default,{activityEntry:t}),u.default.createElement(p.default.Footer,{activityEntry:t},u.default.createElement(m.Comment,{onClick:n}),u.default.createElement(m.Share,{activityEntry:t})),this.props.children)}}]),t}(u.default.Component);t.default=S,S.propTypes={posting:T.ImmutablePropTypes.map.isRequired,onComment:T.PropTypes.func,assignTopics:T.PropTypes.func,className:T.PropTypes.string}},function(e,t,n){"use strict";function r(e){var t=e.person,n=t.get("system:ui_link"),r=t.getIn(["relship:files","targets"]).find(function(e){return"1"===e.get("cdbf_primary")}),o=r?r.get("@id"):null,s=a.default.createElement(i.Thumbnail,{imgSrc:o,fallbackSrc:(0,i.getIcon)("csweb_person_fallback"),size:"md"});return n?a.default.createElement(i.Navigation.Link,{to:n,className:"cs-activitystream-web-picture"},s):s}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var o=n(0),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=n(3),s=n(1);r.propTypes={person:s.ImmutablePropTypes.map.isRequired}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),l=r(c),u=n(11),f=r(u),p=n(2),h=n(1),m=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.activityEntry;return l.default.createElement("div",{className:(0,p.prefixNS)("footer")},l.default.createElement(f.default,{activityEntry:e}),l.default.createElement("div",{className:(0,p.prefixNS)("footer-actions")},this.props.children))}}]),t}(l.default.PureComponent);t.default=m,m.propTypes={activityEntry:h.ImmutablePropTypes.map.isRequired}},function(e,t,n){var r,o,a;!function(n,i){o=[],r=i,void 0!==(a="function"==typeof r?r.apply(t,o):r)&&(e.exports=a)}(0,function(){var e=function(t){t=t||{},this.version=e.version,this.urls=this.normalizeUrlsCfg(t.urls),this.email="boolean"!=typeof t.email||t.email,this.phone="boolean"!=typeof t.phone||t.phone,this.hashtag=t.hashtag||!1,this.mention=t.mention||!1,this.newWindow="boolean"!=typeof t.newWindow||t.newWindow,this.stripPrefix=this.normalizeStripPrefixCfg(t.stripPrefix),this.stripTrailingSlash="boolean"!=typeof t.stripTrailingSlash||t.stripTrailingSlash;var n=this.mention;if(!1!==n&&"twitter"!==n&&"instagram"!==n)throw new Error("invalid `mention` cfg - see docs");var r=this.hashtag;if(!1!==r&&"twitter"!==r&&"facebook"!==r&&"instagram"!==r)throw new Error("invalid `hashtag` cfg - see docs");this.truncate=this.normalizeTruncateCfg(t.truncate),this.className=t.className||"",this.replaceFn=t.replaceFn||null,this.context=t.context||this,this.htmlParser=null,this.matchers=null,this.tagBuilder=null};return e.link=function(t,n){return new e(n).link(t)},e.parse=function(t,n){return new e(n).parse(t)},e.version="1.4.2",e.prototype={constructor:e,normalizeUrlsCfg:function(e){return null==e&&(e=!0),"boolean"==typeof e?{schemeMatches:e,wwwMatches:e,tldMatches:e}:{schemeMatches:"boolean"!=typeof e.schemeMatches||e.schemeMatches,wwwMatches:"boolean"!=typeof e.wwwMatches||e.wwwMatches,tldMatches:"boolean"!=typeof e.tldMatches||e.tldMatches}},normalizeStripPrefixCfg:function(e){return null==e&&(e=!0),"boolean"==typeof e?{scheme:e,www:e}:{scheme:"boolean"!=typeof e.scheme||e.scheme,www:"boolean"!=typeof e.www||e.www}},normalizeTruncateCfg:function(t){return"number"==typeof t?{length:t,location:"end"}:e.Util.defaults(t||{},{length:Number.POSITIVE_INFINITY,location:"end"})},parse:function(e){for(var t=this.getHtmlParser(),n=t.parse(e),r=0,o=[],a=0,i=n.length;a<i;a++){var s=n[a],c=s.getType();if("element"===c&&"a"===s.getTagName())s.isClosing()?r=Math.max(r-1,0):r++;else if("text"===c&&0===r){var l=this.parseText(s.getText(),s.getOffset());o.push.apply(o,l)}}return o=this.compactMatches(o),o=this.removeUnwantedMatches(o)},compactMatches:function(e){e.sort(function(e,t){return e.getOffset()-t.getOffset()});for(var t=0;t<e.length-1;t++)for(var n=e[t],r=n.getOffset()+n.getMatchedText().length;t+1<e.length&&e[t+1].getOffset()<=r;)e.splice(t+1,1);return e},removeUnwantedMatches:function(t){var n=e.Util.remove;return this.hashtag||n(t,function(e){return"hashtag"===e.getType()}),this.email||n(t,function(e){return"email"===e.getType()}),this.phone||n(t,function(e){return"phone"===e.getType()}),this.mention||n(t,function(e){return"mention"===e.getType()}),this.urls.schemeMatches||n(t,function(e){return"url"===e.getType()&&"scheme"===e.getUrlMatchType()}),this.urls.wwwMatches||n(t,function(e){return"url"===e.getType()&&"www"===e.getUrlMatchType()}),this.urls.tldMatches||n(t,function(e){return"url"===e.getType()&&"tld"===e.getUrlMatchType()}),t},parseText:function(e,t){t=t||0;for(var n=this.getMatchers(),r=[],o=0,a=n.length;o<a;o++){for(var i=n[o].parseMatches(e),s=0,c=i.length;s<c;s++)i[s].setOffset(t+i[s].getOffset());r.push.apply(r,i)}return r},link:function(e){if(!e)return"";for(var t=this.parse(e),n=[],r=0,o=0,a=t.length;o<a;o++){var i=t[o];n.push(e.substring(r,i.getOffset())),n.push(this.createMatchReturnVal(i)),r=i.getOffset()+i.getMatchedText().length}return n.push(e.substring(r)),n.join("")},createMatchReturnVal:function(t){var n;return this.replaceFn&&(n=this.replaceFn.call(this.context,t)),"string"==typeof n?n:!1===n?t.getMatchedText():n instanceof e.HtmlTag?n.toAnchorString():t.buildTag().toAnchorString()},getHtmlParser:function(){var t=this.htmlParser;return t||(t=this.htmlParser=new e.htmlParser.HtmlParser),t},getMatchers:function(){if(this.matchers)return this.matchers;var t=e.matcher,n=this.getTagBuilder(),r=[new t.Hashtag({tagBuilder:n,serviceName:this.hashtag}),new t.Email({tagBuilder:n}),new t.Phone({tagBuilder:n}),new t.Mention({tagBuilder:n,serviceName:this.mention}),new t.Url({tagBuilder:n,stripPrefix:this.stripPrefix,stripTrailingSlash:this.stripTrailingSlash})];return this.matchers=r},getTagBuilder:function(){var t=this.tagBuilder;return t||(t=this.tagBuilder=new e.AnchorTagBuilder({newWindow:this.newWindow,truncate:this.truncate,className:this.className})),t}},e.match={},e.matcher={},e.htmlParser={},e.truncate={},e.Util={abstractMethod:function(){throw"abstract"},trimRegex:/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,assign:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},defaults:function(e,t){for(var n in t)t.hasOwnProperty(n)&&void 0===e[n]&&(e[n]=t[n]);return e},extend:function(t,n){var r=t.prototype,o=function(){};o.prototype=r;var a;a=n.hasOwnProperty("constructor")?n.constructor:function(){r.constructor.apply(this,arguments)};var i=a.prototype=new o;return i.constructor=a,i.superclass=r,delete n.constructor,e.Util.assign(i,n),a},ellipsis:function(e,t,n){var r;return e.length>t&&(null==n?(n="&hellip;",r=3):r=n.length,e=e.substring(0,t-r)+n),e},indexOf:function(e,t){if(Array.prototype.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},remove:function(e,t){for(var n=e.length-1;n>=0;n--)!0===t(e[n])&&e.splice(n,1)},splitAndCapture:function(e,t){if(!t.global)throw new Error("`splitRegex` must have the 'g' flag set");for(var n,r=[],o=0;n=t.exec(e);)r.push(e.substring(o,n.index)),r.push(n[0]),o=n.index+n[0].length;return r.push(e.substring(o)),r},trim:function(e){return e.replace(this.trimRegex,"")}},e.HtmlTag=e.Util.extend(Object,{whitespaceRegex:/\s+/,constructor:function(t){e.Util.assign(this,t),this.innerHtml=this.innerHtml||this.innerHTML},setTagName:function(e){return this.tagName=e,this},getTagName:function(){return this.tagName||""},setAttr:function(e,t){return this.getAttrs()[e]=t,this},getAttr:function(e){return this.getAttrs()[e]},setAttrs:function(t){var n=this.getAttrs();return e.Util.assign(n,t),this},getAttrs:function(){return this.attrs||(this.attrs={})},setClass:function(e){return this.setAttr("class",e)},addClass:function(t){for(var n,r=this.getClass(),o=this.whitespaceRegex,a=e.Util.indexOf,i=r?r.split(o):[],s=t.split(o);n=s.shift();)-1===a(i,n)&&i.push(n);return this.getAttrs().class=i.join(" "),this},removeClass:function(t){for(var n,r=this.getClass(),o=this.whitespaceRegex,a=e.Util.indexOf,i=r?r.split(o):[],s=t.split(o);i.length&&(n=s.shift());){var c=a(i,n);-1!==c&&i.splice(c,1)}return this.getAttrs().class=i.join(" "),this},getClass:function(){return this.getAttrs().class||""},hasClass:function(e){return-1!==(" "+this.getClass()+" ").indexOf(" "+e+" ")},setInnerHtml:function(e){return this.innerHtml=e,this},getInnerHtml:function(){return this.innerHtml||""},toAnchorString:function(){var e=this.getTagName(),t=this.buildAttrsStr();return t=t?" "+t:"",["<",e,t,">",this.getInnerHtml(),"</",e,">"].join("")},buildAttrsStr:function(){if(!this.attrs)return"";var e=this.getAttrs(),t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n+'="'+e[n]+'"');return t.join(" ")}}),e.RegexLib=function(){var e="A-Za-z\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢴऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞭꞰ-ꞷꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",t=e+"0-9٠-٩۰-۹߀-߉०-९০-৯੦-੯૦-૯୦-୯௦-௯౦-౯೦-೯൦-൯෦-෯๐-๙໐-໙༠-༩၀-၉႐-႙០-៩᠐-᠙᥆-᥏᧐-᧙᪀-᪉᪐-᪙᭐-᭙᮰-᮹᱀-᱉᱐-᱙꘠-꘩꣐-꣙꤀-꤉꧐-꧙꧰-꧹꩐-꩙꯰-꯹０-９";return{alphaNumericCharsStr:t,alphaCharsStr:e,domainNameRegex:new RegExp("["+t+".\\-]*["+t+"\\-]")}}(),e.AnchorTagBuilder=e.Util.extend(Object,{constructor:function(e){e=e||{},this.newWindow=e.newWindow,this.truncate=e.truncate,this.className=e.className},build:function(t){return new e.HtmlTag({tagName:"a",attrs:this.createAttrs(t),innerHtml:this.processAnchorText(t.getAnchorText())})},createAttrs:function(e){var t={href:e.getAnchorHref()},n=this.createCssClass(e);return n&&(t.class=n),this.newWindow&&(t.target="_blank",t.rel="noopener noreferrer"),this.truncate&&this.truncate.length&&this.truncate.length<e.getAnchorText().length&&(t.title=e.getAnchorHref()),t},createCssClass:function(e){var t=this.className;if(t){for(var n=[t],r=e.getCssClassSuffixes(),o=0,a=r.length;o<a;o++)n.push(t+"-"+r[o]);return n.join(" ")}return""},processAnchorText:function(e){return e=this.doTruncate(e)},doTruncate:function(t){var n=this.truncate;if(!n||!n.length)return t;var r=n.length,o=n.location;return"smart"===o?e.truncate.TruncateSmart(t,r):"middle"===o?e.truncate.TruncateMiddle(t,r):e.truncate.TruncateEnd(t,r)}}),e.htmlParser.HtmlParser=e.Util.extend(Object,{htmlRegex:function(){var e=/!--([\s\S]+?)--/,t=/[0-9a-zA-Z][0-9a-zA-Z:]*/,n=/[^\s"'>\/=\x00-\x1F\x7F]+/,r=/(?:"[^"]*?"|'[^']*?'|[^'"=<>`\s]+)/,o=n.source+"(?:\\s*=\\s*"+r.source+")?";return new RegExp(["(?:","<(!DOCTYPE)","(?:","\\s+","(?:",o,"|",r.source+")",")*",">",")","|","(?:","<(/)?","(?:",e.source,"|","(?:","("+t.source+")","\\s*/?",")","|","(?:","("+t.source+")","\\s+","(?:","(?:\\s+|\\b)",o,")*","\\s*/?",")",")",">",")"].join(""),"gi")}(),htmlCharacterEntitiesRegex:/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi,parse:function(e){for(var t,n,r=this.htmlRegex,o=0,a=[];null!==(t=r.exec(e));){var i=t[0],s=t[3],c=t[1]||t[4]||t[5],l=!!t[2],u=t.index,f=e.substring(o,u);f&&(n=this.parseTextAndEntityNodes(o,f),a.push.apply(a,n)),s?a.push(this.createCommentNode(u,i,s)):a.push(this.createElementNode(u,i,c,l)),o=u+i.length}if(o<e.length){var p=e.substring(o);p&&(n=this.parseTextAndEntityNodes(o,p),n.forEach(function(e){a.push(e)}))}return a},parseTextAndEntityNodes:function(t,n){for(var r=[],o=e.Util.splitAndCapture(n,this.htmlCharacterEntitiesRegex),a=0,i=o.length;a<i;a+=2){var s=o[a],c=o[a+1];s&&(r.push(this.createTextNode(t,s)),t+=s.length),c&&(r.push(this.createEntityNode(t,c)),t+=c.length)}return r},createCommentNode:function(t,n,r){return new e.htmlParser.CommentNode({offset:t,text:n,comment:e.Util.trim(r)})},createElementNode:function(t,n,r,o){return new e.htmlParser.ElementNode({offset:t,text:n,tagName:r.toLowerCase(),closing:o})},createEntityNode:function(t,n){return new e.htmlParser.EntityNode({offset:t,text:n})},createTextNode:function(t,n){return new e.htmlParser.TextNode({offset:t,text:n})}}),e.htmlParser.HtmlNode=e.Util.extend(Object,{offset:void 0,text:void 0,constructor:function(t){if(e.Util.assign(this,t),null==this.offset)throw new Error("`offset` cfg required");if(null==this.text)throw new Error("`text` cfg required")},getType:e.Util.abstractMethod,getOffset:function(){return this.offset},getText:function(){return this.text}}),e.htmlParser.CommentNode=e.Util.extend(e.htmlParser.HtmlNode,{comment:"",getType:function(){return"comment"},getComment:function(){return this.comment}}),e.htmlParser.ElementNode=e.Util.extend(e.htmlParser.HtmlNode,{tagName:"",closing:!1,getType:function(){return"element"},getTagName:function(){return this.tagName},isClosing:function(){return this.closing}}),e.htmlParser.EntityNode=e.Util.extend(e.htmlParser.HtmlNode,{getType:function(){return"entity"}}),e.htmlParser.TextNode=e.Util.extend(e.htmlParser.HtmlNode,{getType:function(){return"text"}}),e.match.Match=e.Util.extend(Object,{constructor:function(e){if(null==e.tagBuilder)throw new Error("`tagBuilder` cfg required");if(null==e.matchedText)throw new Error("`matchedText` cfg required");if(null==e.offset)throw new Error("`offset` cfg required");this.tagBuilder=e.tagBuilder,this.matchedText=e.matchedText,this.offset=e.offset},getType:e.Util.abstractMethod,getMatchedText:function(){return this.matchedText},setOffset:function(e){this.offset=e},getOffset:function(){return this.offset},getAnchorHref:e.Util.abstractMethod,getAnchorText:e.Util.abstractMethod,getCssClassSuffixes:function(){return[this.getType()]},buildTag:function(){return this.tagBuilder.build(this)}}),e.match.Email=e.Util.extend(e.match.Match,{constructor:function(t){if(e.match.Match.prototype.constructor.call(this,t),!t.email)throw new Error("`email` cfg required");this.email=t.email},getType:function(){return"email"},getEmail:function(){return this.email},getAnchorHref:function(){return"mailto:"+this.email},getAnchorText:function(){return this.email}}),e.match.Hashtag=e.Util.extend(e.match.Match,{constructor:function(t){if(e.match.Match.prototype.constructor.call(this,t),!t.hashtag)throw new Error("`hashtag` cfg required");this.serviceName=t.serviceName,this.hashtag=t.hashtag},getType:function(){return"hashtag"},getServiceName:function(){return this.serviceName},getHashtag:function(){return this.hashtag},getAnchorHref:function(){var e=this.serviceName,t=this.hashtag;switch(e){case"twitter":return"https://twitter.com/hashtag/"+t;case"facebook":return"https://www.facebook.com/hashtag/"+t;case"instagram":return"https://instagram.com/explore/tags/"+t;default:throw new Error("Unknown service name to point hashtag to: ",e)}},getAnchorText:function(){return"#"+this.hashtag}}),e.match.Phone=e.Util.extend(e.match.Match,{constructor:function(t){if(e.match.Match.prototype.constructor.call(this,t),!t.number)throw new Error("`number` cfg required");if(null==t.plusSign)throw new Error("`plusSign` cfg required");this.number=t.number,this.plusSign=t.plusSign},getType:function(){return"phone"},getNumber:function(){return this.number},getAnchorHref:function(){return"tel:"+(this.plusSign?"+":"")+this.number},getAnchorText:function(){return this.matchedText}}),e.match.Mention=e.Util.extend(e.match.Match,{constructor:function(t){if(e.match.Match.prototype.constructor.call(this,t),!t.serviceName)throw new Error("`serviceName` cfg required");if(!t.mention)throw new Error("`mention` cfg required");this.mention=t.mention,this.serviceName=t.serviceName},getType:function(){return"mention"},getMention:function(){return this.mention},getServiceName:function(){return this.serviceName},getAnchorHref:function(){switch(this.serviceName){case"twitter":return"https://twitter.com/"+this.mention;case"instagram":return"https://instagram.com/"+this.mention;default:throw new Error("Unknown service name to point mention to: ",this.serviceName)}},getAnchorText:function(){return"@"+this.mention},getCssClassSuffixes:function(){var t=e.match.Match.prototype.getCssClassSuffixes.call(this),n=this.getServiceName();return n&&t.push(n),t}}),e.match.Url=e.Util.extend(e.match.Match,{constructor:function(t){if(e.match.Match.prototype.constructor.call(this,t),"scheme"!==t.urlMatchType&&"www"!==t.urlMatchType&&"tld"!==t.urlMatchType)throw new Error('`urlMatchType` cfg must be one of: "scheme", "www", or "tld"');if(!t.url)throw new Error("`url` cfg required");if(null==t.protocolUrlMatch)throw new Error("`protocolUrlMatch` cfg required");if(null==t.protocolRelativeMatch)throw new Error("`protocolRelativeMatch` cfg required");if(null==t.stripPrefix)throw new Error("`stripPrefix` cfg required");if(null==t.stripTrailingSlash)throw new Error("`stripTrailingSlash` cfg required");this.urlMatchType=t.urlMatchType,this.url=t.url,this.protocolUrlMatch=t.protocolUrlMatch,this.protocolRelativeMatch=t.protocolRelativeMatch,this.stripPrefix=t.stripPrefix,this.stripTrailingSlash=t.stripTrailingSlash},schemePrefixRegex:/^(https?:\/\/)?/i,wwwPrefixRegex:/^(https?:\/\/)?(www\.)?/i,protocolRelativeRegex:/^\/\//,protocolPrepended:!1,getType:function(){return"url"},getUrlMatchType:function(){return this.urlMatchType},getUrl:function(){var e=this.url;return this.protocolRelativeMatch||this.protocolUrlMatch||this.protocolPrepended||(e=this.url="http://"+e,this.protocolPrepended=!0),e},getAnchorHref:function(){return this.getUrl().replace(/&amp;/g,"&")},getAnchorText:function(){var e=this.getMatchedText();return this.protocolRelativeMatch&&(e=this.stripProtocolRelativePrefix(e)),this.stripPrefix.scheme&&(e=this.stripSchemePrefix(e)),this.stripPrefix.www&&(e=this.stripWwwPrefix(e)),this.stripTrailingSlash&&(e=this.removeTrailingSlash(e)),e},stripSchemePrefix:function(e){return e.replace(this.schemePrefixRegex,"")},stripWwwPrefix:function(e){return e.replace(this.wwwPrefixRegex,"$1")},stripProtocolRelativePrefix:function(e){return e.replace(this.protocolRelativeRegex,"")},removeTrailingSlash:function(e){return"/"===e.charAt(e.length-1)&&(e=e.slice(0,-1)),e}}),e.tldRegex=/(?:xn--vermgensberatung-pwb|xn--vermgensberater-ctb|xn--clchc0ea0b2g2a9gcd|xn--w4r85el8fhu5dnra|northwesternmutual|travelersinsurance|vermögensberatung|xn--3oq18vl8pn36a|xn--5su34j936bgsg|xn--bck1b9a5dre4c|xn--mgbai9azgqp6j|xn--mgberp4a5d4ar|xn--xkc2dl3a5ee0h|vermögensberater|xn--fzys8d69uvgm|xn--mgba7c0bbn0a|xn--xkc2al3hye2a|americanexpress|kerryproperties|sandvikcoromant|xn--i1b6b1a6a2e|xn--kcrx77d1x4a|xn--lgbbat1ad8j|xn--mgba3a4f16a|xn--mgbc0a9azcg|xn--nqv7fs00ema|afamilycompany|americanfamily|bananarepublic|cancerresearch|cookingchannel|kerrylogistics|weatherchannel|xn--54b7fta0cc|xn--6qq986b3xl|xn--80aqecdr1a|xn--b4w605ferd|xn--fiq228c5hs|xn--jlq61u9w7b|xn--mgba3a3ejt|xn--mgbaam7a8h|xn--mgbayh7gpa|xn--mgbb9fbpob|xn--mgbbh1a71e|xn--mgbca7dzdo|xn--mgbi4ecexp|xn--mgbx4cd0ab|international|lifeinsurance|orientexpress|spreadbetting|travelchannel|wolterskluwer|xn--eckvdtc9d|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--tiq49xqyj|xn--yfro4i67o|xn--ygbi2ammx|construction|lplfinancial|pamperedchef|scholarships|versicherung|xn--3e0b707e|xn--80adxhks|xn--80asehdb|xn--8y0a063a|xn--gckr3f0f|xn--mgb9awbf|xn--mgbab2bd|xn--mgbpl2fh|xn--mgbt3dhd|xn--mk1bu44c|xn--ngbc5azd|xn--ngbe9e0a|xn--ogbpf8fl|xn--qcka1pmc|accountants|barclaycard|blackfriday|blockbuster|bridgestone|calvinklein|contractors|creditunion|engineering|enterprises|foodnetwork|investments|kerryhotels|lamborghini|motorcycles|olayangroup|photography|playstation|productions|progressive|redumbrella|rightathome|williamhill|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--3bst00m|xn--3ds443g|xn--42c2d9a|xn--45brj9c|xn--55qw42g|xn--6frz82g|xn--80ao21a|xn--9krt00a|xn--cck2b3b|xn--czr694b|xn--d1acj3b|xn--efvy88h|xn--estv75g|xn--fct429k|xn--fjq720a|xn--flw351e|xn--g2xx48c|xn--gecrj9c|xn--gk3at1e|xn--h2brj9c|xn--hxt814e|xn--imr513n|xn--j6w193g|xn--jvr189m|xn--kprw13d|xn--kpry57d|xn--kpu716f|xn--mgbtx2b|xn--mix891f|xn--nyqy26a|xn--pbt977c|xn--pgbs0dh|xn--q9jyb4c|xn--rhqv96g|xn--rovu88b|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--vuq861b|xn--w4rs40l|xn--xhq521b|xn--zfr164b|சிங்கப்பூர்|accountant|apartments|associates|basketball|bnpparibas|boehringer|capitalone|consulting|creditcard|cuisinella|eurovision|extraspace|foundation|healthcare|immobilien|industries|management|mitsubishi|nationwide|newholland|nextdirect|onyourside|properties|protection|prudential|realestate|republican|restaurant|schaeffler|swiftcover|tatamotors|technology|telefonica|university|vistaprint|vlaanderen|volkswagen|xn--30rr7y|xn--3pxu8k|xn--45q11c|xn--4gbrim|xn--55qx5d|xn--5tzm5g|xn--80aswg|xn--90a3ac|xn--9dbq2a|xn--9et52u|xn--c2br7g|xn--cg4bki|xn--czrs0t|xn--czru2d|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--io0a7i|xn--kput3i|xn--mxtq1m|xn--o3cw4h|xn--pssy2u|xn--unup4y|xn--wgbh1c|xn--wgbl6a|xn--y9a3aq|accenture|alfaromeo|allfinanz|amsterdam|analytics|aquarelle|barcelona|bloomberg|christmas|community|directory|education|equipment|fairwinds|financial|firestone|fresenius|frontdoor|fujixerox|furniture|goldpoint|goodhands|hisamitsu|homedepot|homegoods|homesense|honeywell|institute|insurance|kuokgroup|ladbrokes|lancaster|landrover|lifestyle|marketing|marshalls|mcdonalds|melbourne|microsoft|montblanc|panasonic|passagens|pramerica|richardli|scjohnson|shangrila|solutions|statebank|statefarm|stockholm|travelers|vacations|xn--90ais|xn--c1avg|xn--d1alf|xn--e1a4c|xn--fhbei|xn--j1aef|xn--j1amh|xn--l1acc|xn--nqv7f|xn--p1acf|xn--tckwe|xn--vhquv|yodobashi|abudhabi|airforce|allstate|attorney|barclays|barefoot|bargains|baseball|boutique|bradesco|broadway|brussels|budapest|builders|business|capetown|catering|catholic|chrysler|cipriani|cityeats|cleaning|clinique|clothing|commbank|computer|delivery|deloitte|democrat|diamonds|discount|discover|download|engineer|ericsson|esurance|everbank|exchange|feedback|fidelity|firmdale|football|frontier|goodyear|grainger|graphics|guardian|hdfcbank|helsinki|holdings|hospital|infiniti|ipiranga|istanbul|jpmorgan|lighting|lundbeck|marriott|maserati|mckinsey|memorial|mortgage|movistar|observer|partners|pharmacy|pictures|plumbing|property|redstone|reliance|saarland|samsclub|security|services|shopping|showtime|softbank|software|stcgroup|supplies|symantec|telecity|training|uconnect|vanguard|ventures|verisign|woodside|xn--90ae|xn--node|xn--p1ai|xn--qxam|yokohama|السعودية|abogado|academy|agakhan|alibaba|android|athleta|auction|audible|auspost|avianca|banamex|bauhaus|bentley|bestbuy|booking|brother|bugatti|capital|caravan|careers|cartier|channel|chintai|citadel|clubmed|college|cologne|comcast|company|compare|contact|cooking|corsica|country|coupons|courses|cricket|cruises|dentist|digital|domains|exposed|express|farmers|fashion|ferrari|ferrero|finance|fishing|fitness|flights|florist|flowers|forsale|frogans|fujitsu|gallery|genting|godaddy|guitars|hamburg|hangout|hitachi|holiday|hosting|hoteles|hotmail|hyundai|iselect|ismaili|jewelry|juniper|kitchen|komatsu|lacaixa|lancome|lanxess|lasalle|latrobe|leclerc|liaison|limited|lincoln|markets|metlife|monster|netbank|netflix|network|neustar|okinawa|oldnavy|organic|origins|panerai|philips|pioneer|politie|realtor|recipes|rentals|reviews|rexroth|samsung|sandvik|schmidt|schwarz|science|shiksha|shriram|singles|spiegel|staples|starhub|statoil|storage|support|surgery|systems|temasek|theater|theatre|tickets|tiffany|toshiba|trading|walmart|wanggou|watches|weather|website|wedding|whoswho|windows|winners|xfinity|yamaxun|youtube|zuerich|католик|الجزائر|العليان|پاکستان|كاثوليك|موبايلي|இந்தியா|abarth|abbott|abbvie|active|africa|agency|airbus|airtel|alipay|alsace|alstom|anquan|aramco|author|bayern|beauty|berlin|bharti|blanco|bostik|boston|broker|camera|career|caseih|casino|center|chanel|chrome|church|circle|claims|clinic|coffee|comsec|condos|coupon|credit|cruise|dating|datsun|dealer|degree|dental|design|direct|doctor|dunlop|dupont|durban|emerck|energy|estate|events|expert|family|flickr|futbol|gallup|garden|george|giving|global|google|gratis|health|hermes|hiphop|hockey|hughes|imamat|insure|intuit|jaguar|joburg|juegos|kaufen|kinder|kindle|kosher|lancia|latino|lawyer|lefrak|living|locker|london|luxury|madrid|maison|makeup|market|mattel|mobile|mobily|monash|mormon|moscow|museum|mutual|nagoya|natura|nissan|nissay|norton|nowruz|office|olayan|online|oracle|orange|otsuka|pfizer|photos|physio|piaget|pictet|quebec|racing|realty|reisen|repair|report|review|rocher|rogers|ryukyu|safety|sakura|sanofi|school|schule|secure|select|shouji|soccer|social|stream|studio|supply|suzuki|swatch|sydney|taipei|taobao|target|tattoo|tennis|tienda|tjmaxx|tkmaxx|toyota|travel|unicom|viajes|viking|villas|virgin|vision|voting|voyage|vuelos|walter|warman|webcam|xihuan|xperia|yachts|yandex|zappos|москва|онлайн|ابوظبي|ارامكو|الاردن|المغرب|امارات|فلسطين|مليسيا|இலங்கை|ファッション|actor|adult|aetna|amfam|amica|apple|archi|audio|autos|azure|baidu|beats|bible|bingo|black|boats|boots|bosch|build|canon|cards|chase|cheap|chloe|cisco|citic|click|cloud|coach|codes|crown|cymru|dabur|dance|deals|delta|dodge|drive|dubai|earth|edeka|email|epost|epson|faith|fedex|final|forex|forum|gallo|games|gifts|gives|glade|glass|globo|gmail|green|gripe|group|gucci|guide|homes|honda|horse|house|hyatt|ikano|intel|irish|iveco|jetzt|koeln|kyoto|lamer|lease|legal|lexus|lilly|linde|lipsy|lixil|loans|locus|lotte|lotto|lupin|macys|mango|media|miami|money|mopar|movie|nadex|nexus|nikon|ninja|nokia|nowtv|omega|osaka|paris|parts|party|phone|photo|pizza|place|poker|praxi|press|prime|promo|quest|radio|rehab|reise|ricoh|rocks|rodeo|salon|sener|seven|sharp|shell|shoes|skype|sling|smart|smile|solar|space|stada|store|study|style|sucks|swiss|tatar|tires|tirol|tmall|today|tokyo|tools|toray|total|tours|trade|trust|tunes|tushu|ubank|vegas|video|vista|vodka|volvo|wales|watch|weber|weibo|works|world|xerox|yahoo|zippo|ایران|بازار|بھارت|سودان|سورية|همراه|संगठन|বাংলা|భారత్|嘉里大酒店|aarp|able|adac|aero|aigo|akdn|ally|amex|army|arpa|arte|asda|asia|audi|auto|baby|band|bank|bbva|beer|best|bike|bing|blog|blue|bofa|bond|book|buzz|cafe|call|camp|care|cars|casa|case|cash|cbre|cern|chat|citi|city|club|cool|coop|cyou|data|date|dclk|deal|dell|desi|diet|dish|docs|doha|duck|duns|dvag|erni|fage|fail|fans|farm|fast|fiat|fido|film|fire|fish|flir|food|ford|free|fund|game|gbiz|gent|ggee|gift|gmbh|gold|golf|goog|guge|guru|hair|haus|hdfc|help|here|hgtv|host|hsbc|icbc|ieee|imdb|immo|info|itau|java|jeep|jobs|jprs|kddi|kiwi|kpmg|kred|land|lego|lgbt|lidl|life|like|limo|link|live|loan|loft|love|ltda|luxe|maif|meet|meme|menu|mini|mint|mobi|moda|moto|mtpc|name|navy|news|next|nico|nike|ollo|open|page|pars|pccw|pics|ping|pink|play|plus|pohl|porn|post|prod|prof|qpon|raid|read|reit|rent|rest|rich|rmit|room|rsvp|ruhr|safe|sale|sapo|sarl|save|saxo|scor|scot|seat|seek|sexy|shaw|shia|shop|show|silk|sina|site|skin|sncf|sohu|song|sony|spot|star|surf|talk|taxi|team|tech|teva|tiaa|tips|town|toys|tube|vana|visa|viva|vivo|vote|voto|wang|weir|wien|wiki|wine|work|xbox|yoga|zara|zero|zone|дети|сайт|بيتك|تونس|شبكة|عراق|عمان|موقع|भारत|ভারত|ਭਾਰਤ|ભારત|ලංකා|グーグル|クラウド|ポイント|大众汽车|组织机构|電訊盈科|香格里拉|aaa|abb|abc|aco|ads|aeg|afl|aig|anz|aol|app|art|aws|axa|bar|bbc|bbt|bcg|bcn|bet|bid|bio|biz|bms|bmw|bnl|bom|boo|bot|box|buy|bzh|cab|cal|cam|car|cat|cba|cbn|cbs|ceb|ceo|cfa|cfd|com|crs|csc|dad|day|dds|dev|dhl|diy|dnp|dog|dot|dtv|dvr|eat|eco|edu|esq|eus|fan|fit|fly|foo|fox|frl|ftr|fun|fyi|gal|gap|gdn|gea|gle|gmo|gmx|goo|gop|got|gov|hbo|hiv|hkt|hot|how|htc|ibm|ice|icu|ifm|ing|ink|int|ist|itv|iwc|jcb|jcp|jio|jlc|jll|jmp|jnj|jot|joy|kfh|kia|kim|kpn|krd|lat|law|lds|lol|lpl|ltd|man|mba|mcd|med|men|meo|mil|mit|mlb|mls|mma|moe|moi|mom|mov|msd|mtn|mtr|nab|nba|nec|net|new|nfl|ngo|nhk|now|nra|nrw|ntt|nyc|obi|off|one|ong|onl|ooo|org|ott|ovh|pay|pet|pid|pin|pnc|pro|pru|pub|pwc|qvc|red|ren|ril|rio|rip|run|rwe|sap|sas|sbi|sbs|sca|scb|ses|sew|sex|sfr|ski|sky|soy|srl|srt|stc|tab|tax|tci|tdk|tel|thd|tjx|top|trv|tui|tvs|ubs|uno|uol|ups|vet|vig|vin|vip|wed|win|wme|wow|wtc|wtf|xin|xxx|xyz|you|yun|zip|бел|ком|қаз|мкд|мон|орг|рус|срб|укр|հայ|קום|قطر|كوم|مصر|कॉम|नेट|คอม|ไทย|ストア|セール|みんな|中文网|天主教|我爱你|新加坡|淡马锡|诺基亚|飞利浦|ac|ad|ae|af|ag|ai|al|am|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|ελ|бг|ею|рф|გე|닷넷|닷컴|삼성|한국|コム|世界|中信|中国|中國|企业|佛山|信息|健康|八卦|公司|公益|台湾|台灣|商城|商店|商标|嘉里|在线|大拿|娱乐|家電|工行|广东|微博|慈善|手机|手表|政务|政府|新闻|时尚|書籍|机构|游戏|澳門|点看|珠宝|移动|网址|网店|网站|网络|联通|谷歌|购物|通販|集团|食品|餐厅|香港)/,e.matcher.Matcher=e.Util.extend(Object,{constructor:function(e){if(!e.tagBuilder)throw new Error("`tagBuilder` cfg required");this.tagBuilder=e.tagBuilder},parseMatches:e.Util.abstractMethod}),e.matcher.Email=e.Util.extend(e.matcher.Matcher,{matcherRegex:function(){var t=e.RegexLib.alphaNumericCharsStr,n=new RegExp("["+t+"\\-_';:&=+$.,]+@"),r=e.RegexLib.domainNameRegex,o=e.tldRegex;return new RegExp([n.source,r.source,"\\.",o.source].join(""),"gi")}(),parseMatches:function(t){for(var n,r=this.matcherRegex,o=this.tagBuilder,a=[];null!==(n=r.exec(t));){var i=n[0];a.push(new e.match.Email({tagBuilder:o,matchedText:i,offset:n.index,email:i}))}return a}}),e.matcher.Hashtag=e.Util.extend(e.matcher.Matcher,{matcherRegex:new RegExp("#[_"+e.RegexLib.alphaNumericCharsStr+"]{1,139}","g"),nonWordCharRegex:new RegExp("[^"+e.RegexLib.alphaNumericCharsStr+"]"),constructor:function(t){e.matcher.Matcher.prototype.constructor.call(this,t),this.serviceName=t.serviceName},parseMatches:function(t){for(var n,r=this.matcherRegex,o=this.nonWordCharRegex,a=this.serviceName,i=this.tagBuilder,s=[];null!==(n=r.exec(t));){var c=n.index,l=t.charAt(c-1);if(0===c||o.test(l)){var u=n[0],f=n[0].slice(1);s.push(new e.match.Hashtag({tagBuilder:i,matchedText:u,offset:c,serviceName:a,hashtag:f}))}}return s}}),e.matcher.Phone=e.Util.extend(e.matcher.Matcher,{matcherRegex:/(?:(\+)?\d{1,3}[-\040.]?)?\(?\d{3}\)?[-\040.]?\d{3}[-\040.]?\d{4}([,;]*[0-9]+#?)*/g,parseMatches:function(t){for(var n,r=this.matcherRegex,o=this.tagBuilder,a=[];null!==(n=r.exec(t));){var i=n[0],s=i.replace(/[^0-9,;#]/g,""),c=!!n[1];/\D/.test(n[2])&&/\D/.test(i)&&a.push(new e.match.Phone({tagBuilder:o,matchedText:i,offset:n.index,number:s,plusSign:c}))}return a}}),e.matcher.Mention=e.Util.extend(e.matcher.Matcher,{matcherRegexes:{twitter:new RegExp("@[_"+e.RegexLib.alphaNumericCharsStr+"]{1,20}","g"),instagram:new RegExp("@[_."+e.RegexLib.alphaNumericCharsStr+"]{1,50}","g")},nonWordCharRegex:new RegExp("[^"+e.RegexLib.alphaNumericCharsStr+"]"),constructor:function(t){e.matcher.Matcher.prototype.constructor.call(this,t),this.serviceName=t.serviceName},parseMatches:function(t){var n,r=this.matcherRegexes[this.serviceName],o=this.nonWordCharRegex,a=this.serviceName,i=this.tagBuilder,s=[];if(!r)return s;for(;null!==(n=r.exec(t));){var c=n.index,l=t.charAt(c-1);if(0===c||o.test(l)){var u=n[0].replace(/\.+$/g,""),f=u.slice(1);s.push(new e.match.Mention({tagBuilder:i,matchedText:u,offset:c,serviceName:a,mention:f}))}}return s}}),e.matcher.Url=e.Util.extend(e.matcher.Matcher,{matcherRegex:function(){var t=/(?:[A-Za-z][-.+A-Za-z0-9]*:(?![A-Za-z][-.+A-Za-z0-9]*:\/\/)(?!\d+\/?)(?:\/\/)?)/,n=/(?:www\.)/,r=e.RegexLib.domainNameRegex,o=e.tldRegex,a=e.RegexLib.alphaNumericCharsStr,i=new RegExp("[/?#](?:["+a+"\\-+&@#/%=~_()|'$*\\[\\]?!:,.;✓]*["+a+"\\-+&@#/%=~_()|'$*\\[\\]✓])?");return new RegExp(["(?:","(",t.source,r.source,")","|","(","(//)?",n.source,r.source,")","|","(","(//)?",r.source+"\\.",o.source,"(?![-"+a+"])",")",")","(?::[0-9]+)?","(?:"+i.source+")?"].join(""),"gi")}(),wordCharRegExp:new RegExp("["+e.RegexLib.alphaNumericCharsStr+"]"),openParensRe:/\(/g,closeParensRe:/\)/g,constructor:function(t){if(e.matcher.Matcher.prototype.constructor.call(this,t),null==t.stripPrefix)throw new Error("`stripPrefix` cfg required");if(null==t.stripTrailingSlash)throw new Error("`stripTrailingSlash` cfg required");this.stripPrefix=t.stripPrefix,this.stripTrailingSlash=t.stripTrailingSlash},parseMatches:function(t){for(var n,r=this.matcherRegex,o=this.stripPrefix,a=this.stripTrailingSlash,i=this.tagBuilder,s=[];null!==(n=r.exec(t));){var c=n[0],l=n[1],u=n[2],f=n[3],p=n[5],h=n.index,m=f||p,d=t.charAt(h-1);if(e.matcher.UrlMatchValidator.isValid(c,l)&&!(h>0&&"@"===d||h>0&&m&&this.wordCharRegExp.test(d))){if(/\?$/.test(c)&&(c=c.substr(0,c.length-1)),this.matchHasUnbalancedClosingParen(c))c=c.substr(0,c.length-1);else{var g=this.matchHasInvalidCharAfterTld(c,l);g>-1&&(c=c.substr(0,g))}var y=l?"scheme":u?"www":"tld",b=!!l;s.push(new e.match.Url({tagBuilder:i,matchedText:c,offset:h,urlMatchType:y,url:c,protocolUrlMatch:b,protocolRelativeMatch:!!m,stripPrefix:o,stripTrailingSlash:a}))}}return s},matchHasUnbalancedClosingParen:function(e){if(")"===e.charAt(e.length-1)){var t=e.match(this.openParensRe),n=e.match(this.closeParensRe);if((t&&t.length||0)<(n&&n.length||0))return!0}return!1},matchHasInvalidCharAfterTld:function(t,n){if(!t)return-1;var r=0;n&&(r=t.indexOf(":"),t=t.slice(r));var o=e.RegexLib.alphaNumericCharsStr,a=new RegExp("^((.?//)?[-."+o+"]*[-"+o+"]\\.[-"+o+"]+)"),i=a.exec(t);return null===i?-1:(r+=i[1].length,t=t.slice(i[1].length),/^[^-.A-Za-z0-9:\/?#]/.test(t)?r:-1)}}),e.matcher.UrlMatchValidator={hasFullProtocolRegex:/^[A-Za-z][-.+A-Za-z0-9]*:\/\//,uriSchemeRegex:/^[A-Za-z][-.+A-Za-z0-9]*:/,hasWordCharAfterProtocolRegex:new RegExp(":[^\\s]*?["+e.RegexLib.alphaCharsStr+"]"),ipRegex:/[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?(:[0-9]*)?\/?$/,isValid:function(e,t){return!(t&&!this.isValidUriScheme(t)||this.urlMatchDoesNotHaveProtocolOrDot(e,t)||this.urlMatchDoesNotHaveAtLeastOneWordChar(e,t)&&!this.isValidIpAddress(e)||this.containsMultipleDots(e))},isValidIpAddress:function(e){var t=new RegExp(this.hasFullProtocolRegex.source+this.ipRegex.source);return null!==e.match(t)},containsMultipleDots:function(e){return e.indexOf("..")>-1},isValidUriScheme:function(e){var t=e.match(this.uriSchemeRegex)[0].toLowerCase();return"javascript:"!==t&&"vbscript:"!==t},urlMatchDoesNotHaveProtocolOrDot:function(e,t){return!(!e||t&&this.hasFullProtocolRegex.test(t)||-1!==e.indexOf("."))},urlMatchDoesNotHaveAtLeastOneWordChar:function(e,t){return!(!e||!t)&&!this.hasWordCharAfterProtocolRegex.test(e)}},e.truncate.TruncateEnd=function(t,n,r){return e.Util.ellipsis(t,n,r)},e.truncate.TruncateMiddle=function(e,t,n){if(e.length<=t)return e;var r,o;null==n?(n="&hellip;",r=8,o=3):(r=n.length,o=n.length);var a=t-o,i="";return a>0&&(i=e.substr(-1*Math.floor(a/2))),(e.substr(0,Math.ceil(a/2))+n+i).substr(0,a+r)},e.truncate.TruncateSmart=function(e,t,n){var r,o;null==n?(n="&hellip;",o=3,r=8):(o=n.length,r=n.length);var a=function(e){var t="";return e.scheme&&e.host&&(t+=e.scheme+"://"),e.host&&(t+=e.host),e.path&&(t+="/"+e.path),e.query&&(t+="?"+e.query),e.fragment&&(t+="#"+e.fragment),t},i=function(e,t){var r=t/2,o=Math.ceil(r),a=-1*Math.floor(r),i="";return a<0&&(i=e.substr(a)),e.substr(0,o)+n+i};if(e.length<=t)return e;var s=t-o,c=function(e){var t={},n=e,r=n.match(/^([a-z]+):\/\//i);return r&&(t.scheme=r[1],n=n.substr(r[0].length)),r=n.match(/^(.*?)(?=(\?|#|\/|$))/i),r&&(t.host=r[1],n=n.substr(r[0].length)),r=n.match(/^\/(.*?)(?=(\?|#|$))/i),r&&(t.path=r[1],n=n.substr(r[0].length)),r=n.match(/^\?(.*?)(?=(#|$))/i),r&&(t.query=r[1],n=n.substr(r[0].length)),r=n.match(/^#(.*?)$/i),r&&(t.fragment=r[1]),t}(e);if(c.query){var l=c.query.match(/^(.*?)(?=(\?|\#))(.*?)$/i);l&&(c.query=c.query.substr(0,l[1].length),e=a(c))}if(e.length<=t)return e;if(c.host&&(c.host=c.host.replace(/^www\./,""),e=a(c)),e.length<=t)return e;var u="";if(c.host&&(u+=c.host),u.length>=s)return c.host.length==t?(c.host.substr(0,t-o)+n).substr(0,s+r):i(u,s).substr(0,s+r);var f="";if(c.path&&(f+="/"+c.path),c.query&&(f+="?"+c.query),f){if((u+f).length>=s){if((u+f).length==t)return(u+f).substr(0,t);return(u+i(f,s-u.length)).substr(0,s+r)}u+=f}if(c.fragment){var p="#"+c.fragment;if((u+p).length>=s){if((u+p).length==t)return(u+p).substr(0,t);return(u+i(p,s-u.length)).substr(0,s+r)}u+=p}if(c.scheme&&c.host){var h=c.scheme+"://";if((u+h).length<s)return(h+u).substr(0,t)}if(u.length<=t)return u;var m="";return s>0&&(m=u.substr(-1*Math.floor(s/2))),(u.substr(0,Math.ceil(s/2))+n+m).substr(0,s+r)},e})},function(e,t,n){"use strict";e.exports=function(e){for(var t=e.length;/[\s\uFEFF\u00A0]/.test(e[t-1]);)t--;return e.slice(0,t)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),f=r(u),p=n(12),h=r(p),m=n(2),d=n(17),g=r(d),y=n(6),b=n(13),v=r(b),w=n(21),x=r(w),_=n(14),P=r(_),E=n(15),T=r(E),S=n(1),N=function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),l(t,[{key:"render",value:function(){var e=this.props,t=e.posting,n=e.onComment,r=e.assignTopics,a=e.className,i=o(e,["posting","onComment","assignTopics","className"]),s=(0,x.default)(t);return f.default.createElement(h.default,c({},i,{posting:t,className:(0,S.classNames)(a,(0,m.prefixNS)("user-posting"))}),f.default.createElement(h.default.Title,null,f.default.createElement(g.default,{posting:t})),f.default.createElement(h.default.Nav,null,f.default.createElement(v.default,{activityEntry:t,className:"text-muted"}),s,f.default.createElement(y.AssignTopics,{activityEntry:t,assignTopics:r})),f.default.createElement(P.default,{activityEntry:t}),f.default.createElement(T.default,{activityEntry:t}),f.default.createElement(h.default.Footer,{activityEntry:t},f.default.createElement(y.Comment,{onClick:n}),f.default.createElement(y.Share,{activityEntry:t})),this.props.children)}}]),t}(f.default.Component);t.default=N,N.propTypes={posting:S.ImmutablePropTypes.map.isRequired,onComment:S.PropTypes.func,assignTopics:S.PropTypes.func,className:S.PropTypes.string}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.findCommentToPosting=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),l=r(c),u=n(41),f=r(u),p=n(5),h=n(2),m=n(42),d=r(m),g=n(1),y=n(3),b=function(e,t){return e.find(function(e){return e.get("@id")===t})},v=(t.findCommentToPosting=function(e,t){return b(e.getIn(["comments","comments"]),t)},function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={showAll:!1},n.showMore=n.showMore.bind(n),n.scrollToTarget=n.scrollToTarget.bind(n),n._comments={},n}return i(t,e),s(t,[{key:"showMore",value:function(){this.setState({showAll:!0})}},{key:"scrollToTarget",value:function(e){var t=this,n=this._comments[e.get("cdb_object_id")];if(n){f.default.findDOMNode(n).scrollIntoView(!0)}else this.state.showAll||this.setState({showAll:!0},function(){return t.scrollToTarget(e)})}},{key:"render",value:function(){var e=this,t=this.props,n=t.posting,r=t.onComment,o=t.instanceName,a=n.getIn(["comments","comments"]),i=a.count()?a.count():0,s=i<=3||this.state.showAll?null:l.default.createElement(y.Button.TextButton,{className:(0,h.prefixNS)("show-all-comments"),buttonStyle:"link",onClick:this.showMore,label:(0,p.formatStr)("show-all-comments",{commentsAmount:i})}),c=this.state.showAll?a:a.takeLast(3);return l.default.createElement("div",{className:(0,h.prefixNS)("comments")},s,c.map(function(t){return l.default.createElement(d.default,{key:t.get("cdb_object_id"),instanceName:o,posting:n,comment:t,replyTo:b(a,t.get("reply_to")),onComment:r,ref:function(n){return e._comments[t.get("cdb_object_id")]=n},scrollToTarget:e.scrollToTarget})}))}}]),t}(l.default.Component));t.default=v,v.propTypes={instanceName:g.PropTypes.string.isRequired,posting:g.ImmutablePropTypes.map.isRequired,onComment:g.PropTypes.func}},function(e,t){e.exports=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),f=r(u),p=n(16),h=n(5),m=n(2),d=n(12),g=r(d),y=n(17),b=r(y),v=n(14),w=r(v),x=n(6),_=n(1),P=n(13),E=r(P),T=n(15),S=r(T),N=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={showReplyTo:!1},n.showTarget=n.showTarget.bind(n),n.hideTarget=n.hideTarget.bind(n),n.navigateToTarget=n.navigateToTarget.bind(n),n._replyTarget=null,n}return s(t,e),l(t,[{key:"showTarget",value:function(){this.setState({showReplyTo:!0})}},{key:"hideTarget",value:function(){this.setState({showReplyTo:!1})}},{key:"navigateToTarget",value:function(e){e.preventDefault();var t=this.props,n=t.replyTo,r=t.scrollToTarget;r&&r(n)}},{key:"render",value:function(){var e=this,t=this.props,n=t.replyTo,r=t.comment;return f.default.createElement("div",{className:(0,m.prefixNS)("comment-reply-to")},f.default.createElement(b.default,{posting:r}),f.default.createElement("span",null,":"),f.default.createElement("span",{className:(0,m.prefixNS)("comment-reply-to-label")},(0,h.formatStr)("answer-to")),f.default.createElement("a",{onMouseOver:this.showTarget,onMouseOut:this.hideTarget,ref:function(t){return e._replyTarget=t},href:"#",onClick:this.navigateToTarget},n.getIn(["author","name"])),f.default.createElement(p.Overlay,{placement:"top",show:this.state.showReplyTo,target:this._replyTarget},f.default.createElement(p.Popover,{id:"replyToText-"+n.get("cdb_object_id")},f.default.createElement(w.default,{activityEntry:n}))))}}]),t}(f.default.Component);N.propTypes={comment:_.ImmutablePropTypes.map.isRequired,replyTo:_.ImmutablePropTypes.map.isRequired,scrollToTarget:_.PropTypes.func};var O=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onComment=n.onComment.bind(n),n}return s(t,e),l(t,[{key:"onComment",value:function(){this.props.onComment(this.props.comment)}},{key:"render",value:function(){var e=this.props,t=e.posting,n=e.comment,r=e.replyTo,a=e.scrollToTarget,i=o(e,["posting","comment","replyTo","scrollToTarget"]);return delete i.onComment,f.default.createElement(g.default,c({},i,{className:(0,m.prefixNS)("comment"),posting:n}),f.default.createElement(g.default.Title,null,void 0===r?f.default.createElement(b.default,{posting:n}):f.default.createElement(N,{comment:n,replyTo:r,scrollToTarget:a})),f.default.createElement(g.default.Nav,null,f.default.createElement(E.default,{activityEntry:n,className:"text-muted"})),f.default.createElement(w.default,{activityEntry:n}),f.default.createElement(S.default,{activityEntry:n,reloadEntry:!1,onSubmit:this.onUpload}),f.default.createElement(g.default.Footer,{activityEntry:n},f.default.createElement(x.Comment,{onClick:this.onComment}),f.default.createElement(x.Share,{activityEntry:t})))}}]),t}(f.default.Component);t.default=O,O.propTypes={posting:_.ImmutablePropTypes.map.isRequired,comment:_.ImmutablePropTypes.map.isRequired,replyTo:_.ImmutablePropTypes.map,onComment:_.PropTypes.func,scrollToTarget:_.PropTypes.func}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){var n=t.match.params.postingID;return{posting:(0,v.getReferencedPostings)(e,(0,v.getPostingURL)(n))}}function c(e){return{fetchPosting:function(t){var n=(0,v.getPostingURL)(t);e((0,g.fetchPosting)(n))}}}Object.defineProperty(t,"__esModule",{value:!0}),t.PostingLoader=void 0;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),f=r(u),p=n(18),h=r(p),m=n(20),d=r(m),g=n(8),y=n(1),b=n(7),v=n(2),w=t.PostingLoader=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),l(t,[{key:"fetchPosting",value:function(e){var t=e.match.params.postingID;t&&e.fetchPosting(t)}},{key:"componentDidMount",value:function(){this.fetchPosting(this.props)}},{key:"componentWillReceiveProps",value:function(e){e.match.params.postingID!==this.props.match.params.postingID&&this.fetchPosting(e)}},{key:"render",value:function(){var e=this.props,t=e.posting,n=e.location;return t?f.default.createElement(h.default,{location:n,noSidebar:!0},f.default.createElement("div",{className:(0,v.prefixNS)("thread")},f.default.createElement(d.default,{posting:t,instanceName:b.STANDALONE_INSTANCE}))):null}}]),t}(f.default.Component);w.propTypes={match:y.PropTypes.object,location:y.PropTypes.object,fetchPosting:y.PropTypes.func,posting:y.ImmutablePropTypes.map},t.default=(0,y.connect)(s,c)(w)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),l=r(c),u=n(4),f=r(u),p=n(23),h=r(p),m=n(6),d=n(2),g=n(1),y=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={filter:f.default.Map()},n.toggleSystemPostings=n.toggleSystemPostings.bind(n),n}return i(t,e),s(t,[{key:"toggleSystemPostings",value:function(){var e=this.state.filter.get("systemposting");this.setState({filter:this.state.filter.set("systemposting",m.SystemPostingFilter.toggleFilterState(e))})}},{key:"render",value:function(){var e=this.props,t=e.instanceName,n=e.contextObject;return l.default.createElement("div",{className:(0,d.prefixNS)("object-activities")},l.default.createElement(m.SystemPostingFilter,{filterState:this.state.filter.get("systemposting"),onChange:this.toggleSystemPostings}),l.default.createElement(h.default,{instanceName:t,contextObject:n,filter:this.state.filter}))}}]),t}(l.default.Component);y.propTypes={instanceName:g.PropTypes.string.isRequired,contextObject:g.ImmutablePropTypes.map},t.default=y},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),f=r(u),p=n(4),h=r(p),m=n(23),d=r(m),g=n(3),y=n(2),b=n(5),v=n(6),w=n(1),x=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={filter:h.default.Map()},n.toggleSystemPostings=n.toggleSystemPostings.bind(n),n}return s(t,e),l(t,[{key:"toggleSystemPostings",value:function(){var e=this,t=this.state.filter.get("systemposting");window.setTimeout(function(t){e.setState(t)},0,{filter:this.state.filter.set("systemposting",v.SystemPostingFilter.toggleFilterState(t))})}},{key:"render",value:function(){var e=this.props,t=e.instanceName,n=e.contextObject,r=o(e,["instanceName","contextObject"]);return f.default.createElement(g.ContentBlock,c({title:(0,b.formatStr)("activities")},r,{className:(0,y.prefixNS)("object-activities-block")}),f.default.createElement(g.ContentBlock.Header,null,f.default.createElement(v.SystemPostingFilter,{filterState:this.state.filter.get("systemposting"),onChange:this.toggleSystemPostings})),f.default.createElement(g.ContentBlock.Body,null,f.default.createElement(d.default,{instanceName:t,contextObject:n,filter:this.state.filter})))}}]),t}(f.default.Component);t.default=x,x.propTypes={instanceName:w.PropTypes.string.isRequired,contextObject:w.ImmutablePropTypes.map}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),l=r(c),u=n(4),f=r(u),p=n(1),h=n(3),m=n(47),d=r(m),g=n(5),y=n(9),b=r(y),v=n(2),w=0,x=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return w++,n.instanceName="as_widget_instance"+w,n.dataURL=(0,h.getAppSetup)().getIn(["cs-activitystream-web","dataURL"]),n.state={postingFilter:f.default.fromJS({systemposting:"off"})},n}return i(t,e),s(t,[{key:"render",value:function(){return l.default.createElement(d.default.DashboardItem,{item:this.props.item,title:(0,g.formatStr)("activities")},l.default.createElement(b.default,{className:(0,v.prefixNS)("dashboard-widget"),instanceName:this.instanceName,initDataURL:this.dataURL,filter:this.state.postingFilter}))}}]),t}(l.default.Component);t.default=x,x.propTypes={item:p.ImmutablePropTypes.map.isRequired}},function(e,t){e.exports=s}])});
//# sourceMappingURL=cs-activitystream-web.js.map