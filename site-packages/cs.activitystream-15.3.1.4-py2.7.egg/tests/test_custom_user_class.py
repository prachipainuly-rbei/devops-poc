import unittest
from cdb import testcase
from cdb.objects.org import User
from cs.sharing.groups import RecipientCollection
from cs.sharing.groups import RecipientsBrowser


class CustomUser(User):
    pass


CADDOK = None


def setUpModule():
    testcase.run_level_setup()
    global CADDOK
    CADDOK = [CustomUser.ByKeys("caddok")]


class test_CustomUserClass(unittest.TestCase):
    def test_recipient_collection(self):
        rc = RecipientCollection()
        self.assertEqual(rc.objectsToSubjects(CADDOK), [("caddok", "Person")])

    def test_structured_recipients(self):
        self.assertTrue(
            RecipientsBrowser.getAllPossibleRecipients(flat=False))

    def test_flat_recipients(self):
        self.assertTrue(
            RecipientsBrowser.getAllPossibleRecipients(flat=True))


# Allow running this testfile directly
if __name__ == "__main__":
    unittest.main()
