# Copyright (C) 2016 CONTACT Software GmbH
# All rights reserved.
# http://www.contact.de/
#

Feature: Daily Activity Mails


Background:
    GIVEN user is logged in the web-client
        AND user has an email address
        AND no postings and comments exist
        AND user sets setting 'user.email_daily_as' to '1'


Scenario: User Without Daily Activities
    GIVEN user sets setting 'user.email_daily_as' to '0'
        AND post and comment exist
    WHEN daily activities are sent
    THEN user does not get an email


Scenario: No New Activities
    GIVEN post and comment exist
        AND the post is from two days ago
        AND the comment is from two days ago
    WHEN daily activities are sent
    THEN user does not get an email


Scenario Outline: New Activities
    GIVEN post and comment exist
        AND the post is from <post>
        AND the comment is from <comment>
    WHEN daily activities are sent
    THEN user gets an email with <new_posts> posts and <new_comments> comments

    Examples:
        | post         | comment      | new_posts | new_comments |
        | two days ago | yesterday    | 1         | 1            |
        | two days ago | today        | 1         | 1            |
        | yesterday    | two days ago | 1         | 0            |
        | today        | two days ago | 1         | 0            |


Scenario: Subscribed Topics
    GIVEN a post exists in channel A
        AND a post exists in channel B
        AND the post in channel A is from today
        AND the post in channel B is from today
        AND user is subscribed to channel B
    WHEN daily activities are sent
    THEN user gets an email with 0 posts in channel A
        AND user gets an email with 1 posts in channel B


Scenario: My Sharings
    GIVEN caddok shared something today
        AND user shared something today
        AND user shared something two days ago
    WHEN daily activities are sent
    THEN user gets an email with 1 sharings
