#!/usr/bin/env python
# -*- python -*- coding: iso-8859-1 -*-
#
# Copyright (C) 1990 - 2012 CONTACT Software GmbH
# All rights reserved.
# http://www.contact.de/
#

from cdb.validationkit import when, then, operation, run_with_added_roles
from cdb.objects.blog import Channel


# -------------------------------------------------------------
# Scenario: User creates a channel
#
# -------------------------------------------------------------
@when("^user creates a new channel$")
@run_with_added_roles(["Administrator"])
def step(context):
    context.channelLen = len(Channel.Query())
    operation("CDB_Create", Channel, user_input={"title_de": "Test", "title_en": "test"})


@then("^a new channel exists$")
def step(context):
    assert len(Channel.Query()) - context.channelLen == 1
