

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Objekte teilen &mdash; Activities</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Stichwortverzeichnis"
              href="genindex.html"/>
        <link rel="search" title="Suche" href="search.html"/>
    <link rel="top" title="Activities" href="index.html"/>
        <link rel="prev" title="Aktivitäten" href="admin_activitystream.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="/doc/de" class="icon fa-book">
            Dokumentationsportal
          </a>
        

        
          <a href="index.html" class="icon icon-home"> Activities
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="admin_activitystream_intro.html">Einleitung</a></li>
<li class="toctree-l1"><a class="reference internal" href="admin_activitystream.html">Aktivitäten</a><ul>
<li class="toctree-l2"><a class="reference internal" href="admin_activitystream.html#themen-abonnieren">Themen abonnieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="admin_activitystream.html#systembeitrag">Systembeitrag</a></li>
<li class="toctree-l2"><a class="reference internal" href="admin_activitystream.html#anzeige-der-aktivitaten-als-registerkarte">Anzeige der Aktivitäten als Registerkarte</a></li>
<li class="toctree-l2"><a class="reference internal" href="admin_activitystream.html#kanale">Kanäle</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="admin_activitystream.html#tagliche-zusammenfassung-als-e-mail">Tägliche Zusammenfassung als E-Mail</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Objekte teilen</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#operationsablauf">Operationsablauf</a></li>
<li class="toctree-l2"><a class="reference internal" href="#groups">Empfängerlisten</a></li>
<li class="toctree-l2"><a class="reference internal" href="#eingebettete-esearch">Eingebettete Enterprise-Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="#einrichtung-fur-eigene-klassen">Einrichtung für eigene Klassen</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Activities</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Objekte teilen</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/sharing_overview.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="objekte-teilen">
<span id="helpid-cdb-sharing-admin"></span><span id="overview"></span><h1>Objekte teilen<a class="headerlink" href="#objekte-teilen" title="Link zu dieser Überschrift">¶</a></h1>
<div class="section" id="operationsablauf">
<h2>Operationsablauf<a class="headerlink" href="#operationsablauf" title="Link zu dieser Überschrift">¶</a></h2>
<p>Die Operation <code class="xref py py-obj docutils literal"><span class="pre">Teilen</span> <span class="pre">(cdb_share_objects)</span></code> kann mit oder ohne Kontext aufgerufen
werden. Im Wesentlichen ruft sie die URL des Dialogs zum Teilen auf, ggf.
ergänzt um die cdb_object_ids der Kontextobjekte.</p>
<ul class="simple">
<li>URL ohne Kontext: <code class="xref py py-obj docutils literal"><span class="pre">$CADDOK_WWWSERVICE_URL/share_objects</span></code></li>
<li>URL mit Kontext: <code class="xref py py-obj docutils literal"><span class="pre">$CADDOK_WWWSERVICE_URL/share_objects?attachments=eb5af880-4be0-11e0-a016-005056c00008,99504583-76e1-11de-a2d5-986f0c508d59</span></code></li>
</ul>
<p>Im Dialog muss der Nutzer jeweils mindestens ein geteiltes Objekt und einen
Empfänger auswählen. Da auch allgemeine Rollen und Empfängerlisten als Empfänger
nutzbar sind, kann die Operation erst nach Abschluss sicher bestimmen, ob die
Auswahl mindestens einen gültigen Empfänger enthält.</p>
<p>Sobald der Dialog erfolgreich abgeschlossen wird, wird im Hintergrund ein Objekt
der Klasse <code class="xref py py-obj docutils literal"><span class="pre">cdb_sharing</span> <span class="pre">(cs.sharing.Sharing)</span></code> angelegt. Dieses dient als
Nachrichtenkanal, in dem sofort ein Beitrag mit dem eingegebenen Nachrichtentext
und den geteilten Objekten als Anhang erstellt wird. Das Objekt selbst enthält
ansonsten nur Daten der Änderungsverfolgung, wobei nur Anlagedatum und Ersteller
(<code class="xref py py-obj docutils literal"><span class="pre">cdb_cdate</span></code> respektive <code class="xref py py-obj docutils literal"><span class="pre">cdb_cpersno</span></code>) relevant sind.</p>
<p>Nachrichten abonnierter Kanäle für das <code class="xref py py-obj docutils literal"><span class="pre">cdb_sharing</span></code> Objekt sowie eventuelle E-Mail
Benachrichtigungen (einstellbar in den persönlichen Einstellungen) werden
asynchron durch eine Message Queue erzeugt. Wartende und fehlgeschlagene Aufträge
können Sie unter
<span class="menuselection">Administration/Konfiguration ‣ Teilen ‣ Teilen-Aufträge</span>
einsehen und ggf. neu starten.</p>
</div>
<div class="section" id="groups">
<span id="helpid-cdb-sharing-admin-group"></span><h2>Empfängerlisten<a class="headerlink" href="#groups" title="Link zu dieser Überschrift">¶</a></h2>
<p>Nutzer haben die Möglichkeit, sich die aktuelle Auswahl an Empfängern als eigene
Empfängerliste zu speichern. Dazu vergeben sie einen Namen und es wird ein Objekt der
Klasse <code class="xref py py-obj docutils literal"><span class="pre">cdb_personal_sharing_group</span> <span class="pre">(cs.sharing.groups.PersonalSharingGroup)</span></code>
und die Empfänger als Einträge der Klasse
<code class="xref py py-obj docutils literal"><span class="pre">cdb_sharing_group_member</span> <span class="pre">(cs.sharing.groups.SharingGroupMember)</span></code>
angelegt.</p>
<p>Als zugeordnete Empfänger zulässig sind zur Zeit nur Benutzer (<code class="xref py py-obj docutils literal"><span class="pre">angestellter</span></code>),
allgemeine Rollen (<code class="xref py py-obj docutils literal"><span class="pre">cdb_global_role</span></code>) und Empfängerlisten selbst, wobei diese
Einschränkung bei der Anlage nicht geprüft wird.</p>
<p>Empfängerlisten können auch administrativ für bestimmte Anwenderkreise (z.B. &#8220;public&#8221;)
eingerichtet werden. Ist eine Empfängerliste für eine Rolle eingerichtet, sehen alle
Inhaber dieser Rolle die Empfängerliste und können sie verwenden. Änderungsrechte sind
in diesem Fall aber Administratoren vorbehalten.</p>
<div class="section" id="objektspezifische-groups">
<h3>Objektspezifische Empfängerlisten<a class="headerlink" href="#objektspezifische-groups" title="Link zu dieser Überschrift">¶</a></h3>
<p>Geteilte Objekte können dynamische Empfängerlisten (Klasse
<code class="xref py py-obj docutils literal"><span class="pre">cdb_object_sharing_group</span> <span class="pre">(cs.sharing.groups.ObjectSharingGroup)</span></code>)
besitzen, die der Nutzer als Empfänger auswählen kann. Diese Listen sind
vordefiniert und werden anhand einer Objektregel allen geteilten Objekten
zugeordnet, die diese Regel erfüllen.</p>
<p>Aufgelöst werden diese Listen entweder anhand einer Objektmethode der
Powerscriptklasse des geteilten Objekts oder eines ihrer Attribute. Im ersten
Fall muss die Methode eine Liste von Tupeln aus <code class="xref py py-obj docutils literal"><span class="pre">subject_id</span></code> und <code class="xref py py-obj docutils literal"><span class="pre">subject_type</span></code>
zurück liefern, im zweiten muss das Attribut genau eine Personalnummer
(<code class="xref py py-obj docutils literal"><span class="pre">angestellter.personalnummer</span></code>) enthalten.</p>
</div>
</div>
<div class="section" id="eingebettete-esearch">
<h2>Eingebettete Enterprise-Search<a class="headerlink" href="#eingebettete-esearch" title="Link zu dieser Überschrift">¶</a></h2>
<p>Der &#8220;Teilen&#8221; Dialog nutzt die Enterprise-Search für die Funktionalität des Feldes &#8220;Nach
Objekten suchen&#8221;. Bitte stellen Sie sicher, dass alle hierfür benötigten Dienste
laufen und erreichbar sind.</p>
</div>
<div class="section" id="einrichtung-fur-eigene-klassen">
<h2>Einrichtung für eigene Klassen<a class="headerlink" href="#einrichtung-fur-eigene-klassen" title="Link zu dieser Überschrift">¶</a></h2>
<p>Damit Objekte einer Klasse geteilt werden können, muss die Klasse zunächst für
die REST API freigeschaltet werden. Dazu muss in der Klassenkonfiguration die
Option &#8220;REST API aktiv&#8221; an und ein eindeutiger &#8220;REST Name&#8221; vergeben sein.</p>
<div class="section" id="operation-verfugbar-machen">
<h3>Operation verfügbar machen<a class="headerlink" href="#operation-verfugbar-machen" title="Link zu dieser Überschrift">¶</a></h3>
<p>Um im Kontextmenü ihrer eigenen Klasse die Operation <code class="docutils literal"><span class="pre">Teilen</span></code> nutzbar zu
machen, müssen Sie zunächst die Operation <code class="docutils literal"><span class="pre">cdb_share_objects</span></code> in der
Operationskonfiguration (
<span class="menuselection">Administration/Konfiguration ‣ Administration ‣ Operationen</span>
) für die Klasse aktivieren. Anschließend müssen Sie in der Powerscriptklasse
Code analog zu diesem Beispiel einbinden:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cs.sharing.share_objects</span> <span class="kn">import</span> <span class="n">WithSharing</span>
<span class="kn">from</span> <span class="nn">cs.documents</span> <span class="kn">import</span> <span class="n">Document</span>

<span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="n">Document</span><span class="p">,</span> <span class="n">WithSharing</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="section" id="objektspezifische-groups-einrichten">
<span id="helpid-cdb-sharing-admin-object-group"></span><h3>Objektspezifische Empfängerlisten einrichten<a class="headerlink" href="#objektspezifische-groups-einrichten" title="Link zu dieser Überschrift">¶</a></h3>
<p>Objektspezifische Empfängerlisten für die Klasse können wie folgt eingerichtet werden:</p>
<ol class="arabic simple">
<li>Anlage einer neuen Empfängerliste (oder Auswahl einer bestehenden) unter
<span class="menuselection">Administration/Konfiguration ‣ Teilen ‣ Empfängerlisten</span></li>
<li>Die Objektregel der Empfängerliste muss ein Prädikat mit mindestens einem Term für
die Klasse enthalten. Nur Objekte, die diese Regel erfüllen, bieten die
Empfängerliste im Dialog an.</li>
<li>Wenn die Empfängerliste nicht mit einem einfachen Attribut auskommt, in dem eine
Personalnummer steht, muss eine Methode an der Powerscriptklasse eingerichtet
werden, z.B. so:</li>
</ol>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cdb.objects</span> <span class="kn">import</span> <span class="n">Object</span>

<span class="k">class</span> <span class="nc">myObjectsClass</span><span class="p">(</span><span class="n">Object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">getCustomRecipients</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sharingGroup</span><span class="p">):</span>
        <span class="s2">&quot;Empfängerliste auflösen/resolve recipient list&quot;</span>
        <span class="k">return</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">cdb_cpersno</span><span class="p">,</span> <span class="s2">&quot;Person&quot;</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subject_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">subject_type</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Administrator&quot;</span><span class="p">,</span> <span class="s2">&quot;Common Role&quot;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="admin_activitystream.html" class="btn btn-neutral" title="Aktivitäten" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Contact Software.
      Zuletzt aktualisiert am 04.06.2018.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'15.3.1.4',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>